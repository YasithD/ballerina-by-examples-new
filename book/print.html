<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="categories/hello-world/index.html"><strong aria-hidden="true">1.</strong> Hello World</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/hello-world/hello-world.html"><strong aria-hidden="true">1.1.</strong> Hello World Main</a></li><li class="chapter-item expanded "><a href="categories/hello-world/hello-world-service.html"><strong aria-hidden="true">1.2.</strong> Hello World Service</a></li></ol></li><li class="chapter-item expanded "><a href="categories/basics/index.html"><strong aria-hidden="true">2.</strong> Basics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/basics/programs-and-modules.html"><strong aria-hidden="true">2.1.</strong> Programs and Modules</a></li><li class="chapter-item expanded "><a href="categories/basics/variables-and-types.html"><strong aria-hidden="true">2.2.</strong> Variables and Types</a></li><li class="chapter-item expanded "><a href="categories/basics/identifiers.html"><strong aria-hidden="true">2.3.</strong> Identifiers</a></li></ol></li><li class="chapter-item expanded "><a href="categories/simple-basic-types/index.html"><strong aria-hidden="true">3.</strong> Simple Basic Types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/simple-basic-types/integers.html"><strong aria-hidden="true">3.1.</strong> Integers</a></li><li class="chapter-item expanded "><a href="categories/simple-basic-types/floating-point-numbers.html"><strong aria-hidden="true">3.2.</strong> Floating Point Numbers</a></li><li class="chapter-item expanded "><a href="categories/simple-basic-types/decimal-type.html"><strong aria-hidden="true">3.3.</strong> Decimal Type</a></li><li class="chapter-item expanded "><a href="categories/simple-basic-types/nil.html"><strong aria-hidden="true">3.4.</strong> Nil</a></li></ol></li><li class="chapter-item expanded "><a href="categories/strings/index.html"><strong aria-hidden="true">4.</strong> Strings</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/strings/strings.html"><strong aria-hidden="true">4.1.</strong> Strings</a></li></ol></li><li class="chapter-item expanded "><a href="categories/conditional-statements/index.html"><strong aria-hidden="true">5.</strong> Conditional Statements</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/conditional-statements/booleans.html"><strong aria-hidden="true">5.1.</strong> Booleans and Conditionals</a></li><li class="chapter-item expanded "><a href="categories/conditional-statements/match-statement.html"><strong aria-hidden="true">5.2.</strong> Match Statement</a></li></ol></li><li class="chapter-item expanded "><a href="categories/functions/index.html"><strong aria-hidden="true">6.</strong> Functions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/functions/functions.html"><strong aria-hidden="true">6.1.</strong> Functions</a></li><li class="chapter-item expanded "><a href="categories/functions/function-values.html"><strong aria-hidden="true">6.2.</strong> Function Values</a></li></ol></li><li class="chapter-item expanded "><a href="categories/iteration/index.html"><strong aria-hidden="true">7.</strong> Iteration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/iteration/foreach-statement.html"><strong aria-hidden="true">7.1.</strong> Foreach Statement</a></li><li class="chapter-item expanded "><a href="categories/iteration/while-statement.html"><strong aria-hidden="true">7.2.</strong> While Statement</a></li></ol></li><li class="chapter-item expanded "><a href="categories/lang-library/index.html"><strong aria-hidden="true">8.</strong> Lang Library</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/lang-library/langlib-functions.html"><strong aria-hidden="true">8.1.</strong> Langlib Functions</a></li></ol></li><li class="chapter-item expanded "><a href="categories/types-and-typing/index.html"><strong aria-hidden="true">9.</strong> Types and Typing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/types-and-typing/arrays.html"><strong aria-hidden="true">9.1.</strong> Arrays</a></li><li class="chapter-item expanded "><a href="categories/types-and-typing/binary-data.html"><strong aria-hidden="true">9.2.</strong> Binary Data</a></li><li class="chapter-item expanded "><a href="categories/types-and-typing/structural-typing.html"><strong aria-hidden="true">9.3.</strong> Structural Typing</a></li><li class="chapter-item expanded "><a href="categories/types-and-typing/unions.html"><strong aria-hidden="true">9.4.</strong> Unions</a></li><li class="chapter-item expanded "><a href="categories/types-and-typing/error-reporting.html"><strong aria-hidden="true">9.5.</strong> Errors</a></li><li class="chapter-item expanded "><a href="categories/types-and-typing/anydata-type.html"><strong aria-hidden="true">9.6.</strong> Anydata Type</a></li><li class="chapter-item expanded "><a href="categories/types-and-typing/any-type.html"><strong aria-hidden="true">9.7.</strong> Any Type</a></li><li class="chapter-item expanded "><a href="categories/types-and-typing/type-definitions.html"><strong aria-hidden="true">9.8.</strong> Type Definitions</a></li><li class="chapter-item expanded "><a href="categories/types-and-typing/covariance.html"><strong aria-hidden="true">9.9.</strong> Covariance</a></li><li class="chapter-item expanded "><a href="categories/types-and-typing/type-inference.html"><strong aria-hidden="true">9.10.</strong> Type Inference </a></li></ol></li><li class="chapter-item expanded "><a href="categories/mappings/index.html"><strong aria-hidden="true">10.</strong> Mappings</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/mappings/maps.html"><strong aria-hidden="true">10.1.</strong> Maps</a></li><li class="chapter-item expanded "><a href="categories/mappings/records.html"><strong aria-hidden="true">10.2.</strong> Records</a></li></ol></li><li class="chapter-item expanded "><a href="categories/records/index.html"><strong aria-hidden="true">11.</strong> Records</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/records/optional-fields.html"><strong aria-hidden="true">11.1.</strong> Optional Fields</a></li><li class="chapter-item expanded "><a href="categories/records/open-records.html"><strong aria-hidden="true">11.2.</strong> Open Records</a></li><li class="chapter-item expanded "><a href="categories/records/controlling-openness.html"><strong aria-hidden="true">11.3.</strong> Controlling Openness</a></li></ol></li><li class="chapter-item expanded "><a href="categories/objects/index.html"><strong aria-hidden="true">12.</strong> Objects</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/objects/object.html"><strong aria-hidden="true">12.1.</strong> Object</a></li><li class="chapter-item expanded "><a href="categories/objects/defining-classes.html"><strong aria-hidden="true">12.2.</strong> Defining Classes</a></li><li class="chapter-item expanded "><a href="categories/objects/init-return-type.html"><strong aria-hidden="true">12.3.</strong> Init Return Type</a></li></ol></li><li class="chapter-item expanded "><a href="categories/error-handling/index.html"><strong aria-hidden="true">13.</strong> Error Handling</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/error-handling/error-handling.html"><strong aria-hidden="true">13.1.</strong> Error Handling</a></li><li class="chapter-item expanded "><a href="categories/error-handling/check-expression.html"><strong aria-hidden="true">13.2.</strong> Check Expression</a></li><li class="chapter-item expanded "><a href="categories/error-handling/error-subtyping.html"><strong aria-hidden="true">13.3.</strong> Error Subtyping</a></li><li class="chapter-item expanded "><a href="categories/error-handling/panics.html"><strong aria-hidden="true">13.4.</strong> Panics</a></li></ol></li><li class="chapter-item expanded "><a href="categories/ignoring-return-values-and-errors/index.html"><strong aria-hidden="true">14.</strong> Ignoring Return Values and Errors</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/ignoring-return-values-and-errors/ignoring-return-values-and-errors.html"><strong aria-hidden="true">14.1.</strong> Ignoring Return Values and Errors</a></li></ol></li><li class="chapter-item expanded "><a href="categories/mutability-and-identity/index.html"><strong aria-hidden="true">15.</strong> Mutability and Identity</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/mutability-and-identity/identity.html"><strong aria-hidden="true">15.1.</strong> Identity</a></li><li class="chapter-item expanded "><a href="categories/mutability-and-identity/const-and-final.html"><strong aria-hidden="true">15.2.</strong> Const and Final </a></li><li class="chapter-item expanded "><a href="categories/mutability-and-identity/enumerations.html"><strong aria-hidden="true">15.3.</strong> Enumerations</a></li><li class="chapter-item expanded "><a href="categories/mutability-and-identity/immutability.html"><strong aria-hidden="true">15.4.</strong> Immutability</a></li></ol></li><li class="chapter-item expanded "><a href="categories/json/index.html"><strong aria-hidden="true">16.</strong> JSON</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/json/json-type.html"><strong aria-hidden="true">16.1.</strong> JSON Type</a></li><li class="chapter-item expanded "><a href="categories/json/working-directly-with-json.html"><strong aria-hidden="true">16.2.</strong> Working directly with JSON</a></li><li class="chapter-item expanded "><a href="categories/json/match-statement-with-maps.html"><strong aria-hidden="true">16.3.</strong> Match Statement With Maps</a></li><li class="chapter-item expanded "><a href="categories/json/converting-from-user-defined-type-to-json.html"><strong aria-hidden="true">16.4.</strong> Converting From User-Defined Type to JSON</a></li><li class="chapter-item expanded "><a href="categories/json/converting-from-json-to-user-defined-type.html"><strong aria-hidden="true">16.5.</strong> Converting From JSON to User-Defined Type</a></li><li class="chapter-item expanded "><a href="categories/json/converting-to-user-defined-type.html"><strong aria-hidden="true">16.6.</strong> Converting to User-Defined Type</a></li><li class="chapter-item expanded "><a href="categories/json/resource-method-typing.html"><strong aria-hidden="true">16.7.</strong> Resource Method Typing</a></li><li class="chapter-item expanded "><a href="categories/json/json-numbers.html"><strong aria-hidden="true">16.8.</strong> JSON Numbers</a></li></ol></li><li class="chapter-item expanded "><a href="categories/tables/index.html"><strong aria-hidden="true">17.</strong> Tables</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/tables/table-syntax.html"><strong aria-hidden="true">17.1.</strong> Table Syntax</a></li><li class="chapter-item expanded "><a href="categories/tables/multiple-key-fields.html"><strong aria-hidden="true">17.2.</strong> Multiple Key Fields</a></li><li class="chapter-item expanded "><a href="categories/tables/structured-keys.html"><strong aria-hidden="true">17.3.</strong> Structured Keys</a></li></ol></li><li class="chapter-item expanded "><a href="categories/query-expressions/index.html"><strong aria-hidden="true">18.</strong> Query Expressions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/query-expressions/query-expressions.html"><strong aria-hidden="true">18.1.</strong> Query Expressions</a></li><li class="chapter-item expanded "><a href="categories/query-expressions/destructuring-records.html"><strong aria-hidden="true">18.2.</strong> Destructuring Records</a></li><li class="chapter-item expanded "><a href="categories/query-expressions/let-clause.html"><strong aria-hidden="true">18.3.</strong> Let Clause</a></li><li class="chapter-item expanded "><a href="categories/query-expressions/ordering.html"><strong aria-hidden="true">18.4.</strong> Ordering</a></li><li class="chapter-item expanded "><a href="categories/query-expressions/limit-clause.html"><strong aria-hidden="true">18.5.</strong> Limit Clause</a></li><li class="chapter-item expanded "><a href="categories/query-expressions/querying-tables.html"><strong aria-hidden="true">18.6.</strong> Querying Tables</a></li><li class="chapter-item expanded "><a href="categories/query-expressions/creating-tables-with-query.html"><strong aria-hidden="true">18.7.</strong> Creating Tables With Query</a></li><li class="chapter-item expanded "><a href="categories/query-expressions/join-clause.html"><strong aria-hidden="true">18.8.</strong> Join Clause</a></li><li class="chapter-item expanded "><a href="categories/query-expressions/stream-type.html"><strong aria-hidden="true">18.9.</strong> Stream Type</a></li><li class="chapter-item expanded "><a href="categories/query-expressions/querying-with-streams.html"><strong aria-hidden="true">18.10.</strong> Querying With Streams</a></li></ol></li><li class="chapter-item expanded "><a href="categories/backtick-templates/index.html"><strong aria-hidden="true">19.</strong> Backtick Templates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/backtick-templates/raw-templates.html"><strong aria-hidden="true">19.1.</strong> Raw Templates</a></li><li class="chapter-item expanded "><a href="categories/backtick-templates/backtick-templates.html"><strong aria-hidden="true">19.2.</strong> Backtick Templates</a></li><li class="chapter-item expanded "><a href="categories/backtick-templates/xml-templates.html"><strong aria-hidden="true">19.3.</strong> XML Templates</a></li></ol></li><li class="chapter-item expanded "><a href="categories/xml/index.html"><strong aria-hidden="true">20.</strong> XML</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/xml/xml-data-model.html"><strong aria-hidden="true">20.1.</strong> XML Data Model</a></li><li class="chapter-item expanded "><a href="categories/xml/xml-operations.html"><strong aria-hidden="true">20.2.</strong> XML Operations</a></li><li class="chapter-item expanded "><a href="categories/xml/xml-subtyping.html"><strong aria-hidden="true">20.3.</strong> XML Subtyping</a></li><li class="chapter-item expanded "><a href="categories/xml/xml-navigation.html"><strong aria-hidden="true">20.4.</strong> XML Navigation </a></li><li class="chapter-item expanded "><a href="categories/xml/xml-templates-and-query.html"><strong aria-hidden="true">20.5.</strong> XML Templates and Query</a></li><li class="chapter-item expanded "><a href="categories/xml/xml-namespaces.html"><strong aria-hidden="true">20.6.</strong> XML Namespaces</a></li><li class="chapter-item expanded "><a href="categories/xml/xmlns-declarations.html"><strong aria-hidden="true">20.7.</strong> XMLNS Declarations</a></li></ol></li><li class="chapter-item expanded "><a href="categories/metadata/index.html"><strong aria-hidden="true">21.</strong> Metadata</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/metadata/documentation.html"><strong aria-hidden="true">21.1.</strong> Documentation</a></li><li class="chapter-item expanded "><a href="categories/metadata/annotations.html"><strong aria-hidden="true">21.2.</strong> Annotations</a></li></ol></li><li class="chapter-item expanded "><a href="categories/network-interaction/index.html"><strong aria-hidden="true">22.</strong> Network Interaction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/network-interaction/consuming-services.html"><strong aria-hidden="true">22.1.</strong> Consuming Services: Client Objects</a></li><li class="chapter-item expanded "><a href="categories/network-interaction/providing-services.html"><strong aria-hidden="true">22.2.</strong> Providing Services</a></li><li class="chapter-item expanded "><a href="categories/network-interaction/module-lifecycle.html"><strong aria-hidden="true">22.3.</strong> Module Lifecycle</a></li><li class="chapter-item expanded "><a href="categories/network-interaction/service-declaration.html"><strong aria-hidden="true">22.4.</strong> Service Declaration</a></li><li class="chapter-item expanded "><a href="categories/network-interaction/resource-methods.html"><strong aria-hidden="true">22.5.</strong> Resource Methods</a></li><li class="chapter-item expanded "><a href="categories/network-interaction/hierarchical-resources.html"><strong aria-hidden="true">22.6.</strong> Hierarchical Resources</a></li><li class="chapter-item expanded "><a href="categories/network-interaction/resource-path-parameters.html"><strong aria-hidden="true">22.7.</strong> Resource Path Parameters</a></li></ol></li><li class="chapter-item expanded "><a href="categories/configurability/index.html"><strong aria-hidden="true">23.</strong> Configurability</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/configurability/configurable-variables.html"><strong aria-hidden="true">23.1.</strong> Configurable Variables</a></li></ol></li><li class="chapter-item expanded "><a href="categories/concurrency/index.html"><strong aria-hidden="true">24.</strong> Concurrency</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/concurrency/asynchronous-function-calls.html"><strong aria-hidden="true">24.1.</strong> Asynchronous Function Calls</a></li><li class="chapter-item expanded "><a href="categories/concurrency/named-workers.html"><strong aria-hidden="true">24.2.</strong> Named Workers</a></li><li class="chapter-item expanded "><a href="categories/concurrency/sequence-diagrams.html"><strong aria-hidden="true">24.3.</strong> Sequence Diagrams</a></li><li class="chapter-item expanded "><a href="categories/concurrency/waiting-for-workers.html"><strong aria-hidden="true">24.4.</strong> Waiting for Workers</a></li><li class="chapter-item expanded "><a href="categories/concurrency/strands.html"><strong aria-hidden="true">24.5.</strong> Strands</a></li><li class="chapter-item expanded "><a href="categories/concurrency/named-worker-return-values.html"><strong aria-hidden="true">24.6.</strong> Named Worker Return Values</a></li><li class="chapter-item expanded "><a href="categories/concurrency/alternate-wait.html"><strong aria-hidden="true">24.7.</strong> Alternate Wait</a></li><li class="chapter-item expanded "><a href="categories/concurrency/multiple-wait.html"><strong aria-hidden="true">24.8.</strong> Multiple Wait</a></li><li class="chapter-item expanded "><a href="categories/concurrency/named-workers-and-futures.html"><strong aria-hidden="true">24.9.</strong> Named Workers and Futures</a></li><li class="chapter-item expanded "><a href="categories/concurrency/inter-worker-message-passing.html"><strong aria-hidden="true">24.10.</strong> Inter-Worker Message Passing</a></li><li class="chapter-item expanded "><a href="categories/concurrency/inter-worker-failure-propagation.html"><strong aria-hidden="true">24.11.</strong> Inter-Worker Failure Propagation</a></li></ol></li><li class="chapter-item expanded "><a href="categories/transactions/index.html"><strong aria-hidden="true">25.</strong> Transactions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/transactions/transaction-statement.html"><strong aria-hidden="true">25.1.</strong> Transaction Statement</a></li><li class="chapter-item expanded "><a href="categories/transactions/check-semantics.html"><strong aria-hidden="true">25.2.</strong> Check Semantics</a></li><li class="chapter-item expanded "><a href="categories/transactions/rollback.html"><strong aria-hidden="true">25.3.</strong> Rollback</a></li><li class="chapter-item expanded "><a href="categories/transactions/retry-transaction-statement.html"><strong aria-hidden="true">25.4.</strong> Retry Transaction Statement</a></li><li class="chapter-item expanded "><a href="categories/transactions/transactional-qualifier.html"><strong aria-hidden="true">25.5.</strong> Transactional Qualifier</a></li><li class="chapter-item expanded "><a href="categories/transactions/transactional-named-workers.html"><strong aria-hidden="true">25.6.</strong> Transactional Named Workers</a></li><li class="chapter-item expanded "><a href="categories/transactions/commit-rollback-handlers.html"><strong aria-hidden="true">25.7.</strong> Commit/Rollback Handlers</a></li></ol></li><li class="chapter-item expanded "><a href="categories/concurrency-safety/index.html"><strong aria-hidden="true">26.</strong> Concurrency Safety</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/concurrency-safety/lock-statement.html"><strong aria-hidden="true">26.1.</strong> Lock Statement</a></li><li class="chapter-item expanded "><a href="categories/concurrency-safety/isolated-functions.html"><strong aria-hidden="true">26.2.</strong> Isolated Functions</a></li><li class="chapter-item expanded "><a href="categories/concurrency-safety/readonly-type.html"><strong aria-hidden="true">26.3.</strong> Readonly Type</a></li><li class="chapter-item expanded "><a href="categories/concurrency-safety/readonly-and-isolated.html"><strong aria-hidden="true">26.4.</strong> Readonly and Isolated</a></li><li class="chapter-item expanded "><a href="categories/concurrency-safety/combining-isolated-functions-and-lock.html"><strong aria-hidden="true">26.5.</strong> Combining Isolated Functions and Lock</a></li><li class="chapter-item expanded "><a href="categories/concurrency-safety/isolated-variables.html"><strong aria-hidden="true">26.6.</strong> Isolated Variables</a></li><li class="chapter-item expanded "><a href="categories/concurrency-safety/isolated-methods.html"><strong aria-hidden="true">26.7.</strong> Isolated Methods</a></li><li class="chapter-item expanded "><a href="categories/concurrency-safety/isolated-objects.html"><strong aria-hidden="true">26.8.</strong> Isolated Objects</a></li><li class="chapter-item expanded "><a href="categories/concurrency-safety/inferring-isolated.html"><strong aria-hidden="true">26.9.</strong> Inferring Isolated</a></li></ol></li><li class="chapter-item expanded "><a href="categories/testing/index.html"><strong aria-hidden="true">27.</strong> Testing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/testing/testerina-assertions.html"><strong aria-hidden="true">27.1.</strong> Assertions</a></li><li class="chapter-item expanded "><a href="categories/testing/testerina-before-and-after-test.html"><strong aria-hidden="true">27.2.</strong> Before and After Test</a></li><li class="chapter-item expanded "><a href="categories/testing/testerina-before-and-after-each.html"><strong aria-hidden="true">27.3.</strong> Before and After Each</a></li><li class="chapter-item expanded "><a href="categories/testing/testerina-before-and-after-groups.html"><strong aria-hidden="true">27.4.</strong> Before and After Groups</a></li><li class="chapter-item expanded "><a href="categories/testing/testerina-before-and-after-suite.html"><strong aria-hidden="true">27.5.</strong> Before and After Suite</a></li><li class="chapter-item expanded "><a href="categories/testing/testerina-data-driven-tests.html"><strong aria-hidden="true">27.6.</strong> Data Driven Tests</a></li><li class="chapter-item expanded "><a href="categories/testing/testerina-guarantee-test-execution-order.html"><strong aria-hidden="true">27.7.</strong> Guarantee Test Execution Order</a></li><li class="chapter-item expanded "><a href="categories/testing/testerina-group-tests.html"><strong aria-hidden="true">27.8.</strong> Group Tests</a></li><li class="chapter-item expanded "><a href="categories/testing/testerina-mocking-functions.html"><strong aria-hidden="true">27.9.</strong> Function Mocking</a></li><li class="chapter-item expanded "><a href="categories/testing/testerina-mocking-objects.html"><strong aria-hidden="true">27.10.</strong> Object Mocking</a></li></ol></li><li class="chapter-item expanded "><a href="categories/rest-api/index.html"><strong aria-hidden="true">28.</strong> REST API</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/rest-api/http-absolute-path-and-path.html"><strong aria-hidden="true">28.1.</strong> Service Path and Resource Path</a></li><li class="chapter-item expanded "><a href="categories/rest-api/http-data-binding.html"><strong aria-hidden="true">28.2.</strong> Service Data Binding</a></li><li class="chapter-item expanded "><a href="categories/rest-api/http-default-resource.html"><strong aria-hidden="true">28.3.</strong> Default Resource</a></li><li class="chapter-item expanded "><a href="categories/rest-api/http-path-param.html"><strong aria-hidden="true">28.4.</strong> Path Parameter</a></li><li class="chapter-item expanded "><a href="categories/rest-api/http-query-parameter.html"><strong aria-hidden="true">28.5.</strong> Query Parameter</a></li><li class="chapter-item expanded "><a href="categories/rest-api/http-matrix-param.html"><strong aria-hidden="true">28.6.</strong> Matrix Parameter</a></li><li class="chapter-item expanded "><a href="categories/rest-api/http-header-param.html"><strong aria-hidden="true">28.7.</strong> Header Parameter</a></li><li class="chapter-item expanded "><a href="categories/rest-api/http-resource-returns.html"><strong aria-hidden="true">28.8.</strong> Typed Resource Responses</a></li><li class="chapter-item expanded "><a href="categories/rest-api/http-restrict-by-media-type.html"><strong aria-hidden="true">28.9.</strong> Restrict By Media Type</a></li></ol></li><li class="chapter-item expanded "><a href="categories/rest-client/index.html"><strong aria-hidden="true">29.</strong> REST Client</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/rest-client/http-client-endpoint.html"><strong aria-hidden="true">29.1.</strong> Client</a></li><li class="chapter-item expanded "><a href="categories/rest-client/http-client-data-binding.html"><strong aria-hidden="true">29.2.</strong> Client Data Binding</a></li><li class="chapter-item expanded "><a href="categories/rest-client/http-caching-client.html"><strong aria-hidden="true">29.3.</strong> Caching Client</a></li></ol></li><li class="chapter-item expanded "><a href="categories/rest-api-security/index.html"><strong aria-hidden="true">30.</strong> REST API Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/rest-api-security/http-service-ssl-tls.html"><strong aria-hidden="true">30.1.</strong> Service - SSL/TLS</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-service-mutual-ssl.html"><strong aria-hidden="true">30.2.</strong> Service - Mutual SSL</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-service-basic-auth-file-user-store.html"><strong aria-hidden="true">30.3.</strong> Service - Basic Auth File User Store</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-service-basic-auth-ldap-user-store.html"><strong aria-hidden="true">30.4.</strong> Service - Basic Auth LDAP User Store</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-service-jwt-auth.html"><strong aria-hidden="true">30.5.</strong> Service - JWT Auth</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-service-oauth2.html"><strong aria-hidden="true">30.6.</strong> Service - OAuth2</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-client-ssl-tls.html"><strong aria-hidden="true">30.7.</strong> Client - SSL/TLS</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-client-mutual-ssl.html"><strong aria-hidden="true">30.8.</strong> Client - Mutual SSL</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-client-basic-auth.html"><strong aria-hidden="true">30.9.</strong> Client - Basic Auth</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-client-bearer-token-auth.html"><strong aria-hidden="true">30.10.</strong> Client - Bearer Token Auth</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-client-self-signed-jwt-auth.html"><strong aria-hidden="true">30.11.</strong> Client - Self Signed JWT Auth</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-client-oauth2-client-credentials-grant-type.html"><strong aria-hidden="true">30.12.</strong> Client - OAuth2 Client Credentials Grant Type</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-client-oauth2-password-grant-type.html"><strong aria-hidden="true">30.13.</strong> Client - OAuth2 Password Grant Type</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-client-oauth2-refresh-token-grant-type.html"><strong aria-hidden="true">30.14.</strong> Client - OAuth2 Refresh Token Grant Type</a></li><li class="chapter-item expanded "><a href="categories/rest-api-security/http-client-oauth2-jwt-bearer-grant-type.html"><strong aria-hidden="true">30.15.</strong> Client - OAuth2 JWT Bearer Grant Type</a></li></ol></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/index.html"><strong aria-hidden="true">31.</strong> REST API Advanced</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-redirects.html"><strong aria-hidden="true">31.1.</strong> Redirects</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-cors.html"><strong aria-hidden="true">31.2.</strong> CORS</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-100-continue.html"><strong aria-hidden="true">31.3.</strong> 100 Continue</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-streaming.html"><strong aria-hidden="true">31.4.</strong> Streaming</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-compression.html"><strong aria-hidden="true">31.5.</strong> Compression</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-trace-logs.html"><strong aria-hidden="true">31.6.</strong> Trace logs</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-access-logs.html"><strong aria-hidden="true">31.7.</strong> Access logs</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-cookies.html"><strong aria-hidden="true">31.8.</strong> Cookies</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-disable-chunking.html"><strong aria-hidden="true">31.9.</strong> Chunking</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-response-with-multiparts.html"><strong aria-hidden="true">31.10.</strong> Response With Multiparts</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-request-with-multiparts.html"><strong aria-hidden="true">31.11.</strong> Request With Multiparts</a></li><li class="chapter-item expanded "><a href="categories/rest-api-advanced/http-passthrough.html"><strong aria-hidden="true">31.12.</strong> Passthrough</a></li></ol></li><li class="chapter-item expanded "><a href="categories/rest-api-interceptors/index.html"><strong aria-hidden="true">32.</strong> REST API Interceptors</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/rest-api-interceptors/http-request-interceptor-at-listener.html"><strong aria-hidden="true">32.1.</strong> Request Interceptor At Listener Level</a></li><li class="chapter-item expanded "><a href="categories/rest-api-interceptors/http-request-interceptor-at-service.html"><strong aria-hidden="true">32.2.</strong> Request Interceptor At Service Level</a></li><li class="chapter-item expanded "><a href="categories/rest-api-interceptors/http-request-error-interceptor.html"><strong aria-hidden="true">32.3.</strong> Request Error Interceptor</a></li></ol></li><li class="chapter-item expanded "><a href="categories/http2/index.html"><strong aria-hidden="true">33.</strong> HTTP2</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/http2/http-1-1-to-2-0-protocol-switch.html"><strong aria-hidden="true">33.1.</strong> HTTP 1.1 to 2.0 Protocol Switch</a></li><li class="chapter-item expanded "><a href="categories/http2/http-2-0-server-push.html"><strong aria-hidden="true">33.2.</strong> HTTP 2.0 Server Push</a></li></ol></li><li class="chapter-item expanded "><a href="categories/graphql/index.html"><strong aria-hidden="true">34.</strong> GraphQL</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/graphql/graphql-hello-world.html"><strong aria-hidden="true">34.1.</strong> Hello World</a></li><li class="chapter-item expanded "><a href="categories/graphql/graphql-returning-record-values.html"><strong aria-hidden="true">34.2.</strong> Returning Record Values</a></li><li class="chapter-item expanded "><a href="categories/graphql/graphql-hierarchical-resource-paths.html"><strong aria-hidden="true">34.3.</strong> Hierarchical Resource Paths</a></li><li class="chapter-item expanded "><a href="categories/graphql/graphql-returning-service-objects.html"><strong aria-hidden="true">34.4.</strong> Returning Service Objects</a></li><li class="chapter-item expanded "><a href="categories/graphql/graphql-input-types.html"><strong aria-hidden="true">34.5.</strong> Input Types</a></li><li class="chapter-item expanded "><a href="categories/graphql/graphql-mutations.html"><strong aria-hidden="true">34.6.</strong> Mutations</a></li><li class="chapter-item expanded "><a href="categories/graphql/graphql-context.html"><strong aria-hidden="true">34.7.</strong> Context</a></li><li class="chapter-item expanded "><a href="categories/graphql/graphql-file-upload.html"><strong aria-hidden="true">34.8.</strong> File Upload</a></li></ol></li><li class="chapter-item expanded "><a href="categories/graphql-security/index.html"><strong aria-hidden="true">35.</strong> GraphQL Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/graphql-security/graphql-service-ssl-tls.html"><strong aria-hidden="true">35.1.</strong> Service - SSL/TLS</a></li><li class="chapter-item expanded "><a href="categories/graphql-security/graphql-service-mutual-ssl.html"><strong aria-hidden="true">35.2.</strong> Service - Mutual SSL</a></li><li class="chapter-item expanded "><a href="categories/graphql-security/graphql-service-basic-auth-file-user-store.html"><strong aria-hidden="true">35.3.</strong> Service - Basic Auth File User Store</a></li><li class="chapter-item expanded "><a href="categories/graphql-security/graphql-service-basic-auth-ldap-user-store.html"><strong aria-hidden="true">35.4.</strong> Service - Basic Auth LDAP User Store</a></li><li class="chapter-item expanded "><a href="categories/graphql-security/graphql-service-jwt-auth.html"><strong aria-hidden="true">35.5.</strong> Service - JWT Auth</a></li><li class="chapter-item expanded "><a href="categories/graphql-security/graphql-service-oauth2.html"><strong aria-hidden="true">35.6.</strong> Service - OAuth2</a></li></ol></li><li class="chapter-item expanded "><a href="categories/websockets/index.html"><strong aria-hidden="true">36.</strong> WebSockets</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/websockets/websocket-text-client.html"><strong aria-hidden="true">36.1.</strong> Handle Text Messages with Client</a></li><li class="chapter-item expanded "><a href="categories/websockets/websocket-binary-client.html"><strong aria-hidden="true">36.2.</strong> Handle Binary Messages with Client</a></li><li class="chapter-item expanded "><a href="categories/websockets/websocket-retry-client.html"><strong aria-hidden="true">36.3.</strong> Retry</a></li><li class="chapter-item expanded "><a href="categories/websockets/websocket-basic-sample.html"><strong aria-hidden="true">36.4.</strong> Listener Functionalities</a></li></ol></li><li class="chapter-item expanded "><a href="categories/websocket-security/index.html"><strong aria-hidden="true">37.</strong> WebSocket Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-service-ssl-tls.html"><strong aria-hidden="true">37.1.</strong> Service - SSL/TLS</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-service-mutual-ssl.html"><strong aria-hidden="true">37.2.</strong> Service - Mutual SSL</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-service-basic-auth-file-user-store.html"><strong aria-hidden="true">37.3.</strong> Service - Basic Auth File User Store</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-service-basic-auth-ldap-user-store.html"><strong aria-hidden="true">37.4.</strong> Service - Basic Auth LDAP User Store</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-service-jwt-auth.html"><strong aria-hidden="true">37.5.</strong> Service - JWT Auth</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-service-oauth2.html"><strong aria-hidden="true">37.6.</strong> Service - OAuth2</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-client-ssl-tls.html"><strong aria-hidden="true">37.7.</strong> Client - SSL/TLS</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-client-mutual-ssl.html"><strong aria-hidden="true">37.8.</strong> Client - Mutual SSL</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-client-basic-auth.html"><strong aria-hidden="true">37.9.</strong> Client - Basic Auth</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-client-bearer-token-auth.html"><strong aria-hidden="true">37.10.</strong> Client - Bearer Token Auth</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-client-self-signed-jwt-auth.html"><strong aria-hidden="true">37.11.</strong> Client - Self Signed JWT Auth</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-client-oauth2-client-cred-grant-type.html"><strong aria-hidden="true">37.12.</strong> Client - OAuth2 Client Credentials Grant Type</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-client-oauth2-password-grant-type.html"><strong aria-hidden="true">37.13.</strong> Client - OAuth2 Password Grant Type</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-client-oauth2-refresh-token-grant-type.html"><strong aria-hidden="true">37.14.</strong> Client - OAuth2 Refresh Token Grant Type</a></li><li class="chapter-item expanded "><a href="categories/websocket-security/websocket-client-oauth2-jwt-bearer-grant-type.html"><strong aria-hidden="true">37.15.</strong> Client - OAuth2 JWT Bearer Grant Type</a></li></ol></li><li class="chapter-item expanded "><a href="categories/websub/index.html"><strong aria-hidden="true">38.</strong> WebSub</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/websub/websub-webhook-sample.html"><strong aria-hidden="true">38.1.</strong> Websub Subscriber Service</a></li></ol></li><li class="chapter-item expanded "><a href="categories/resiliency/index.html"><strong aria-hidden="true">39.</strong> Resiliency</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/resiliency/http-circuit-breaker.html"><strong aria-hidden="true">39.1.</strong> Circuit Breaker</a></li><li class="chapter-item expanded "><a href="categories/resiliency/http-load-balancer.html"><strong aria-hidden="true">39.2.</strong> Load Balancer</a></li><li class="chapter-item expanded "><a href="categories/resiliency/http-failover.html"><strong aria-hidden="true">39.3.</strong> Failover</a></li><li class="chapter-item expanded "><a href="categories/resiliency/http-retry.html"><strong aria-hidden="true">39.4.</strong> Retry</a></li><li class="chapter-item expanded "><a href="categories/resiliency/http-timeout.html"><strong aria-hidden="true">39.5.</strong> Timeout</a></li></ol></li><li class="chapter-item expanded "><a href="categories/listeners/index.html"><strong aria-hidden="true">40.</strong> Listeners</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/listeners/dynamic-listener.html"><strong aria-hidden="true">40.1.</strong> Dynamic Listener</a></li></ol></li><li class="chapter-item expanded "><a href="categories/grpc/index.html"><strong aria-hidden="true">41.</strong> gRPC</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/grpc/grpc-simple.html"><strong aria-hidden="true">41.1.</strong> Simple RPC</a></li><li class="chapter-item expanded "><a href="categories/grpc/grpc-simple-with-headers.html"><strong aria-hidden="true">41.2.</strong> Simple RPC With Headers</a></li><li class="chapter-item expanded "><a href="categories/grpc/grpc-server-streaming.html"><strong aria-hidden="true">41.3.</strong> Server Streaming RPC</a></li><li class="chapter-item expanded "><a href="categories/grpc/grpc-client-streaming.html"><strong aria-hidden="true">41.4.</strong> Client Streaming RPC</a></li><li class="chapter-item expanded "><a href="categories/grpc/grpc-bidirectional-streaming.html"><strong aria-hidden="true">41.5.</strong> Bidirectional Streaming RPC</a></li><li class="chapter-item expanded "><a href="categories/grpc/proto-to-ballerina.html"><strong aria-hidden="true">41.6.</strong> Proto To Ballerina</a></li></ol></li><li class="chapter-item expanded "><a href="categories/grpc-security/index.html"><strong aria-hidden="true">42.</strong> gRPC Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-service-ssl-tls.html"><strong aria-hidden="true">42.1.</strong> Service - SSL/TLS</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-service-mutual-ssl.html"><strong aria-hidden="true">42.2.</strong> Service - Mutual SSL</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-service-basic-auth-file-user-store.html"><strong aria-hidden="true">42.3.</strong> Service - Basic Auth File User Store</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-service-basic-auth-ldap-user-store.html"><strong aria-hidden="true">42.4.</strong> Service - Basic Auth LDAP User Store</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-service-jwt-auth.html"><strong aria-hidden="true">42.5.</strong> Service - JWT Auth</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-service-oauth2.html"><strong aria-hidden="true">42.6.</strong> Service - OAuth2</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-client-ssl-tls.html"><strong aria-hidden="true">42.7.</strong> Client - SSL/TLS</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-client-mutual-ssl.html"><strong aria-hidden="true">42.8.</strong> Client - Mutual SSL</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-client-basic-auth.html"><strong aria-hidden="true">42.9.</strong> Client - Basic Auth</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-client-bearer-token-auth.html"><strong aria-hidden="true">42.10.</strong> Client - Bearer Token Auth</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-client-self-signed-jwt-auth.html"><strong aria-hidden="true">42.11.</strong> Client - Self Signed JWT Auth</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-client-oauth2-client-credentials-grant-type.html"><strong aria-hidden="true">42.12.</strong> Client - OAuth2 Client Credentials Grant Type</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-client-oauth2-password-grant-type.html"><strong aria-hidden="true">42.13.</strong> Client - OAuth2 Password Grant Type</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-client-oauth2-refresh-token-grant-type.html"><strong aria-hidden="true">42.14.</strong> Client - OAuth2 Refresh Token Grant Type</a></li><li class="chapter-item expanded "><a href="categories/grpc-security/grpc-client-oauth2-jwt-bearer-grant-type.html"><strong aria-hidden="true">42.15.</strong> Client - OAuth2 JWT Bearer Grant Type</a></li></ol></li><li class="chapter-item expanded "><a href="categories/nats/index.html"><strong aria-hidden="true">43.</strong> NATS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/nats/nats-basic-pub-sub.html"><strong aria-hidden="true">43.1.</strong> Publish/Subscribe</a></li><li class="chapter-item expanded "><a href="categories/nats/nats-basic-request-reply.html"><strong aria-hidden="true">43.2.</strong> Request/Reply</a></li><li class="chapter-item expanded "><a href="categories/nats/nats-basic-secure-connection.html"><strong aria-hidden="true">43.3.</strong> Secured Connection</a></li></ol></li><li class="chapter-item expanded "><a href="categories/stan/index.html"><strong aria-hidden="true">44.</strong> STAN</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/stan/nats-streaming-pub-sub.html"><strong aria-hidden="true">44.1.</strong> Publish/Subscribe</a></li><li class="chapter-item expanded "><a href="categories/stan/nats-streaming-queue-group.html"><strong aria-hidden="true">44.2.</strong> Queue Groups</a></li><li class="chapter-item expanded "><a href="categories/stan/nats-streaming-durable-subscriptions.html"><strong aria-hidden="true">44.3.</strong> Durable Subscriptions</a></li><li class="chapter-item expanded "><a href="categories/stan/nats-streaming-start-position.html"><strong aria-hidden="true">44.4.</strong> Historical Message Replay</a></li><li class="chapter-item expanded "><a href="categories/stan/nats-streaming-secure-connection.html"><strong aria-hidden="true">44.5.</strong> Secured Connection</a></li></ol></li><li class="chapter-item expanded "><a href="categories/kafka/index.html"><strong aria-hidden="true">45.</strong> Kafka</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/kafka/kafka-producer.html"><strong aria-hidden="true">45.1.</strong> Producer</a></li><li class="chapter-item expanded "><a href="categories/kafka/kafka-consumer-service.html"><strong aria-hidden="true">45.2.</strong> Consumer Service</a></li><li class="chapter-item expanded "><a href="categories/kafka/kafka-consumer-client.html"><strong aria-hidden="true">45.3.</strong> Consumer Client</a></li><li class="chapter-item expanded "><a href="categories/kafka/kafka-producer-transactional.html"><strong aria-hidden="true">45.4.</strong> Transactional Producer</a></li><li class="chapter-item expanded "><a href="categories/kafka/kafka-consumer-group-service.html"><strong aria-hidden="true">45.5.</strong> Consumer Groups</a></li><li class="chapter-item expanded "><a href="categories/kafka/kafka-authentication-sasl-plain-consumer.html"><strong aria-hidden="true">45.6.</strong> SASL Authentication - Consumer</a></li><li class="chapter-item expanded "><a href="categories/kafka/kafka-authentication-sasl-plain-producer.html"><strong aria-hidden="true">45.7.</strong> SASL Authentication - Producer</a></li></ol></li><li class="chapter-item expanded "><a href="categories/rabbitmq/index.html"><strong aria-hidden="true">46.</strong> RabbitMQ</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/rabbitmq/rabbitmq-producer.html"><strong aria-hidden="true">46.1.</strong> Producer</a></li><li class="chapter-item expanded "><a href="categories/rabbitmq/rabbitmq-consumer.html"><strong aria-hidden="true">46.2.</strong> Consumer</a></li><li class="chapter-item expanded "><a href="categories/rabbitmq/rabbitmq-consumer-with-client-acknowledgement.html"><strong aria-hidden="true">46.3.</strong> Client Acknowledgements</a></li><li class="chapter-item expanded "><a href="categories/rabbitmq/rabbitmq-transaction-producer.html"><strong aria-hidden="true">46.4.</strong> Transactional Producer</a></li><li class="chapter-item expanded "><a href="categories/rabbitmq/rabbitmq-transaction-consumer.html"><strong aria-hidden="true">46.5.</strong> Transactional Consumer</a></li><li class="chapter-item expanded "><a href="categories/rabbitmq/rabbitmq-secure-connection.html"><strong aria-hidden="true">46.6.</strong> Secured Connection</a></li></ol></li><li class="chapter-item expanded "><a href="categories/tcp/index.html"><strong aria-hidden="true">47.</strong> TCP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/tcp/tcp-client.html"><strong aria-hidden="true">47.1.</strong> Client</a></li><li class="chapter-item expanded "><a href="categories/tcp/tcp-listener.html"><strong aria-hidden="true">47.2.</strong> Listener</a></li><li class="chapter-item expanded "><a href="categories/tcp/tcp-transport-security.html"><strong aria-hidden="true">47.3.</strong> Transport Security</a></li></ol></li><li class="chapter-item expanded "><a href="categories/udp/index.html"><strong aria-hidden="true">48.</strong> UDP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/udp/udp-client.html"><strong aria-hidden="true">48.1.</strong> Connectionless Client</a></li><li class="chapter-item expanded "><a href="categories/udp/udp-connect-client.html"><strong aria-hidden="true">48.2.</strong> Connection-Oriented Client</a></li><li class="chapter-item expanded "><a href="categories/udp/udp-listener.html"><strong aria-hidden="true">48.3.</strong> Listener</a></li></ol></li><li class="chapter-item expanded "><a href="categories/email/index.html"><strong aria-hidden="true">49.</strong> Email</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/email/send-email.html"><strong aria-hidden="true">49.1.</strong> Send Emails</a></li><li class="chapter-item expanded "><a href="categories/email/receive-email-using-client.html"><strong aria-hidden="true">49.2.</strong> Receive Emails Using a Client</a></li><li class="chapter-item expanded "><a href="categories/email/receive-email-using-listener.html"><strong aria-hidden="true">49.3.</strong> Receive Emails Using a Listener</a></li></ol></li><li class="chapter-item expanded "><a href="categories/ftp/index.html"><strong aria-hidden="true">50.</strong> FTP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/ftp/ftp-client.html"><strong aria-hidden="true">50.1.</strong> Client</a></li><li class="chapter-item expanded "><a href="categories/ftp/ftp-listener.html"><strong aria-hidden="true">50.2.</strong> Listener</a></li></ol></li><li class="chapter-item expanded "><a href="categories/sftp/index.html"><strong aria-hidden="true">51.</strong> SFTP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/sftp/sftp-client.html"><strong aria-hidden="true">51.1.</strong> Client</a></li><li class="chapter-item expanded "><a href="categories/sftp/sftp-listener.html"><strong aria-hidden="true">51.2.</strong> Listener</a></li></ol></li><li class="chapter-item expanded "><a href="categories/mysql/index.html"><strong aria-hidden="true">52.</strong> MySQL</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/mysql/mysql-query-operation.html"><strong aria-hidden="true">52.1.</strong> Simple Query</a></li><li class="chapter-item expanded "><a href="categories/mysql/mysql-complex-type-queries.html"><strong aria-hidden="true">52.2.</strong> Query With Complex Types</a></li><li class="chapter-item expanded "><a href="categories/mysql/mysql-execute-operation.html"><strong aria-hidden="true">52.3.</strong> DML and DDL Operation</a></li><li class="chapter-item expanded "><a href="categories/mysql/mysql-batch-execute-operation.html"><strong aria-hidden="true">52.4.</strong> Batch Execute</a></li><li class="chapter-item expanded "><a href="categories/mysql/mysql-atomic-batch-execute-operation.html"><strong aria-hidden="true">52.5.</strong> Atomic Batch Execute</a></li><li class="chapter-item expanded "><a href="categories/mysql/mysql-call-stored-procedures.html"><strong aria-hidden="true">52.6.</strong> Call Stored Procedures</a></li></ol></li><li class="chapter-item expanded "><a href="categories/jdbc/index.html"><strong aria-hidden="true">53.</strong> JDBC</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/jdbc/jdbc-query-operation.html"><strong aria-hidden="true">53.1.</strong> Simple Query</a></li><li class="chapter-item expanded "><a href="categories/jdbc/jdbc-complex-type-queries.html"><strong aria-hidden="true">53.2.</strong> Query With Complex Types</a></li><li class="chapter-item expanded "><a href="categories/jdbc/jdbc-execute-operation.html"><strong aria-hidden="true">53.3.</strong> DML and DDL Operation</a></li><li class="chapter-item expanded "><a href="categories/jdbc/jdbc-batch-execute-operation.html"><strong aria-hidden="true">53.4.</strong> Batch Execute</a></li><li class="chapter-item expanded "><a href="categories/jdbc/jdbc-atomic-batch-execute-operation.html"><strong aria-hidden="true">53.5.</strong> Atomic Batch Execute</a></li></ol></li><li class="chapter-item expanded "><a href="categories/io/index.html"><strong aria-hidden="true">54.</strong> IO</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/io/io-bytes.html"><strong aria-hidden="true">54.1.</strong> Read/Write Bytes</a></li><li class="chapter-item expanded "><a href="categories/io/io-strings.html"><strong aria-hidden="true">54.2.</strong> Read/Write Strings</a></li><li class="chapter-item expanded "><a href="categories/io/io-csv.html"><strong aria-hidden="true">54.3.</strong> Read/Write CSV</a></li><li class="chapter-item expanded "><a href="categories/io/io-json.html"><strong aria-hidden="true">54.4.</strong> Read/Write JSON</a></li><li class="chapter-item expanded "><a href="categories/io/io-xml.html"><strong aria-hidden="true">54.5.</strong> Read/Write XML</a></li></ol></li><li class="chapter-item expanded "><a href="categories/security/index.html"><strong aria-hidden="true">55.</strong> Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/security/security-crypto.html"><strong aria-hidden="true">55.1.</strong> Cryptographic Operations</a></li><li class="chapter-item expanded "><a href="categories/security/security-jwt-issue-validate.html"><strong aria-hidden="true">55.2.</strong> JWT Issue/Validate</a></li></ol></li><li class="chapter-item expanded "><a href="categories/url/index.html"><strong aria-hidden="true">56.</strong> URL</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/url/url-encode-decode.html"><strong aria-hidden="true">56.1.</strong> URL Encode/Decode Operations</a></li></ol></li><li class="chapter-item expanded "><a href="categories/time/index.html"><strong aria-hidden="true">57.</strong> Time</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/time/time-utc.html"><strong aria-hidden="true">57.1.</strong> UTC Time</a></li><li class="chapter-item expanded "><a href="categories/time/time-utc-and-civil.html"><strong aria-hidden="true">57.2.</strong> Time with Zone Offset</a></li><li class="chapter-item expanded "><a href="categories/time/time-formatting-and-parsing.html"><strong aria-hidden="true">57.3.</strong> Time formatting/Parsing</a></li></ol></li><li class="chapter-item expanded "><a href="categories/cache/index.html"><strong aria-hidden="true">58.</strong> Cache</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/cache/cache-basics.html"><strong aria-hidden="true">58.1.</strong> Cache Basics</a></li><li class="chapter-item expanded "><a href="categories/cache/cache-invalidation.html"><strong aria-hidden="true">58.2.</strong> Cache Invalidation</a></li></ol></li><li class="chapter-item expanded "><a href="categories/log/index.html"><strong aria-hidden="true">59.</strong> Log</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/log/logging.html"><strong aria-hidden="true">59.1.</strong> Logging</a></li><li class="chapter-item expanded "><a href="categories/log/logging-with-context.html"><strong aria-hidden="true">59.2.</strong> Logging with Context</a></li><li class="chapter-item expanded "><a href="categories/log/logging-configuration.html"><strong aria-hidden="true">59.3.</strong> Configure Logging</a></li></ol></li><li class="chapter-item expanded "><a href="categories/file/index.html"><strong aria-hidden="true">60.</strong> File</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/file/filepaths.html"><strong aria-hidden="true">60.1.</strong> File Paths</a></li><li class="chapter-item expanded "><a href="categories/file/directories.html"><strong aria-hidden="true">60.2.</strong> Directories</a></li><li class="chapter-item expanded "><a href="categories/file/files.html"><strong aria-hidden="true">60.3.</strong> Files</a></li><li class="chapter-item expanded "><a href="categories/file/temp-files-directories.html"><strong aria-hidden="true">60.4.</strong> Temp Files and Directories</a></li><li class="chapter-item expanded "><a href="categories/file/directory-listener.html"><strong aria-hidden="true">60.5.</strong> Directory Listener</a></li></ol></li><li class="chapter-item expanded "><a href="categories/random/index.html"><strong aria-hidden="true">61.</strong> Random</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/random/random-numbers.html"><strong aria-hidden="true">61.1.</strong> Random Numbers</a></li></ol></li><li class="chapter-item expanded "><a href="categories/task/index.html"><strong aria-hidden="true">62.</strong> Task</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/task/task-frequency-job-execution.html"><strong aria-hidden="true">62.1.</strong> Schedule Job recurrence by Frequency</a></li><li class="chapter-item expanded "><a href="categories/task/task-one-time-job-execution.html"><strong aria-hidden="true">62.2.</strong> Schedule one time job</a></li><li class="chapter-item expanded "><a href="categories/task/manage-scheduled-jobs.html"><strong aria-hidden="true">62.3.</strong> Manage Scheduled Jobs</a></li></ol></li><li class="chapter-item expanded "><a href="categories/uuid/index.html"><strong aria-hidden="true">63.</strong> UUID</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/uuid/uuid-generation.html"><strong aria-hidden="true">63.1.</strong> Generate UUID</a></li><li class="chapter-item expanded "><a href="categories/uuid/uuid-operations.html"><strong aria-hidden="true">63.2.</strong> UUID Operations</a></li></ol></li><li class="chapter-item expanded "><a href="categories/xslt/index.html"><strong aria-hidden="true">64.</strong> XSLT</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/xslt/xslt-transformation.html"><strong aria-hidden="true">64.1.</strong> XSLT Transformation</a></li></ol></li><li class="chapter-item expanded "><a href="categories/regex/index.html"><strong aria-hidden="true">65.</strong> Regex</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/regex/regular-expressions.html"><strong aria-hidden="true">65.1.</strong> Regular Expressions</a></li></ol></li><li class="chapter-item expanded "><a href="categories/os/index.html"><strong aria-hidden="true">66.</strong> OS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/os/environment-variables.html"><strong aria-hidden="true">66.1.</strong> Environment Variables</a></li></ol></li><li class="chapter-item expanded "><a href="categories/xml-data/index.html"><strong aria-hidden="true">67.</strong> XML Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/xml-data/xml-json-conversion.html"><strong aria-hidden="true">67.1.</strong> XML JSON Conversion</a></li></ol></li><li class="chapter-item expanded "><a href="categories/tracing/index.html"><strong aria-hidden="true">68.</strong> Tracing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/tracing/tracing.html"><strong aria-hidden="true">68.1.</strong> Distributed Tracing</a></li><li class="chapter-item expanded "><a href="categories/tracing/counter-metrics.html"><strong aria-hidden="true">68.2.</strong> Counter-Based Metrics</a></li></ol></li><li class="chapter-item expanded "><a href="categories/metrics/index.html"><strong aria-hidden="true">69.</strong> Metrics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/metrics/gauge-metrics.html"><strong aria-hidden="true">69.1.</strong> Gauge-Based Metrics</a></li></ol></li><li class="chapter-item expanded "><a href="categories/code-to-cloud/index.html"><strong aria-hidden="true">70.</strong> Code to Cloud</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/code-to-cloud/c2c-deployment.html"><strong aria-hidden="true">70.1.</strong> Kubernetes</a></li></ol></li><li class="chapter-item expanded "><a href="categories/function-as-a-service/index.html"><strong aria-hidden="true">71.</strong> Function as a Service</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="categories/function-as-a-service/azure-functions-deployment.html"><strong aria-hidden="true">71.1.</strong> Azure Functions</a></li><li class="chapter-item expanded "><a href="categories/function-as-a-service/aws-lambda-deployment.html"><strong aria-hidden="true">71.2.</strong> AWS Lambda</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="hello-world"><a class="header" href="#hello-world">Hello World</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hello-world-main"><a class="header" href="#hello-world-main">Hello World Main</a></h1>
<p>Let's write the <code>Hello World</code> program in Ballerina.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    io:println(&quot;Hello, World!&quot;);
}
</code></pre>
<h4 id="output"><a class="header" href="#output">Output</a></h4>
<pre><code class="language-bash"># To run this sample, place the source code in 
# `hello_world.bal` file and use `bal run` command.
bal run hello_world.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hello-world-service"><a class="header" href="#hello-world-service">Hello World Service</a></h1>
<p>Let's write a simple HTTP service in Ballerina. 
This example demonstrates the network primitives in the language that make it simpler to develop services.</p>
<pre><code class="language-go">import ballerina/http;

service / on new http:Listener(9090) {

    // This function responds with `string` value `Hello, World!` to HTTP GET requests.
    resource function get greeting() returns string {
        return &quot;Hello, World!&quot;;
    }

}
</code></pre>
<h4 id="output-1"><a class="header" href="#output-1">Output</a></h4>
<pre><code class="language-bash">bal run hello_world_service.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="basics"><a class="header" href="#basics">Basics</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="programs-and-modules"><a class="header" href="#programs-and-modules">Programs and Modules</a></h1>
<p>Every Ballerina program consists of modules. Modules are one or more <code>.bal</code> files. 
The module names take the form <code>org/x.y.z</code>.</p>
<pre><code class="language-go">// This import declaration binds the prefix `io` to the `ballerina/io` module. 
// The prefix by default comes form the last part of the module name.
// The `ballerina` org name is reserved for the standard library modules.
import ballerina/io;

// `main` function is the program entry point. 
// `public` makes function visible outside the module.
public function main() {
    // Here `io:println` means function `println` is in the module bound to prefix `io`.
    io:println(&quot;Hello, World!&quot;);

}
</code></pre>
<h4 id="output-2"><a class="header" href="#output-2">Output</a></h4>
<pre><code class="language-bash">bal run programs_and_modules.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="variables-and-types"><a class="header" href="#variables-and-types">Variables and Types</a></h1>
<p>A variable has a type, which constrains what values the variable can hold. 
There is a built-in set of named types, including <code>int</code>, <code>float</code>, <code>boolean</code>, <code>string</code>.</p>
<pre><code class="language-go">import ballerina/io;

// Modules and functions can declare variables. You can see both in this example.
// Here we declare a variable `greeting` of type `string` and initialize it to `&quot;Hello&quot;`.
string greeting = &quot;Hello&quot;;

public function main() {
    // Assignments are statements not expressions.
    string name = &quot;Ballerina&quot;;

    io:println(greeting, &quot; &quot;, name);
}
</code></pre>
<h4 id="output-3"><a class="header" href="#output-3">Output</a></h4>
<pre><code class="language-bash">bal run variables_and_types.bal
Hello Ballerina
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="identifiers"><a class="header" href="#identifiers">Identifiers</a></h1>
<p>Identifier syntax is similar to C. Keywords are reserved. </p>
<pre><code class="language-go">import ballerina/io;

// You can have Unicode identifiers.
function (string ) {
    // Use \u{H} to specify character using Unicode code point in hex.
   io:println(\u{E2D});

}

// Prefix reserved keywords with a single quote.
string 'from = &quot;contact@ballerina.io&quot;;

// Prefix non-identifier character with a \\.
string first\ name = &quot;Ballerina&quot;;

public function main() {
    (&quot;&quot;);
}
</code></pre>
<h4 id="output-4"><a class="header" href="#output-4">Output</a></h4>
<pre><code class="language-bash">bal run identifiers.bal

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="simple-basic-types"><a class="header" href="#simple-basic-types">Simple Basic Types</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="integers"><a class="header" href="#integers">Integers</a></h1>
<p>The <code>int</code> type is 64-bit signed integers (same as <code>long</code> in Java) and supports the usual arithmetic operators: <code>+ - / %</code>.
The operator precedence is same as C. Integer overflow is a runtime error in Ballerina.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    int m = 1;

    // Integer literals can be hexadecimal (but not octal).
    int n = 0xFFFF;

    // You can use compound assignment operations such as `+=` and `-=`. 
    n += m;

    io:println(n);
}
</code></pre>
<h4 id="output-5"><a class="header" href="#output-5">Output</a></h4>
<pre><code class="language-bash">bal run integers.bal
65536
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="floating-point-numbers"><a class="header" href="#floating-point-numbers">Floating Point Numbers</a></h1>
<p>The <code>float</code> type is IEEE 64-bit binary floating point (same as <code>double</code> in Java) and supports the same arithmetic
operators as <code>int</code>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    float x = 1.0;

    int n = 5;

    // No implicit conversions between integers and floating point values are allowed.
    // You can use `&lt;T&gt;` for explicit conversions.
    float y = x + &lt;float&gt;n;

    io:println(y);
}
</code></pre>
<h4 id="output-6"><a class="header" href="#output-6">Output</a></h4>
<pre><code class="language-bash">bal run floating_point_numbers.bal 
6.0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="decimal-type"><a class="header" href="#decimal-type">Decimal Type</a></h1>
<p>The <code>decimal</code> type is the third numeric type. It works like <code>int</code> and <code>float</code> types.
It is a separate basic type and belongs to the <code>anydata</code> type.
There is no implicit conversions between <code>decimal</code> and other numeric types.
It can represent <code>decimal</code> fractions exactly and it preserves precision.
The <code>decimal</code> type does not include infinity, NaN, or negative zero.
It supports floating-point precision to 34 decimal digits.</p>
<pre><code class="language-go">import ballerina/io;

// The `decimal` type represents the set of 128-bits IEEE 754R decimal floating point numbers.
decimal nanos = 1d/1000000000d;

function floatSurprise() {
    float f = 100.10 - 0.01;
    io:println(f);
}

public function main() {
    floatSurprise();
    io:println(nanos);

    // Numeric literals can use the `d` suffix for them to be interpreted as `decimal` values
    // (similarly, the `f` suffix can be used for `float`).
    var d = 12345d;
    io:println(d is decimal);
}
</code></pre>
<h4 id="output-7"><a class="header" href="#output-7">Output</a></h4>
<pre><code class="language-bash">bal run decimal_type.bal
100.08999999999999
1E-9
true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nil"><a class="header" href="#nil">Nil</a></h1>
<p>Ballerina's version of <code>null</code> is called <code>nil</code> and written as <code>()</code>. 
Ballerina types do not implicitly allow <code>nil</code>.
Type <code>T?</code> means <code>T</code> or <code>nil</code>. You can use <code>==</code> and <code>!=</code> to test whether a value is <code>nil</code>: no implicit conversion to
<code>boolean</code>.</p>
<pre><code class="language-go">import ballerina/io;

// Here type `int?` indicates that the value of `v` can be an `int` or `()`.
int? v = ();

// Here the value of `n` cannot be `()`.
int? n = v == () ? 0 : v;

// Elvis operator `x ?: y` returns `x` if it is not `nil` and `y` otherwise.
int m = v ?: 0;

// Falling off the end of a function or `return` by itself is equivalent to `return ()`.
function foo() returns () {
    return ();
}

// Leaving off return type is equivalent to `returns ()`.
public function main() {

    io:println(v);
}
</code></pre>
<h4 id="output-8"><a class="header" href="#output-8">Output</a></h4>
<pre><code class="language-bash">bal run nil.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="strings"><a class="header" href="#strings">Strings</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="strings-1"><a class="header" href="#strings-1">Strings</a></h1>
<p>The <code>string</code> type represents immutable sequence of zero or more Unicode characters. 
There is no separate character type: a character is represented by a <code>string</code> of length 1.
Two <code>string</code> values are <code>==</code> if both sequences have the same characters.
You can use <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, and <code>&gt;=</code> operators on <code>string</code> values and they work by comparing code points.
Unpaired surrogates are not allowed.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    // String literals use double quotes. You can use usual C escapes such as `\t \n`.
    // Numeric escapes specify Unicode code point using one or more hex digits `\u{H}`.
    string grin = &quot;\u{1F600}&quot;;

    // String concatenation uses `+` operator.
    string greeting = &quot;Hello&quot; + grin;

    io:println(greeting);

    // `greeting[1]` accesses character at index 1 (zero-based).
    io:println(greeting[1]);

}
</code></pre>
<h4 id="output-9"><a class="header" href="#output-9">Output</a></h4>
<pre><code class="language-bash">bal run strings.bal
Hello
e
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="conditional-statements"><a class="header" href="#conditional-statements">Conditional Statements</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="booleans-and-conditionals"><a class="header" href="#booleans-and-conditionals">Booleans and Conditionals</a></h1>
<p>The <code>boolean</code> type has two values: <code>true</code>, <code>false</code>.
The <code>!</code> operator works on booleans only.  <code>&amp;&amp;</code> and <code>||</code> operators short-circuit as in C.
Usual comparison operators (<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, and <code>&gt;=</code>) produce boolean values.</p>
<pre><code class="language-go">import ballerina/io;

boolean flag = true;

// Here's a conditional expression. Uses C syntax.
int n = flag ? 1 : 2;

public function main() {
    // Parentheses are optional in conditions, but curly braces are required in `if/else` and other compound statements.
    if flag {
        io:println(1);
    } else {
        io:println(2);
    }

}
</code></pre>
<h4 id="output-10"><a class="header" href="#output-10">Output</a></h4>
<pre><code class="language-bash">bal run booleans.bal
1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="match-statement"><a class="header" href="#match-statement">Match Statement</a></h1>
<p><code>match</code> statement is similar to <code>switch</code> statement in <code>C</code> and <code>JavaScript</code>. It matches the value, not the type.
<code>==</code> is used to test whether left hand side matches the value being matched. Left hand side can be a
simple literal (<code>nil</code>, <code>boolean</code>, <code>int</code>, <code>float</code>, <code>string</code>) identifier referring to a constant.
Left hand side of <code>_</code> matches if the value is of type <code>any</code>. You can use <code>|</code> to match more than one value.</p>
<pre><code class="language-go">import ballerina/io;

const KEY = &quot;xyzzy&quot;;

function matchTest(any v) returns string {
    // The value of the `v` variable is matched against the
    // given value match patterns.
    match v {
        17 =&gt; {
            return &quot;number&quot;;
        }
        true =&gt; {
            return &quot;boolean&quot;;
        }
        &quot;str&quot; =&gt; {
            return &quot;string&quot;;
        }
        KEY =&gt; {
            return &quot;constant&quot;;
        }
        0|1 =&gt; {
            return &quot;or&quot;;
        }
        _ =&gt; {
            return &quot;any&quot;;
        }
    }

}

public function main() {
    io:println(matchTest(&quot;str&quot;));
    io:println(matchTest(17));
    io:println(matchTest(20.5));
}
</code></pre>
<h4 id="output-11"><a class="header" href="#output-11">Output</a></h4>
<pre><code class="language-bash">bal run match_statement.bal
string
number
any
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="functions"><a class="header" href="#functions">Functions</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="functions-1"><a class="header" href="#functions-1">Functions</a></h1>
<p>A function accepts zero or more arguments and returns a single value.
Function parameters are declared as in C. You are not allowed to assign to parameters in Ballerina.</p>
<pre><code class="language-go">import ballerina/io;

// This function definition has two parameters of type `int`. 
// `returns` clause specifies type of return value.
function add(int x, int y) returns int {

    int sum = x + y;
    // `return` statement returns a value.
    return sum;

}

public function main() {
    io:println(add(5, 11));
}
</code></pre>
<h4 id="output-12"><a class="header" href="#output-12">Output</a></h4>
<pre><code class="language-bash">bal run functions.bal
16
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="function-values"><a class="header" href="#function-values">Function Values</a></h1>
<p>Functions are values and work as closures.
Function type is a separate basic type.
Anonymous function and type syntax look like function definition without the name.</p>
<pre><code class="language-go">import ballerina/io;

// Anonymous function syntax.
var isOdd = function(int n) returns boolean {
    return n % 2 != 0;
};

// Function type syntax.
type IntFilter function (int n) returns boolean;

// Module-level function definition.
function isEven(int n) returns boolean {
    return n % 2 == 0;
}

public function main() {
    // The `isEven` function  referred as a value.
    IntFilter f = isEven;

    int[] nums = [1, 2, 3];

    // Arrays provide the usual functional methods: 
    // `filter`, `map`, `forEach`, and `reduce`.
    int[] evenNums = nums.filter(f);

    io:println(evenNums);

    // Shorthand syntax when the type is inferred and the body is an expression.
    int[] oddNums = nums.filter(n =&gt; n % 2 != 0);

    io:println(oddNums);
}
</code></pre>
<h4 id="output-13"><a class="header" href="#output-13">Output</a></h4>
<pre><code class="language-bash">bal run function_values.bal
[2]
[1,3]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iteration"><a class="header" href="#iteration">Iteration</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="foreach-statement"><a class="header" href="#foreach-statement">Foreach Statement</a></h1>
<p>The <code>foreach</code> statement iterates over an iterable value, by binding a variable to each member of the
iterable value in order. <code>foreach</code> also works for strings, and will iterate over each character of the <code>string</code>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    float v1 = sum([10.5, 20.5, 30.5]);
    float v2 = sum2([10.5, 20.5, 30.5]);
    io:println(&quot;v1:&quot;, v1, &quot; v2:&quot;, v2);
}

function sum(float[] v) returns float {
    float r = 0.0;
    // `foreach` statement can be used to iterate an `array`.
    // Each iteration returns an element in the `array`.
    foreach float x in v {
        r += x;
    }

    return r;
}

function sum2(float[] v) returns float {
    float r = 0.0;
    // `m ..&lt; n` creates a value that when iterated over will give the
    // integers starting from `m` that are `&lt; n`.
    foreach int i in 0 ..&lt; v.length() {
        r += v[i];
    }

    return r;
}
</code></pre>
<h4 id="output-14"><a class="header" href="#output-14">Output</a></h4>
<pre><code class="language-bash">bal run foreach_statement.bal
v1:61.5 v2:61.5
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="while-statement"><a class="header" href="#while-statement">While Statement</a></h1>
<p>The <code>while</code> statement is a more flexible iteration than <code>foreach</code>. <code>break</code> and <code>continue</code> statements
can be used within the loops to alter control flow.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    LinkedList link1 = {value: &quot;link1&quot;, next: ()};
    LinkedList link2 = {value: &quot;link2&quot;, next: link1};
    io:println(len(link2));
}

type LinkedList record {
    string value;
    LinkedList? next;
};

function len(LinkedList ll) returns int {
    int n = 0;
    LinkedList? v = ll;
    // Executes the code block that is defined within the `while` block
    // as long as the value of `v` is not `nil`.
    while v != () {
        n += 1;
        v = v.next;
    }

    return n;
}
</code></pre>
<h4 id="output-15"><a class="header" href="#output-15">Output</a></h4>
<pre><code class="language-bash">bal run while_statement.bal
2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lang-library"><a class="header" href="#lang-library">Lang Library</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="langlib-functions"><a class="header" href="#langlib-functions">Langlib Functions</a></h1>
<p>Langlib is a small library defined by language providing fundamental operations on built-in data types.
Langlib functions can be called using convenient method-call syntax, but these types are not objects!
There exists a <code>ballerina/lang.T</code> module for each built-in type <code>T</code> and they are automatically imported
using <code>T</code> prefix.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    // You can call langlib functions using the method-call syntax.
    string s = &quot;abc&quot;.substring(1, 2);

    io:println(s);

    // `n` will be 1.
    int n = s.length();
    io:println(n);

    // `s.length()` is same as `string:length(s)`.
    int m = string:length(s);
    io:println(m);

}
</code></pre>
<h4 id="output-16"><a class="header" href="#output-16">Output</a></h4>
<pre><code class="language-bash">bal run langlib_functions.bal
b
1
1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="types-and-typing"><a class="header" href="#types-and-typing">Types and Typing</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="arrays"><a class="header" href="#arrays">Arrays</a></h1>
<p><code>T[]</code> is an <code>array</code> of <code>T</code>. Arrays are mutable. <code>==</code> and <code>!=</code> on arrays is deep: two arrays are
equal if they have the same members in the same order. Ordering is lexicographical based on the
ordering of the members. Langlib <code>arr.length()</code> function gets the length; <code>arr.setLength(n)</code> sets the length.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    int[] v = [1, 2, 3];

    // `v[i]` does indexed access.
    int n = v[0];

    io:println(n);

    // `v[i]` is an `lvalue`.
    v[3] = 4;

    // `len` will be 3.
    int len = v.length();
    io:println(len);
}
</code></pre>
<h4 id="output-17"><a class="header" href="#output-17">Output</a></h4>
<pre><code class="language-bash">bal run arrays.bal
1
4
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="binary-data"><a class="header" href="#binary-data">Binary Data</a></h1>
<p>Binary data is represented by arrays of <code>byte</code> values. It is a special syntax for <code>byte</code> arrays
in <code>base 64</code> and <code>base 16</code>. The relationship between <code>byte</code> and <code>int</code> is not the same as
what you are used to. A <code>byte</code> is an <code>int</code> in the range <code>0</code> to <code>0xFF</code>. <code>byte</code> is a subtype of int.
<code>int</code> type supports normal bitwise operators: <code>&amp;</code> <code>|</code> <code>^</code> <code>~</code> <code>&lt;&lt;</code> <code>&gt;&gt;</code> <code>&gt;&gt;&gt;</code>.
Ballerina knows the obvious rules about when bitwise operations produce a <code>byte</code>.</p>
<pre><code class="language-go">public function main() {
    // Creates a `byte` array using the `base64` byte array literal.
    byte[] _ = base64`yPHaytRgJPg+QjjylUHakEwz1fWPx/wXCW41JSmqYW8=`;

    // Creates a `byte` using a hexadecimal numeral.
    byte x = 0xA;

    // `byte &amp; int` will be `byte`.
    byte _ = x &amp; 0xFF;

}
</code></pre>
<h4 id="output-18"><a class="header" href="#output-18">Output</a></h4>
<pre><code class="language-bash">bal run binary_data.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="structural-typing"><a class="header" href="#structural-typing">Structural Typing</a></h1>
<p>Typing in Ballerina is structural: a type describes a set of values. Ballerina has semantic subtyping:
subtype means subset. Universe of values is partitioned into basic types. Each value belongs to
exactly one basic type. You can think of each value as being tagged with its basic type.
There is a complexity in making structural typing work with mutation. <br/><br/>
Immutable basic types (so far): <code>nil</code>, <code>boolean</code>, <code>int</code>, <code>float</code>, <code>string</code> <br/><br/>
Mutable basic types (so far): <code>array</code>, <code>map</code>, and <code>record</code></p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    // 1 belongs to `int`.
    io:println(1 is int);
    // [10, 20, 30] belongs to `int[]`.
    io:println([10, 20, 30] is int[]);

}
</code></pre>
<h4 id="output-19"><a class="header" href="#output-19">Output</a></h4>
<pre><code class="language-bash">bal run structural_typing.bal
true
true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unions"><a class="header" href="#unions">Unions</a></h1>
<p><code>T1|T2</code> is the union of the sets described by <code>T1</code> and <code>T2</code>. <code>T?</code> is completely equivalent to <code>T|()</code>.
Unions are untagged. The <code>is</code> operator tests whether a value belongs to a specific type. The <code>is</code> operator in
the condition causes the declared type to be narrowed.</p>
<pre><code class="language-go">import ballerina/io;

type StructuredName record {
    string firstName;
    string lastName;
};

// A `Name` type value can be either a `StructuredName` or a `string`.
type Name StructuredName|string;

public function main() {
    // `name1` is a `StructuredName`.
    Name name1 = {
        firstName: &quot;Rowan&quot;,
        lastName: &quot;Atkinson&quot;
    };
    // `name2` is a `string`.
    Name name2 = &quot;Leslie Banks&quot;;

    io:println(nameToString(name1));
    io:println(nameToString(name2));
}

function nameToString(Name nm) returns string {
    // Checks whether `nm` belongs to `string` type.
    if nm is string {

        return nm;
    } else {
        return nm.firstName + &quot; &quot; + nm.lastName;
    }
}
</code></pre>
<h4 id="output-20"><a class="header" href="#output-20">Output</a></h4>
<pre><code class="language-bash">bal run unions.bal
Rowan Atkinson
Leslie Banks
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="errors"><a class="header" href="#errors">Errors</a></h1>
<p>Ballerina does not have exceptions. Errors are reported by functions returning
<code>error</code> values.
<code>error</code> is its own basic type.
The return type of a function that may return an <code>error</code> value will be a union with <code>error</code>.
An <code>error</code> value includes a <code>string</code> message.
An <code>error</code> value includes the stack trace from the point at which the error is constructed (i.e., <code>error(msg)</code> is called). 
Error values are immutable.</p>
<pre><code class="language-go">import ballerina/io;

// Parses a `string` value to convert to an `int` value.
// This function may return error values.
// The return type is a union with `error`.
function parse(string s) returns int|error {

    int n = 0;
    int[] cps = s.toCodePointInts();
    foreach int cp in cps {
        int p = cp - 0x30;
        if p &lt; 0 || p &gt; 9 {
            // If `p` is not a digit construct, it returns
            // an `error` value with `not a digit` as the error message.
            return error(&quot;not a digit&quot;);

        }
        n = n * 10 + p;
    }
    return n;
}

public function main() {
    // An `int` value is returned when the argument is a `string` value,
    // which can be parsed successfully as an integer.
    int|error x = parse(&quot;123&quot;);

    io:println(x);

    // An `error` value is returned when the argument is a `string` value,
    // which has a character that is not a digit.
    int|error y = parse(&quot;1h&quot;);

    io:println(y);
}
</code></pre>
<h4 id="output-21"><a class="header" href="#output-21">Output</a></h4>
<pre><code class="language-bash">bal run error_reporting.bal
123
error(&quot;not a digit&quot;)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="anydata-type"><a class="header" href="#anydata-type">Anydata Type</a></h1>
<p>The type for plain data is <code>anydata</code>. It is a subtype of <code>any</code>. <code>==</code> and <code>!=</code> operators test for deep equality.
<code>x.clone()</code> returns a deep copy with the same mutability. <code>x.cloneReadOnly()</code> returns a deep copy that is
immutable. Ballerina syntax uses <code>readonly</code> to mean immutable. Both <code>x.clone()</code> and <code>x.cloneReadOnly()</code> do
not copy immutable parts of <code>x</code>. <code>const</code> structures are allowed. Equality and cloning handle cycles.</p>
<pre><code class="language-go">import ballerina/io;

anydata x1 = [1, &quot;string&quot;, true];
// `x1.clone()` returns a deep copy with the same mutability.
anydata x2 = x1.clone();

// Checks deep equality.
boolean eq = (x1 == x2);

public function main() {
    io:println(x2);
    io:println(eq);
}
</code></pre>
<h4 id="output-22"><a class="header" href="#output-22">Output</a></h4>
<pre><code class="language-bash">bal run anydata_type.bal
[1,&quot;string&quot;,true]
true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="any-type"><a class="header" href="#any-type">Any Type</a></h1>
<p><code>any</code> means any value except an <code>error</code> value.
Equivalent to a union of all non-error basic types.
Use <code>any|error</code> for absolutely any value.
The <code>lang.value</code> lang library contains functions that apply to multiple basic types.</p>
<pre><code class="language-go">import ballerina/io;

// A variable of type `any` can hold any value except an `error` value.
any x = 1;

public function main() {
    // Can cast `any` to specific type.
    int n = &lt;int&gt;x;
    
    io:println(n);

    // The `lang.value` lang library contains functions that apply to multiple basic types.
    // `x.toString()` converts `x` to a `string`.
    string s = x.toString();

    io:println(s == &quot;1&quot;);

    // Can test its type with the `is` operator.
    float f = x is int|float ? &lt;float&gt;x : 0.0;

    io:println(f);
}
</code></pre>
<h4 id="output-23"><a class="header" href="#output-23">Output</a></h4>
<pre><code class="language-bash">bal run any_type.bal
1
true
1.0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="type-definitions"><a class="header" href="#type-definitions">Type Definitions</a></h1>
<p>A type definition gives a name for a type. Its name is just an alias for the type, like <code>typedef</code> in C.</p>
<pre><code class="language-go">import ballerina/io;

// Defines a type named `MapArray`.
type MapArray map&lt;string&gt;[];

public function main() {
    // Creates a `MapArray` value.
    // `arr` has elements which are of `map&lt;string&gt;` type.
    MapArray arr = [
        {&quot;x&quot;: &quot;foo&quot;},
        {&quot;y&quot;: &quot;bar&quot;}
    ];

    io:println(arr[0]);
}
</code></pre>
<h4 id="output-24"><a class="header" href="#output-24">Output</a></h4>
<pre><code class="language-bash">bal run type_definitions.bal
{&quot;x&quot;:&quot;foo&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="covariance"><a class="header" href="#covariance">Covariance</a></h1>
<p>Arrays and maps are covariant.
Static type-checking guarantees that the result of a read from a mutable
structure will be consistent with the static type.
Covariance means that a write to a mutable structure may result in a 
runtime error.
Arrays, maps, and records have an &quot;inherent&quot; type that constrains mutation.</p>
<pre><code class="language-go">int[] iv = [1, 2, 3];

// Assigning `int[]` to `any[]` is allowed.
// The set of values allowed by `int` is a subset of set of values allowed by `any`
// The set of values allowed by `int[]` is a subset of set of values allowed by `any[]`
any[] av = iv;

public function main() {
    // A runtime error or else `iv[0]` would have the wrong type.
    av[0] = &quot;str&quot;;

}
</code></pre>
<h4 id="output-25"><a class="header" href="#output-25">Output</a></h4>
<pre><code class="language-bash">bal run covariance.bal
error: {ballerina/lang.array}InherentTypeViolation {&quot;message&quot;:&quot;incompatible types: expected 'int', found 'string'&quot;}
        at covariance:main(covariance.bal:10)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="type-inference"><a class="header" href="#type-inference">Type Inference</a></h1>
<p>Type inference is local and restricted to a single expression.
Overuse of type inference can make the code harder to understand.</p>
<pre><code class="language-go">import ballerina/io;

//`var` says that the type of the variable is from the type of expression
// used to initialize it.
var x = &quot;str&quot;;

function printLines(string[] sv) {
    // Type inference with a `foreach` statement.
    foreach var s in sv {
        io:println(s);
    }

}

public function main() {
    string[] s = [x, x];
    printLines(s);

    // Infers `x`'s type as `MyClass`.
    var x = new MyClass();
    MyClass _ = x;

    // Infers the class for `new` as `MyClass`.
    MyClass _ = new;

}

class MyClass {
    function foo() {

    }
}
</code></pre>
<h4 id="output-26"><a class="header" href="#output-26">Output</a></h4>
<pre><code class="language-bash">bal run type_inference.bal
str
str
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mappings"><a class="header" href="#mappings">Mappings</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="maps"><a class="header" href="#maps">Maps</a></h1>
<p>The <code>map&lt;T&gt;</code> type is a mapping from strings to <code>T</code>. The map syntax is similar to JSON. Maps are mutable.
<code>m[k]</code> is an &quot;lvalue&quot;. <code>foreach</code> will iterate over the values of the <code>map</code>. <code>m[k]</code> gets entry for <code>k</code>; <code>nil</code> if
missing. Use <code>m.get(k)</code> when you know that there is an entry for <code>k</code>. <code>m.keys()</code> can be used
to iterate over keys to get the keys as an <code>array</code> of strings. <code>==</code> and <code>!=</code> on maps is deep. Two maps
are equal if they have the same set of keys and the values for each key are equal.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    // Creates a `map` constrained by the `int` type.
    map&lt;int&gt; m = {
        &quot;x&quot;: 1,
        &quot;y&quot;: 2
    };

    // Gets the entry for `x`.
    int? v = m[&quot;x&quot;];

    io:println(v);

    // Adds a new entry for `z`.
    m[&quot;z&quot;] = 5;

    // Using `m[&quot;x&quot;]` wouldn't work here because type would be `int?`,
    // not `int`.
    m[&quot;z&quot;] = m.get(&quot;x&quot;);

}
</code></pre>
<h4 id="output-27"><a class="header" href="#output-27">Output</a></h4>
<pre><code class="language-bash">bal run maps.bal
1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="records"><a class="header" href="#records">Records</a></h1>
<p>A <code>record</code> type has specific named fields. Fields can be accessed with <code>r.x</code>. Records are mutable. <code>r.x</code> is an
<code>lvalue</code>. Records can be constructed using a similar syntax to a <code>map</code>. Typically, a <code>record</code> type is combined
with a type definition. The name of the type is not significant. A <code>record</code> is just a collection of fields.
Record equality works the same as <code>map</code> equality.</p>
<pre><code class="language-go">import ballerina/io;

// Defines a `record` type named `Coord`.
type Coord record {
    int x;
    int y;
};

public function main() {
    // Creates a `record`, specifying values for its fields.
    record { int x; int y; } r = {
        x: 1,
        y: 2
    };

    // Creates a `Coord` record.
    Coord c = {
        x: 1,
        y: 2
    };

    int a = r.y;
    io:println(a);

    int b = c.x;
    io:println(b);
}
</code></pre>
<h4 id="output-28"><a class="header" href="#output-28">Output</a></h4>
<pre><code class="language-bash">bal run records.bal
2
1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="records-1"><a class="header" href="#records-1">Records</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="optional-fields"><a class="header" href="#optional-fields">Optional Fields</a></h1>
<p>Fields of a <code>record</code> type can be marked as optional. These fields can be omitted when creating a value of the <code>record</code> type.
Such fields can be accessed via optional field access (e.g., <code>p?.name</code>) or member access (e.g., <code>p[&quot;name&quot;]</code>),
which will both return <code>()</code> if the field is not present in the <code>record</code> value.</p>
<pre><code class="language-go">import ballerina/io;

type Headers record {
   string 'from;
   string to;

   // Records can have optional fields.
   string subject?;

};

Headers h = {
  'from: &quot;John&quot;,
  to: &quot;Jill&quot;
};

// Use the `?.` operator to access the optional field.
string? subject = h?.subject;

public function main() {
    io:println(&quot;Header value: &quot;, h);
    io:println(&quot;Subject value:&quot;, subject);
}
</code></pre>
<h4 id="output-29"><a class="header" href="#output-29">Output</a></h4>
<pre><code class="language-bash">bal run optional_fields.bal
Header value: {&quot;from&quot;:&quot;John&quot;,&quot;to&quot;:&quot;Jill&quot;}
Subject value:
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="open-records"><a class="header" href="#open-records">Open Records</a></h1>
<p>Record types are open by default. They allow fields other than those specified. The type of unspecified
fields is <code>anydata</code>. Records are <code>maps</code>. Open records belong to <code>map&lt;anydata&gt;</code>. Use quoted keys for
fields not mentioned in the <code>record</code> type.</p>
<pre><code class="language-go">import ballerina/io;

// `Person` type allows additional fields with `anydata` values.
type Person record {
    string name;
};

// `Employee` type allows additional fields with `anydata` values.
type Employee record {
    string name;
    int id;
};

// Adds an additional `id` field to `e`.
Employee e = {
    name: &quot;James&quot;, id: 10
};

// You can assign an `Employee` type value to a `Person`.
Person p = e;

Person p2 = {
    name: &quot;John&quot;, &quot;country&quot;: &quot;UK&quot;
};

// You can assign a `Person` type value to a `map`.
map&lt;anydata&gt; m = p2;

public function main() {
    io:println(p);
    io:println(m);
}
</code></pre>
<h4 id="output-30"><a class="header" href="#output-30">Output</a></h4>
<pre><code class="language-bash">bal run open_records.bal
{&quot;name&quot;:&quot;James&quot;,&quot;id&quot;:10}
{&quot;name&quot;:&quot;John&quot;,&quot;country&quot;:&quot;UK&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="controlling-openness"><a class="header" href="#controlling-openness">Controlling Openness</a></h1>
<p>Use <code>record {| ... |}</code> to describe a <code>record</code> type that allows exclusively what is specified in the body.
Use <code>T...</code> to allow other fields of type <code>T</code>. <code>map&lt;T&gt;</code> is same as <code>record {| T...; |}</code>.</p>
<pre><code class="language-go">import ballerina/io;

type Coord record {|
    float x;
    float y;
|};

Coord x = { x: 1.0, y: 2.0 };

// `x` is a `map` with `float` values.
map&lt;float&gt; m1 = x;

type Headers record {|
    string 'from;
    string to;
    string...;
|};

Headers h = {
    'from: &quot;Jane&quot;, to: &quot;John&quot;
};

// `h` is a `map` with `string` values.
map&lt;string&gt; m2 = h;

public function main() {
    io:println(m1);
    io:println(m2);
}
</code></pre>
<h4 id="output-31"><a class="header" href="#output-31">Output</a></h4>
<pre><code class="language-bash">bal run controlling_openness.bal
{&quot;x&quot;:1.0,&quot;y&quot;:2.0}
{&quot;from&quot;:&quot;Jane&quot;,&quot;to&quot;:&quot;John&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="objects"><a class="header" href="#objects">Objects</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="object"><a class="header" href="#object">Object</a></h1>
<p>The <code>object</code> type is a separate basic type.
An <code>object</code> value has named methods and fields.
Methods and fields are in the same symbol space.
A <code>class</code> defines an <code>object</code> type and provides a way to construct an object.
Apply the <code>new</code> operator with a <code>class</code> to get an object.
Call method using <code>obj.foo(args)</code>.
Access field using <code>obj.x</code>.</p>
<pre><code class="language-go">import ballerina/io;

class MyClass {
    int n;

    function init(int n) {
        self.n = n;
    }

    function func() {
        self.n += 1;
    }
}

public function main() {
    // Apply the `new` operator with a `class` to get an `object` value.
    MyClass x = new MyClass(1234);

    // Call method using `obj.foo(args)`.
    x.func();

    // Access field using `obj.x`.
    int n = x.n;

    io:println(n);
}
</code></pre>
<h4 id="output-32"><a class="header" href="#output-32">Output</a></h4>
<pre><code class="language-bash">bal run object.bal
1235
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="defining-classes"><a class="header" href="#defining-classes">Defining Classes</a></h1>
<p>A module can contain <code>class</code> definitions.
<code>init</code> method initializes the object.
Arguments to <code>new</code> are passed as arguments to <code>init</code>.
Methods use <code>self</code> to access their object.
<code>private</code> means accessible only by code within the <code>class</code> definition.</p>
<pre><code class="language-go">import ballerina/io;

public class Counter {
    // `private` means accessible only by code within the `class` definition.
    private int n;

    // `init` method initializes the object.
    public function init(int n = 0) {
        self.n = n;
    }

    public function get() returns int {
        // Methods use `self` to access their object.
        return self.n;

    }

    public function inc() {
        self.n += 1;
    }
}

public function main() {
    // Arguments to `new` are passed as arguments to `init`.
    Counter counter = new (12);

    io:println(counter.get());
}
</code></pre>
<h4 id="output-33"><a class="header" href="#output-33">Output</a></h4>
<pre><code class="language-bash">bal run defining_classes.bal
12
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="init-return-type"><a class="header" href="#init-return-type">Init Return Type</a></h1>
<p><code>init</code> function has a return type, which must be a subtype of <code>error?</code>. If <code>init</code> returns <code>()</code>,
then <code>new</code> returns the newly constructed <code>object</code>. If <code>init</code> returns an <code>error</code>, then <code>new</code> returns
that <code>error</code>. If <code>init</code> does not specify a return type, then the return type defaults to <code>()</code> as usual,
meaning that <code>new</code> will never return an <code>error</code>.</p>
<pre><code class="language-go">import ballerina/io;

// Defines a `class` called `File`.
class File {

    string path;
    string contents;
    // The `init()` method is used to initialize the `object`.
    // when creating a new `object`.
    function init(string p, string? c) returns error? {
        self.path = p;
        self.contents = check c.ensureType(string);
        return;
    }

}

public function main() returns error? {
    // `new` returns the newly-constructed `File` object.
    File f = check new File(&quot;test.txt&quot;, &quot;Hello World&quot;);

    io:println(f.contents);
    return;
}
</code></pre>
<h4 id="output-34"><a class="header" href="#output-34">Output</a></h4>
<pre><code class="language-bash">bal run init_return_type.bal
Hello World
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="error-handling-1"><a class="header" href="#error-handling-1">Error Handling</a></h1>
<p>Usually, a function handles errors by passing them up to its caller.
The <code>main</code> function can also return an <code>error</code> value.</p>
<pre><code class="language-go">import ballerina/io;

// Converts `bytes` to a `string` value and then to an `int` value.
function intFromBytes(byte[] bytes) returns int|error {

    string|error ret = string:fromBytes(bytes);

    // The `is` operator can be used to distinguish errors
    // from other values.
    if ret is error {

        return ret;
    } else {
        return int:fromString(ret);
    }
}

// The `main` function can return an `error` value.
public function main() returns error? {

    int|error res = intFromBytes([104, 101, 108, 108, 111]);    
    if res is error {
        // The `check` expression is the shorthand for this pattern of
        // checking if a value is an `error` value and returning that value.
        return res;

    } else {
        io:println(&quot;result: &quot;, res);
        return;
    }
}
</code></pre>
<h4 id="output-35"><a class="header" href="#output-35">Output</a></h4>
<pre><code class="language-bash">bal run error_handling.bal
error: {ballerina/lang.int}NumberParsingError {&quot;message&quot;:&quot;'string' value 'hello' cannot be converted to 'int'&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="check-expression"><a class="header" href="#check-expression">Check Expression</a></h1>
<p><code>check E</code> is used with an expression <code>E</code> that might result in an <code>error</code> value.
If <code>E</code> results in an <code>error</code> value , then <code>check</code> makes the function return that <code>error</code> value
immediately.
Type of <code>check E</code> does not include <code>error</code>.
The control flow remains explicit.</p>
<pre><code class="language-go">import ballerina/io;

// Convert `bytes` to a `string` value and then to an `int` value.
function intFromBytes(byte[] bytes) returns int|error {

    // Use `check` with an expression that may return `error`.
    // If `string:fromBytes(bytes)` returns an `error` value, `check`
    // makes the function return the `error` value here.
    // If not, the returned `string` value is used as the
    // value of the `str` variable.
    string str = check string:fromBytes(bytes);


    return int:fromString(str);
}

public function main() {
    int|error res = intFromBytes([104, 101, 108, 108, 111]);
    io:println(res);
}
</code></pre>
<h4 id="output-36"><a class="header" href="#output-36">Output</a></h4>
<pre><code class="language-bash">bal run check_expression.bal
error(&quot;{ballerina/lang.int}NumberParsingError&quot;,message=&quot;'string' value 'hello' cannot be converted to 'int'&quot;)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="error-subtyping"><a class="header" href="#error-subtyping">Error Subtyping</a></h1>
<p><code>distinct</code> creates a new subtype and can be used to define
subtypes of <code>error</code>.
The name of the distinct <code>error</code> type can be used with the error
constructor to create an <code>error</code> value of that type.
Works like a nominal type. The <code>is</code> operator can be used to
distinguish distinct subtypes.
Each occurrence of <code>distinct</code> has a unique identifier that is 
used to tag instances of the type.</p>
<pre><code class="language-go">import ballerina/io;

// `distinct` creates a new subtype.
type XErr distinct error;
type YErr distinct error;

type Err XErr|YErr;

// The name of the distinct type can be used with the error
// constructor to create an `error` value of that type.
// `err` holds an `error` value of type `XErr`.
Err err = error XErr(&quot;Whoops!&quot;);

function desc(Err err) returns string {
    // The `is` operator can be used to distinguish distinct subtypes.
    return err is XErr ? &quot;X&quot; : &quot;Y&quot;;

}

public function main() {
    io:println(desc(err));
}
</code></pre>
<h4 id="output-37"><a class="header" href="#output-37">Output</a></h4>
<pre><code class="language-bash">bal run error_subtyping.bal
X
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="panics"><a class="header" href="#panics">Panics</a></h1>
<p>Ballerina distinguishes normal errors from abnormal errors.
Normal errors are handled by returning error values.
Abnormal errors are handled using the panic statement.
Abnormal errors should typically result in immediate program termination.
e.g., A programming bug or out of memory.
A panic has an associated error value.</p>
<pre><code class="language-go">import ballerina/io;

// `n` must not be `0`.
function divide(int m, int n) returns int {

    if n == 0 {
        // Panic if `n` is `0`.
        panic error(&quot;division by 0&quot;);

    }
    return m / n;
}

public function main() {
    int x = divide(1, 0);

    // Since `divide(1, 0)` panics, the program will
    // terminate and the following code will not be
    // executed.
    io:println(x);

}
</code></pre>
<h4 id="output-38"><a class="header" href="#output-38">Output</a></h4>
<pre><code class="language-bash">bal run panics.bal
error: division by 0
        at panics:divide(panics.bal:8)
           panics:main(panics.bal:15)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ignoring-return-values-and-errors"><a class="header" href="#ignoring-return-values-and-errors">Ignoring Return Values and Errors</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ignoring-return-values-and-errors-1"><a class="header" href="#ignoring-return-values-and-errors-1">Ignoring Return Values and Errors</a></h1>
<p>Ballerina does not allow silently ignoring return values.
To ignore a return value, assign it to <code>_</code>; this is like 
an implicitly declared variable that cannot be referenced.
When a return type includes an error, you have to do something 
with the error.
<code>_</code> is of type any: you cannot use <code>_</code> to ignore an error.
<code>checkpanic</code> is like <code>check</code>, but panics on error rather than 
returning.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    // Allowed only if the return value is `()`.
    doX();

    // Allowed if the return value does not include an `error`.
    _ = getX();

    // Use `checkpanic` if you don't want to handle an `error`.
    checkpanic tryX(true);
    checkpanic tryX(false);

}

function doX() {
    io:println(&quot;Do X&quot;);
}

function getX() returns boolean {
    io:println(&quot;Get X&quot;);
    return true;
}

function tryX(boolean x) returns error? {
    io:println(&quot;Try X&quot;);
    if !x {
        return error(&quot;error!&quot;);
    }
    return;
}
</code></pre>
<h4 id="output-39"><a class="header" href="#output-39">Output</a></h4>
<pre><code class="language-bash">bal run ignoring_return_values_and_errors.bal
Do X
Get X
Try X
Try X
error: error!
        at ignoring_return_values_and_errors:tryX(ignoring_return_values_and_errors.bal:28)
           ignoring_return_values_and_errors:main(ignoring_return_values_and_errors.bal:12)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mutability-and-identity"><a class="header" href="#mutability-and-identity">Mutability and Identity</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="identity"><a class="header" href="#identity">Identity</a></h1>
<p><code>===</code> and <code>!==</code> operators test for identity. Values of mutable basic types are identical if and only if they are stored in the same address.
<code>==</code> and <code>!=</code> are not defined for objects. <code>-0.0</code> and <code>+0.0</code> are equal but not identical.</p>
<pre><code class="language-go">import ballerina/io;

class MyClass {
    int i = 0;
}

public function main() {
    MyClass obj1 = new MyClass();
    MyClass obj2 = new MyClass();
    // `b1` will be true.
    boolean b1 = (obj1 === obj1);

    io:println(b1);

    // `b2` will be false.
    boolean b2 = (obj1 === obj2);

    io:println(b2);

    // `b3` will be true.
    boolean b3 = ([1, 2, 3] == [1, 2, 3]);

    io:println(b3);

    // `b4` will be false.
    boolean b4 = ([1, 2, 3] === [1, 2, 3]);

    io:println(b4);

    // `b5` will be true.
    boolean b5 = (-0.0 == +0.0);

    io:println(b5);

    // `b6` will be false.
    boolean b6 = (-0.0 === +0.0);

    io:println(b6);

}
</code></pre>
<h4 id="output-40"><a class="header" href="#output-40">Output</a></h4>
<pre><code class="language-bash">bal run identity.bal
true
false
true
false
true
false
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="const-and-final"><a class="header" href="#const-and-final">Const and Final</a></h1>
<p><code>const</code> means immutable and known at compile-time. Its type is singleton: a set containing a single value.
A variable or a class field can be declared as <code>final</code>, which means it cannot be assigned after
it has been initialized.</p>
<pre><code class="language-go">import ballerina/io;

// Constants can be defined without the type.
// Then the type is inferred from the right hand side.
const MAX_VALUE = 1000;
const URL = &quot;https://ballerina.io&quot;;

// The value for variable `msg` can only be assigned once.
final string msg = loadMessage();

public function main() {
    io:println(MAX_VALUE);
    io:println(URL);
    io:println(msg);
}

function loadMessage() returns string {
    return &quot;Hello World&quot;;
}
</code></pre>
<h4 id="output-41"><a class="header" href="#output-41">Output</a></h4>
<pre><code class="language-bash">bal run const_and_final
1000
https://ballerina.io
Hello World
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="enumerations"><a class="header" href="#enumerations">Enumerations</a></h1>
<p><code>Enumerations</code> are shorthand for unions of <code>string</code> constants. A <code>const</code> can be used as a singleton type.
An <code>enum</code> is not a distinct type. You can specify the string constants explicitly.</p>
<pre><code class="language-go">import ballerina/io;

// This is shorthand for,
//
// `const RED = &quot;RED&quot;;`
//
// `const GREEN = &quot;GREEN&quot;;`
//
// `const BLUE = &quot;BLUE&quot;;`
//
// `type Color RED|GREEN|BLUE;`
enum Color {
    RED,
    GREEN,
    BLUE
}

// An `enum` member can explicitly specify an associated expression.
enum Language {
    ENG = &quot;English&quot;,
    TL = &quot;Tamil&quot;,
    SI = &quot;Sinhala&quot;
}

public function main() {
    io:println(RED);
    io:println(ENG);
}
</code></pre>
<h4 id="output-42"><a class="header" href="#output-42">Output</a></h4>
<pre><code class="language-bash">bal run enumerations.bal
RED
English
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="immutability"><a class="header" href="#immutability">Immutability</a></h1>
<p><code>anydata</code> values can be made immutable. Simple and <code>string</code> values are inherently immutable.
A structural value can be constructed as mutable or immutable. A value includes an immutable flag.
The immutable flag is fixed at the time of construction. Attempting to mutate an immutable structure
causes a panic at runtime. Immutability is deep: an immutable structure can only have immutable
members. An immutable value is safe for concurrent access without locking.</p>
<pre><code class="language-go">import ballerina/io;

type Student record {|
    int grade;
    string name;
    map&lt;int&gt; marks;
|};

public function main() {
    // Creates an immutable `Student` value using an intersection
    // type with `readonly`.
    Student &amp; readonly student = {

        grade: 12,
        name: &quot;John&quot;,
        // The applicable contextually-expected type for `marks`
        // is now `map&lt;int&gt; &amp; readonly`. Thus, the value for `marks`
        // will be constructed as an immutable map.
        marks: {
            &quot;Maths&quot;: 75,
            &quot;English&quot;: 90
        }

    };
    boolean x = student[&quot;marks&quot;] is map&lt;int&gt; &amp; readonly;
    io:println(x);
}
</code></pre>
<h4 id="output-43"><a class="header" href="#output-43">Output</a></h4>
<pre><code class="language-bash">bal run immutability.bal
true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json"><a class="header" href="#json">JSON</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json-type"><a class="header" href="#json-type">JSON Type</a></h1>
<p><code>json</code> type is a union: <code>()|boolean|int|float|decimal|string|json[]|map&lt;json&gt;</code>. A <code>json</code> value can
be converted to and from the JSON format straightforwardly except for the choice of the Ballerina numeric type.
Ballerina syntax is compatible with <code>JSON</code> and allows <code>null</code> for <code>()</code> for JSON compatibility.
<code>json</code> is <code>anydata</code> without <code>table</code> and <code>xml</code>. <code>toJson</code> recursively converts <code>anydata</code> to <code>json</code>.
<code>table</code> values are converted to <code>arrays</code>. <code>xml</code> values are converted to <code>strings</code>.<code>json</code> and <code>xml</code>
types are not parallel.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/lang.value;

json j = {&quot;x&quot;: 1, &quot;y&quot;: 2};

// Returns the `string` that represents `j` in JSON format.
string s = j.toJsonString();

// Parses a `string` in the JSON format and returns the value that it represents.
json j2 = check value:fromJsonString(s);

// Allows `null` for JSON compatibility.
json j3 = null;

public function main() {
    io:println(s);
    io:println(j2);
}
</code></pre>
<h4 id="output-44"><a class="header" href="#output-44">Output</a></h4>
<pre><code class="language-bash">bal run json_type.bal
{&quot;x&quot;:1, &quot;y&quot;:2}
{&quot;x&quot;:1,&quot;y&quot;:2}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="working-directly-with-json"><a class="header" href="#working-directly-with-json">Working directly with JSON</a></h1>
<p>Ballerina defines certain types as lax types for which static typing rules are less strict.
For example, field access (<code>.</code>) and optional field access (<code>?.</code>), which are generally allowed on
records and objects for fields that are defined in the type descriptors, are also additionally
allowed on lax types. For such operations, some of the type checking is moved from compile time to runtime.
<code>json</code> is defined to be a lax type along with any <code>map&lt;T&gt;</code> where <code>T</code> is a lax type.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/lang.value as value;

// Define a variable of type `json` that holds a mapping value.
json j = {
    x: {
        y: {
            z: &quot;ballerina&quot;
        }
    }
};

// Field access is allowed on the `json`-typed variable. However, the return
// type would be a union of `json` and `error`.
json v = check j.x.y;
string s1 = check v.z;

// `ensureType` method can also be used to perform conversions.
string s2 = check value:ensureType(v.z, string);

public function main() {
    io:println(&quot;Value of s1: &quot; + s1);
    io:println(&quot;Value of s2: &quot; + s2);
}
</code></pre>
<h4 id="output-45"><a class="header" href="#output-45">Output</a></h4>
<pre><code class="language-bash">bal run working_directly_with_json.bal
Value of s1: ballerina
Value of s2: ballerina
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="match-statement-with-maps"><a class="header" href="#match-statement-with-maps">Match Statement With Maps</a></h1>
<p>Match statement can be used to match maps.
Patterns on the left hand side in a match statement can have variable
parts that can be captured.
Useful for working directly with <code>json</code>.
Match semantics are open (may have fields other than those specified in the pattern).</p>
<pre><code class="language-go">import ballerina/io;

function foo(json j) returns error? {
    match j {
        // Match statement can be used to match maps.
        // Patterns on the left hand side in a match statement can have variable
        // parts that can be captured.
        // Match semantics are open (may have fields other than those 
        // specified in the pattern).
        {command: &quot;add&quot;, amount: var x} =&gt; {
            decimal n = check x.ensureType(decimal);
            add(n);
            return;
        }

        _ =&gt; {
            return error(&quot;invalid command&quot;);
        }
    }
}

decimal total = 0;

function add(decimal amount) {
    total += amount;
    io:println(&quot;Total: &quot;, total);
}

public function main() returns error? {
    check foo({command: &quot;add&quot;, amount: 100, status: &quot;pending&quot;});
    check foo({command: &quot;add&quot;, amount: 10});
    check foo({command: &quot;subtract&quot;, amount: 100});
    return;
}
</code></pre>
<h4 id="output-46"><a class="header" href="#output-46">Output</a></h4>
<pre><code class="language-bash">bal run match_statement_with_maps.bal
Total: 100.0
Total: 110.0
error: invalid command
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="converting-from-user-defined-type-to-json"><a class="header" href="#converting-from-user-defined-type-to-json">Converting From User-Defined Type to JSON</a></h1>
<p>Conversion from <code>json</code> value to JSON format is straightforward.
Converting from application-specific, user-defined subtype of <code>anydata</code>
to <code>json</code> is also possible.
In many cases, this is a no-op: user-defined type will be a subtype of
<code>json</code> as well as of <code>anydata</code>.
With tables, XML or records open to <code>anydata</code>, use <code>toJson()</code> to convert
<code>anydata</code> to <code>json</code>.
APIs that generate JSON typically accept <code>anydata</code> and automatically 
apply <code>toJson()</code>.</p>
<pre><code class="language-go">import ballerina/io;

// Closed type.
type ClosedCoord record {|
    float x;
    float y;
|};

// Open type, can have additional `anydata` fields.
type OpenCoord record {
    float x;
    float y;
};

public function main() {
    ClosedCoord a = {x: 1.0, y: 2.0};
    // Nothing to do.
    json j = a;

    io:println(j);

    OpenCoord b = {x: 1.0, y: 2.0, &quot;z&quot;: &quot;city&quot;};
    // Use `toJson()` to convert `anydata` to `json`.
    // Usually happens automatically.
    json k = b.toJson();

    io:println(k);
}
</code></pre>
<h4 id="output-47"><a class="header" href="#output-47">Output</a></h4>
<pre><code class="language-bash">bal run converting_from_user_defined_type_to_json.bal
{&quot;x&quot;:1.0,&quot;y&quot;:2.0}
{&quot;x&quot;:1.0,&quot;y&quot;:2.0,&quot;z&quot;:&quot;city&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="converting-from-json-to-user-defined-type"><a class="header" href="#converting-from-json-to-user-defined-type">Converting From JSON to User-Defined Type</a></h1>
<p>With mutable values, it would not be type-safe to allow a cast.
Mutable structures have the <code>inherent</code> type that limits mutation.
Cast to <code>T</code> will work on mutable structure <code>s</code> only if the <code>inherent</code> type
of <code>s</code> is a subtype of <code>T</code>.
Casting immutable values will work but it does not do numeric conversions.</p>
<pre><code class="language-go">import ballerina/io;

type Coord record {
    float x;
    float y;
};

public function main() {
    json j = {x: 1.0, y: 2.0};
    
    
    // With mutable values, it would not be type-safe to allow a cast.
    // Cast to `T` will work on the mutable structure `s` only if the inherent type
    // of `s` is a subtype of `T`.
    // Use `cloneReadOnly()` to create a read-only copy of the mutable value.
    // Then, you can cast the resulting immutable value successfully.
    json k = j.cloneReadOnly();
    Coord c = &lt;Coord&gt; k;

    io:println(c.x);
    io:println(c.y);
}
</code></pre>
<h4 id="output-48"><a class="header" href="#output-48">Output</a></h4>
<pre><code class="language-bash">bal run converting_from_json_to_user_defined_type.bal
1.0
2.0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="converting-to-user-defined-type"><a class="header" href="#converting-to-user-defined-type">Converting to User-Defined Type</a></h1>
<p>The <code>cloneWithType()</code> langlib function in the lang.value
module can be used to convert a value to a user-defined type.
Result recursively uses specified type as inherent type of new value.
Automatically performs numeric conversions as necessary.
Every part of the value is cloned including immutable structural values.
Graph structure is not preserved. 
Variant <code>fromJsonWithType()</code> also does reverse of conversions done by
<code>toJson</code>.</p>
<pre><code class="language-go">import ballerina/io;

type Coord record {
    float x;
    float y;
};

public function main() returns error? {
    json j = {x: 1.0, y: 2.0};

    // Argument is a `typedesc` value.
    // The static return type depends on the argument.
    Coord c = check j.cloneWithType(Coord);

    io:println(c.x);

    // Argument defaulted from the context.
    Coord d = check j.cloneWithType();

    io:println(d.x);
    return;
}
</code></pre>
<h4 id="output-49"><a class="header" href="#output-49">Output</a></h4>
<pre><code class="language-bash">bal run converting_to_user_defined_type.bal
1.0
1.0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="resource-method-typing"><a class="header" href="#resource-method-typing">Resource Method Typing</a></h1>
<p>Resource method arguments can use user-defined types.
Listener will use introspection to map from protocol format 
(typically JSON) to user-defined type, using <code>cloneWithType</code>.
Return value that is subtype of <code>anydata</code> will be mapped from 
user-defined type to protocol format, typically JSON, using <code>toJson</code>.
Can generate API description (e.g. OpenAPI) from Ballerina 
service declaration.
Annotations can be used to refine the mapping between 
Ballerina-declared type and wire format.</p>
<pre><code class="language-go">import ballerina/http;

type Args record {|
    decimal x;
    decimal y;
|};

listener http:Listener h = new (9090);

service /calc on h {
    // Resource method arguments can use user-defined types.
    // Annotations can be used to refine the mapping between 
    // Ballerina-declared type and wire format.
    resource function post add(@http:Payload Args args) 
            returns decimal {
        return args.x + args.y;
    }

}
</code></pre>
<h4 id="output-50"><a class="header" href="#output-50">Output</a></h4>
<pre><code class="language-bash">curl http://localhost:9090/calc/add -d &quot;{\&quot;x\&quot;: 1.0, \&quot;y\&quot;: 2.0}&quot;
3.0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="json-numbers"><a class="header" href="#json-numbers">JSON Numbers</a></h1>
<p>Ballerina has three numeric types; but JSON has one.
The <code>json</code> type allows <code>int|float|decimal</code>.
<code>toJsonString()</code> will convert <code>int|float|decimal</code> into JSON numeric syntax.
<code>fromJsonString()</code> converts JSON numeric syntax into <code>int</code>, if possible, and
otherwise <code>decimal</code>.
<code>cloneWithType()</code> or <code>ensureType()</code> will convert from <code>int</code> or <code>decimal</code> into user's
chosen numeric type.
Net result is that you can use <code>json</code> to exchange full range of all three Ballerina
numeric types.
<code>-0</code> is an edge case: represented as <code>float</code>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    int a = 1;
    float b = 2.1;
    decimal c = 3.24;

    // The `json` type allows `int|float|decimal`.
    json[] d = [a, b, c];

    // `toJsonString()` will convert `int|float|decimal` into JSON
    // numeric syntax.
    string e = d.toJsonString();

    io:println(e);

    // `fromJsonString()` converts JSON numeric syntax into `int`,
    // if possible, and otherwise `decimal`.
    json f = check e.fromJsonString();

    io:println(f);

    json[] g = &lt;json[]&gt; f;

    io:println(typeof g[0]);
    io:println(typeof g[1]);
    io:println(typeof g[2]);

    // `cloneWithType()` or `ensureType()` will convert from `int` or `decimal` into the user's
    // chosen numeric type.
    float h = check g[2].ensureType();

    io:println(h);

    // `-0` is an edge case: represented as `float`.
    string i = &quot;-0&quot;;

    io:println(typeof check i.fromJsonString());
    return;
}
</code></pre>
<h4 id="output-51"><a class="header" href="#output-51">Output</a></h4>
<pre><code class="language-bash">bal run json_numbers.bal
[1, 2.1, 3.24]
[1,2.1,3.24]
typedesc 1
typedesc 2.1
typedesc 3.24
3.24
typedesc -0.0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tables"><a class="header" href="#tables">Tables</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="table-syntax"><a class="header" href="#table-syntax">Table Syntax</a></h1>
<p>A <code>table</code> is a collection of records. Each <code>record</code> represents a row of the <code>table</code>.
A <code>table</code> is plain data if and only if its rows are plain data. A <code>table</code> maintains an invariant
that each row is uniquely identified by a key. Each rows key is stored in fields, which
must be immutable. <br/><br/>
Compared to maps,</p>
<ul>
 <li>key is part of the value rather than being separate.</li>
 <li>The type of the key is not restricted to `string`.</li>
 <li>The order of the members is preserved.</li>
 </ul>
 <br/><br/>
 <p>A `record` field can be declared as `readonly`. A value cannot be assigned to such a field
 after the record is created. The `table` type gives the type of the row and the name of the key field.
 The `table constructor expression` looks like an `array constructor`. The `foreach` statement will
 iterate over a table's rows in their order. Use `t[k]` to access a row using its key.</p>
<pre><code class="language-go">import ballerina/io;

type Employee record {
    readonly string name;
    int salary;
};

// Creates a `table` with members of the `Employee` type, where each
// member is uniquely identified using their `name` field.
table&lt;Employee&gt; key(name) t = table [
    { name: &quot;John&quot;, salary: 100 },
    { name: &quot;Jane&quot;, salary: 200 }
];

function increaseSalary(int n) {
    // Iterates over the rows of `t` in the specified order.
    foreach Employee e in t {
        e.salary += n;
    }
    
}

public function main() {
    // Retrieves the `Employee` member with `&quot;Fred&quot;` as the value of the key.
    Employee? e = t[&quot;Fred&quot;];
    io:println(e.toBalString());

    increaseSalary(100);
    io:println(t);
}
</code></pre>
<h4 id="output-52"><a class="header" href="#output-52">Output</a></h4>
<pre><code class="language-bash">bal run table_syntax.bal
()
[{&quot;name&quot;:&quot;John&quot;,&quot;salary&quot;:200},{&quot;name&quot;:&quot;Jane&quot;,&quot;salary&quot;:300}]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="multiple-key-fields"><a class="header" href="#multiple-key-fields">Multiple Key Fields</a></h1>
<p>A <code>table</code> provides access to its members using a key that comes from the <code>read-only</code> fields of the member.
It is a key sequence, which is used to provide keyed access to its members. The key sequence is an ordered
sequence of field names.</p>
<pre><code class="language-go">import ballerina/io;

type Employee record {
    readonly string firstName;
    readonly string lastName;
    int salary;
};

public function main() {
    // `t` has a key sequence with `firstName` and `lastName` fields.
    table&lt;Employee&gt; key(firstName, lastName) t = table [
        {firstName: &quot;John&quot;, lastName: &quot;Smith&quot;, salary: 100},
        {firstName: &quot;Fred&quot;, lastName: &quot;Bloggs&quot;, salary: 200}
    ];

    // The key sequence provides keyed access to members of the `table`.
    Employee? e = t[&quot;Fred&quot;, &quot;Bloggs&quot;];


    io:println(e);
}
</code></pre>
<h4 id="output-53"><a class="header" href="#output-53">Output</a></h4>
<pre><code class="language-bash">bal run multiple_key_fields.bal
{&quot;firstName&quot;:&quot;Fred&quot;,&quot;lastName&quot;:&quot;Bloggs&quot;,&quot;salary&quot;:200}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="structured-keys"><a class="header" href="#structured-keys">Structured Keys</a></h1>
<p>Key fields can be structured as long as they belong to any subtype of plain data. The value of the key field
must be immutable. The initializer of the <code>readonly</code> field will be constructed as immutable. In other cases,
can use <code>cloneReadOnly()</code> to create an immutable value.</p>
<pre><code class="language-go">import ballerina/io;

type Employee record {
    readonly record {
        string first;
        string last;
    } name;
    int salary;
};

public function main() {
    // key field, `name` is of `record` type.
    table&lt;Employee&gt; key(name) t = table [
        {name: {first: &quot;John&quot;, last: &quot;Smith&quot;}, salary: 100},
        {name: {first: &quot;Fred&quot;, last: &quot;Bloggs&quot;}, salary: 200}
    ];

    Employee? e = t[{first: &quot;Fred&quot;, last: &quot;Bloggs&quot;}];
    io:println(e);
}
</code></pre>
<h4 id="output-54"><a class="header" href="#output-54">Output</a></h4>
<pre><code class="language-bash">bal run structured_keys.bal
{&quot;name&quot;:{&quot;first&quot;:&quot;Fred&quot;,&quot;last&quot;:&quot;Bloggs&quot;},&quot;salary&quot;:200}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="query-expressions"><a class="header" href="#query-expressions">Query Expressions</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="query-expressions-1"><a class="header" href="#query-expressions-1">Query Expressions</a></h1>
<p>Query-like expressions start with a <code>from</code> clause and end with a <code>select</code> clause. It is a
list comprehension, based on mathematical &quot;set builder&quot; notation.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    int[] nums = [1, 2, 3, 4];

    // The `from` clause works similar to a `foreach` statement.
    int[] numsTimes10 = from var i in nums
                        // The `select` clause is evaluated for each iteration.
                        select i * 10;

                        
    io:println(numsTimes10);

    // This is based on
    //
    // `{ 10  i | i  nums }`
    //
    // `{ i | i mod 2 = 0, i  nums }`
    //
    // set builder notation.
    int[] evenNums = from var i in nums
                     where i % 2 == 0
                     select i;

    io:println(evenNums);
}
</code></pre>
<h4 id="output-55"><a class="header" href="#output-55">Output</a></h4>
<pre><code class="language-bash">bal run query_expressions.bal
[10,20,30,40]
[2,4]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="destructuring-records"><a class="header" href="#destructuring-records">Destructuring Records</a></h1>
<p>Destructuring records is particularly useful with query expressions but works anywhere you can have <code>var</code>.
<code>var</code> is followed by a <code>binding pattern</code>. The semantics of <code>binding pattern</code> is open. <code>{x}</code> is short for
<code>{x: x}</code> in both binding patterns and record constructors.</p>
<pre><code class="language-go">import ballerina/io;

type Person record {
 string first;
 string last;
 int yearOfBirth;
};

public function main() {
    Person[] persons = [
        {first: &quot;Melina&quot;, last: &quot;Kodel&quot;, yearOfBirth: 1994},
        {first: &quot;Tom&quot;, last: &quot;Riddle&quot;, yearOfBirth: 1926}
    ];

    // A `Person` record is destructured here, as a
    // projection with `first` and `last` fields.
    // `{first: f, last: l}` is the `binding pattern`.
    var names1 = from var {first: f, last: l} in persons
                select {first: f, last: l};


    io:println(names1);

    // The same can be simplified as this.
    var names2 = from var {first, last} in persons
                select {first, last};


    io:println(names2);
}
</code></pre>
<h4 id="output-56"><a class="header" href="#output-56">Output</a></h4>
<pre><code class="language-bash">bal run destructuring_records.bal
[{&quot;first&quot;:&quot;Melina&quot;,&quot;last&quot;:&quot;Kodel&quot;},{&quot;first&quot;:&quot;Tom&quot;,&quot;last&quot;:&quot;Riddle&quot;}]
[{&quot;first&quot;:&quot;Melina&quot;,&quot;last&quot;:&quot;Kodel&quot;},{&quot;first&quot;:&quot;Tom&quot;,&quot;last&quot;:&quot;Riddle&quot;}]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="let-clause"><a class="header" href="#let-clause">Let Clause</a></h1>
<p>Query expressions can have <code>let</code> clauses. They can be anywhere between <code>from</code> and <code>select</code>
clauses. Multiple <code>where</code> clauses are also allowed. The semantics are similar to <code>XQuery FLWOR</code>.</p>
<pre><code class="language-go">import ballerina/io;

type Person record {
 string first;
 string last;
 int yearOfBirth;
};

public function main() {
    Person[] persons = [
        {first: &quot;Melina&quot;, last: &quot;Kodel&quot;, yearOfBirth: 1994},
        {first: &quot;Tom&quot;, last: &quot;Riddle&quot;, yearOfBirth: 1926}
    ];

    string[] names = from var {first, last} in persons
                     // The `let` clause binds the variables.
                     let int len1 = first.length()
                     // The `where` clause provides a way to perform conditional execution.
                     where len1 &gt; 0

                     let int len2 = last.length()
                     where len2 &gt; 0
                     let string name = first + &quot; &quot; + last
                     select name;
                     
    io:println(names);
}
</code></pre>
<h4 id="output-57"><a class="header" href="#output-57">Output</a></h4>
<pre><code class="language-bash">bal run let_clause.bal
[&quot;Melina Kodel&quot;,&quot;Tom Riddle&quot;]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ordering"><a class="header" href="#ordering">Ordering</a></h1>
<p>Ordering works consistently with <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code> operators. Some comparisons involving
<code>()</code> and <code>float NaN</code> are considered <code>unordered</code>. <code>order by</code> clause allows <code>expressions</code> not just
<code>field access</code>. A library module can enable Unicode-aware sorting by providing a
<code>unicode:sortKey(str, locale)</code> function.</p>
<pre><code class="language-go">import ballerina/io;

type Employee record {
    string firstName;
    string lastName;
    decimal salary;
};

public function main() {
    Employee[] employees = [
        {firstName: &quot;Jones&quot;, lastName: &quot;Welsh&quot;, salary: 1000.00},
        {firstName: &quot;Anne&quot;, lastName: &quot;Frank&quot;, salary: 5000.00},
        {firstName: &quot;Rocky&quot;, lastName: &quot;Irving&quot;, salary: 6000.00},
        {firstName: &quot;Anne&quot;, lastName: &quot;Perera&quot;, salary: 3000.00},
        {firstName: &quot;Jermaine&quot;, lastName: &quot;Perera&quot;, salary: 4000.00},
        {firstName: &quot;Miya&quot;, lastName: &quot;Bauer&quot;, salary: 9000.00},
        {firstName: &quot;Rocky&quot;, lastName: &quot;Puckett&quot;, salary: 6000.00},
        {firstName: &quot;Jermaine&quot;, lastName: &quot;Kent&quot;, salary: 4000.00}
    ];

    Employee[] sorted = from var e in employees
                        // The `order by` clause sorts the output items based on the
                        // given `order-key` and `order-direction`. The `order-key`
                        // must be an `ordered` type. The `order-direction` is `ascending`
                        // if not specified explicitly.
                        order by e.firstName ascending, e.lastName descending


                        select e;

    foreach Employee e in sorted {
        io:println(e.firstName, &quot; &quot;, e.lastName);
    }
}
</code></pre>
<h4 id="output-58"><a class="header" href="#output-58">Output</a></h4>
<pre><code class="language-bash">bal run ordering.bal
Anne Perera
Anne Frank
Jermaine Perera
Jermaine Kent
Jones Welsh
Miya Bauer
Rocky Puckett
Rocky Irving
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="limit-clause"><a class="header" href="#limit-clause">Limit Clause</a></h1>
<p>The <code>limit</code> clause limits the number of results from the earlier clauses.</p>
<pre><code class="language-go">import ballerina/io;

type Employee record {
    string firstName;
    string lastName;
    decimal salary;
};

public function main() {
    Employee[] employees = [
        {firstName: &quot;Jones&quot;, lastName: &quot;Welsh&quot;, salary: 1000.00},
        {firstName: &quot;Anne&quot;, lastName: &quot;Frank&quot;, salary: 5000.00},
        {firstName: &quot;Michael&quot;, lastName: &quot;Cain&quot;, salary: 10000.00},
        {firstName: &quot;Tom&quot;, lastName: &quot;Hiddleston&quot;, salary: 2000.00}
    ];

    Employee[] top3 = from var e in employees
                      order by e.salary descending
                      // The `limit` clause limits the number of output items to 3.
                      limit 3


                      select e;

    foreach var emp in top3 {
        io:println(emp);
    }
}
</code></pre>
<h4 id="output-59"><a class="header" href="#output-59">Output</a></h4>
<pre><code class="language-bash">bal run limit_clause.bal
{&quot;firstName&quot;:&quot;Michael&quot;,&quot;lastName&quot;:&quot;Cain&quot;,&quot;salary&quot;:10000.00}
{&quot;firstName&quot;:&quot;Anne&quot;,&quot;lastName&quot;:&quot;Frank&quot;,&quot;salary&quot;:5000.00}
{&quot;firstName&quot;:&quot;Tom&quot;,&quot;lastName&quot;:&quot;Hiddleston&quot;,&quot;salary&quot;:2000.00}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="querying-tables"><a class="header" href="#querying-tables">Querying Tables</a></h1>
<p>Tables can be nicely combined with <code>query expressions</code> unlike <code>maps</code>. Basic type of the output of
<code>query expression</code> is determined by the contextually expected type and the input type.</p>
<pre><code class="language-go">import ballerina/io;

type Employee record {|
    readonly int id;
    string firstName;
    string lastName;
    int salary;
|};

public function main() {
    table&lt;Employee&gt; key(id) employees = table [
        {id: 1, firstName: &quot;John&quot;, lastName: &quot;Smith&quot;, salary: 100},
        {id: 2, firstName: &quot;Jane&quot;, lastName: &quot;Smith&quot;, salary: 150},
        {id: 4, firstName: &quot;Fred&quot;, lastName: &quot;Bloggs&quot;, salary: 200},
        {id: 7, firstName: &quot;Bobby&quot;, lastName: &quot;Clark&quot;, salary: 300},
        {id: 9, firstName: &quot;Cassie&quot;, lastName: &quot;Smith&quot;, salary: 250}
    ];

    // The `from` clause iterates the `employees` table.
    // Since the contextually-expected type for the query expression is `int[]` evaluation of the query expression will result in an integer array.
    int[] salaries = from var {salary} in employees
                     select salary;


    io:println(salaries);

    // The `from` clause iterates `employees` `table` and creates a `table`.
    // The query expression creates a `table` based on the contextually-expected type.
    table&lt;Employee&gt; smiths = from Employee emp in employees
                     where emp.lastName == &quot;Smith&quot; select emp;

    foreach Employee emp in smiths {
        io:println(emp.firstName, &quot; &quot;, emp.lastName);
    }
}
</code></pre>
<h4 id="output-60"><a class="header" href="#output-60">Output</a></h4>
<pre><code class="language-bash">bal run querying_tables.bal
[100,150,200,300,250]
John Smith
Jane Smith
Cassie Smith
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creating-tables-with-query"><a class="header" href="#creating-tables-with-query">Creating Tables With Query</a></h1>
<p>Query expressions can create tables. The key of the created <code>table</code> can be specified explicitly.</p>
<pre><code class="language-go">import ballerina/io;

type Employee record {|
    readonly int id;
    string firstName;
    string lastName;
    int salary;
|};

public function main() {
    table&lt;Employee&gt; key(id) employees = table [
        {id: 1, firstName: &quot;John&quot;, lastName: &quot;Smith&quot;, salary: 100},
        {id: 2, firstName: &quot;Fred&quot;, lastName: &quot;Bloggs&quot;, salary: 2000}
    ];

    // The query expression starts with `table`.
    // The key specifier `key(id)` specifies the key sequence of the constructed `table`.
    // The result of the query expression is a `table`.
    var highPaidEmployees = table key(id) from var e in employees
                            where e.salary &gt;= 1000
                            select e;


    io:println(highPaidEmployees);
}
</code></pre>
<h4 id="output-61"><a class="header" href="#output-61">Output</a></h4>
<pre><code class="language-bash">bal run creating_tables_with_query.bal
[{&quot;id&quot;:2,&quot;firstName&quot;:&quot;Fred&quot;,&quot;lastName&quot;:&quot;Bloggs&quot;,&quot;salary&quot;:2000}]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="join-clause"><a class="header" href="#join-clause">Join Clause</a></h1>
<p><code>Query</code> can take advantage of <code>table</code> keys by using a <code>join clause</code>. Performs an <code>inner equijoin</code>.
The result is similar to using nested <code>from clause</code> and <code>where clause</code>. It is implemented as
a hash join: <code>table</code> keys allow you to avoid building a hash table. The type to join on must be <code>anydata</code>.</p>
<pre><code class="language-go">import ballerina/io;

type User record {|
    readonly int id;
    string name;
|};

type Login record {|
    int userId;
    string time;
|};

public function main() {
    table&lt;User&gt; key(id) users = table [
        {id: 1234, name: &quot;Keith&quot;},
        {id: 6789, name: &quot;Anne&quot;}
    ];

    Login[] logins = [
        {userId: 6789, time: &quot;20:10:23&quot;},
        {userId: 1234, time: &quot;10:30:02&quot;},
        {userId: 3987, time: &quot;12:05:00&quot;}
    ];

    string[] loginLog = from var login in logins
                        // The `join` clause iterates any iterable value similarly to the
                        // `from` clause.
                        join var user in users
                        // The `on` condition is used to match the `login` with the `user`
                        // based on the `userId`. The iteration is skipped when the
                        // condition is not satisfied.
                        on login.userId equals user.id


                        select user.name + &quot;:&quot; + login.time;
    io:println(loginLog);
}
</code></pre>
<h4 id="output-62"><a class="header" href="#output-62">Output</a></h4>
<pre><code class="language-bash">bal run join_clause.bal
[&quot;Anne:20:10:23&quot;,&quot;Keith:10:30:02&quot;]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stream-type"><a class="header" href="#stream-type">Stream Type</a></h1>
<p>A <code>stream</code> represents a sequence of values that are generated as needed. The end of a <code>stream</code> is indicated with a
termination value, which is <code>error</code> or <code>nil</code>. The type <code>stream&lt;T,E&gt;</code> is a <code>stream</code> where the members of the
sequence are type <code>T</code> and termination value is type <code>E</code>. <code>stream&lt;T&gt;</code> means <code>stream&lt;T,()&gt;</code>. The <code>stream</code> type
is a separate basic type, but like an object.</p>
<pre><code class="language-go">import ballerina/io;

// Defines a class called `EvenNumberGenerator`.
// Each class has its own `next()` method, which gets 
// invoked when the stream's `next()` function
// gets called.
class EvenNumberGenerator {
    int i = 0;
    public isolated function next() returns record {| int value; |}|error? {
        self.i += 2;
        return { value: self.i };
    }
}

type ResultValue record {|
    int value;
|};

public function main() {
    EvenNumberGenerator evenGen = new();
    // Creates a `stream` passing an `EvenNumberGenerator` object
    // to the `stream` constructor.
    stream&lt;int, error?&gt; evenNumberStream = new(evenGen);

    var evenNumber = evenNumberStream.next();
    
    if (evenNumber is ResultValue) {
        io:println(&quot;Retrieved even number: &quot;, evenNumber.value);
    }
}
</code></pre>
<h4 id="output-63"><a class="header" href="#output-63">Output</a></h4>
<pre><code class="language-bash">bal run stream_type.bal
Retrieved even number: 2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="querying-with-streams"><a class="header" href="#querying-with-streams">Querying With Streams</a></h1>
<p>If stream terminates with <code>error</code>, result of <code>query expression</code> is an <code>error</code>. You cannot use <code>foreach</code>
on <code>stream</code> type with termination type that allows <code>error</code>. Instead use <code>from</code> with <code>do</code> clause; the
result is a subtype of <code>error?</code>. Use <code>stream</code> keyword in front of <code>from</code> to create a <code>stream</code> which is
lazily evaluated. The failure of <code>check</code> within the <code>query</code> will cause the <code>stream</code> to produce an
<code>error</code> termination value.</p>
<pre><code class="language-go">import ballerina/io;

type Error error;

type LineStream stream&lt;string, Error?&gt;;

type ValueRecord record {|
    string value;
|};

const SAMPLE_LINE_COUNT = 5;

class LineGenerator {
    int i = -1;
    string inputString;

    public function init(string str) {
        self.inputString = str;
    }

    public isolated function next() returns ValueRecord|Error? {
        self.i += 1;
        if (self.i &lt; SAMPLE_LINE_COUNT) {
            if (self.i % 2 == 0) {
                return {value: self.inputString};
            }
            return {value: &quot;&quot;};
        }
        return;
    }
}

// This method strips the blank lines.
function strip(LineStream lines) returns LineStream {
    // Creates a `stream` from the query expression.
    LineStream res = stream from var line in lines
             where line.trim().length() &gt; 0
             select line;

    return res;
}

function count(LineStream lines) returns int|Error {
    int nLines = 0;
    // Counts the number of lines by iterating the `stream`
    // in `query action`.
    var _ = check from var _ in lines
              do {
                  nLines += 1;
              };

    return nLines;
}

public function main() {
    LineGenerator generator = new (&quot;Everybody can dance&quot;);
    LineStream inputLineStream = new (generator);

    LineStream strippedStream = strip(inputLineStream);

    int|Error nonBlankCount = count(strippedStream);

    if (nonBlankCount is int) {
        io:println(&quot;Input line count: &quot;, SAMPLE_LINE_COUNT.toString());
        io:println(&quot;Non blank line count: &quot;, nonBlankCount.toString());
    }
}
</code></pre>
<h4 id="output-64"><a class="header" href="#output-64">Output</a></h4>
<pre><code class="language-bash">bal run querying_with_streams.bal
Input line count: 5
Non blank line count: 3
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="backtick-templates"><a class="header" href="#backtick-templates">Backtick Templates</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="raw-templates"><a class="header" href="#raw-templates">Raw Templates</a></h1>
<p>A raw template is a backtick template without a tag. Exposes result of phase 1 without further processing.
Raw template is evaluated by evaluating each expression and creating an object containing.</p>
<ul>
 <li>an `array` of the `strings` separated by insertions</li>
 <li>an `array` of the results of expression evaluation and an `array` of `strings` separating</li>
 </ul>
<br></br>
 <p>Important use case: SQL parameters.</p>
 Note that the relevant database driver JAR should be defined in the `Ballerina.toml` file as a dependency.
 This sample is based on an H2 database and the H2 database driver JAR need to be added to `Ballerina.toml` file.
 For a sample configuration and more information on the underlying module, see the [JDBC module](https:docs.central.ballerina.io/ballerinax/java.jdbc/latest/) .<br><br>
 This sample is written using H2 2.1.210 and it is recommended to use H2 JAR with versions higher than 2.1.210.
<pre><code class="language-go">import ballerina/io;
import ballerinax/java.jdbc;
import ballerina/sql;

jdbc:Client dbClient = check new (url = &quot;jdbc:h2:file:./master/orderdb&quot;,
                           user = &quot;test&quot;, password = &quot;test&quot;);

public function main() returns error? {
    // Uses a raw template to create `Orders` table.
    _ = check dbClient-&gt;execute(`CREATE TABLE IF NOT EXISTS Orders
                                (orderId INTEGER NOT NULL,
                                customerId INTEGER, noOfItems INTEGER,
                                PRIMARY KEY (orderId))`);
    // Uses a raw template to insert values to `Orders` table.
    _ = check dbClient-&gt;execute(`INSERT INTO Orders (orderId, customerId,
                                noOfItems) VALUES (1, 1, 20)`);
    _ = check dbClient-&gt;execute(`INSERT INTO Orders (orderId, customerId,
                                noOfItems) VALUES (2, 1, 15)`);

    stream&lt;record {| anydata...; |}, sql:Error?&gt; strm = getOrders(1);
    record {|record {} value;|}|sql:Error? v = strm.next();
    while (v is record {|record {} value;|}) {
        record {} value = v.value;
        io:println(value);
        v = strm.next();
    }
}

function getOrders(int customerId)
    returns stream&lt;record {| anydata...; |}, sql:Error?&gt; {
    // In this raw template, the `customerId` variable is interpolated in the literal.
    return dbClient-&gt;query(`SELECT * FROM orders
                          WHERE customerId = ${customerId}`);

}
</code></pre>
<h4 id="output-65"><a class="header" href="#output-65">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

{&quot;ORDERID&quot;:1,&quot;CUSTOMERID&quot;:1,&quot;NOOFITEMS&quot;:20}
{&quot;ORDERID&quot;:2,&quot;CUSTOMERID&quot;:1,&quot;NOOFITEMS&quot;:15}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="backtick-templates-1"><a class="header" href="#backtick-templates-1">Backtick Templates</a></h1>
<p>The backtick templates consist of a tag followed by characters surrounded by backticks. They can contain
<code>expressions</code> in <code>${...}</code> to be interpolated. If no escapes are recognized: use an <code>expression</code> to escape.
They can contain newlines. <br></br>
Processed in two phases.</p>
<ul>
 <li>Phase 1 does tag-independent parse: result is a list of `strings` and `expressions`</li>
 <li>Phase 2 is tag-dependent</li>
 </ul>
<br></br>
 Phase 2 for `string...` converts `expressions` to `strings` and concatenates. `base16` and `base64`
 tags do not allow `expressions`.
<pre><code class="language-go">import ballerina/io;

public function main() {
    string name = &quot;James&quot;;

    // Concatenates `Hello, ` strings with the `name` value.
    string s1 = string`Hello, ${name}`;
    io:println(s1);

    // Concatenates `Backtick:` strings with `.
    string s2 = string`Backtick:${&quot;`&quot;}`;
    io:println(s2);
}
</code></pre>
<h4 id="output-66"><a class="header" href="#output-66">Output</a></h4>
<pre><code class="language-bash">bal run backtick_templates.bal
Hello, James
Backtick:`
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xml-templates"><a class="header" href="#xml-templates">XML Templates</a></h1>
<p><code>xml</code> values can be constructed using an XML template expression.
Phase 2 processing for <code>xml</code> template tag parses strings using 
the XML 1.0 Recommendation's grammar for content (what XML allows 
between a start-tag and an end-tag).
Interpolated expressions can be in content (<code>xml</code> or <code>string</code> values) 
or in attribute values (<code>string</code> values).</p>
<pre><code class="language-go">import ballerina/io;

string url = &quot;https://ballerina.io&quot;;

xml content = 
    // `xml` values can be constructed using an XML template expression.
    // Attribute values can have `string` values as interpolated expressions.
    xml `&lt;a href=&quot;${url}&quot;&gt;Ballerina&lt;/a&gt; is an &lt;em&gt;exciting&lt;/em&gt; new language!`;

// Interpolated expressions can also be in content (`xml` or `string` values).
xml p = xml `&lt;p&gt;${content}&lt;/p&gt;`;

public function main() {
    io:println(content);
    io:println(p);
}
</code></pre>
<h4 id="output-67"><a class="header" href="#output-67">Output</a></h4>
<pre><code class="language-bash">bal run xml_templates.bal
&lt;a href=&quot;https://ballerina.io&quot;&gt;Ballerina&lt;/a&gt; is an &lt;em&gt;exciting&lt;/em&gt; new language!
&lt;p&gt;&lt;a href=&quot;https://ballerina.io&quot;&gt;Ballerina&lt;/a&gt; is an &lt;em&gt;exciting&lt;/em&gt; new language!&lt;/p&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xml"><a class="header" href="#xml">XML</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xml-data-model"><a class="header" href="#xml-data-model">XML Data Model</a></h1>
<p>An <code>xml</code> value is a sequence representing the parsed content of an XML element. <br></br>
An <code>xml</code> value has four kinds of items.</p>
<ul>
 <li>The element, processing instruction, and comment singletons correspond directly to the items in the XML information set</li>
 <li>The text item corresponds to one or more character information items</li>
 </ul>
<br></br>
 <p>XML document is an `xml` sequence with only one `element` and no `text`. An `element` item is mutable
 and consists of:</p>
 <ul>
 <li>name: type `string`</li>
 <li>attributes: type `map<string>`</li>
 <li>children: type `xml`</li>
 </ul>
<br></br>
 <p>A `text` item is immutable.</p>
 <ul>
 <li>it has no identity: `==` is the same as `===`</li>
 <li>consecutive `text` items never occur in an `xml` value: they are always merged</li>
 </ul>
<pre><code class="language-go">import ballerina/io;

public function main() {
    // An XML element. There can be only one root element.
    xml x1 = xml `&lt;book&gt;The Lost World&lt;/book&gt;`;
    io:println(x1);

    // An XML text.
    xml x2 = xml `Hello, world!`;
    io:println(x2);

    // An XML comment.
    xml x3 = xml `&lt;!--I am a comment--&gt;`;
    io:println(x3);

    // An XML processing instructions.
    xml x4 = xml `&lt;?target data?&gt;`;
    io:println(x4);

    // Multiple XML items can be combined to form a sequence of XML.
    // The resulting sequence is another XML on its own.
    xml x5 = x1 + x2 + x3 + x4;
    io:println(x5);

}
</code></pre>
<h4 id="output-68"><a class="header" href="#output-68">Output</a></h4>
<pre><code class="language-bash">bal run xml.bal
&lt;book&gt;The Lost World&lt;/book&gt;
Hello, world!
&lt;!--I am a comment--&gt;
&lt;?target data?&gt;
&lt;book&gt;The Lost World&lt;/book&gt;Hello, world!&lt;!--I am a comment--&gt;&lt;?target data?&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xml-operations"><a class="header" href="#xml-operations">XML Operations</a></h1>
<p><code>+</code> does concatenation.
<code>==</code> does deep equals.
<code>foreach</code> iterates over each item.
<code>x[i]</code> gives i-th item (empty sequence if none).
<code>x.id</code> accesses required attribute named <code>id</code>:
result is error if there is no such attribute
or if x is not a singleton.
<code>x?.id</code> accesses optional attribute named <code>id</code>:
result is () if there is no such attribute.
Langlib lang.xml provides other operations.
Mutate an element using <code>e.setChildren(x)</code>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    xml x1 = xml `&lt;name&gt;Sherlock Holmes&lt;/name&gt;`;
    xml:Element x2 = 
        xml `&lt;details&gt;
                &lt;author&gt;Sir Arthur Conan Doyle&lt;/author&gt;
                &lt;language&gt;English&lt;/language&gt;
            &lt;/details&gt;`;

    // `+` does concatenation.
    xml x3 = x1 + x2;

    io:println(x3);

    xml x4 = xml `&lt;name&gt;Sherlock Holmes&lt;/name&gt;&lt;details&gt;
                        &lt;author&gt;Sir Arthur Conan Doyle&lt;/author&gt;
                        &lt;language&gt;English&lt;/language&gt;
                  &lt;/details&gt;`;
    // `==` does deep equals.
    boolean eq = x3 == x4;

    io:println(eq);

    // `foreach` iterates over each item.
    foreach var item in x4 {
        io:println(item);
    }

    // `x[i]` gives i-th item (empty sequence if none).
    io:println(x3[0]);

    // `x.id` accesses required attribute named `id`:
    // result is `error` if there is no such attribute
    // or if `x` is not a singleton.
    xml x5 = xml `&lt;para id=&quot;greeting&quot;&gt;Hello&lt;/para&gt;`;
    string id = check x5.id;

    io:println(id);

    // `x?.id` accesses optional attribute named `id`:
    // result is `()` if there is no such attribute.
    string? name = check x5?.name;

    io:println(name is ());

    // Mutate an element using `e.setChildren(x)`.
    x2.setChildren(xml `&lt;language&gt;French&lt;/language&gt;`);

    io:println(x2);
    io:println(x3);
}
</code></pre>
<h4 id="output-69"><a class="header" href="#output-69">Output</a></h4>
<pre><code class="language-bash">bal run xml_operations.bal
&lt;name&gt;Sherlock Holmes&lt;/name&gt;&lt;details&gt;
                &lt;author&gt;Sir Arthur Conan Doyle&lt;/author&gt;
                &lt;language&gt;English&lt;/language&gt;
            &lt;/details&gt;
false
&lt;name&gt;Sherlock Holmes&lt;/name&gt;
&lt;details&gt;
                        &lt;author&gt;Sir Arthur Conan Doyle&lt;/author&gt;
                        &lt;language&gt;English&lt;/language&gt;
                  &lt;/details&gt;
&lt;name&gt;Sherlock Holmes&lt;/name&gt;
greeting
true
&lt;details&gt;&lt;language&gt;French&lt;/language&gt;&lt;/details&gt;
&lt;name&gt;Sherlock Holmes&lt;/name&gt;&lt;details&gt;&lt;language&gt;French&lt;/language&gt;&lt;/details&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xml-subtyping"><a class="header" href="#xml-subtyping">XML Subtyping</a></h1>
<p>An <code>xml</code> value belongs to <code>xml:Element</code> if it consists of just an element
item. Similarly for <code>xml:Comment</code> and <code>xml:ProcessingInstruction</code>.
An <code>xml</code> value belongs to <code>xml:Text</code> if it consists of a text item or is 
empty.
An <code>xml</code> value belongs to the type <code>xml&lt;T&gt;</code> if each of its members belong 
to <code>T</code>.
Functions in lang.xml use this to provide safe and convenient typing.
For example, <code>x.elements()</code> returns element items in <code>x</code> as type 
<code>xml&lt;xml:Element&gt;</code> and <code>e.getName()</code> and <code>e.setName()</code> are defined when 
<code>e</code> has type <code>xml:Element</code>.</p>
<pre><code class="language-go">import ballerina/io;

// An `xml` value belongs to `xml:Element` if it consists of just an element
// item. 
xml:Element element = xml `&lt;p&gt;Hello&lt;/p&gt;`;

// Similarly for `xml:Comment` and `xml:ProcessingInstruction`.
xml:Comment comment = xml `&lt;!--This is a comment--&gt;`;
xml:ProcessingInstruction procInst = xml `&lt;?target data?&gt;`;

public function main() {
    // An `xml` value belongs to the `xml:Text` if it consists of a text item or is empty.
    xml:Text _ = xml ``;
    xml:Text _ = xml `Hello World`;

    string hello = &quot;Hello&quot;;
    string world = &quot;World&quot;;
    xml:Text c = stringToXml(hello + &quot; &quot; + world);
    io:println(c);

    xml:Element otherElement = xml `&lt;q&gt;World&lt;/q&gt;`;

    xml d = element + otherElement;
    xml e = xml `&lt;p&gt;hello&lt;/p&gt;World`;
    // An `xml` value belongs to the type `xml&lt;T&gt;` if each of its members belong 
    // to `T`.
    io:println(element is xml&lt;xml:Element&gt;);
    io:println(d is xml&lt;xml:Element&gt;);
    io:println(e is xml&lt;xml:Element&gt;);

    io:println(d);
    rename(d, &quot;q&quot;, &quot;r&quot;);
    io:println(d);
}

function stringToXml(string s) returns xml:Text {
    return xml:createText(s);
}

// Functions in lang.xml use subtyping to provide safe and convenient typing.
// For example, `x.elements()` returns element items in `x` as type 
// `xml&lt;xml:Element&gt;` and `e.getName()` and `e.setName()` are defined when 
// `e` has type `xml:Element`.
function rename(xml x, string oldName, string newName) {
    foreach xml:Element e in x.elements() {
        if e.getName() == oldName {
            e.setName(newName);
        }
        rename(e.getChildren(), oldName, newName);
    }
}
</code></pre>
<h4 id="output-70"><a class="header" href="#output-70">Output</a></h4>
<pre><code class="language-bash">bal run xml_subtyping.bal
Hello World
true
true
false
&lt;p&gt;Hello&lt;/p&gt;&lt;q&gt;World&lt;/q&gt;
&lt;p&gt;Hello&lt;/p&gt;&lt;r&gt;World&lt;/r&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xml-navigation"><a class="header" href="#xml-navigation">XML Navigation</a></h1>
<p>XML navigation expressions allow for convenient navigation of XML 
element structure, in a similar way to XPath.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    xml x = xml 
        `&lt;items&gt;
            &lt;!--Contents--&gt;
            &lt;book&gt;
                &lt;name&gt;A Study in Scarlet&lt;/name&gt;
                &lt;author&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;&lt;/author&gt;
            &lt;/book&gt;
            &lt;planner&gt;Daily Planner&lt;kind&gt;day&lt;/kind&gt;&lt;pages&gt;365&lt;/pages&gt;&lt;/planner&gt;
            &lt;book&gt;
                &lt;name&gt;The Sign of Four&lt;/name&gt;
                &lt;author&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;&lt;/author&gt;
            &lt;/book&gt;
            &lt;pen&gt;&lt;kind&gt;marker&lt;/kind&gt;&lt;color&gt;blue&lt;/color&gt;&lt;/pen&gt;
        &lt;/items&gt;`;

    // `x.&lt;items&gt;` - every element in `x` named `items`.
    xml a = x.&lt;items&gt;;
    io:println(a);

    // `x/*` - for every element `e` in `x`, the children of `e`.
    xml b = x/*;
    io:println(b);

    // `x/&lt;planner&gt;` - for every element `e` in `x`, every element named `planner` in the children of `e`.
    xml c = x/&lt;planner&gt;;
    io:println(c);

    // `x/&lt;planner|pen&gt;` - for every element `e` in `x`, every element named `planner` or `pen` in the
    // children of `e`.
    xml d = x/&lt;planner|pen&gt;;
    io:println(d);

    // `x/&lt;*&gt;` - for every element `e` in `x`, every element in the children of `e`.
    xml e = x/&lt;*&gt;;
    io:println(e);

    // x/**/&lt;name&gt;  - for every element `e` in `x`, every element named `name` in
    // the descendants of `e`.
    xml f = x/**/&lt;name&gt;;
    io:println(f);

    // x/&lt;book&gt;[0]  - for every element `e` in `x`, first element named `book` in
    // the children of `e`.
    xml g = x/&lt;book&gt;[0];
    io:println(g);

}
</code></pre>
<h4 id="output-71"><a class="header" href="#output-71">Output</a></h4>
<pre><code class="language-bash">bal run xml_navigation.bal
&lt;items&gt;
            &lt;!--Contents--&gt;
            &lt;book&gt;
                &lt;name&gt;A Study in Scarlet&lt;/name&gt;
                &lt;author&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;&lt;/author&gt;
            &lt;/book&gt;
            &lt;planner&gt;Daily Planner&lt;kind&gt;day&lt;/kind&gt;&lt;pages&gt;365&lt;/pages&gt;&lt;/planner&gt;
            &lt;book&gt;
                &lt;name&gt;The Sign of Four&lt;/name&gt;
                &lt;author&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;&lt;/author&gt;
            &lt;/book&gt;
            &lt;pen&gt;&lt;kind&gt;marker&lt;/kind&gt;&lt;color&gt;blue&lt;/color&gt;&lt;/pen&gt;
        &lt;/items&gt;

            &lt;!--Contents--&gt;
            &lt;book&gt;
                &lt;name&gt;A Study in Scarlet&lt;/name&gt;
                &lt;author&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;&lt;/author&gt;
            &lt;/book&gt;
            &lt;planner&gt;Daily Planner&lt;kind&gt;day&lt;/kind&gt;&lt;pages&gt;365&lt;/pages&gt;&lt;/planner&gt;
            &lt;book&gt;
                &lt;name&gt;The Sign of Four&lt;/name&gt;
                &lt;author&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;&lt;/author&gt;
            &lt;/book&gt;
            &lt;pen&gt;&lt;kind&gt;marker&lt;/kind&gt;&lt;color&gt;blue&lt;/color&gt;&lt;/pen&gt;
        
&lt;planner&gt;Daily Planner&lt;kind&gt;day&lt;/kind&gt;&lt;pages&gt;365&lt;/pages&gt;&lt;/planner&gt;
&lt;planner&gt;Daily Planner&lt;kind&gt;day&lt;/kind&gt;&lt;pages&gt;365&lt;/pages&gt;&lt;/planner&gt;&lt;pen&gt;&lt;kind&gt;marker&lt;/kind&gt;&lt;color&gt;blue&lt;/color&gt;&lt;/pen&gt;
&lt;book&gt;
                &lt;name&gt;A Study in Scarlet&lt;/name&gt;
                &lt;author&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;&lt;/author&gt;
            &lt;/book&gt;&lt;planner&gt;Daily Planner&lt;kind&gt;day&lt;/kind&gt;&lt;pages&gt;365&lt;/pages&gt;&lt;/planner&gt;&lt;book&gt;
                &lt;name&gt;The Sign of Four&lt;/name&gt;
                &lt;author&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;&lt;/author&gt;
            &lt;/book&gt;&lt;pen&gt;&lt;kind&gt;marker&lt;/kind&gt;&lt;color&gt;blue&lt;/color&gt;&lt;/pen&gt;
&lt;name&gt;A Study in Scarlet&lt;/name&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;&lt;name&gt;The Sign of Four&lt;/name&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;
&lt;book&gt;
                &lt;name&gt;A Study in Scarlet&lt;/name&gt;
                &lt;author&gt;&lt;name&gt;Arthur Conan Doyle&lt;/name&gt;&lt;/author&gt;
            &lt;/book&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xml-templates-and-query"><a class="header" href="#xml-templates-and-query">XML Templates and Query</a></h1>
<p>XML templates can be combined with queries (e.g., you can have a template containing a query expression, which
also contains a template).</p>
<pre><code class="language-go">import ballerina/io;

type Person record {|
    string name;
    string country;
|};

function personsToXml(Person[] persons) returns xml {
    // Uses a template containing a query expression, which also contains a template.
    return xml`&lt;data&gt;${from var {name, country} in persons
           select xml`&lt;person country=&quot;${country}&quot;&gt;${name}&lt;/person&gt;`}&lt;/data&gt;`;

}

public function main() {
    Person[] persons = [
        {name: &quot;Jane&quot;, country: &quot;USA&quot;},
        {name: &quot;Mike&quot;, country: &quot;Germany&quot;}
    ];
    io:println(personsToXml(persons));
}
</code></pre>
<h4 id="output-72"><a class="header" href="#output-72">Output</a></h4>
<pre><code class="language-bash">bal run xml_templates_and_query.bal
&lt;data&gt;&lt;person country=&quot;USA&quot;&gt;Jane&lt;/person&gt;&lt;person country=&quot;Germany&quot;&gt;Mike&lt;/person&gt;&lt;/data&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xml-namespaces"><a class="header" href="#xml-namespaces">XML Namespaces</a></h1>
<p>The goal is to support namespaces without adding complexity if you dont use them. The 
<code>ns:x</code> qualified name in XML is expanded into <code>{url}x</code> where <code>url</code> is the namespace name bound to <code>ns</code>. The XML namespace
declarations are kept as attributes using the standard binding of <a href="http:www.w3.org/2000/xmlns/">xmlns</a>.</p>
<pre><code class="language-go">xml:Element e = xml`&lt;p:e xmlns:p=&quot;http://example.com/&quot;/&gt;`;
// `name` will be `{http://example.com}e`.
string name = e.getName();
</code></pre>
<h4 id="output-73"><a class="header" href="#output-73">Output</a></h4>
<pre><code class="language-bash">bal run xml_namespaces.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xmlns-declarations"><a class="header" href="#xmlns-declarations">XMLNS Declarations</a></h1>
<p>The <code>xmlns</code> declarations are like import declarations, but bind the prefix to a namespace URL rather than
a module. The <code>xmlns</code> declarations in the Ballerina module provide namespace context for parsing <code>xml</code>
templates. The Qualified names in Ballerina modules are expanded into <code>strings</code> using the <code>xmlns</code>
declarations in the module. The <code>xmlns</code> declarations are also allowed at block level.</p>
<pre><code class="language-go">// The identifier followed by the `as` keyword is the prefix bound
// to this namespace name.
xmlns &quot;http://example.com&quot; as eg;

xml x = xml`&lt;eg:doc&gt;Hello&lt;/eg:doc&gt;`;

xmlns &quot;http://example.com&quot; as ex;

// `b` will be `true`.
boolean b = (x === x.&lt;ex:doc&gt;);

// `exdoc` will be `{http://example.com}doc`.
string exdoc = ex:doc;
</code></pre>
<h4 id="output-74"><a class="header" href="#output-74">Output</a></h4>
<pre><code class="language-bash">bal run xmlns_declarations.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="metadata"><a class="header" href="#metadata">Metadata</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="documentation"><a class="header" href="#documentation">Documentation</a></h1>
<p>Annotations would be inconvenient for specifying structured documentation.
Ballerina-flavored Markdown (BFM) is an additional convention on top of Markdown,
which makes it more convenient for documenting Ballerina code.</p>
<pre><code class="language-go">// Lines starting with `#` contain structured documentation in Markdown format.
# Adds two integers.
// Documenting parameters of the function
# + x - an integer
# + y - another integer
// Documenting return parameter of the function
# + return - the sum of `x` and `y`
public function add(int x, int y)
                    returns int {

    return x + y;
}
</code></pre>
<h4 id="output-75"><a class="header" href="#output-75">Output</a></h4>
<pre><code class="language-bash">bal run documentation.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="annotations"><a class="header" href="#annotations">Annotations</a></h1>
<p>Annotations start with <code>@tag</code> and they come before what they apply to.
Unprefixed tags refer to standard platform-defined annotations and
prefixed tags refer to annotations declared in modules.
<code>@tag</code> can be followed by record constructor expression.</p>
<pre><code class="language-go">import ballerina/io;

// The `@display` annotation applies to the transform function.
@display {
    label: &quot;Transform&quot;,
    iconPath: &quot;transform.png&quot;
}
public function transform(string s) returns string {
    return s.toUpperAscii();
}

public function main() {
    // The `@strand` annotation applies to the `start` action.
    future&lt;int&gt; fut = @strand {thread: &quot;any&quot;} start foo();

    int|error x = wait fut;
    io:println(x);
}

public function foo() returns int {
    return 10;
}
</code></pre>
<h4 id="output-76"><a class="header" href="#output-76">Output</a></h4>
<pre><code class="language-bash">bal run annotations.bal
10
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="network-interaction"><a class="header" href="#network-interaction">Network Interaction</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="consuming-services-client-objects"><a class="header" href="#consuming-services-client-objects">Consuming Services: Client Objects</a></h1>
<p>Ballerina has a language construct called client objects. 
They are a special kind of objects that contain <code>remote</code> methods in addition to regular methods. 
<code>remote</code> methods are used to interact with a remote service. 
Applications typically do not need to write client classes, which are either provided by library modules or generated from some flavor of IDL.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

public function main() returns error? {
    // A client object is created by applying `new` to a client class.
    http:Client httpClient = check new (&quot;https://api.github.com&quot;);

    // The remote method calls use the `-&gt;` syntax. This enables the sequence diagram view.
    http:Response resp =
                    check httpClient-&gt;get(&quot;/orgs/ballerina-platform/repos&quot;);

    io:println(resp.statusCode);
}
</code></pre>
<h4 id="output-77"><a class="header" href="#output-77">Output</a></h4>
<pre><code class="language-bash">bal run consuming_services.bal
200
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="providing-services"><a class="header" href="#providing-services">Providing Services</a></h1>
<p>Providing services involves the interaction of three main things <br/><br/></p>
<ol>
<li>
<p>Service objects are the counterpart of client objects. Service objects also have remote methods and they are remotely accessible to clients.
Remote method of a client object typically calls the remote method of a service object.</p>
</li>
<li>
<p>Listener is the entity that receives the network input and then it makes calls to remote methods of attached service objects.
Listeners are registered with the module as illustrated in the following example.</p>
</li>
<li>
<p>Modules have a lifecycle and they are initialized on program startup. Modules start up the registered listeners after the initialization and
shut them down during the program shutdown.</p>
</li>
</ol>
<pre><code class="language-go">import ballerina/http;

// Listener declarations are allowed at the module level. 
// They are similar to variable declarations, but register the newly created Listener object with the module.
// If `new` returns an error, then module initialization fails.
listener http:Listener h = new (8080);
</code></pre>
<h4 id="output-78"><a class="header" href="#output-78">Output</a></h4>
<pre><code class="language-bash">bal run providing_services.bal

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="module-lifecycle"><a class="header" href="#module-lifecycle">Module Lifecycle</a></h1>
<p>All modules are initialized at program startup. Module initialization is ordered so that if module A imports module B,
then module A is initialized after module B. The initialization phase ends by calling the <code>main</code> function if there is one. <br/><br/>
A module's listeners are registered during module initialization.
If there are registered listeners, then the initialization phase is followed by the listening phase. <br/><br/>
The listening phase starts by calling the <code>start</code> method on each registered listener. The listening phase is terminated by signal (e.g. <code>SIGINT</code>, <code>SIGTERM</code>).</p>
<pre><code class="language-go">import ballerina/io;

// Usually it is an error to import a module without using it, but if you want to import a module because of what its initialization does,
//  then use `as _` as in this example.
import ballerina/grpc as _;

// A module can have an `init` function just like an object. 
// The initialization of a module ends by called its `init` function if there is one.
function init() {
    io:println(&quot;Hello world&quot;);
}
</code></pre>
<h4 id="output-79"><a class="header" href="#output-79">Output</a></h4>
<pre><code class="language-bash">bal run module_lifecycle.bal
Hello world
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service-declaration"><a class="header" href="#service-declaration">Service Declaration</a></h1>
<p>A service represents a collection of remotely accessible methods attached to a particular listener.
A service declaration is syntactic sugar for creating services in Ballerina. 
A service declaration gets desugared into several things including creating a listener object,
registering it with the module, creating a service object, attaching the service object to the listener object, etc,.
The type of the listener determines required type of remote methods.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/udp;

// You can combine a listener declaration with a service declaration as shown in this example.
service on new udp:Listener(8080) {
    remote function onDatagram(readonly &amp; udp:Datagram dg) {
        io:println(&quot;bytes received: &quot;, dg.data.length());
    }
}
</code></pre>
<h4 id="output-80"><a class="header" href="#output-80">Output</a></h4>
<pre><code class="language-bash">bal run service_declaration.bal
bytes received: 17
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="resource-methods"><a class="header" href="#resource-methods">Resource Methods</a></h1>
<p>Service objects use <code>remote</code> methods to expose services in procedural style: remote methods are named by verbs. <br/><br/>
Service objects use <code>resource</code> methods to expose services in an RESTful style: resources are named by nouns. <br/><br/>
Resources are motivated by HTTP, but are general enough also to work for GraphQL. 
<code>resource</code> methods are a network-oriented generalization of OO getter/setter concept.</p>
<pre><code class="language-go">import ballerina/http;

// Service declaration specifies base path for the resource names. The base path is `/` in this example.
service / on new http:Listener(8080) {
    // Resource method is associated with combination of accessor (`get`) and resource name (`hello`). 
    // Accessors are determined by the network protocol.
    // In HTTP resources, function parameters come from query parameters.
    resource function get hello(string name) returns string {
        return &quot;Hello, &quot; + name;
    }

}
</code></pre>
<h4 id="output-81"><a class="header" href="#output-81">Output</a></h4>
<pre><code class="language-bash">bal run resource_methods.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hierarchical-resources"><a class="header" href="#hierarchical-resources">Hierarchical Resources</a></h1>
<p>Resource name is relative path, which can have multiple path segments.
Base path is absolute path. A listener can have multiple services each with different base paths.</p>
<pre><code class="language-go">import ballerina/http;

// Base path of this service is `/demo`.
service /demo on new http:Listener(8080) {
    // You can combine base path and relative path to get the path of the resource, that is `/demo/greeting/hello`.
    resource function get greeting/hello(string name) returns string {
        return &quot;Hello, &quot; + name;
    }

}
</code></pre>
<h4 id="output-82"><a class="header" href="#output-82">Output</a></h4>
<pre><code class="language-bash"># Run this cURL command to invoke the resource.
curl &quot;localhost:8080/demo/greeting/hello?name=Ballerina&quot;
Hello, Ballerina
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="resource-path-parameters"><a class="header" href="#resource-path-parameters">Resource Path Parameters</a></h1>
<p>Path segments can be treated as parameters in Ballerina.</p>
<pre><code class="language-go">import ballerina/http;

service /demo on new http:Listener(8080) {
    // Here is how you can make path segments as parameters.
    resource function get greeting/hello/[string name]() returns string {

        return &quot;Hello, &quot; + name;
    }
}
</code></pre>
<h4 id="output-83"><a class="header" href="#output-83">Output</a></h4>
<pre><code class="language-bash">bal run resource_path_parameters.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configurability"><a class="header" href="#configurability">Configurability</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configurable-variables"><a class="header" href="#configurable-variables">Configurable Variables</a></h1>
<p>A module-level variable can be declared as <code>configurable</code>. The initializer of a <code>configurable</code> variable
can be overridden at runtime (e.g., by a TOML file). A variable for which a configuration is required
can use an initializer of <code>?</code>. The type of a <code>configurable</code> variable must be a subtype of <code>anydata</code>.<br/><br/>
For more information, see <a href="https:ballerina.io/learn/making-ballerina-programs-configurable/defining-configurable-variables/">Making Ballerina Programs Configurable</a>.</p>
<pre><code class="language-go">// Port on which to run the service.
configurable int port = 8080;

//`configurable string password = ?;`
//
// This specifies that the password must be supplied in a configuration file.
</code></pre>
<h4 id="output-84"><a class="header" href="#output-84">Output</a></h4>
<pre><code class="language-bash">bal run configurable_variables.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="concurrency"><a class="header" href="#concurrency">Concurrency</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="asynchronous-function-calls"><a class="header" href="#asynchronous-function-calls">Asynchronous Function Calls</a></h1>
<p><code>start</code> calls a function asynchronously and the function runs on a separate logical thread (<code>strand</code>).
It is cooperatively multitasked by default.
The result will be of type <code>future&lt;T&gt;</code> and <code>future</code> is a separate basic type.
Waiting for the same <code>future</code> more than once gives an <code>error</code>.
Use <code>f.cancel()</code> to terminate a <code>future</code>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    // `start` calls a function asynchronously.
    future&lt;int&gt; fut = start foo();

    // `wait` for `future&lt;T&gt;` gives `T|error`.
    int|error x = wait fut;

    io:println(x);
}

function foo() returns int {
    return 10;
}
</code></pre>
<h4 id="output-85"><a class="header" href="#output-85">Output</a></h4>
<pre><code class="language-bash">bal run asynchronous_function_calls.bal
10
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="named-workers"><a class="header" href="#named-workers">Named Workers</a></h1>
<p>Normally all of a function's code belongs to the function's default worker, 
which has a single logical thread of control.
A function can also declare named workers, which run concurrently with the
function's default worker and other named workers.
Code before any named workers is executed before named workers start.
Variables declared before all named workers and function parameters are
accessible in named workers.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    // Code before any named workers is executed before named 
    // workers start.
    io:println(&quot;Initializing&quot;);
    final string greeting = &quot;Hello&quot;;

    // A function can declare named workers, which run concurrently with the
    // function's default worker and other named workers.
    worker A {
        // Variables declared before all named workers and function 
        // parameters are accessible in named workers.
        io:println(greeting + &quot; from worker A&quot;);

    }

    worker B {
        io:println(greeting + &quot; from worker B&quot;);
    }

    io:println(greeting + &quot; from function worker&quot;);
}
</code></pre>
<h4 id="output-86"><a class="header" href="#output-86">Output</a></h4>
<pre><code class="language-bash">bal run named_workers.bal
Initializing
Hello from function worker
Hello from worker B
Hello from worker A
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sequence-diagrams"><a class="header" href="#sequence-diagrams">Sequence Diagrams</a></h1>
<p>A function can be viewed as a sequence diagram as shown below.
<br/><br/>
<img src="categories/concurrency//learn/by-example/images/sequence-diagram.png" alt="Sequence Diagrams" width="600" height="500">
<br/><br/>
The diagram has a lifeline (vertical line) for each worker (both named 
worker and function's default worker).
The diagram also has a lifeline for each client object parameter or variable in 
the initialization section, representing the remote system to which the client 
object is sending messages.
Each remote method call on a client object is represented as a horizontal line
between the lifeline of the worker making the call and the remote system.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// A function can be viewed as a sequence diagram.
// The diagram has a lifeline (vertical line) for each worker (both named 
// worker and function's default worker).
public function main() returns error? {
    // The diagram also has a lifeline for each client object parameter or variable in 
    // the initialization section, representing the remote system to which the client  
    // object is sending messages.
    http:Client cl = check new (&quot;https://www.mocky.io&quot;);

    // Each remote method call on a client object is represented as a horizontal line
    // between the lifeline of the worker making the call and the remote system.
    string payload = check cl-&gt;get(&quot;/v2/5ae082123200006b00510c3d/&quot;);

    io:println(payload);
    return;
}
</code></pre>
<h4 id="output-87"><a class="header" href="#output-87">Output</a></h4>
<pre><code class="language-bash">bal run sequence_diagrams.bal
Hello World
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="waiting-for-workers"><a class="header" href="#waiting-for-workers">Waiting for Workers</a></h1>
<p>Named workers can continue to execute after the function's default worker
terminates and the function returns.
A worker (function or named) can use <code>wait</code> to wait for a named worker.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    io:println(&quot;Initializing&quot;);

    worker A {
        io:println(&quot;In worker A&quot;);
    }

    io:println(&quot;In function worker&quot;);

    // A worker (function or named) can use `wait` to wait for a named worker.
    wait A;

    io:println(&quot;After wait A&quot;);
}
</code></pre>
<h4 id="output-88"><a class="header" href="#output-88">Output</a></h4>
<pre><code class="language-bash">bal run waiting_for_workers.bal
Initializing
In function worker
In worker A
After wait A
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="strands"><a class="header" href="#strands">Strands</a></h1>
<p>By default, named workers are multitasked cooperatively, not preemptively.
Each named worker has a &quot;strand&quot; (logical thread of control) and execution
switches between strands only at specific &quot;yield&quot; points such as doing a wait
or when a library function invokes a system call that would block.
This avoids the need for users to lock variables that are accessed from
multiple named workers.
An annotation can be used to make a strand run on a separate thread.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    // By default, named workers are multitasked cooperatively, not preemptively.
    // Each named worker has a &quot;strand&quot; (logical thread of control) and execution
    // switches between strands only at specific &quot;yield&quot; points.
    worker A {
        io:println(&quot;In worker A&quot;);
    }

    // An annotation can be used to make a strand run on a separate thread.
    @strand {
        thread: &quot;any&quot;
    }

    worker B {
        io:println(&quot;In worker B&quot;);
    }

    io:println(&quot;In function worker&quot;);
}
</code></pre>
<h4 id="output-89"><a class="header" href="#output-89">Output</a></h4>
<pre><code class="language-bash">bal run strands.bal
In worker B
In function worker
In worker A
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="named-worker-return-values"><a class="header" href="#named-worker-return-values">Named Worker Return Values</a></h1>
<p>Named workers have a return type, which defaults to nil.
A <code>return</code> statement in a named worker terminates
the worker, not the function.
Similarly, when <code>check</code> is used and the expression evaluates
to an <code>error</code>, the <code>error</code> value is returned terminating the worker.
Waiting on a named worker will give its return value.</p>
<pre><code class="language-go">import ballerina/io;

function demo(string s) returns int|error {
    // Named workers have a return type, which defaults to nil
    // if not specified.
    worker A returns int|error {
        // A return statement in a named worker terminates 
        // the worker, not the function.
        // Similarly, when `check` is used and the expression evaluates
        // to an `error`, the `error` value is returned terminating only the worker.
        int x = check int:fromString(s);
        return x + 1;

    }

    io:println(&quot;In function worker&quot;);

    // Waiting on a named worker will give its return value.
    int y = check wait A;

    return y + 1;
}

public function main() returns error? {
    int res = check demo(&quot;50&quot;);
    io:println(res);

    res = check demo(&quot;50m&quot;);
    io:println(res);
}
</code></pre>
<h4 id="output-90"><a class="header" href="#output-90">Output</a></h4>
<pre><code class="language-bash">bal run named_worker_return_values.bal
In function worker
52
In function worker
error: {ballerina/lang.int}NumberParsingError {&quot;message&quot;:&quot;'string' value '50m' cannot be converted to 'int'&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="alternate-wait"><a class="header" href="#alternate-wait">Alternate Wait</a></h1>
<p>The <code>wait</code> action can be used to wait for one of several workers.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// Fetch from A or B.
function altFetch(string urlA, string urlB) returns string|error {

    worker A returns string|error {
        return fetch(urlA);
    }

    worker B returns string|error {
        return fetch(urlB);
    }

    // The `wait` action can be used to wait for one of several workers.
    // This function will return as soon as the return value of either
    // `A` or `B` is available.
    return wait A | B;

}

public function main() returns error? {
    string res = 
        check altFetch(&quot;https://postman-echo.com/get?lang=ballerina&quot;,
                       &quot;https://postman-echo.com/get?greeting=hello&quot;);
    io:println(res);
}

function fetch(string url) returns string|error {
    http:Client cl = check new (url);
    map&lt;json&gt; payload = check cl-&gt;get(&quot;&quot;);
    return payload[&quot;args&quot;].toString();
}
</code></pre>
<h4 id="output-91"><a class="header" href="#output-91">Output</a></h4>
<pre><code class="language-bash">bal run alternate_wait.bal
{&quot;lang&quot;:&quot;ballerina&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="multiple-wait"><a class="header" href="#multiple-wait">Multiple Wait</a></h1>
<p>The <code>wait</code> action can be used to wait for multiple named workers.
Works with futures also.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

type Result record {
    string|error a;
    string|error b;
};

function multiFetch(string urlA, string urlB) returns Result {
    worker WA returns string|error {
        return fetch(urlA);
    }
    worker WB returns string|error {
        return fetch(urlB);
    }

    // The `wait` action can be used to wait for multiple named workers.
    return wait {a: WA, b: WB};

}

public function main() returns error? {
    Result res =  multiFetch(&quot;https://postman-echo.com/get?lang=ballerina&quot;,
                             &quot;https://postman-echo.com/get?greeting=hello&quot;);
    io:println(res);
    return;
}

function fetch(string url) returns string|error {
    http:Client cl = check new (url);
    map&lt;json&gt; payload = check cl-&gt;get(&quot;&quot;);
    return payload[&quot;args&quot;].toString();
}
</code></pre>
<h4 id="output-92"><a class="header" href="#output-92">Output</a></h4>
<pre><code class="language-bash">bal run multiple_wait.bal
{&quot;a&quot;:&quot;{&quot;lang&quot;:&quot;ballerina&quot;}&quot;,&quot;b&quot;:&quot;{&quot;greeting&quot;:&quot;hello&quot;}&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="named-workers-and-futures"><a class="header" href="#named-workers-and-futures">Named Workers and Futures</a></h1>
<p>Futures and workers are the same thing.
A reference to a named worker can be implicitly converted into a <code>future</code>.
<code>start</code> is sugar for calling a function with a named worker and returning
the named worker as a <code>future</code>.
Cancellation of futures only happens at yield points.</p>
<pre><code class="language-go">import ballerina/io;

function demo() returns future&lt;int&gt; {
    worker A returns int {
        return 42;
    }
    
    // Futures and workers are the same thing.
    // A reference to a named worker can be implicitly converted into a `future`.
    return A;

}

type FuncInt function () returns int;

function startInt(FuncInt f) returns future&lt;int&gt; {
    // `start` is sugar for calling a function with a named worker and returning
    // the named worker as a `future`.
    return start f();

}

public function main() returns error? {
    future&lt;int&gt; a = demo();
    int b = check wait a;
    io:println(b);

    future&lt;int&gt; c = startInt(() =&gt; 100);
    int d = check wait c;
    io:println(d);
}
</code></pre>
<h4 id="output-93"><a class="header" href="#output-93">Output</a></h4>
<pre><code class="language-bash">bal run named_workers_and_futures.bal
42
100
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inter-worker-message-passing"><a class="header" href="#inter-worker-message-passing">Inter-Worker Message Passing</a></h1>
<p>Use <code>-&gt; W</code> or <code>&lt;- W</code> to send a message to or receive a message from worker <code>W</code> (use
<code>function</code> to refer to the function's default worker).
The messages are copied using <code>clone()</code>. It implies immutable values are passed
without a copy.
Message sends and receives are paired up at compile-time.
Each pair turns into a horizontal line in the sequence diagram.
Easy to use and safe, but limited expressiveness.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {

    worker A {
        // Use `-&gt; W` to send a message to worker `W`.
        1 -&gt; B;
        2 -&gt; C;

    }

    worker B {
        // Use `&lt;- W` to receive a message from worker `W`.
        int x1 = &lt;- A;

        // Use `function` to refer to the function's default worker.
        x1 -&gt; function;

    }

    worker C {
        int x2 = &lt;- A;
        x2 -&gt; function;
    }

    int y1 = &lt;- B;
    int y2 = &lt;- C;
    
    io:println(y1 + y2);
}
</code></pre>
<h4 id="output-94"><a class="header" href="#output-94">Output</a></h4>
<pre><code class="language-bash">bal run inter_worker_message_passing.bal
3
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inter-worker-failure-propagation"><a class="header" href="#inter-worker-failure-propagation">Inter-Worker Failure Propagation</a></h1>
<p>Workers may need to call functions that can return an <code>error</code>.
Pairing up of sends and receives guarantees that each send will be
received, and vice-versa, provided neither sending nor receiving worker 
has failed.
Send to or receive from failed worker will propagate the failure.</p>
<pre><code class="language-go">import ballerina/io;

int counter = 0;

function demo() returns int|error {
    worker A returns error? {
        // Workers may need to call functions that can return an `error`.
        // Pairing up of sends and receives guarantees that each send will be
        // received, and vice-versa, provided neither sending nor receiving worker 
        // has failed.
        error? res = foo();
        if res is error {
            return res;
        }
        42 -&gt; function;
    }

    // Send to or receive from failed worker will propagate the failure.
    int x = check &lt;- A;

    return x;
}

function foo() returns error? {
    if counter == 1 {
        return error(&quot;maximum count exceeded&quot;);
    }

    counter += 1;
}

public function main() returns error? {
    int a = check demo();
    io:println(a);

    int b = check demo();
    io:println(b);
}
</code></pre>
<h4 id="output-95"><a class="header" href="#output-95">Output</a></h4>
<pre><code class="language-bash">bal run inter_worker_failure_propagation.bal
42
error: maximum count exceeded
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transactions"><a class="header" href="#transactions">Transactions</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transaction-statement"><a class="header" href="#transaction-statement">Transaction Statement</a></h1>
<p>Ballerina provides support for interacting with a transaction manager.
Compile-time guarantees that transactions are bracketed with begin and <code>commit</code> or <code>rollback</code>.
The region in the middle is typed as being a transactional context.
Ballerina does not have a transactional memory and includes a transaction manager.
The current transaction is a part of the execution context of a strand.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    // Compile-time guarantees that transactions are bracketed with
    // begin and commit or rollback. Transaction statement begins
    // a new transaction and executes a block.
    transaction {
        doStage1();
        doStage2();

        // Commit of a transaction must be done explicitly using commit.
        // Commit must be lexically within a transaction statement and may
        // return an error;
        check commit;

    }
    return;
}

function doStage1() {
    io:println(&quot;Stage1 completed&quot;);
}

function doStage2() {
    io:println(&quot;Stage2 completed&quot;);
}
</code></pre>
<h4 id="output-96"><a class="header" href="#output-96">Output</a></h4>
<pre><code class="language-bash">bal run transaction_statement.bal
Stage1 completed
Stage2 completed
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="check-semantics"><a class="header" href="#check-semantics">Check Semantics</a></h1>
<p><code>check</code> semantics is not to simply return on an <code>error</code> value.
When <code>check</code> gets an <code>error</code> value, it fails.
The enclosing block decides how to handle the failure.
Most blocks pass the failure up to the enclosing block.
Function definition handles the failure by returning the error.
<code>on fail</code> can catch the error.
<code>fail</code> statement is like <code>check</code>, but it always fails.
Differs from exceptions in that control flow is explicit.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    do {
        // If either `foo()` or `bar()` invocations returns an error,
        // the error will be returned from the `main` function and execution
        // of the `main` function ends.
        check foo();
        check bar();

        if !isOK() {
            // Fails explicitly with an error.
            fail error(&quot;not OK&quot;);

        }
    }
    // Failure with the respective error is caught by the `on fail` block.
    on fail var e {
        io:println(e.toString());
        return e;
    }

    return;
}

function foo() returns error? {
    io:println(&quot;OK&quot;);
    return;
}

function bar() returns error? {
    io:println(&quot;OK&quot;);
    return;
}

function isOK() returns boolean {
    // Returns `false`.
    return false;

}
</code></pre>
<h4 id="output-97"><a class="header" href="#output-97">Output</a></h4>
<pre><code class="language-bash">bal run check_semantics.bal
OK
OK
error(&quot;not OK&quot;)
error: not OK
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rollback"><a class="header" href="#rollback">Rollback</a></h1>
<p>If there is a fail or panic in the execution of the block, then the transaction is rolled back.
Transaction statement can also contain a rollback statement.
Every possible exit from a transaction block must be either <code>commit</code>, <code>rollback</code>, fail exit (e.g., from <code>check</code>), or panic exit.
Rollback does not automatically restore Ballerina variables to values before the transaction.</p>
<pre><code class="language-go">// Defines the `Update` record type.
type Update record {
    int updateIndex;
    int stockMnt;
};

public function main() returns error? {

    // Creates an array of `Update` records.
    Update[] updates =
    [
        {updateIndex: 0, stockMnt: 2000},
        {updateIndex: 1, stockMnt: -1000},
        {updateIndex: 2, stockMnt: 1500},
        {updateIndex: 3, stockMnt: -1000},
        {updateIndex: 4, stockMnt: -2000}
    ];
    // If an error is returned from the `transfer` function,
    // the error is returned from the `main` and it exits.
    check transfer(updates);

    return;
}

function transfer(Update[] updates) returns error? {

    transaction {
        // Inside the transaction, call `doUpdate` on each `update` record.
        foreach var u in updates {
            // If an error is returned, the `transfer` function returns with
            // that error and the transaction is rolled back.
            check doUpdate(u);

        }
        // `commit` will not be called because of an implicit rollback.
        check commit;

    }
    return;
}

function doUpdate(Update u) returns error? {
    // If the stock amount is less than -1500, an error is returned.
    if (u.stockMnt &lt; -1500) {
        return error(&quot;Not enough Stocks: &quot;, stockIndex = u.updateIndex);
    }

    return;
}
</code></pre>
<h4 id="output-98"><a class="header" href="#output-98">Output</a></h4>
<pre><code class="language-bash">bal run rollback.bal
error: Not enough Stocks:  {&quot;stockIndex&quot;:4}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="retry-transaction-statement"><a class="header" href="#retry-transaction-statement">Retry Transaction Statement</a></h1>
<p>Transactional errors are often transient: retrying will fix them.
This works by creating a  RetryManager object <code>r</code>, before executing the transaction.
If the block fails with error <code>e</code>, it calls <code>r.shouldRetry(e)</code>.
If that returns <code>true</code>, then it executes the block again.
<code>retry</code> has an optional type parameter giving class of <code>RetryManager</code> to create, and optional arguments to new <code>DefaultRetryManager</code> tries <code>n</code> times.
<code>retry</code> can be used without <code>transaction</code>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    // Short for `retry&lt;DefaultRetryManager&gt;(3)`.
    // If any of the `doStage1` and `doStage2` returns  `error:Retriable`,
    // the program will retry execution until execution succeeds without an `error:Retriable` error.
    // By default, it will retry 3 times with the `DefaultRetryManager`.
    retry transaction {
        check doStage1();
        check doStage2();
        check commit;
    }

    return;
}

function doStage1() returns error? {
    io:println(&quot;Stage1 completed&quot;);
    return;
}

function doStage2() returns error? {
    // Returns `error:Retriable` error for retrying.
    // To support custom errors, a custom implementation of the `RetryManager` is required.
    return error 'error:Retriable(&quot;Stage2 failed&quot;);

}
</code></pre>
<h4 id="output-99"><a class="header" href="#output-99">Output</a></h4>
<pre><code class="language-bash">bal run retry_transaction_statement.bal
Stage1 completed
Stage1 completed
Stage1 completed
Stage1 completed
error: Stage2 failed
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transactional-qualifier"><a class="header" href="#transactional-qualifier">Transactional Qualifier</a></h1>
<p>At compile-time, regions of code are typed as being a transactional context.
Ballerina guarantees that, whenever that region is executed, there will be a current transaction.
A function with a <code>transactional</code> qualifier can only be called from a transactional context; function  body will be a transactional context.
<code>transactional</code> is also a boolean expression that tests at runtime whether there is a current transaction: used in a condition results in a transactional context.</p>
<pre><code class="language-go">import ballerina/io;

type Update record {
    int updateIndex;
    int stockMnt;
};

public function main() returns error? {
    Update updates = {updateIndex: 0, stockMnt: 100};
    transaction {
        check doUpdate(updates);
        check commit;
    }
    return;
}

// Called within the transaction statement.
transactional function doUpdate(Update u) returns error? {
    // Calls the `foo()` non-transactional function.
    foo(u);
    // Calls the `bar()` transactional function.
    bar(u);
    return;
}

function foo(Update u) {
    if transactional {
        // This is a transactional context.
        bar(u);

    }
}

transactional function bar(Update u) {
    io:println(&quot;Calling from a transactional context&quot;);
}
</code></pre>
<h4 id="output-100"><a class="header" href="#output-100">Output</a></h4>
<pre><code class="language-bash">bal run transactional_qualifier.bal
Calling from a transactional context
Calling from a transactional context
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transactional-named-workers"><a class="header" href="#transactional-named-workers">Transactional Named Workers</a></h1>
<p>A named worker within a transactional function can be declared as <code>transactional</code>.
This will start a new transaction branch for the named worker, as with a distributed transaction.</p>
<pre><code class="language-go">import ballerina/io;

type Update record {
    int updateIndex;
    int stockMnt;
};

public function main() returns error? {
    Update newUpdate = {
        updateIndex: 132,
        stockMnt: 3500
    };
    transaction {
        check exec(newUpdate);
        check commit;
    }
}

// A `transactional` function can only be called from a `transactional` context
transactional function exec(Update u) returns error? {
    // A `transactional` named worker starts a transaction branch
    // in the current transaction.
    transactional worker A {
        bar();
    }
}

transactional function bar() {
    io:println(&quot;bar() invoked&quot;);
}
</code></pre>
<h4 id="output-101"><a class="header" href="#output-101">Output</a></h4>
<pre><code class="language-bash">bal run transactional_named_workers.bal
bar() invoked
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="commitrollback-handlers"><a class="header" href="#commitrollback-handlers">Commit/Rollback Handlers</a></h1>
<p>Often code needs to get executed depending on whether a transaction is committed.
Testing the result of the <code>commit</code> within the transaction statement works. However, it is inconvenient
from a modularity perspective, particularly, when you want to undo changes on <code>rollback</code>.
This seems much worse in a distributed transaction when the transaction statement is in another program.
Ballerina provides <code>commit</code>/<code>rollback</code> handlers, which are functions that get executed when the decision
whether to commit is known.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    transaction {
        check update();
        check commit;
    }
    return;
}

transactional function update() returns error? {
    check updateDatabase();
    //  Registers a commit handler to be invoked when the `commit` is executed.
    'transaction:onCommit(sendEmail);
    'transaction:onRollback(logError);
}

function updateDatabase() returns error? {
    io:println(&quot;Database updated&quot;);
    return;
}

isolated function sendEmail('transaction:Info info) {
    io:println(&quot;Email sent.&quot;);
}

isolated function logError('transaction:Info info,
                            error? cause, boolean willRetry) {
    io:println(&quot;Logged database update failure&quot;);
}
</code></pre>
<h4 id="output-102"><a class="header" href="#output-102">Output</a></h4>
<pre><code class="language-bash">bal run commit_rollback_handlers.bal
Database updated
Email sent.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="concurrency-safety"><a class="header" href="#concurrency-safety">Concurrency Safety</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lock-statement"><a class="header" href="#lock-statement">Lock Statement</a></h1>
<p>The <code>lock</code> statement allows mutable state to be safely accessed from multiple strands that are running on
separate threads. Semantics are like an atomic section. The execution of the outermost <code>lock</code> block is not
interleaved. Naive implementation uses single, global, recursive lock. Efficient implementation can do
compile-time lock inference.</p>
<pre><code class="language-go">import ballerina/io;

int n = 0;

function inc() {
    // Locks the global variable `n` and increments it by 1.
    lock {
        n += 1;
    }

    io:println(n);
}

public function main() {
    inc();
}
</code></pre>
<h4 id="output-103"><a class="header" href="#output-103">Output</a></h4>
<pre><code class="language-bash">bal run lock_statement.bal
1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="isolated-functions"><a class="header" href="#isolated-functions">Isolated Functions</a></h1>
<p>A call to an <code>isolated</code> function is concurrency-safe if it is called with arguments
that are safe at least until the call returns. <br></br>
A function defined as <code>isolated</code>:</p>
<ul>
 <li>has access to mutable state only through its parameters</li>
 <li>has unrestricted access to immutable state</li>
 <li>can only call functions that are `isolated`</li>
 </ul>
 <br></br>
 <p>Constraints are enforced at compile-time. `isolated` is a part of the function type.
 Weaker concept than pure function.</p>
<pre><code class="language-go">import ballerina/io;

type R record {
    int v;
};

final int N = getN();

function getN() returns int {
    return 100;
}

// Can access mutable state that is passed as a parameter.
isolated function set(R r) returns R {
    // Can access non-`isolated` module-level state only if the variable
    // is `final` and the type is a subtype of `readonly` or
    // `isolated object {}`.
    r.v = N;

    return r;
}

R r = {v: 0};

// This is not an `isolated` function.
function setGlobal(int n) {

    r.v = n;
}

public function main() {
    setGlobal(200);
    io:println(r);
    io:println(set(r));
}
</code></pre>
<h4 id="output-104"><a class="header" href="#output-104">Output</a></h4>
<pre><code class="language-bash">bal run isolated_functions.bal
{&quot;v&quot;:200}
{&quot;v&quot;:100}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="readonly-type"><a class="header" href="#readonly-type">Readonly Type</a></h1>
<p>The <code>readonly</code> type consists of values that are immutable. For structural type <code>T</code>, <code>T &amp; readonly</code> means
immutable <code>T</code>. <code>T &amp; readonly</code> is a subtype of <code>T</code> and a subtype of <code>readonly</code>. Guaranteed that if declared
type of a value is a subtype of <code>readonly</code>, then at runtime the value can never be mutated. It is enforced
by runtime checks on the mutating structures. With <code>readonly</code> field, both the field and its value
are immutable.</p>
<pre><code class="language-go">import ballerina/io;

// A `const` is immutable.
const s = &quot;Anne&quot;;

type Row record {
    // Both the field and its value are immutable.
    readonly string k;
    int value;

};

table&lt;Row&gt; key(k) t = table [
    {k: &quot;John&quot;, value: 17}
];

public function main() {
    // Can safely use `s` as a key.
    t.add({k: s, value: 18});

    io:println(t);
}
</code></pre>
<h4 id="output-105"><a class="header" href="#output-105">Output</a></h4>
<pre><code class="language-bash">bal run readonly_type.bal
[{&quot;k&quot;:&quot;John&quot;,&quot;value&quot;:17},{&quot;k&quot;:&quot;Anne&quot;,&quot;value&quot;:18}]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="readonly-and-isolated"><a class="header" href="#readonly-and-isolated">Readonly and Isolated</a></h1>
<p><code>isolated</code> functions can access <code>final</code> variables with <code>readonly</code> type without locking. It relies on the fact that
immutability is deep. <code>isolated</code> for functions complements <code>readonly</code> for data.</p>
<pre><code class="language-go">import ballerina/io;

type Entry map&lt;json&gt;;

type RoMap readonly &amp; map&lt;Entry&gt;;

final RoMap m = loadMap();

function loadMap() returns RoMap {
    readonly &amp; Entry entry1 = {
        &quot;munich&quot;: {latitude: &quot;48.1351N&quot;, longitude: &quot;11.5820E&quot;},
        &quot;berlin&quot;: {latitude: &quot;52.5200N&quot;, longitude: &quot;13.4050E&quot;}
    };
    readonly &amp; Entry entry2 = {
        &quot;bordeaux&quot;: {latitude: &quot;44.8378N&quot;, longitude: &quot;0.5792W&quot;},
        &quot;paris&quot;: {latitude: &quot;48.8566N&quot;, longitude: &quot;2.3522E&quot;}
    };
    RoMap roMap = {&quot;germany&quot;: entry1, &quot;france&quot;: entry2};
    return roMap;
}

isolated function lookup(string s) returns readonly &amp; Entry? {
    // Accesses `m` directly without locking.
    return m[s];

}

public function main() {
    io:println(lookup(&quot;france&quot;));
}
</code></pre>
<h4 id="output-106"><a class="header" href="#output-106">Output</a></h4>
<pre><code class="language-bash">bal run readonly_and_isolated.bal
{&quot;bordeaux&quot;:{&quot;latitude&quot;:&quot;44.8378N&quot;,&quot;longitude&quot;:&quot;0.5792W&quot;},&quot;paris&quot;:{&quot;latitude&quot;:&quot;48.8566N&quot;,&quot;longitude&quot;:&quot;2.3522E&quot;}}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="combining-isolated-functions-and-lock"><a class="header" href="#combining-isolated-functions-and-lock">Combining Isolated Functions and Lock</a></h1>
<p>Combining <code>isolated</code> functions and <code>lock</code> allows <code>isolated</code> functions to use
<code>lock</code> to access mutable module-level state.
Key concept is <code>isolated</code> root. A value <code>r</code> is an <code>isolated</code> root if mutable state reachable
from <code>r</code> cannot be reached from outside except through <code>r</code>. An expression is an
<code>isolated</code> expression if it follows rules that guarantee that its value will be an
<code>isolated</code> root. e.g.,</p>
<ul>
 <li>an expression with a type that is a subtype of `readonly` is always `isolated`</li>
 <li>an expression `[E1, E2]` is isolated if `E1` and `E2` are `isolated`</li>
 <li>an expression `f(E1, E2)` is `isolated` if `E1` and `E1` are `isolated`, and
 the type of `f` is an `isolated` function.</li>
 </ul>
<pre><code class="language-go">import ballerina/io;

type R record {
    int v;
};

// The initialization expression of an `isolated` variable
// has to be an `isolated` expression, which itself will be
// an `isolated` root.
isolated R r = {v: 0};

isolated function setGlobal(int n) {
    // An `isolated` variable can be accessed within
    // a `lock` statement.
    lock {
        r.v = n;
    }

}

public function main() {
    setGlobal(200);
    // Accesses the `isolated` variable within a
    // `lock` statement.
    lock {
       io:println(r);
    }

}
</code></pre>
<h4 id="output-107"><a class="header" href="#output-107">Output</a></h4>
<pre><code class="language-bash">bal run combining_isolated_functions_and_lock.bal
{&quot;v&quot;:200}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="isolated-variables"><a class="header" href="#isolated-variables">Isolated Variables</a></h1>
<p>When a variable is declared as <code>isolated</code>, the compiler guarantees that it is an <code>isolated</code> root and
accessed only within a <code>lock</code> statement. An isolated variable declaration must be a non-public
module-level variable declaration initialized with an <code>isolated</code> expression. A <code>lock</code> statement
that accesses an <code>isolated</code> variable must maintain <code>isolated</code> root invariant:</p>
<ul>
 <li>access only one `isolated` variable</li>
 <li>call only `isolated` functions</li>
 <li>transfers of values in and out must use `isolated` expressions</li>
 </ul>
 <br></br>
 <p>The `isolated` functions are allowed to access `isolated` module-level variables,
 provided they follow the above rules.</p>
<pre><code class="language-go">import ballerina/io;

// Initializes an `isolated` variable using
// an `isolated` expression.
isolated int[] stack = [];

isolated function push(int n) {
    // Accesses `isolated` variable within a
    // `lock` statement.
    lock {
        stack.push(n);
    }

}

isolated function pop() returns int {
    lock {
        return stack.pop();
    }
}

public function main() {
    push(10);
    push(20);
    io:println(pop());
}
</code></pre>
<h4 id="output-108"><a class="header" href="#output-108">Output</a></h4>
<pre><code class="language-bash">bal run isolated_variables.bal
20
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="isolated-methods"><a class="header" href="#isolated-methods">Isolated Methods</a></h1>
<p>Object methods can be <code>isolated</code>. An <code>isolated</code> method is same as an <code>isolated</code> function with
<code>self</code> treated as a parameter. An <code>isolated</code> method call is concurrency-safe if both the object
is safe and the arguments are safe. This is not quite enough for service concurrency. When
a <code>listener</code> makes calls to a <code>remote</code> or <code>resource</code> method,</p>
<ul>
 <li>it can ensure the safety of arguments it passes</li>
 <li>it has no way to ensure the safety of the object itself (since the object may have fields)</li>
 </ul>
<pre><code class="language-go">import ballerina/io;

class EvenNumber {
    int i = 1;

    // `isolated` method.
    isolated function generate() returns int {

        lock {
            // Uses `self` to access mutable field `i`
            // within a `lock` statement.
            return self.i * 2;

        }
    }
}

public function main() {
    EvenNumber e = new;
    int c = e.generate();
    io:println(c);
}
</code></pre>
<h4 id="output-109"><a class="header" href="#output-109">Output</a></h4>
<pre><code class="language-bash">bal run isolated_methods.bal
2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="isolated-objects"><a class="header" href="#isolated-objects">Isolated Objects</a></h1>
<p>An object defined as <code>isolated</code> is similar to a module with <code>isolated</code> module-level variables.
Mutable fields of an <code>isolated</code> object,</p>
<ul>
 <li>must be `private` and so can only be accessed using `self`</li>
 <li>must be initialized with an `isolated` expression</li>
 <li>must only be accessed within a `lock` statement</li>
 <li>`lock` statement must follow the same rules for `self` as for an `isolated` variable</li>
 <li>a field is mutable unless it is `final` and has a type that is a subtype of `readonly`</li>
 </ul>
 <br></br>
 <p>Isolated root concept treats `isolated` objects as opaque. Isolated functions can access a `final`
 variable whose type is an `isolated` object.</p>
<pre><code class="language-go">import ballerina/io;

// An `isolated` objects mutable state is `isolated` from the
// rest of the program.
isolated class Counter {
    // `n` is a mutable field.
    private int n = 0;

    isolated function get() returns int {
        lock {
            // `n` can only be accessed using `self`.
            return self.n;

        }
    }

    isolated function inc() {
        lock {
            self.n += 1;
        }
    }
}

public function main() {
    // The objects mutable state is accessible only via the
    // object itself making it an isolated root.
    Counter c = new;

    c.inc();
    int v = c.get();
    io:println(v);
}
</code></pre>
<h4 id="output-110"><a class="header" href="#output-110">Output</a></h4>
<pre><code class="language-bash">bal run isolated_objects.bal
1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inferring-isolated"><a class="header" href="#inferring-isolated">Inferring Isolated</a></h1>
<p><code>isolated</code> is a complex feature, which would be a lot for an application developer to understand.
A typical Ballerina application consists of a single module that imports multiple library modules.
Within a single module, the compiler infers <code>isolated</code> qualifiers. An object without mutable fields is
inherently <code>isolated</code>. It is the application developer's responsibility to use <code>lock</code> statements where
needed. e.g.,</p>
<ul>
 <li>accessing `self` in a `service` object with mutable state</li>
 <li>accessing mutable module-level variables</li>
 </ul>
 <br></br>
 <p>Compiler can inform developer where missing locks are preventing a `service` object or method from
 being `isolated`.</p>
<pre><code class="language-go">import ballerina/io;

public function main() {
    // function's default worker, worker `A` and `B` run concurrently.
    worker A {
        // It is safe to access the parameters of `sayHello` for the
        // duration of the function call.
        string a = sayHello(&quot;John&quot;);

        io:println(a);
    }

    worker B {
        string b = sayHello(&quot;Anne&quot;);
        io:println(b);
    }

    // `sayHello` is inferred to be an `isolated` function.
    boolean c = sayHello is isolated function (string str) returns string;

    io:println(c);
}

function sayHello(string name) returns string {
    return &quot;Hello &quot; + name;
}
</code></pre>
<h4 id="output-111"><a class="header" href="#output-111">Output</a></h4>
<pre><code class="language-bash">bal run inferring_isolated.bal
true
Hello Anne
Hello John
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="testing"><a class="header" href="#testing">Testing</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="assertions"><a class="header" href="#assertions">Assertions</a></h1>
<p>Testerina has in-built assertions that enable you to
assert an outcome against an expected outcome.
This example illustrates how to use different assertions.<br/><br/>
For more information, see <a href="https:ballerina.io/learn/testing-ballerina-code/testing-quick-start/">Testing Ballerina Code</a>
and the <a href="https:docs.central.ballerina.io/ballerina/test/latest/">Test Module</a>.</p>
<pre><code class="language-go">import ballerina/test;

@test:Config { }
function testAssertEquals() {
    json a = {name:&quot;John Doe&quot;, age:25, address:{city:&quot;Colombo&quot;, 
    country:&quot;Sri Lanka&quot;}};
    json b = {name:&quot;John Doe&quot;, age:25, address:{city:&quot;Colombo&quot;, 
    country:&quot;Sri Lanka&quot;}};
    // Asserts two values for value equality using `assertEquals`.
    test:assertEquals(a, b, msg = &quot;JSON values are not equal&quot;);
}

@test:Config { }
function testAssertNotEquals() {
    string s1 = &quot;abc&quot;;
    string s2 = &quot;def&quot;;
    // Asserts two values for value inequality using `assertNotEquals`.
    test:assertNotEquals(s1, s2, msg = &quot;String values are equal&quot;);
}

@test:Config { }
function testAssertTrue() {
    boolean value = true;
    // Asserts if the provided value is `true`.
    test:assertTrue(value, msg = &quot;AssertTrue failed&quot;);
}

@test:Config { }
function testAssertFalse() {
    boolean value = false;
    // Asserts if the provided value is `false`.
    test:assertFalse(value, msg = &quot;AssertFalse failed&quot;);
}

@test:Config { }
function testAssertFail() {
    boolean flag = true;
    if (flag) {
        return;
    }
    // Intentionally, throws an `AssertionError`.
    test:assertFail(msg = &quot;AssertFailed&quot;);
}

class Person {
    public string name = &quot;&quot;;
    public int age = 0;
    public Person? parent = ();
    private string email = &quot;default@abc.com&quot;;
    string address = &quot;No 20, Palm grove&quot;;
}

@test:Config { }
function testAssertExactEquals() {
    Person person1 = new;
    Person person2 = person1;
    // Compares the values for exact equality i.e. whether both refer to the same entity.
    test:assertExactEquals(person1, person2,
        msg = &quot;Objects are not exactly equal&quot;);
}

@test:Config { }
function testAssertNotExactEquals() {
    Person person1 = new;
    Person person2 = new;
    // Compares the values for the negation of exact equality.
    test:assertNotExactEquals(person1, person2,
        msg = &quot;Objects are exactly equal&quot;);
}
</code></pre>
<h4 id="output-112"><a class="header" href="#output-112">Output</a></h4>
<pre><code class="language-bash">bal test test_module

Compiling source
        ballerinatest/test_module:0.1.0

Running tests
    ballerinatest/test_module:0.1.0

                [pass] testAssertEquals
                [pass] testAssertExactEquals
                [pass] testAssertFail
                [pass] testAssertFalse
                [pass] testAssertNotEquals
                [pass] testAssertNotExactEquals
                [pass] testAssertTrue

                7 passing
                0 failing
                0 skipped

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="before-and-after-test"><a class="header" href="#before-and-after-test">Before and After Test</a></h1>
<p>The <code>before</code> attribute allows you to execute a function before a test function.
Similarly, the <code>after</code> attribute can be used to execute a function after a test function.<br/><br/>
These annotations can be used to set up the prerequisites and post actions for a test case.<br/><br/>
For more information, see <a href="https:ballerina.io/learn/testing-ballerina-code/testing-quick-start/">Testing Ballerina Code</a>
and the <a href="https:docs.central.ballerina.io/ballerina/test/latest/">Test Module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/test;

// Executed before the `testFunction` function.
function beforeFunc() {
    io:println(&quot;I'm the before function!&quot;);
}

// The Test function.
// The `before` and `after` attributes are used to define the functions
// that need to be executed before and after this test function.
@test:Config {
    before: beforeFunc,
    after: afterFunc
}
function testFunction() {
    io:println(&quot;I'm in test function!&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}

// Executed after the `testFunction` function.
function afterFunc() {
    io:println(&quot;I'm the after function!&quot;);
}
</code></pre>
<h4 id="output-113"><a class="header" href="#output-113">Output</a></h4>
<pre><code class="language-bash">bal test test_module

Compiling source
        ballerinatest/test_module:0.1.0

Running tests
    ballerinatest/test_module:0.1.0
I'm the before function!
I'm in test function!
I'm the after function!

        [pass] testFunction

        1 passing
        0 failing
        0 skipped
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="before-and-after-each"><a class="header" href="#before-and-after-each">Before and After Each</a></h1>
<p>The function specified with the <code>BeforeEach</code> annotation is executed before every test and
the function specified with the <code>AfterEach</code> annotation is executed after every test within the test suite.
This can be used for repeatedly initializing and tearing down test level aspects before every test function.<br/><br/>
For more information, see <a href="https:ballerina.io/learn/testing-ballerina-code/testing-quick-start/">Testing Ballerina Code</a>
and the <a href="https:docs.central.ballerina.io/ballerina/test/latest/">Test Module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/test;

// The `BeforeEach` function is executed before each test function.
@test:BeforeEach
function beforeEachFunc() {
    io:println(&quot;I'm the before each function!&quot;);
}

// The `AfterEach` function is executed after each test function.
@test:AfterEach
function afterEachFunc() {
    io:println(&quot;I'm the after each function!&quot;);
}

// A test function.
@test:Config { }
function testFunction1() {
    io:println(&quot;I'm in test function 1!&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}

// Another test function.
@test:Config { }
function testFunction2() {
    io:println(&quot;I'm in test function 2!&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}
</code></pre>
<h4 id="output-114"><a class="header" href="#output-114">Output</a></h4>
<pre><code class="language-bash">bal test test_module

Compiling source
        ballerinatest/test_module:0.1.0

Running tests
        ballerinatest/test_module:0.1.0
I'm the before each function!
I'm in test function 1!
I'm the after each function!
I'm the before each function!
I'm in test function 2!
I'm the after each function!

                [pass] testFunction1
                [pass] testFunction2

                2 passing
                0 failing
                0 skipped

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="before-and-after-groups"><a class="header" href="#before-and-after-groups">Before and After Groups</a></h1>
<p>The function specified with the <code>BeforeGroups</code> annotation is executed once before all the tests belonging to the
specified group is executed and the function specified with the <code>AfterGroups</code> annotation is executed once after all
the tests belonging to the specified group is executed.<br/><br/>
For more information, see <a href="https:ballerina.io/learn/testing-ballerina-code/testing-quick-start/">Testing Ballerina Code</a>
and the <a href="https:docs.central.ballerina.io/ballerina/test/latest/">Test Module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/test;

// Executed before the first test function of the group `g1`.
@test:BeforeGroups { value:[&quot;g1&quot;] }
function beforeGroupsFunc() {
    io:println(&quot;I'm the before groups function!&quot;);
}

// Executed after the last test function of the group `g1`.
@test:AfterGroups { value:[&quot;g1&quot;] }
function afterGroupsFunc() {
    io:println(&quot;I'm the after groups function!&quot;);
}

// A test function belonging to the group `g1`.
@test:Config { groups: [&quot;g1&quot;]}
function testFunction1() {
    io:println(&quot;I'm in test function 1!&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}

// Another test function.
@test:Config {}
function testFunction2() {
    io:println(&quot;I'm in test function 2!&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}
</code></pre>
<h4 id="output-115"><a class="header" href="#output-115">Output</a></h4>
<pre><code class="language-bash">bal test test_module

Compiling source
        ballerinatest/test_module:0.1.0

Running tests
        ballerinatest/test_module:0.1.0
I'm the before groups function!
I'm in test function 1!
I'm the after groups function!
I'm in test function 2!

	[pass] testFunction1
	[pass] testFunction2

	2 passing
	0 failing
	0 skipped
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="before-and-after-suite"><a class="header" href="#before-and-after-suite">Before and After Suite</a></h1>
<p>The <code>BeforeSuite</code> annotation allows you to execute a function before executing a test suite.
Similarly, the <code>AfterSuite</code> annotation can be used to execute a function after a test suite.<br/><br/>
A module is considered as a suite in the Test framework. <br></br>
These annotations can be used to set up prerequisites and post actions for a test suite.
For more information, see <a href="https:ballerina.io/learn/testing-ballerina-code/testing-quick-start/">Testing Ballerina Code</a>
and the <a href="https:docs.central.ballerina.io/ballerina/test/latest/">Test Module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/test;

// Executed before all the test functions in the module.
@test:BeforeSuite
function beforeSuit() {
    io:println(&quot;I'm the before suite function!&quot;);
}

// A Test function.
@test:Config { }
function testFunction1() {
    io:println(&quot;I'm in test function 1!&quot;);
    test:assertTrue(true, msg = &quot;Failed&quot;);
}

// A Test function.
@test:Config { }
function testFunction2() {
    io:println(&quot;I'm in test function 2!&quot;);
    test:assertTrue(true, msg = &quot;Failed&quot;);
}

// Executed after all the test functions in the module.
@test:AfterSuite { }
function afterSuite() {
    io:println(&quot;I'm the after suite function!&quot;);
}
</code></pre>
<h4 id="output-116"><a class="header" href="#output-116">Output</a></h4>
<pre><code class="language-bash">bal test test_module

Compiling source
        ballerinatest/test_module:0.1.0

Running tests
        ballerinatest/test_module:0.1.0
I'm the before suite function!
I'm in test function 1!
I'm in test function 2!
I'm the after suite function!

                [pass] testFunction1
                [pass] testFunction2

                2 passing
                0 failing
                0 skipped
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-driven-tests"><a class="header" href="#data-driven-tests">Data Driven Tests</a></h1>
<p>The Ballerina Test framework provides in-built support for data-driven tests.<br/><br/>
You can specify a function that returns a set of data values as a data-provider to a test function.
The test execution will iterate the same test function over the provided dataset.<br/><br/>
For more information, see <a href="https:ballerina.io/learn/testing-ballerina-code/testing-quick-start/">Testing Ballerina Code</a>
and the <a href="https:docs.central.ballerina.io/ballerina/test/latest/">Test Module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/test;

// The `dataProvider` attribute is used to specify a data-provider function for the test.
@test:Config {
    dataProvider: stringDataProvider
}
// Data is passed to the function as function parameters.
function testAddingValues(string fValue, string sValue, string result) returns error? {
    int value1 = check 'int:fromString(fValue);
    int value2 = check 'int:fromString(sValue);
    int result1 = check 'int:fromString(result);
    io:println(&quot;Input : [&quot; + fValue + &quot;,&quot; + sValue + &quot;,&quot; + result + &quot;]&quot;);
    test:assertEquals(value1 + value2, result1, msg = &quot;Incorrect Sum&quot;);
}

// The data provider function, which returns a `string` value-set in array format.
function stringDataProvider() returns (string[][]) {
    return [[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], [&quot;10&quot;, &quot;20&quot;, &quot;30&quot;], [&quot;5&quot;, &quot;6&quot;, &quot;11&quot;]];
}

@test:Config {
    dataProvider: mapDataProvider
}
function mapDataProviderTest(int value1, int value2, string fruit) returns error? {
    io:println(&quot;Input : [&quot; + value1.toBalString() + &quot;,&quot; + value2.toBalString() + &quot;,&quot; + fruit + &quot;]&quot;);
    test:assertEquals(value1, value2, msg = &quot;The provided values are not equal&quot;);
    test:assertEquals(fruit.length(), 6);
}

// The data provider function, which returns a  data set as a map of tuples.
function mapDataProvider() returns map&lt;[int, int, string]&gt;|error {
    map&lt;[int, int, string]&gt; dataSet = {
        &quot;banana&quot;: [10, 10, &quot;banana&quot;],
        &quot;cherry&quot;: [5, 5, &quot;cherry&quot;]
    };
    return dataSet;
}
</code></pre>
<h4 id="output-117"><a class="header" href="#output-117">Output</a></h4>
<pre><code class="language-bash">bal test test_module
Compiling source
        ballerinatest/test_module:0.1.0

Running tests
        ballerinatest/test_module:0.1.0
Input : [10,10,banana]
Input : [5,5,cherry]
Input : [1,2,3]
Input : [10,20,30]
Input : [5,6,11]

        [pass] mapDataProviderTest#banana
        [pass] mapDataProviderTest#cherry
        [pass] testAddingValues#0
        [pass] testAddingValues#1
        [pass] testAddingValues#2

        5 passing
        0 failing
        0 skipped
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="guarantee-test-execution-order"><a class="header" href="#guarantee-test-execution-order">Guarantee Test Execution Order</a></h1>
<p>The <code>dependsOn</code> attribute can be used to define a list of functions that the test 
function depends on. These functions will be executed before the execution of that test.<br/><br/>
This allows you to ensure that the tests are being executed in the expected order.<br/><br/>
For more information, see <a href="https:ballerina.io/learn/testing-ballerina-code/testing-quick-start/">Testing Ballerina Code</a>
and the <a href="https:docs.central.ballerina.io/ballerina/test/latest/">Test Module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/test;

// This test function depends on the `testFunction3`.
@test:Config { 
    dependsOn: [testFunction3] }
function testFunction1() {
    io:println(&quot;I'm in test function 1!&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}

// This test function depends on the `testFunction1`.
@test:Config { dependsOn: [testFunction1] }
function testFunction2() {
    io:println(&quot;I'm in test function 2!&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}

// This will be executed without depending on other functions.
// However, since other functions depend on this function, it will be executed first.
@test:Config { }
function testFunction3() {
    io:println(&quot;I'm in test function 3!&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}
</code></pre>
<h4 id="output-118"><a class="header" href="#output-118">Output</a></h4>
<pre><code class="language-bash">bal test test_module

Compiling source
        ballerinatest/test_module:0.1.0

Running tests
    ballerinatest/test_module:0.1.0
I'm in test function 3!
I'm in test function 1!
I'm in test function 2!

                [pass] testFunction3
                [pass] testFunction1
                [pass] testFunction2

                3 passing
                0 failing
                0 skipped
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="group-tests"><a class="header" href="#group-tests">Group Tests</a></h1>
<p>You can tag your test cases with a single group name or multiple group names (one or more).
This allows you to control the execution of selected tests.<br/><br/>
In order to execute tests belonging to a selected test group, you can name the 
test groups that are to be executed when you run the tests.
Likewise, you can exclude executing the selected test groups as well.<br/><br/>
For more information, see <a href="https:ballerina.io/learn/testing-ballerina-code/testing-quick-start/">Testing Ballerina Code</a>
and the <a href="https:docs.central.ballerina.io/ballerina/test/latest/">Test Module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/test;

// Belongs to the test group `g1`.
@test:Config { groups: [&quot;g1&quot;] }
function testFunction1() {
    io:println(&quot;I'm in test belonging to group g1!&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}

// Belongs to the test groups `g1` and `g2`.
@test:Config { groups: [&quot;g1&quot;, &quot;g2&quot;] }
function testFunction2() {
    io:println(&quot;I'm in test belonging to groups g1 and g2!&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}

// Does not belong to any test group.
@test:Config { }
function testFunction3() {
    io:println(&quot;I'm the ungrouped test&quot;);
    test:assertTrue(true, msg = &quot;Failed!&quot;);
}
</code></pre>
<h4 id="output-119"><a class="header" href="#output-119">Output</a></h4>
<pre><code class="language-bash"># To run this sample, navigate to the directory that contains the
# `.bal` file, and execute the `ballerina test` command below.

# Run the tests belonging to the `g1` and `g2` groups
bal test --groups g1,g2 testerina_group_tests.bal

Compiling source
    testerina_group_tests.bal

Running tests

    testerina_group_tests.bal
I'm in test belonging to group g1!
I'm in test belonging to groups g1 and g2!

        [pass] testFunction1
        [pass] testFunction2

        2 passing
        0 failing
        0 skipped

# Run the tests belonging to the `g1` group
bal test --groups g1 testerina_group_tests.bal

Compiling source
    testerina_group_tests.bal

Running tests

    testerina_group_tests.bal
I'm in test belonging to group g1!
I'm in test belonging to groups g1 and g2!

        [pass] testFunction1
        [pass] testFunction2

        2 passing
        0 failing
        0 skipped

# Run all tests other than the tests belonging to the `g2` group
bal test --disable-groups g2 testerina_group_tests.bal

Compiling source
    testerina_group_tests.bal

Running tests

    testerina_group_tests.bal
I'm in test belonging to group g1!
I'm the ungrouped test

        [pass] testFunction1
        [pass] testFunction3

        2 passing
        0 failing
        0 skipped
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="function-mocking"><a class="header" href="#function-mocking">Function Mocking</a></h1>
<p>Mock functions allow you to hide the real function implementation and engage your own definition when running tests.
This allows you to isolate your tests from the other modules and functions.<br/><br/>
Function mocks can be stubbed with return values or with another user-defined function,
which has the same signature as the original function.<br/><br/>
For more information, see <a href="https:ballerina.io/learn/testing-ballerina-code/testing-quick-start/">Testing Ballerina Code</a>
and the <a href="https:docs.central.ballerina.io/ballerina/test/latest/">Test Module</a>.</p>
<pre><code class="language-go">// This demonstrates different ways to mock functions.
import ballerina/test;
import ballerina/io;

// Creates a `MockFunction` for stubbing calls to
// the `intAdd` function of the same module.
@test:Mock { functionName: &quot;intAdd&quot; }
test:MockFunction intAddMockFn = new();

@test:Config {}
function testReturn() {
    // Stubs the calls to return a specific value.
    test:when(intAddMockFn).thenReturn(20);
    // Stubs the calls to return a specific value when
    // specific arguments are provided.
    test:when(intAddMockFn).withArguments(0, 0).thenReturn(-1);

    test:assertEquals(intAdd(10, 6), 20, msg = &quot;function mocking failed&quot;);
    test:assertEquals(intAdd(0, 0), -1,
            msg = &quot;function mocking with arguments failed&quot;);
}

// Creates a `MockFunction` that should replace the
// imported `io:println` function.
@test:Mock {
    moduleName: &quot;ballerina/io&quot;,
    functionName: &quot;println&quot;
}
test:MockFunction printlnMockFn = new();

int tally = 0;

// This has a function signature similar to the `io:println` function.
public function mockPrint(any|error... val) {
    tally = tally + 1;
}

@test:Config {}
function testCall() {
    // Stubs the calls to the `io:println` function
    // to invoke the `mockPrint` function instead.
    test:when(printlnMockFn).call(&quot;mockPrint&quot;);

    io:println(&quot;Testing 1&quot;);
    io:println(&quot;Testing 2&quot;);
    io:println(&quot;Testing 3&quot;);

    test:assertEquals(tally, 3);
}
</code></pre>
<h4 id="output-120"><a class="header" href="#output-120">Output</a></h4>
<pre><code class="language-bash"># To run this sample, create a Ballerina project named `bbe_mocking` and create a `tests` directory inside.
# Replace the content of the `main.bal` and add the `main_test.bal` to the `tests` directory.
# Execute the `bal test` command below.
# Function mocking is not supported for testing single `.bal` files.

bal test bbe_mocking

Compiling source
        ballerinatest/bbe_mocking:0.1.0

Running Tests

        bbe_mocking

                [pass] testCall
                [pass] testReturn

                2 passing
                0 failing
                0 skipped
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="object-mocking"><a class="header" href="#object-mocking">Object Mocking</a></h1>
<p>Object mocking enables controlling the values of member variables and the behavior of
the member functions of an object. Mocking of objects can be done in two ways. <br/><br/></p>
<ol>
<li>Creating a test double - providing an equivalent mock object in place of the real<br/></li>
<li>Stubbing the member function or member variable - stubbing the behavior of functions
and values of variables<br/><br/>
Creating a test double is suitable when a single mock function/object can be used
throughout all tests whereas stubbing is ideal when defining different behaviors for
different test cases is required.<br/><br/>
For more information, see <a href="https:ballerina.io/learn/testing-ballerina-code/testing-quick-start/">Testing Ballerina Code</a>
and the <a href="https:docs.central.ballerina.io/ballerina/test/latest/">Test Module</a>.</li>
</ol>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;
import ballerina/email;

// Sample client that you can use for member access.
public client class ExampleClient {
    public string id;

    public function init(string id) {
        self.id = id;
    }
}

// Client objects are defined globally to be able to replace in the test files.
http:Client clientEndpoint = check new(&quot;http://postman-echo.com&quot;);
email:SmtpClient smtpClient = check new(&quot;localhost&quot;, &quot;admin&quot;, &quot;admin&quot;);
ExampleClient exampleClient = new(&quot;originalId&quot;);

// Performs two `GET` requests to the specified
// endpoint and returns the response.
function performGet() returns @tainted http:Response {
    io:println(&quot;Executing the 1st GET request&quot;);
    http:Response response = &lt;http:Response&gt; 
    checkpanic clientEndpoint -&gt; get(&quot;/headers&quot;);
    io:println(&quot;Status code: &quot;, response.statusCode.toString());

    if (response.statusCode == 200) {
        io:println(&quot;Executing the 2nd GET request&quot;);
        response = &lt;http:Response&gt; checkpanic
        clientEndpoint -&gt; get(&quot;/get?test=123&quot;,
            {&quot;Sample-Name&quot;: &quot;http-client-connector&quot;});
        io:println(&quot;Status code: &quot;, response.statusCode.toString());
    }
    return response;
}

// Sends an email to the specified email addresses
// and returns an error if found.
function sendNotification(string[] emailIds) returns error? {
    email:Message msg = {
        'from: &quot;builder@abc.com&quot;,
        subject: &quot;Error Alert ...&quot;,
        to: emailIds,
        body: &quot;&quot;
    };
    return smtpClient -&gt; sendMessage(msg);
}
</code></pre>
<h4 id="output-121"><a class="header" href="#output-121">Output</a></h4>
<pre><code class="language-bash"># To run this sample, create a Ballerina project named `bbe_mocking` and create a `tests` directory inside.
# Replace the content of the `main.bal` and add the `main_test.bal` to the `tests` directory.
# Execute the `bal test` command below.

bal test bbe_mocking
Compiling source
        ballerinatest/bbe_mocking:0.1.0

Running Tests

        bbe_mocking
Executing the 1st GET request
Status code: 200
Executing the 2nd GET request
Status code: 200
Executing the 1st GET request
Status code: 200
Executing the 2nd GET request
Status code: 404
Executing the 1st GET request
Status code: 404
Executing the 1st GET request
Status code: 500

                [pass] testMemberVariable
                [pass] testReturn
                [pass] testReturnSequence
                [pass] testReturnWithArgs
                [pass] testSendNotification
                [pass] testTestDouble

                6 passing
                0 failing
                0 skipped
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rest-api"><a class="header" href="#rest-api">REST API</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service-path-and-resource-path"><a class="header" href="#service-path-and-resource-path">Service Path and Resource Path</a></h1>
<p>Ballerina supports writing RESTful services according to the JAX-RS specification. 
You can use the <code>absolute-resource-path</code> and <code>resource-name</code> to access a resource function while the <code>accessor-name</code>,
which is an HTTP verb as <code>post</code> and <code>get</code> to constrain your resource function in a RESTful manner.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// The `absolute resource path` represents the absolute path to the service. When bound to a listener
// endpoint, the service will be accessible at the specified path. If the path is omitted, then it defaults to `/`.
// A string literal also can represent the absolute path. E.g., `&quot;/foo&quot;`.
// The `type descriptor` represents the respective type of the service. E.g., `http:Service`.
service http:Service /foo on new http:Listener(9090) {

    // The `resource method name` (`post`) confines the resource to the specified HTTP methods. In this
    // instance, only `POST` requests are allowed. The `default` accessor can be used to match with all methods
    // including standard HTTP methods and custom methods.
    // The `resource path` associates the relative path to the service object's path. E.g., `bar`.
    resource function post bar(@http:Payload json payload) returns json {
        return payload;
    }
}
</code></pre>
<h4 id="output-122"><a class="header" href="#output-122">Output</a></h4>
<pre><code class="language-bash">bal run absolute_path_and_path.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service-data-binding"><a class="header" href="#service-data-binding">Service Data Binding</a></h1>
<p>HTTP service data binding helps to access the request payload through a resource signature parameter. The payload
parameter should be declared with the <code>@Payload</code> annotation. <code>string</code>, <code>json</code>, <code>xml</code>, <code>byte[]</code>, record, and record[]
are supported as parameter types. Binding failures will be responded with 400[Bad Request] response<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

type Student record {
    string Name;
    int Grade;
};

service /hello on new http:Listener(9090) {

    // The `Student` parameter in [Payload annotation](https://docs.central.ballerina.io/ballerina/http/latest/records/Payload)
    // represents the entity body of the inbound request.
    @http:ResourceConfig {
        consumes: [&quot;application/json&quot;]
    }
    resource function post bindStudent(@http:Payload Student student)
            returns json {
        string name = student.Name;
        return {Name: name};
    }

    //Binds the XML payload of the inbound request to the `store` variable.
    @http:ResourceConfig {
        consumes: [&quot;application/xml&quot;]
    }
    resource function post bindXML(@http:Payload xml store) returns xml {
        xml city = store.selectDescendants(&quot;{http://www.test.com}city&quot;);
        return city;
    }
}
</code></pre>
<h4 id="output-123"><a class="header" href="#output-123">Output</a></h4>
<pre><code class="language-bash">bal run http_data_binding.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="default-resource"><a class="header" href="#default-resource">Default Resource</a></h1>
<p>Ballerina provides rest params in the resource path and the default resource method to help designing proxy services
and default resources. It can be used to handle unmatched requests.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// The `absolute resource path` can be omitted. Then, it defaults to `/`.
service on new http:Listener(9090) {

    // The `default` accessor name can be used to match with all methods including standard HTTP methods
    // and custom methods. The rest param is used to represent the wildcard of the `resource path` in which any path
    // segment will get dispatched to the resource in the absence of an exact path match.
    resource function 'default [string... paths](http:Request req)
            returns json {
        return {method: req.method, path: paths};
    }
}
</code></pre>
<h4 id="output-124"><a class="header" href="#output-124">Output</a></h4>
<pre><code class="language-bash">Run the cURL command below with the unmatched path and method.
curl &quot;http://localhost:9090/foo/bar&quot; -X POST
{&quot;method&quot;:&quot;POST&quot;, &quot;path&quot;:[&quot;foo&quot;, &quot;bar&quot;]}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="path-parameter"><a class="header" href="#path-parameter">Path Parameter</a></h1>
<p>HTTP module provides first class support for specifying <code>Path parameters</code> in the resource path along with the type.
The supported types are string, int, float, boolean, and decimal (e.g., path/[string foo]).<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

service /company on new http:Listener(9090) {

    // The path param is defined as a part of the resource path along with the type and it is extracted from the
    // request URI.
    resource function get empId/[int id]() returns json {
        return {empId: id};
    }

    resource function get empName/[string first]/[string last]() returns json {
        return {firstName: first, lastName: last};
    }
}
</code></pre>
<h4 id="output-125"><a class="header" href="#output-125">Output</a></h4>
<pre><code class="language-bash">bal run http_path_param.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="query-parameter"><a class="header" href="#query-parameter">Query Parameter</a></h1>
<p>HTTP module provides first class support for reading URL query parameters as resource method argument.
The supported types are string, int, float, boolean, decimal, and the array types of the aforementioned types. The
query param type can be nilable (e.g., (string? bar)). The request also provide certain method to retrieve query
param at their convenience <br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

service /product on new http:Listener(9090) {

    // The `a`, `b` method arguments are considered as query parameters.
    resource function get count(int a, int b) returns json {
        return { count : a + b};
    }

    // The query param type is nilable which means the URI may contain the param.
    // In the absence of the query param `id` the type is nil.
    resource function get name(string? id) returns string {
        if (id is string) {
            return &quot;product_&quot; + id;
        }
        return &quot;product_0000&quot;;
    }

    // The multiple query param values also can be accommodate to an array.
    resource function get detail(string[]? colour) returns json {
        return { product_colour : colour};
    }
}
</code></pre>
<h4 id="output-126"><a class="header" href="#output-126">Output</a></h4>
<pre><code class="language-bash">Run the cURL command below to invoke product/count resource.
curl &quot;http://localhost:9090/product/count?a=315&amp;b=585&quot;
{&quot;count&quot;:900}

Run the cURL command below to invoke product/name resource.
curl &quot;http://localhost:9090/product/name?id=432423&quot;
product_432423

Run the cURL command below to invoke product/detail resource.
curl &quot;http://localhost:9090/product/detail?colour=red&amp;colour=green&quot;
{&quot;product_colour&quot;:[&quot;red&quot;, &quot;green&quot;]}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="matrix-parameter"><a class="header" href="#matrix-parameter">Matrix Parameter</a></h1>
<p>Ballerina supports extracting <code>MatrixParam</code> values using <code>http:Request</code> support method.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

service /sample on new http:Listener(9090) {

    // The path param is defined as a part of the resource path along with the type and it is extracted from the
    // request URI.
    resource function get path/[string foo](http:Request req) returns json {

        // Gets the [MatrixParams](https://docs.central.ballerina.io/ballerina/http/latest/classes/Request#getMatrixParams).
        map&lt;any&gt; pathMParams = req.getMatrixParams(&quot;/sample/path&quot;);
        var a = &lt;string&gt;pathMParams[&quot;a&quot;];
        var b = &lt;string&gt;pathMParams[&quot;b&quot;];
        string pathMatrixStr = string `a=${a}, b=${b}`;

        map&lt;any&gt; fooMParams = req.getMatrixParams(&quot;/sample/path/&quot; + foo);
        var x = &lt;string&gt;fooMParams[&quot;x&quot;];
        var y = &lt;string&gt;fooMParams[&quot;y&quot;];
        string fooMatrixStr = string `x=${x}, y=${y}`;
        json matrixJson = {&quot;path&quot;: pathMatrixStr, &quot;foo&quot;: fooMatrixStr};

        // Create a JSON payload with the extracted values.
        json responseJson = {
            &quot;pathParam&quot;: foo,
            &quot;matrix&quot;: matrixJson
        };
        // Send a response with the JSON payload to the client.
        return responseJson;
    }
}
</code></pre>
<h4 id="output-127"><a class="header" href="#output-127">Output</a></h4>
<pre><code class="language-bash">bal run http_matrix_param.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="header-parameter"><a class="header" href="#header-parameter">Header Parameter</a></h1>
<p>The <code>http</code> module provides support for accessing inbound request headers as resource method arguments.
The header key can be specified as a variable name along with the <code>@http:Header</code> annotation. Else, it can be specified
in the <code>name</code> field of the annotation. The supported types are <code>string</code>, <code>string[]</code>, and optional.
The <code>string[]</code> type returns all the values for a given header key while <code>string</code> returns the first value. Unless the
type is optional, the request will be responded with a 400 Bad request in the absence of the mentioned header.
However, more header manipulations can be done via the <code>http:Headers</code> header object, which also can be accessed as
a resource method argument without using the annotation.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/log;

service / on new http:Listener(9090) {
    // The `clientKey` method argument is considered as the value for the
    // `X-Client-Key` HTTP header.
    resource function get hello(@http:Header {name: &quot;X-Client-Key&quot;}
            string clientKey) returns string {

        log:printInfo(&quot;Received header value: &quot; + clientKey);
        return clientKey;
    }
}
</code></pre>
<h4 id="output-128"><a class="header" href="#output-128">Output</a></h4>
<pre><code class="language-bash">bal run http_headers.bal
time = 2021-06-25T11:56:13.746+05:30 level = INFO module = &quot;&quot; message = &quot;Received header value 0987654321&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="typed-resource-responses"><a class="header" href="#typed-resource-responses">Typed Resource Responses</a></h1>
<p>The resource method can return <code>anydata</code> type, an <code>http:Response</code> object, <code>StatusCodeResponse</code> records along with
<code>error?</code>. Instead of using an <code>http:Caller</code>, the response can be sent similarly by returning from the method.
When returning <code>anydata</code>, the <code>@http:Payload</code> annotation can be used to specify the <code>Content-type</code> of the response
additionally. Otherwise, the default content type of the respective return value type will be added.
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

type PersonAccount record {
    string name;
    int accountNo;
};

service /bank on new http:Listener(9090) {

    // The resource returns the json type values and the `Content-type` header is set according to the `mediaType`
    // field of [@http:Payload](https://docs.central.ballerina.io/ballerina/http/latest/records/HttpPayload)
    // annotation.
    resource function get branch() returns
            @http:Payload {mediaType:&quot;application/json+id&quot;} json {
        return { branch : [&quot;Colombo, Srilanka&quot;]};
    }

    // The [StatusCodeResponse](https://docs.central.ballerina.io/ballerina/http/latest/types#StatusCodeResponse)
    // can be state as return type to send responses with specific HTTP status codes.
    resource function get [string 'type]()
            returns http:Ok|http:InternalServerError {
        if 'type == &quot;open&quot; {

            // Creates response with 200 status code and set body as response payload.
            http:Ok ok = {body: &quot;Bank is open&quot;};
            return ok;
        } else {

            // Creates response with 500 status code and set body as response payload.
            http:InternalServerError err = {body: &quot;Bank is closed&quot;};
            return err;
        }
    }

    // Inline response records are useful to return headers and body along with status code. In this instance the
    // return type is a subtype of [http:Created](https://docs.central.ballerina.io/ballerina/http/latest/records/Created)
    // record, hence 201 response will be sent.
    resource function put account(@http:Payload string name)
            returns record {|*http:Created; PersonAccount body;|} {
        PersonAccount account = {accountNo: 84230, name: name};
        return {
            mediaType: &quot;application/account+json&quot;,
            headers: {
                &quot;Location&quot;: &quot;/myServer/084230&quot;
            },
            body: account
        };
    }
}
</code></pre>
<h4 id="output-129"><a class="header" href="#output-129">Output</a></h4>
<pre><code class="language-bash">Run the cURL command below to invoke bank/branch resource.
curl -v &quot;http://localhost:9090/bank/branch&quot;
&gt; GET /bank/branch HTTP/1.1
&gt; Host: localhost:9090
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200 OK
&lt; content-type: application/json+id
&lt; content-length: 32
&lt; server: ballerina
&lt; date: Sat, 15 May 2021 16:14:10 +0530
&lt;
* Connection #0 to host localhost left intact
{&quot;branch&quot;:[&quot;Colombo, Srilanka&quot;]}* Closing connection 0

Run the cURL command below to invoke second resource.
curl -v &quot;http://localhost:9090/bank/open&quot;
&gt; GET /bank/open HTTP/1.1
&gt; Host: localhost:9090
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200 OK
&lt; content-type: text/plain
&lt; content-length: 12
&lt; server: ballerina
&lt; date: Sat, 15 May 2021 16:16:56 +0530
&lt;
* Connection #0 to host localhost left intact
Bank is open* Closing connection 0

Run the cURL command below to invoke bank/account resource.
curl -v &quot;http://localhost:9090/bank/account&quot; -d &quot;bal&quot; -X PUT
&gt; PUT /bank/account HTTP/1.1
&gt; Host: localhost:9090
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt; Content-Length: 3
&gt; Content-Type: application/x-www-form-urlencoded
&gt;
&lt; HTTP/1.1 201 Created
&lt; Location: /myServer/084230
&lt; content-type: application/account+json
&lt; content-length: 33
&lt; server: ballerina
&lt; date: Sat, 15 May 2021 16:19:31 +0530
&lt;
* Connection #0 to host localhost left intact
{&quot;name&quot;:&quot;bal&quot;, &quot;accountNo&quot;:84230}* Closing connection 0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="restrict-by-media-type"><a class="header" href="#restrict-by-media-type">Restrict By Media Type</a></h1>
<p>You can configure resources of HTTP services to restrict the types of media they consume and produce.
This is done through the <code>consumes</code> and <code>produces</code> annotation attributes of the <code>ResourceConfig</code> annotation,
which is used with resources.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

service on new http:Listener(9092) {
    // The `consumes` and `produces` annotations of the [resource configuration](https://docs.central.ballerina.io/ballerina/http/latest/records/HttpResourceConfig)
    // contain MIME types as an array of strings. The resource can only consume/accept `text/json` and
    // `application/json` media types. Therefore, the `Content-Type` header
    // of the request must be in one of these two types. The resource can produce
    // `application/xml` payloads. Therefore, you need to set the `Accept` header accordingly.
    @http:ResourceConfig {
        consumes: [&quot;text/json&quot;, &quot;application/json&quot;],
        produces: [&quot;application/xml&quot;]
    }
    resource function post infoService(@http:Payload json msg)
            returns xml|http:InternalServerError {
        json|error nameString = msg.name;
        if (nameString is json) {
            xml name = xml `&lt;name&gt;${&lt;string&gt;nameString}&lt;/name&gt;`;
            return name;
        }
        return { body: &quot;Invalid json: `name` not present&quot;};
    }
}
</code></pre>
<h4 id="output-130"><a class="header" href="#output-130">Output</a></h4>
<pre><code class="language-bash"># To invoke the service, execute the following cURL request.
curl -v http://localhost:9092/infoService -H &quot;Accept:application/xml&quot; -H &quot;Content-Type:application/json&quot; -d '{&quot;name&quot;:&quot;Ballerina&quot;}'
&gt; POST /infoService HTTP/1.1
&gt; Host: localhost:9092
&gt; User-Agent: curl/7.64.1
&gt; Accept:application/xml
&gt; Content-Type:application/json
&gt; Content-Length: 20
&gt;
* upload completely sent off: 20 out of 20 bytes
&lt; HTTP/1.1 200 OK
&lt; content-type: application/xml
&lt; content-length: 22
&lt; server: ballerina
&lt; date: Wed, 23 Sep 2020 10:25:55 +0530
&lt;
* Connection #0 to host localhost left intact
&lt;name&gt;Ballerina&lt;/name&gt;* Closing connection 0

# To invoke the service using unsupported media type, execute the following cURL request. The content type of the
# request is not listed under the `consumes` resource configuration.
curl -v http://localhost:9092/infoService -H &quot;Accept:application/xml&quot; -H &quot;Content-Type:text/plain&quot; -d &quot;Hello ballerina&quot;
&gt; POST /infoService HTTP/1.1
&gt; Host: localhost:9092
&gt; User-Agent: curl/7.64.1
&gt; Accept:application/xml
&gt; Content-Type:text/plain
&gt; Content-Length: 15
&gt;
* upload completely sent off: 15 out of 15 bytes
&lt; HTTP/1.1 415 Unsupported Media Type
&lt; content-type: text/plain
&lt; content-length: 0
&lt; server: ballerina
&lt; date: Wed, 23 Sep 2020 10:26:50 +0530
&lt;
* Connection #0 to host localhost left intact
* Closing connection 0

# To invoke the service with a media type that is not acceptable, execute the following cURL request. The media type mentioned
# in the Accept header is not listed under the `produces` resource configuration.
curl -v http://localhost:9092/infoService -H &quot;Accept:text/html&quot; -H &quot;Content-Type:application/json&quot; -d '{&quot;name&quot;:&quot;Ballerina&quot;}'
&gt; POST /infoService HTTP/1.1
&gt; Host: localhost:9092
&gt; User-Agent: curl/7.64.1
&gt; Accept:text/html
&gt; Content-Type:application/json
&gt; Content-Length: 20
&gt;
* upload completely sent off: 20 out of 20 bytes
&lt; HTTP/1.1 406 Not Acceptable
&lt; content-type: text/plain
&lt; content-length: 0
&lt; server: ballerina
&lt; date: Wed, 23 Sep 2020 10:27:28 +0530
&lt;
* Connection #0 to host localhost left intact
* Closing connection 0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rest-client"><a class="header" href="#rest-client">REST Client</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client"><a class="header" href="#client">Client</a></h1>
<p>The HTTP Client Connector can be used to connect to and interact with an HTTP server.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

public function main() returns error? {
    // Creates a new client with the backend URL.
    final http:Client clientEndpoint = 
                        check new (&quot;http://postman-echo.com&quot;);
    
    // Sends a `GET` request to the specified endpoint.
    io:println(&quot;GET request:&quot;);
    json resp = check clientEndpoint-&gt;get(&quot;/get?test=123&quot;);
    io:println(resp.toJsonString());

    // The `get()`, `head()`, and `options()` have the optional headers parameter to send out headers,
    io:println(&quot;\nGET request with Headers:&quot;);
    resp = check clientEndpoint-&gt;get(&quot;/get&quot;,
            {&quot;Sample-Name&quot;: &quot;http-client-connector&quot;});
    io:println(resp.toJsonString());

    // Sends a `POST` request to the specified endpoint.
    io:println(&quot;\nPOST request:&quot;);
    resp = check clientEndpoint-&gt;post(&quot;/post&quot;, &quot;POST: Hello World&quot;);
    io:println(resp.toJsonString());

    // Uses the `execute()` remote function for custom HTTP verbs.
    io:println(&quot;\nUse custom HTTP verbs:&quot;);
    http:Response response = check clientEndpoint-&gt;execute(
                        &quot;COPY&quot;, &quot;/get&quot;, &quot;CUSTOM: Hello World&quot;);

    io:println(&quot;Status code: &quot; + response.statusCode.toString());
}
</code></pre>
<h4 id="output-131"><a class="header" href="#output-131">Output</a></h4>
<pre><code class="language-bash">bal run http_client_endpoint.bal
GET request:
{&quot;args&quot;:{&quot;test&quot;:&quot;123&quot;}, &quot;headers&quot;:{&quot;x-forwarded-proto&quot;:&quot;http&quot;, &quot;x-forwarded-port&quot;:&quot;80&quot;, &quot;host&quot;:&quot;postman-echo.com&quot;, &quot;x-amzn-trace-id&quot;:&quot;Root=1-60b723e3-2cec8477340e121571a5df88&quot;, &quot;user-agent&quot;:&quot;ballerina&quot;}, &quot;url&quot;:&quot;http://postman-echo.com/get?test=123&quot;}

GET request with Headers:
{&quot;args&quot;:{}, &quot;headers&quot;:{&quot;x-forwarded-proto&quot;:&quot;http&quot;, &quot;x-forwarded-port&quot;:&quot;80&quot;, &quot;host&quot;:&quot;postman-echo.com&quot;, &quot;x-amzn-trace-id&quot;:&quot;Root=1-60b723e6-124af9746490533b1a560cca&quot;, &quot;sample-name&quot;:&quot;http-client-connector&quot;, &quot;user-agent&quot;:&quot;ballerina&quot;}, &quot;url&quot;:&quot;http://postman-echo.com/get&quot;}

POST request:
{&quot;args&quot;:{}, &quot;data&quot;:&quot;POST: Hello World&quot;, &quot;files&quot;:{}, &quot;form&quot;:{}, &quot;headers&quot;:{&quot;x-forwarded-proto&quot;:&quot;http&quot;, &quot;x-forwarded-port&quot;:&quot;80&quot;, &quot;host&quot;:&quot;postman-echo.com&quot;, &quot;x-amzn-trace-id&quot;:&quot;Root=1-60b723e6-60ad459c47889ca53a89df90&quot;, &quot;content-length&quot;:&quot;17&quot;, &quot;content-type&quot;:&quot;text/plain&quot;, &quot;user-agent&quot;:&quot;ballerina&quot;}, &quot;json&quot;:null, &quot;url&quot;:&quot;http://postman-echo.com/post&quot;}

Use custom HTTP verbs:
Status code: 404
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client-data-binding"><a class="header" href="#client-data-binding">Client Data Binding</a></h1>
<p>Through client data binding, the response payload can be accessed directly. The payload type is inferred from the
contextually-expected type or from the <code>targetType</code> argument. A possible payload type out of <code>string</code>|<code>xml</code>|<code>json</code>|
<code>map&lt;json&gt;</code>|<code>byte[]</code>|<code>record</code>|<code>record[]</code> and <code>http:Response</code> is expected as return value type.
When the user expects client data binding to happen, the HTTP error responses (4XX, 5XX) will be categorized
as an <code>error</code> (<code>http:ClientRequestError</code>, <code>http:RemoteServerError</code>) of the client remote operation.
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/log;

type Person record {|
    string name;
    int age;
|};

http:Client backendClient = check new(&quot;http://localhost:9092&quot;);

service /call on new http:Listener(9090) {

    resource function get all() returns json|error {
        // Binding the payload to a string type. The `targetType` is inferred from the LHS variable type.
        string result = check backendClient-&gt;get(&quot;/backend/string&quot;);
        log:printInfo(&quot;String payload: &quot; + result);

        // A `record` and `record[]` are also possible types for data binding.
        Person person = check backendClient-&gt;get(&quot;/backend/person&quot;);
        log:printInfo(&quot;Person name: &quot; + person.name);
        return person;
    }

    // When the data binding is expected to happen and if the `post` remote function gets a 5XX response from the
    // backend, the response will be returned as an [http:RemoteServerError](https://docs.central.ballerina.io/ballerina/http/latest/errors#RemoteServerError)
    // including the error payload, headers, and status code.
    resource function get '5xx() returns json {
        json|error res = backendClient-&gt;post(&quot;/backend/5XX&quot;, &quot;want 500&quot;);
        if (res is http:RemoteServerError) {
            http:Detail detail = res.detail();
            return { code:detail.statusCode, payload:&lt;string&gt;detail.body};
        } else {
            return { code: &quot;invalid&quot; };
        }
    }

    // When the data binding is expected to happen and if the client remote function gets a 4XX response from the
    // backend, the response will be returned as an [http:ClientRequestError](https://docs.central.ballerina.io/ballerina/http/latest/errors#ClientRequestError)
    // including the error payload, headers, and status code.
    resource function get '4xx() returns json {
        json|error res = backendClient-&gt;post(&quot;/backend/err&quot;, &quot;want 400&quot;);
        if (res is http:ClientRequestError) {
            http:Detail detail = res.detail();
            return { code:detail.statusCode, payload:&lt;string&gt;detail.body};
        } else {
            return { code: &quot;invalid&quot; };
        }
    }
}

service /backend on new http:Listener(9092) {

    resource function get 'string() returns string {
        return &quot;Hello ballerina!!!!&quot;;
    }

    resource function get person() returns record {|*http:Ok; Person body;|} {
        return {body: {name: &quot;Smith&quot;, age: 15}};
    }

    resource function post '5XX() returns http:NotImplemented {
        return {body:&quot;data-binding-failed-with-501&quot;};
    }
}
</code></pre>
<h4 id="output-132"><a class="header" href="#output-132">Output</a></h4>
<pre><code class="language-bash"># To invoke the `/call/all` resource, use the cURL command below.
curl &quot;http://localhost:9090/call/all&quot;
{&quot;name&quot;:&quot;Smith&quot;, &quot;age&quot;:15}

# To invoke the `/call/5xx` resource, use the cURL command below.
curl &quot;http://localhost:9090/call/5xx&quot;
{&quot;code&quot;:501, &quot;payload&quot;:&quot;data-binding-failed-with-501&quot;}

# To invoke the `/call/4xx` resource, use the cURL command below.
curl &quot;http://localhost:9090/call/4xx&quot;
{&quot;code&quot;:404, &quot;payload&quot;:&quot;no matching resource found for path : /backend/err , method : POST&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="caching-client"><a class="header" href="#caching-client">Caching Client</a></h1>
<p>HTTP caching is enabled by default in HTTP client endpoints.
Users can configure caching using the <code>cache</code> field in the client configurations.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// Caching can be enabled by setting `enabled:true` in the `cache` config of the client.
// In this example, the `isShared` field of the `cacheConfig` is set
// to true, as the cache will be a public cache in this particular scenario.
//
// The default caching policy is to cache a response only if it contains a
// `cache-control` header and either an `etag` header, or a `last-modified`
// header. The user can control this behaviour by setting the `policy` field of
// the `cacheConfig`. Currently, there are only 2 policies:
// `CACHE_CONTROL_AND_VALIDATORS` (the default policy) and `RFC_7234`.

http:Client cachingEP = checkpanic new (&quot;http://localhost:8080&quot;,
                        {cache: {enabled: true, isShared: true}});
service / on new http:Listener(9090) {

    resource function get cache(http:Request req)
            returns http:Response|error? {
        http:Response response = check cachingEP-&gt;forward(&quot;/hello&quot;, req);
        // If the request was successful, an HTTP response will be
        // returned.
        return response;
    }
}

service / on new http:Listener(8080) {

    resource function 'default hello() returns http:Response {
        http:Response res = new;
        // The `ResponseCacheControl` object in the `Response` object can be
        // used for setting the cache control directives associated with the
        // response. In this example, `max-age` directive is set to 15 seconds
        // indicating that the response will be fresh for 15 seconds. The
        // `must-revalidate` directive instructs that the cache should not
        // serve a stale response without validating it with the origin server
        // first. The `public` directive is set by setting `isPrivate=false`.
        // This indicates that the response can be cached even by intermediary
        // caches which serve multiple users.
        http:ResponseCacheControl resCC = new;

        resCC.maxAge = 15;
        resCC.mustRevalidate = true;
        resCC.isPrivate = false;
        res.cacheControl = resCC;
        json payload = {&quot;message&quot;: &quot;Hello, World!&quot;};

        // The `setETag()` function can be used for generating ETags for
        // `string`, `json`, and `xml` types. This uses the `getCRC32()`
        // function from the `ballerina/crypto` module for generating the ETag.
        res.setETag(payload);

        // The `setLastModified()` function sets the current time as the
        // `last-modified` header.
        res.setLastModified();

        res.setPayload(payload);
        // When sending the response, if the `cacheControl` field of the
        // response is set, and the user has not already set a `cache-control`
        // header, a `cache-control` header will be set using the directives set
        // in the `cacheControl` object.
        return res;

    }
}
</code></pre>
<h4 id="output-133"><a class="header" href="#output-133">Output</a></h4>
<pre><code class="language-bash"># Invoke the service.
curl -v http://localhost:9090/cache
&gt; GET /cache HTTP/1.1
&gt; Host: localhost:9090
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200 OK
&lt; etag: 620328e8
&lt; last-modified: Fri, 26 Nov 2021 04:22:32 GMT
&lt; content-type: application/json
&lt; cache-control: must-revalidate,public,max-age=15
&lt; date: Fri, 26 Nov 2021 09:52:32 +0530
&lt; server: ballerina
&lt; content-length: 27
&lt;
{&quot;message&quot;:&quot;Hello, World!&quot;}

curl -v http://localhost:9090/cache
&gt; GET /cache HTTP/1.1
&gt; Host: localhost:9090
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200 OK
&lt; etag: 620328e8
&lt; last-modified: Fri, 26 Nov 2021 04:22:32 GMT
&lt; content-type: application/json
&lt; cache-control: must-revalidate,public,max-age=15
&lt; date: Fri, 26 Nov 2021 09:52:32 +0530
&lt; age: 8
&lt; server: ballerina
&lt; content-length: 27
&lt;
{&quot;message&quot;:&quot;Hello, World!&quot;}

curl -v http://localhost:9090/cache
&gt; GET /cache HTTP/1.1
&gt; Host: localhost:9090
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200 OK
&lt; content-type: application/json
&lt; cache-control: must-revalidate,public,max-age=15
&lt; date: Fri, 26 Nov 2021 09:52:54 +0530
&lt; etag: 620328e8
&lt; last-modified: Fri, 26 Nov 2021 04:22:54 GMT
&lt; age: 0
&lt; server: ballerina
&lt; content-length: 27
&lt;
{&quot;message&quot;:&quot;Hello, World!&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rest-api-security"><a class="header" href="#rest-api-security">REST API Security</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---ssltls"><a class="header" href="#service---ssltls">Service - SSL/TLS</a></h1>
<p>You can use the HTTPS listener to connect to or interact with an HTTPS client.
Provide the <code>http:ListenerSecureSocket</code> configurations to the server to
expose an HTTPS connection.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// An HTTP listener can be configured to communicate through HTTPS as well.
// To secure a listener using HTTPS, the listener needs to be configured with
// a certificate file and a private key file for the listener.
// The [`http:ListenerSecureSocket`](https://docs.central.ballerina.io/ballerina/http/latest/records/ListenerSecureSocket) record
// provides the SSL-related listener configurations of the listener.
listener http:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

service /foo on securedEP {
    resource function get bar() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-134"><a class="header" href="#output-134">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run http_service_ssl_tls.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---mutual-ssl"><a class="header" href="#service---mutual-ssl">Service - Mutual SSL</a></h1>
<p>Ballerina supports mutual SSL, which is a certificate-based authentication
process in which two parties (the client and server) authenticate each other by
verifying the digital certificates. It ensures that both parties are assured
of each other's identity.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// An HTTP listener can be configured to accept new connections that are
// secured via mutual SSL.
// The [`http:ListenerSecureSocket`](https://docs.central.ballerina.io/ballerina/http/latest/records/ListenerSecureSocket) record provides the SSL-related listener configurations.
listener http:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        },
        // Enables mutual SSL.
        mutualSsl: {
            verifyClient: http:REQUIRE,
            cert: &quot;../resource/path/to/public.crt&quot;
        },
        // Enables the preferred SSL protocol and its versions.
        protocol: {
            name: http:TLS,
            versions: [&quot;TLSv1.2&quot;, &quot;TLSv1.1&quot;]
        },
        // Configures the preferred ciphers.
        ciphers: [&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;]

    }
);

service /foo on securedEP {
    resource function get bar() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-135"><a class="header" href="#output-135">Output</a></h4>
<pre><code class="language-bash"># To invoke the service, use the cURL commands below.
curl https://localhost:9090/foo/bar --cert /path/to/client-public.crt
    --key /path/to/client-private.key --cacert /path/to/server-public.crt
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---basic-auth-file-user-store"><a class="header" href="#service---basic-auth-file-user-store">Service - Basic Auth File User Store</a></h1>
<p>An HTTP service/resource can be secured using Basic auth and optionally by
enforcing authorization. Then, it validates the Basic auth token sent in the
<code>Authorization</code> header against the provided configurations. This reads data
from a file, which has a TOML format. This stores the usernames, passwords
for authentication, and scopes for authorization.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s).<br/>
In the authorization phase, the scopes of the service/resource are compared
against the scope included in the user store for at least one match between
the two sets.<br/>
<code>Config.toml</code> has defined three users - alice, ldclakmal and eve. Each user has a
password and optionally assigned scopes as an array.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/http;

listener http:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with Basic auth and can be authorized optionally.
// Using Basic auth with the file user store can be enabled by setting the
// [`http:FileUserStoreConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/FileUserStoreConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@http:ServiceConfig {
    auth: [
        {
            fileUserStoreConfig: {},
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /foo on securedEP {

    // It is optional to override the authentication and authorization
    // configurations at the resource levels. Otherwise, the service auth
    // configurations will be applied automatically to the resources as well.
    resource function get bar() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-136"><a class="header" href="#output-136">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, ensure that the `Config.toml` file is populated correctly
# with the user information.
echo '[[&quot;ballerina.auth.users&quot;]]
username=&quot;alice&quot;
password=&quot;password1&quot;
scopes=[&quot;scope1&quot;]
[[&quot;ballerina.auth.users&quot;]]
username=&quot;bob&quot;
password=&quot;password2&quot;
scopes=[&quot;scope2&quot;, &quot;scope3&quot;]' &gt; Config.toml

# You may need to change the certificate file path and private key file path.
bal run http_service_basic_auth_file_user_store.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---basic-auth-ldap-user-store"><a class="header" href="#service---basic-auth-ldap-user-store">Service - Basic Auth LDAP User Store</a></h1>
<p>An HTTP service/resource can be secured using Basic auth and by enforcing
authorization optionally. Then, it validates the Basic auth token sent in
the <code>Authorization</code> header against the provided configurations. This reads
data from the configured LDAP. This stores usernames, passwords for
authentication, and scopes for authorization.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s).<br/>
In the authorization phase, the scopes of the service/resource are compared
against the scope included in the user store for at least one match between
the two sets.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/http;

listener http:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with Basic auth and can be authorized  optionally.
// Basic auth using the LDAP user store can be enabled by setting the
// [`http:LdapUserStoreConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/LdapUserStoreConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@http:ServiceConfig {
    auth: [
        {
            ldapUserStoreConfig: {
                domainName: &quot;avix.lk&quot;,
                connectionUrl: &quot;ldap://localhost:389&quot;,
                connectionName: &quot;cn=admin,dc=avix,dc=lk&quot;,
                connectionPassword: &quot;avix123&quot;,
                userSearchBase: &quot;ou=Users,dc=avix,dc=lk&quot;,
                userEntryObjectClass: &quot;inetOrgPerson&quot;,
                userNameAttribute: &quot;uid&quot;,
                userNameSearchFilter: &quot;(&amp;(objectClass=inetOrgPerson)(uid=?))&quot;,
                userNameListFilter: &quot;(objectClass=inetOrgPerson)&quot;,
                groupSearchBase: [&quot;ou=Groups,dc=avix,dc=lk&quot;],
                groupEntryObjectClass: &quot;groupOfNames&quot;,
                groupNameAttribute: &quot;cn&quot;,
                groupNameSearchFilter: &quot;(&amp;(objectClass=groupOfNames)(cn=?))&quot;,
                groupNameListFilter: &quot;(objectClass=groupOfNames)&quot;,
                membershipAttribute: &quot;member&quot;,
                userRolesCacheEnabled: true,
                connectionPoolingEnabled: false,
                connectionTimeout: 5,
                readTimeout: 60
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /foo on securedEP {

    // It is optional to override the authentication and authorization
    // configurations at the resource levels. Otherwise, the service auth
    // configurations will be applied automatically to the resources as well.
    resource function get bar() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-137"><a class="header" href="#output-137">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run http_service_basic_auth_ldap_user_store.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---jwt-auth"><a class="header" href="#service---jwt-auth">Service - JWT Auth</a></h1>
<p>An HTTP service/resource can be secured using JWT and by enforcing
authorization optionally. Then, it validates the JWT sent in the
<code>Authorization</code> header against the provided configurations.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s). The scope can be included
in the JWT using a custom claim attribute. That custom claim attribute
also can be configured as the <code>scopeKey</code>.<br/>
In the authorization phase, the scopes of the service/resource are compared
against the scope included in the JWT for at least one match between the two
sets.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/jwt/latest/">JWT module</a>.</p>
<pre><code class="language-go">import ballerina/http;

listener http:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with JWT authentication and can be authorized
// optionally. JWT authentication can be enabled by setting the
// [`http:JwtValidatorConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/JwtValidatorConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@http:ServiceConfig {
    auth: [
        {
            jwtValidatorConfig: {
                issuer: &quot;wso2&quot;,
                audience: &quot;ballerina&quot;,
                signatureConfig: {
                    certFile: &quot;../resource/path/to/public.crt&quot;
                },
                scopeKey: &quot;scp&quot;
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /foo on securedEP {

    // It is optional to override the authentication and authorization
    // configurations at the resource levels. Otherwise, the service auth
    // configurations will be applied automatically to the resources as well.
    resource function get bar() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-138"><a class="header" href="#output-138">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run http_service_jwt_auth.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---oauth2"><a class="header" href="#service---oauth2">Service - OAuth2</a></h1>
<p>An HTTP service/resource can be secured using OAuth2 and by enforcing
authorization optionally. Then, it validates the OAuth2 token sent in the
<code>Authorization</code> header against the provided configurations. This calls the
configured introspection endpoint to validate.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s). The scope can be included
in the introspection response using a custom claim attribute. That custom
claim attribute also can be configured as the <code>scopeKey</code>.<br/>
In the authorization phase, the scopes of the service/resource are compared
against the scope included in the introspection response for at least one
match between the two sets.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/http;

listener http:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with OAuth2 authentication and can be authorized
// optionally. OAuth2 authentication can be enabled by setting the
// [`http:OAuth2IntrospectionConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/OAuth2IntrospectionConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@http:ServiceConfig {
    auth: [
        {
            oauth2IntrospectionConfig: {
                url: &quot;https://localhost:9445/oauth2/introspect&quot;,
                tokenTypeHint: &quot;access_token&quot;,
                scopeKey: &quot;scp&quot;,
                clientConfig: {
                    customHeaders: {&quot;Authorization&quot;: &quot;Basic YWRtaW46YWRtaW4=&quot;},
                    secureSocket: {
                        cert: &quot;../resource/path/to/public.crt&quot;
                    }
                }
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /foo on securedEP {

    // It is optional to override the authentication and authorization
    // configurations at the resource levels. Otherwise, the service auth
    // configurations will be applied automatically to the resources as well.
    resource function get bar() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-139"><a class="header" href="#output-139">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run http_service_oauth2.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---ssltls"><a class="header" href="#client---ssltls">Client - SSL/TLS</a></h1>
<p>You can use the HTTPS client to connect or interact with an HTTPS listener.
Provide the <code>http:ClientSecureSocket</code> configurations to the client to
initiate an HTTPS connection.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// An HTTP client can be configured to communicate through HTTPS as well.
// To secure a client using HTTPS, the client needs to be configured with
// a certificate file of the listener.
// The [`http:ClientSecureSocket`](https://docs.central.ballerina.io/ballerina/http/latest/records/ClientSecureSocket) record
// provides the SSL-related configurations of the client.
http:Client securedEP = check new(&quot;https://localhost:9090&quot;,
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string response = check securedEP-&gt;get(&quot;/foo/bar&quot;);
    io:println(response);
}
</code></pre>
<h4 id="output-140"><a class="header" href="#output-140">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with SSL.
# You may need to change the trusted certificate file path.
bal run http_client_ssl_tls.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---mutual-ssl"><a class="header" href="#client---mutual-ssl">Client - Mutual SSL</a></h1>
<p>Ballerina supports mutual SSL, which is a certificate-based authentication
process in which two parties (the client and server) authenticate each other by
verifying the digital certificates. It ensures that both parties are assured
of each other's identity.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// An HTTP client can be configured to initiate new connections that are
// secured via mutual SSL.
// The [`http:ClientSecureSocket`](https://docs.central.ballerina.io/ballerina/http/latest/records/ClientSecureSocket) record provides the SSL-related configurations.
http:Client securedEP = check new(&quot;https://localhost:9090&quot;,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        },
        cert: &quot;../resource/path/to/public.crt&quot;,
        protocol: {
            name: http:TLS
        },
        ciphers: [&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;]

    }
);

public function main() returns error? {
    string response = check securedEP-&gt;get(&quot;/foo/bar&quot;);
    io:println(response);
}
</code></pre>
<h4 id="output-141"><a class="header" href="#output-141">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with mutual SSL.
# You may need to change the certificate file path, private key file path, and
# trusted certificate file path.
bal run http_client_mutual_ssl.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---basic-auth"><a class="header" href="#client---basic-auth">Client - Basic Auth</a></h1>
<p>A client, which is secured with Basic auth can be used to connect to
a secured service.<br/>
The client is enriched with the <code>Authorization: Basic &lt;token&gt;</code> header by
passing the <code>http:CredentialsConfig</code> for the <code>auth</code> configuration of the
client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// Defines the HTTP client to call the Basic auth secured APIs.
// The client is enriched with the `Authorization: Basic &lt;token&gt;` header by
// passing the [`http:CredentialsConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/CredentialsConfig) for the `auth` configuration of the
// client.
http:Client securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        username: &quot;ldclakmal&quot;,
        password: &quot;ldclakmal@123&quot;
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string response = check securedEP-&gt;get(&quot;/foo/bar&quot;);
    io:println(response);
}
</code></pre>
<h4 id="output-142"><a class="header" href="#output-142">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with Basic Auth.
# You may need to change the trusted certificate file path.
bal run http_client_basic_auth.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---bearer-token-auth"><a class="header" href="#client---bearer-token-auth">Client - Bearer Token Auth</a></h1>
<p>A client, which is secured with Bearer token auth can be used to connect to
a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>http:BearerTokenConfig</code> for the <code>auth</code> configuration of the
client.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// Defines the HTTP client to call the secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`http:BearerTokenConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/BearerTokenConfig) for the `auth` configuration of the
// client.
http:Client securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        token: &quot;56ede317-4511-44b4-8579-a08f094ee8c5&quot;
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string response = check securedEP-&gt;get(&quot;/foo/bar&quot;);
    io:println(response);
}
</code></pre>
<h4 id="output-143"><a class="header" href="#output-143">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a secured sample service.
# You may need to change the trusted certificate file path.
bal run http_client_bearer_token_auth.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---self-signed-jwt-auth"><a class="header" href="#client---self-signed-jwt-auth">Client - Self Signed JWT Auth</a></h1>
<p>A client, which is secured with self-signed JWT can be used to connect to
a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>http:JwtIssuerConfig</code> to the <code>auth</code> configuration of the
client. A self-signed JWT is issued before the request is sent.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// Defines the HTTP client to call the JWT auth secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`http:JwtIssuerConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/JwtIssuerConfig) for the `auth` configuration of the
// client. A self-signed JWT is issued before the request is sent.
http:Client securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        username: &quot;ballerina&quot;,
        issuer: &quot;wso2&quot;,
        audience: [&quot;ballerina&quot;, &quot;ballerina.org&quot;, &quot;ballerina.io&quot;],
        keyId: &quot;5a0b754-895f-4279-8843-b745e11a57e9&quot;,
        jwtId: &quot;JlbmMiOiJBMTI4Q0JDLUhTMjU2In&quot;,
        customClaims: { &quot;scp&quot;: &quot;admin&quot; },
        expTime: 3600,
        signatureConfig: {
            config: {
                keyFile: &quot;../resource/path/to/private.key&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string response = check securedEP-&gt;get(&quot;/foo/bar&quot;);
    io:println(response);
}
</code></pre>
<h4 id="output-144"><a class="header" href="#output-144">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with OAuth2.
# You may need to change the trusted certificate file path and private key file path.
bal run http_client_self_signed_jwt_auth.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-client-credentials-grant-type"><a class="header" href="#client---oauth2-client-credentials-grant-type">Client - OAuth2 Client Credentials Grant Type</a></h1>
<p>A client, which is secured with OAuth2 client credentials grant type
can be used to connect to a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>http:OAuth2ClientCredentialsGrantConfig</code> for the <code>auth</code>
configuration of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// Defines the HTTP client to call the OAuth2 secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`http:OAuth2ClientCredentialsGrantConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/OAuth2ClientCredentialsGrantConfig) for the `auth` configuration
// of the client.
http:Client securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        tokenUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string response = check securedEP-&gt;get(&quot;/foo/bar&quot;);
    io:println(response);
}
</code></pre>
<h4 id="output-145"><a class="header" href="#output-145">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with OAuth2.
# You may need to change the trusted certificate file path.
bal run http_client_oauth2_client_credentials_grant_type.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-password-grant-type"><a class="header" href="#client---oauth2-password-grant-type">Client - OAuth2 Password Grant Type</a></h1>
<p>A client, which is secured with OAuth2 password grant type can be used to
connect to a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>http:OAuth2PasswordGrantConfig</code> to the <code>auth</code> configuration of
the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// Defines the HTTP client to call the OAuth2 secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`http:OAuth2PasswordGrantConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/OAuth2PasswordGrantConfig) to the `auth` configuration of the
// client.
http:Client securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        tokenUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        username: &quot;admin&quot;,
        password: &quot;admin&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        refreshConfig: {
            refreshUrl: &quot;https://localhost:9445/oauth2/token&quot;,
            scopes: [&quot;hello&quot;],
            clientConfig: {
                secureSocket: {
                    cert: &quot;../resource/path/to/public.crt&quot;
                }
            }
        },
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string response = check securedEP-&gt;get(&quot;/foo/bar&quot;);
    io:println(response);
}
</code></pre>
<h4 id="output-146"><a class="header" href="#output-146">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with OAuth2.
# You may need to change the trusted certificate file path.
bal run http_client_oauth2_password_grant_type.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-refresh-token-grant-type"><a class="header" href="#client---oauth2-refresh-token-grant-type">Client - OAuth2 Refresh Token Grant Type</a></h1>
<p>A client, which is secured with an OAuth2 refresh token grant type can be
used to connect to a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>http:OAuth2RefreshTokenGrantConfig</code> to the <code>auth</code>
configuration of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// Defines the HTTP client to call the OAuth2 secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`http:OAuth2RefreshTokenGrantConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/OAuth2RefreshTokenGrantConfig) for the `auth` configuration of the
// client.
http:Client securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        refreshUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        refreshToken: &quot;24f19603-8565-4b5f-a036-88a945e1f272&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string response = check securedEP-&gt;get(&quot;/foo/bar&quot;);
    io:println(response);
}
</code></pre>
<h4 id="output-147"><a class="header" href="#output-147">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with OAuth2.
# You may need to change the trusted certificate file path.
bal run http_client_oauth2_refresh_token_grant_type.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-jwt-bearer-grant-type"><a class="header" href="#client---oauth2-jwt-bearer-grant-type">Client - OAuth2 JWT Bearer Grant Type</a></h1>
<p>A client, which is secured with an OAuth2 JWT bearer grant type can be
used to connect to a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>http:OAuth2JwtBearerGrantConfig</code> to the <code>auth</code>
configuration of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// Defines the HTTP client to call the OAuth2 secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`http:OAuth2JwtBearerGrantConfig`](https://docs.central.ballerina.io/ballerina/http/latest/records/OAuth2JwtBearerGrantConfig) for the `auth` configuration of the
// client.
http:Client securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        tokenUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        assertion: &quot;eyJhbGciOiJFUzI1NiIsImtpZCI6Ij[...omitted for brevity...]&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string response = check securedEP-&gt;get(&quot;/foo/bar&quot;);
    io:println(response);
}
</code></pre>
<h4 id="output-148"><a class="header" href="#output-148">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with OAuth2.
# You may need to change the trusted certificate file path.
bal run http_client_oauth2_jwt_bearer_grant_type.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rest-api-advanced"><a class="header" href="#rest-api-advanced">REST API Advanced</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="redirects"><a class="header" href="#redirects">Redirects</a></h1>
<p>This example demonstrates an HTTP redirect. 
To follow redirects when calling an external HTTP server using the Ballerina HTTP client connector, set <code>followRedirect</code>
to true.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// Creates an HTTP client to interact with a remote endpoint.
// [followRedirects](https://docs.central.ballerina.io/ballerina/http/latest/records/FollowRedirects) record provides configurations associated with HTTP redirects.
http:Client clientEndpoint = check new (&quot;http://localhost:9092&quot;, {
        followRedirects: {enabled: true, maxCount: 5}
    }
);

service / on new http:Listener(9090) {

    resource function get hello() returns string|error {
        // Sends a `GET` request to the specified endpoint and Retrieved the text payload from the response.
        string returnResult = check clientEndpoint-&gt;get(&quot;/redirect1&quot;);
        return &quot;Response received : &quot; + returnResult;
    }
}

service / on new http:Listener(9092) {

    resource function get redirect1(http:Caller caller) returns error? {
        http:Response res = new;
        // Sends a redirect response with a location.
        check caller-&gt;redirect(res,
            http:REDIRECT_TEMPORARY_REDIRECT_307,
            [&quot;http://localhost:9093/redirect2&quot;]);
    }
}

service /redirect2 on new http:Listener(9093) {

    resource function get .() returns string {
        // Sends a response to the caller.
        return &quot;Hello World!&quot;;
    }
}
</code></pre>
<h4 id="output-149"><a class="header" href="#output-149">Output</a></h4>
<pre><code class="language-bash"># Invoke the service using the &quot;cURL&quot; command below.
curl -v http://localhost:9090/hello/
*   Trying 127.0.0.1:9090...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 9090 (#0)
&gt; GET /hello/ HTTP/1.1
&gt; Host: localhost:9090
&gt; User-Agent: curl/7.68.0
&gt; Accept: */*
&gt; 
* Mark bundle as not supporting multiuse
&lt; HTTP/1.1 200 OK
&lt; content-type: text/plain
&lt; content-length: 32
&lt; server: ballerina
&lt; date: Wed, 2 Jun 2021 11:03:08 +0530
&lt; 
* Connection #0 to host localhost left intact
Response received : Hello World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cors"><a class="header" href="#cors">CORS</a></h1>
<p>This sample demonstrates the Ballerina server connector CORS configuration.
CORS headers can be applied in both the service-level and the resource-level. Service-level CORS headers apply to all the resources
unless there are headers configured at the resource-level. Ballerina CORS supports both simple and pre-flight requests.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// Service-level [CORS config](https://docs.central.ballerina.io/ballerina/http/latest/records/CorsConfig) applies
// globally to each `resource`.
@http:ServiceConfig {
    cors: {
        allowOrigins: [&quot;http://www.m3.com&quot;, &quot;http://www.hello.com&quot;],
        allowCredentials: false,
        allowHeaders: [&quot;CORELATION_ID&quot;],
        exposeHeaders: [&quot;X-CUSTOM-HEADER&quot;],
        maxAge: 84900
    }
}
service /crossOriginService on new http:Listener(9092) {

    // Resource-level [CORS config](https://docs.central.ballerina.io/ballerina/http/latest/records/CorsConfig)
    // overrides the service-level CORS headers.
    @http:ResourceConfig {
        cors: {
            allowOrigins: [&quot;http://www.bbc.com&quot;],
            allowCredentials: true,
            allowHeaders: [&quot;X-Content-Type-Options&quot;, &quot;X-PINGOTHER&quot;]
        }
    }
    resource function get company() returns json {
        return {&quot;type&quot;: &quot;middleware&quot;};
    }

    // Since there are no resource-level CORS configs defined here, the global
    // service-level CORS configs will be applied to this resource.
    resource function post lang() returns json {
        return {&quot;lang&quot;: &quot;Ballerina&quot;};
    }
}
</code></pre>
<h4 id="output-150"><a class="header" href="#output-150">Output</a></h4>
<pre><code class="language-bash"># Run the cURL command below to send a CORS simple request. 
curl -v &quot;http://localhost:9092/crossOriginService/company&quot; -H &quot;Origin:http://www.bbc.com&quot;
&gt; GET /crossOriginService/company HTTP/1.1
&gt; Host: localhost:9092
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt; Origin:http://www.bbc.com
&gt;
&lt; HTTP/1.1 200 OK
&lt; content-type: application/json
&lt; access-control-allow-origin: http://www.bbc.com
&lt; access-control-allow-credentials: true
&lt; content-length: 21
&lt; server: ballerina
&lt;
* Connection #0 to host localhost left intact
{&quot;type&quot;:&quot;middleware&quot;}* Closing connection 0

# Run the cURL command below to send a CORS preflight request. 
curl -v &quot;http://localhost:9092/crossOriginService/lang&quot; -X OPTIONS -H &quot;Origin:http://www.m3.com&quot; -H &quot;Access-Control-Request-Method:POST&quot;
&gt; OPTIONS /crossOriginService/lang HTTP/1.1
&gt; Host: localhost:9092
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt; Origin:http://www.m3.com
&gt; Access-Control-Request-Method:POST
&gt;
&lt; HTTP/1.1 204 No Content
&lt; access-control-allow-origin: http://www.m3.com
&lt; access-control-max-age: 84900
&lt; access-control-allow-methods: POST
&lt; content-length: 0
&lt; server: ballerina
&lt;
* Connection #0 to host localhost left intact
* Closing connection 0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="100-continue"><a class="header" href="#100-continue">100 Continue</a></h1>
<p>Convenience functions are provided in the HTTP library for ease of use when handling 100-continue scenarios. 
100-continue indicates that the server has received the request headers and the client can proceed with sending the request.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/log;

service / on new http:Listener(9090) {

    resource function 'default hello(http:Caller caller, http:Request request)
            returns error? {
        // [Check if the client expects a 100-continue response](https://docs.central.ballerina.io/ballerina/http/latest/classes/Request#expects100Continue).
        if (request.expects100Continue()) {
            string mediaType = request.getContentType();
            if (mediaType.toLowerAscii() == &quot;text/plain&quot;) {

                // Send a 100-continue response to the client.
                var result = caller-&gt;continue();
                if (result is error) {
                    log:printError(&quot;Error sending response&quot;, 'error = result);
                }

            // Send a 417 response to ignore the payload since content type is mismatched
            // with the expected content type.
            } else {
                http:Response resp = new;
                resp.statusCode = http:STATUS_EXPECTATION_FAILED;
                resp.setPayload(&quot;Unprocessable Entity&quot;);
                check caller-&gt;respond(resp);
            }
        }

        // The client starts sending the payload once it receives the
        // 100-continue response. Retrieve the payload that is sent by the client.
        var payload = request.getTextPayload();
        if (payload is string) {
            log:printInfo(payload);
            check caller-&gt;respond(&quot;Hello World!\n&quot;);
        } else {
            http:Response resp = new;
            resp.statusCode = http:STATUS_INTERNAL_SERVER_ERROR;
            resp.setPayload(payload.message());
            check caller-&gt;respond(resp);
        }
    }
}
</code></pre>
<h4 id="output-151"><a class="header" href="#output-151">Output</a></h4>
<pre><code class="language-bash">bal run http_expect_header.bal
time = 2021-01-21 20:31:28,347 level = INFO  module = &quot;&quot; message = &quot;TEST 100 CONTINUE&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="streaming"><a class="header" href="#streaming">Streaming</a></h1>
<p>Ballerina supports HTTP input and output streaming capability based on the Ballerina <code>stream</code> type.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;
import ballerina/mime;

// Creates an endpoint for the [client](https://docs.central.ballerina.io/ballerina/http/latest/clients/Client).
http:Client clientEndpoint = check new (&quot;http://localhost:9090&quot;);

service /'stream on new http:Listener(9090) {

    resource function get fileupload() returns http:Response|error? {
        http:Request request = new;

        //[Sets the file](https://docs.central.ballerina.io/ballerina/http/latest/classes/Request#setFileAsPayload) as the request payload.
        request.setFileAsPayload(&quot;./files/BallerinaLang.pdf&quot;,
            contentType = mime:APPLICATION_PDF);

        //Sends the request to the client with the file content.
        http:Response clientResponse =
            check clientEndpoint-&gt;post(&quot;/stream/receiver&quot;, request);

        // forward received response to caller
        return clientResponse;
    }

    resource function post receiver(http:Caller caller,
                                    http:Request request) returns error? {
        //[Retrieve the byte stream](https://docs.central.ballerina.io/ballerina/http/latest/classes/Request#getByteStream).
        stream&lt;byte[], io:Error?&gt; streamer = check request.getByteStream();

        //Writes the incoming stream to a file using `io:fileWriteBlocksFromStream` API by providing the file location to which the content should be written to.
        check io:fileWriteBlocksFromStream(
                                    &quot;./files/ReceivedFile.pdf&quot;, streamer);
        check streamer.close();
        check caller-&gt;respond(&quot;File Received!&quot;);
    }
}
</code></pre>
<h4 id="output-152"><a class="header" href="#output-152">Output</a></h4>
<pre><code class="language-bash">#Send a request to the streaming service.
curl -X GET http://localhost:9090/stream/fileupload
File Received!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compression"><a class="header" href="#compression">Compression</a></h1>
<p>This sample demonstrates how the Ballerina HTTP service is configured to change the compression behaviour. By default, the server
compresses the response entity body with the scheme(gzip, deflate) that is specified in the Accept-Encoding request header. When
the particular header is not present or the header value is &quot;identity&quot;, the server does not perform any compression. Compression
is disabled when the option is set to <code>COMPRESSION_NEVER</code> and always enabled when the option is set to <code>COMPRESSION_ALWAYS</code><br/><br/>
In the same way <code>http:Client</code> can be configured as well. For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// [COMPRESSION_ALWAYS](https://docs.central.ballerina.io/ballerina/http/latest/constants#COMPRESSION_ALWAYS)
// guarantees a compressed response entity body. Compression scheme is set to the
// value indicated in Accept-Encoding request header. When a particular header is not present or the header
// value is &quot;identity&quot;, encoding is done using the &quot;gzip&quot; scheme.
// By default, Ballerina compresses any MIME type unless they are mentioned under `contentTypes`.
// Compression can be constrained to certain MIME types by specifying them as an array of MIME types.
// In this example encoding is applied to &quot;text/plain&quot; responses only.
@http:ServiceConfig {
    compression: {
        enable: http:COMPRESSION_ALWAYS,
        contentTypes: [&quot;text/plain&quot;]
    }
}
service / on new http:Listener(9090) {

    // The response entity body is always compressed since MIME type has matched.
    resource function 'default alwaysCompress() returns string {
        return &quot;Type : This is a string&quot;;
    }
}
</code></pre>
<h4 id="output-153"><a class="header" href="#output-153">Output</a></h4>
<pre><code class="language-bash">bal run http_compression.bal
ballerina: started HTTP/WS listener 0.0.0.0:9092
ballerina: started HTTP/WS listener 0.0.0.0:9090
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="trace-logs"><a class="header" href="#trace-logs">Trace logs</a></h1>
<p>The HTTP trace logs can be used to monitor the HTTP traffic that goes in and out of Ballerina.
To enable trace logs, the log level has to be set to <code>TRACE</code> using the runtime argument:
<br> <code>-Cballerina.http.traceLogConsole=true</code>. <br>
The configurations can be set in the <code>Config.toml</code> file for advanced use cases such as specifying the file path
to save the trace logs and specifying the hostname and port of a socket service to publish the trace logs.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

service /hello on new http:Listener(9090) {

    resource function get .(http:Request req) returns http:Response|error {
        http:Client clientEP = check new (&quot;https://httpstat.us&quot;);
        http:Response resp = check clientEP-&gt;forward(&quot;/200&quot;, req);
        return resp;
    }
}
</code></pre>
<h4 id="output-154"><a class="header" href="#output-154">Output</a></h4>
<pre><code class="language-bash"># Invoke the service.
curl http://localhost:9090/hello
200 OK
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="access-logs"><a class="header" href="#access-logs">Access logs</a></h1>
<p>Ballerina supports HTTP access logs for HTTP services. The access log format used is the combined log format.
To enable access logs, set <code>console=true</code> under the <code>ballerina.http.accessLogConfig</code> in the <code>Config.toml</code> file.
Also, the <code>path</code> field can be used to specify the file path to save the access logs.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

service / on new http:Listener(9095) {

    resource function get hello() returns string {
        return &quot;Successful&quot;;
    }
}
</code></pre>
<h4 id="output-155"><a class="header" href="#output-155">Output</a></h4>
<pre><code class="language-bash"># Invoke the service.
curl http://localhost:9095/hello
Successful
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cookies"><a class="header" href="#cookies">Cookies</a></h1>
<p>This example demonstrates how to handle HTTP cookies in a Ballerina service and client.
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

listener http:Listener serverEP = new (9095);

service /cookieDemo on serverEP {

    resource function post login(http:Request req)
            returns http:Response|http:BadRequest {
        // Retrieve the JSON payload from the request as it
        // contains the login details of a user.
        json|error details = req.getJsonPayload();

        if (details is json) {
            // Retrieve the username and password.
            json|error name = details.name;
            json|error password = details.password;

            if (name is json &amp;&amp; password is json) {
                // Check the password value.
                if (password == &quot;p@ssw0rd&quot;) {

                    // [Create a new cookie](https://docs.central.ballerina.io/ballerina/http/latest/classes/Cookie)
                    // by setting `name` as the `username` and `value` as the logged-in user's name. Set the cookies
                    // path as `/` to apply it to all the resources in the service.
                    http:Cookie cookie = new(&quot;username&quot;, name.toString(),
                                                path = &quot;/&quot;);

                    http:Response response = new;

                    // [Add the created cookie to the response](https://docs.central.ballerina.io/ballerina/http/latest/classes/Response#addCookie).
                    response.addCookie(cookie);

                    // Set a message payload to inform that the login has
                    // been succeeded.
                    response.setTextPayload(&quot;Login succeeded&quot;);
                    return response;
                }
            }
        }
        return {body: &quot;Invalid request payload&quot;};
    }

    resource function get welcome(http:Request req) returns string {
        // [Retrieve cookies from the request](https://docs.central.ballerina.io/ballerina/http/latest/classes/Request#getCookies).
        http:Cookie[] cookies = req.getCookies();

        // Get the cookie value of the `username`.
        http:Cookie[] usernameCookie = cookies.filter(function
                                (http:Cookie cookie) returns boolean {
            return cookie.name == &quot;username&quot;;
        });

        if (usernameCookie.length() &gt; 0) {
            string? user = usernameCookie[0].value;
            if (user is string) {
                // Respond with the username added to the welcome message.
                return &quot;Welcome back &quot; + user;

            } else {
                // If the user is `nil`, send a login message.
                return &quot;Please login&quot;;
            }
        } else {
            // If the `username` cookie is not presented, send a login message.
            return &quot;Please login&quot;;
        }
    }
}
</code></pre>
<h4 id="output-156"><a class="header" href="#output-156">Output</a></h4>
<pre><code class="language-bash">bal run cookie_server.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chunking"><a class="header" href="#chunking">Chunking</a></h1>
<p>This sample demonstrates how to configure the chunking behavior of an <code>http:Client</code>. By default, the HTTP client sends messages with the <code>content-length</code> header.
If the message size is larger than the buffer size (8K), messages are chunked. Chunking can be disabled using the client options.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// The HTTP client's chunking behavior can be configured as [CHUNKING_AUTO](https://docs.central.ballerina.io/ballerina/http/latest/constants#CHUNKING_AUTO),
// [CHUNKING_ALWAYS](https://docs.central.ballerina.io/ballerina/http/latest/constants#CHUNKING_ALWAYS),
// or [CHUNKING_NEVER](https://docs.central.ballerina.io/ballerina/http/latest/constants#CHUNKING_NEVER).
// In this example, it is set to `CHUNKING_NEVER`, which means that chunking never happens irrespective of the request size. 
// When chunking is set to `CHUNKING_AUTO`, chunking is done based on the request.
// [http1Settings](https://docs.central.ballerina.io/ballerina/http/latest/records/ClientHttp1Settings) annotation
// provides the chunking-related configurations.
final http:Client clientEndpoint = check new (&quot;http://localhost:9090&quot;,
                        {http1Settings: {chunking: http:CHUNKING_NEVER}});

service / on new http:Listener(9092) {
    resource function get chunkingSample() returns json|error {
        //Invoke endpoint along with a JSON payload.
        json clientResponse =
            check clientEndpoint-&gt;post(&quot;/echo&quot;, {&quot;name&quot;: &quot;Ballerina&quot;});
        return clientResponse;
    }
}

// A sample backend, which responds according to the chunking behavior.
service / on new http:Listener(9090) {
    resource function post echo(@http:Header{name:&quot;Content-length&quot;} string cLen)
             returns json {
        //Set the response with the content length.
        string value = &quot;Length-&quot; + cLen;
        return {&quot;Outbound request content&quot;: value};
    }
}
</code></pre>
<h4 id="output-157"><a class="header" href="#output-157">Output</a></h4>
<pre><code class="language-bash">bal run http_disable_chunking.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="response-with-multiparts"><a class="header" href="#response-with-multiparts">Response With Multiparts</a></h1>
<p>Ballerina supports encoding and decoding multipart content in HTTP responses along with the nested parts.
When you request multiparts from an HTTP inbound response, you get an array of the parts of the body (an array of
entities). If the received parts contain nested parts, you can loop through the parent parts and get the child parts.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/mime/latest/">Mime module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;
import ballerina/log;
import ballerina/mime;

// Creates an endpoint for the client.
http:Client clientEP = check new (&quot;http://localhost:9092&quot;);

service /multiparts on new http:Listener(9092) {

    resource function get encode_out_response() returns http:Response {
        // Creates an enclosing entity to hold the child parts.
        mime:Entity parentPart = new;

        // Creates a child part with the JSON content.
        mime:Entity childPart1 = new;
        childPart1.setJson({&quot;name&quot;: &quot;wso2&quot;});
        // Creates another child part with a file.
        mime:Entity childPart2 = new;
        // This file path is relative to where the Ballerina is running.
        //If your file is located outside, please give the
        //absolute file path instead.
        childPart2.setFileAsEntityBody(&quot;./files/test.xml&quot;,
            contentType = mime:TEXT_XML);
        // Creates an array to hold the child parts.
        mime:Entity[] childParts = [childPart1, childPart2];
        // [Sets the child parts to the parent part](https://docs.central.ballerina.io/ballerina/mime/latest/classes/Entity#setBodyParts).
        parentPart.setBodyParts(childParts,
            contentType = mime:MULTIPART_MIXED);
        // Creates an array to hold the parent part and set it to the response.
        mime:Entity[] immediatePartsToResponse = [parentPart];
        http:Response outResponse = new;
        outResponse.setBodyParts(immediatePartsToResponse,
            contentType = mime:MULTIPART_FORM_DATA);
        return outResponse;
    }
}

// Binds the listener to the service.
service /multiparts on new http:Listener(9090) {

    // This resource accepts multipart responses.
    resource function get decode_in_response()
            returns string|http:InternalServerError {
        http:Response|error returnResult = clientEP-&gt;get(
                        &quot;/multiparts/encode_out_response&quot;);
        if (returnResult is http:Response) {
            // [Extracts the body parts](https://docs.central.ballerina.io/ballerina/http/latest/classes/Response#getBodyParts)  from the response.
            var parentParts = returnResult.getBodyParts();
            if (parentParts is mime:Entity[]) {
                //Loops through body parts.
                foreach var parentPart in parentParts {
                    handleNestedParts(parentPart);
                }
                return &quot;Body Parts Received!&quot;;
            } else {
                return { body: &quot;Invalid payload&quot;};
            }
        } else {
            return { body: &quot;Connection error&quot;};
        }
    }
}

// Gets the child parts that are nested within the parent.
function handleNestedParts(mime:Entity parentPart) {
    string contentTypeOfParent = parentPart.getContentType();
    if (contentTypeOfParent.startsWith(&quot;multipart/&quot;)) {
        var childParts = parentPart.getBodyParts();
        if (childParts is mime:Entity[]) {
            log:printInfo(&quot;Nested Parts Detected!&quot;);
            foreach var childPart in childParts {
                handleContent(childPart);
            }
        } else {
            log:printError(&quot;Error retrieving child parts! &quot; +
                            childParts.message());
        }
    }
}

//The content logic that handles the body parts
//vary based on your requirement.
function handleContent(mime:Entity bodyPart) {
    string baseType = getBaseType(bodyPart.getContentType());
    if (mime:APPLICATION_XML == baseType || mime:TEXT_XML == baseType) {
        // [Extracts XML data](https://docs.central.ballerina.io/ballerina/mime/latest/classes/Entity#getXml) from the body part.
        var payload = bodyPart.getXml();
        if (payload is xml) {
             log:printInfo(&quot;XML data: &quot; + payload.toString());
        } else {
             log:printError(&quot;Error in parsing XML data&quot;, 'error = payload);
        }
    } else if (mime:APPLICATION_JSON == baseType) {
        // [Extracts JSON data](https://docs.central.ballerina.io/ballerina/mime/latest/classes/Entity#getJson) from the body part.
        var payload = bodyPart.getJson();
        if (payload is json) {
            log:printInfo(&quot;JSON data: &quot; + payload.toJsonString());
        } else {
             log:printError(&quot;Error in parsing JSON data&quot;, 'error = payload);
        }
    } else if (mime:TEXT_PLAIN == baseType) {
        // [Extracts text data](https://docs.central.ballerina.io/ballerina/mime/latest/classes/Entity#getText) from the body part.
        var payload = bodyPart.getText();
        if (payload is string) {
            log:printInfo(&quot;Text data: &quot; + payload);
        } else {
            log:printError(&quot;Error in parsing text data&quot;, 'error = payload);
        }
    } else if (mime:APPLICATION_PDF == baseType) {
        // [Extracts the byte stream](https://docs.central.ballerina.io/ballerina/http/latest/classes/Response#getByteStream) from the body part and saves it as a file.
        var payload = bodyPart.getByteStream();
        if (payload is stream&lt;byte[], io:Error?&gt;) {
            //Writes the incoming stream to a file using `io:fileWriteBlocksFromStream` API by providing the file location to which the content should be written to.
            io:Error? result = io:fileWriteBlocksFromStream(
                                    &quot;./files/ReceivedFile.pdf&quot;, payload);

            if (result is error) {
                log:printError(&quot;Error occurred while writing &quot;,
                                'error = result);
            }
            close(payload);
        } else {
            log:printError(&quot;Error in parsing byte channel :&quot;,
                            'error = payload);
        }
    }
}

//Gets the base type from a given content type.
function getBaseType(string contentType) returns string {
    var result = mime:getMediaType(contentType);
    if (result is mime:MediaType) {
        return result.getBaseType();
    } else {
        panic result;
    }
}

//Closes the byte stream.
function close(stream&lt;byte[], io:Error?&gt; byteStream) {
    var cr = byteStream.close();
    if (cr is error) {
        log:printError(&quot;Error occurred while closing the stream: &quot;,
                       'error = cr);
    }
}
</code></pre>
<h4 id="output-158"><a class="header" href="#output-158">Output</a></h4>
<pre><code class="language-bash"># In the directory, which contains the `.bal` file, create a directory named `files`,
# and add an XML file named `test.xml` in it.
bal run response_with_multiparts.bal
time = 2021-01-21 22:20:38,143 level = INFO  module = &quot;&quot; message = &quot;Nested Parts Detected!&quot; 
time = 2021-01-21 22:20:38,185 level = INFO  module = &quot;&quot; message = &quot;JSON data: {&quot;name&quot;:&quot;wso2&quot;}&quot; 
time = 2021-01-21 22:20:38,324 level = INFO  module = &quot;&quot; message = &quot;XML data: &lt;ballerinalang&gt;
    &lt;version&gt;0.963&lt;/version&gt;
    &lt;test&gt;test xml file to be used as a file part&lt;/test&gt;
&lt;/ballerinalang&gt;&quot; 
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="request-with-multiparts"><a class="header" href="#request-with-multiparts">Request With Multiparts</a></h1>
<p>Ballerina supports encoding and decoding multipart content in http requests along with nested parts.
When you request multiparts from the HTTP inbound request, you get an array of body parts (an array of entities).
You can loop through this array and handle the received body parts according to your requirement.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/mime/latest/">Mime module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/log;
import ballerina/mime;

http:Client clientEP = check new (&quot;http://localhost:9090&quot;);

//Binds the listener to the service.
service /multiparts on new http:Listener(9090) {

    resource function post decode(http:Request request)
            returns http:Response|http:InternalServerError{
        http:Response response = new;
        // [Extracts bodyparts](https://docs.central.ballerina.io/ballerina/http/latest/classes/Request#getBodyParts) from the request.
        var bodyParts = request.getBodyParts();

        if (bodyParts is mime:Entity[]) {
            foreach var part in bodyParts {
                handleContent(part);
            }
            response.setPayload(bodyParts);
            return response;
        } else {
            log:printError(bodyParts.message());
            return {body:&quot;Error in decoding multiparts!&quot;};
        }
    }

    resource function get encode(http:Request req)
            returns http:Response|http:InternalServerError {
        //Create a json body part.
        mime:Entity jsonBodyPart = new;
        jsonBodyPart.setContentDisposition(
                        getContentDispositionForFormData(&quot;json part&quot;));
        jsonBodyPart.setJson({&quot;name&quot;: &quot;wso2&quot;});
        //Create an `xml` body part as a file upload.
        mime:Entity xmlFilePart = new;
        xmlFilePart.setContentDisposition(
                       getContentDispositionForFormData(&quot;xml file part&quot;));
        // This file path is relative to where the ballerina is running.
        // If your file is located outside, please
        // give the absolute file path instead.
        xmlFilePart.setFileAsEntityBody(&quot;./files/test.xml&quot;,
                                        contentType = mime:APPLICATION_XML);
        // Create an array to hold all the body parts.
        mime:Entity[] bodyParts = [jsonBodyPart, xmlFilePart];
        http:Request request = new;
        // [Set the body parts](https://docs.central.ballerina.io/ballerina/http/latest/classes/Request#setBodyParts) to the request.
        // Here the content-type is set as multipart form data.
        // This also works with any other multipart media type.
        // eg:- `multipart/mixed`, `multipart/related` etc.
        // You need to pass the content type that suit your requirement.
        request.setBodyParts(bodyParts, contentType = mime:MULTIPART_FORM_DATA);
        http:Response|error returnResponse =
            clientEP-&gt;post(&quot;/multiparts/decode&quot;, request);
        if (returnResponse is http:Response) {
            return returnResponse;
        } else {
            return {body:&quot;Error occurred while sending multipart request!&quot;};
        }
    }
}

// The content logic that handles the body parts vary based on your requirement.
function handleContent(mime:Entity bodyPart) {
    // [Get the media type](https://docs.central.ballerina.io/ballerina/mime/latest/functions#getMediaType) from the body part retrieved from the request.
    var mediaType = mime:getMediaType(bodyPart.getContentType());
    if (mediaType is mime:MediaType) {
        string baseType = mediaType.getBaseType();
        if (mime:APPLICATION_XML == baseType || mime:TEXT_XML == baseType) {
            //[Extracts `xml` data](https://docs.central.ballerina.io/ballerina/mime/latest/classes/Entity#getXml) from the body part.
            var payload = bodyPart.getXml();
            if (payload is xml) {
                log:printInfo(payload.toString());
            } else {
                log:printError(payload.message());
            }
        } else if (mime:APPLICATION_JSON == baseType) {
            //[Extracts `json` data](https://docs.central.ballerina.io/ballerina/mime/latest/classes/Entity#getJson) from the body part.
            var payload = bodyPart.getJson();
            if (payload is json) {
                log:printInfo(payload.toJsonString());
            } else {
                log:printError(payload.message());
            }
        } else if (mime:TEXT_PLAIN == baseType) {
            //[Extracts text data](https://docs.central.ballerina.io/ballerina/mime/latest/classes/Entity#getText) from the body part.
            var payload = bodyPart.getText();
            if (payload is string) {
                log:printInfo(payload);
            } else {
                log:printError(payload.message());
            }
        }
    }
}

function getContentDispositionForFormData(string partName)
                                    returns (mime:ContentDisposition) {
    mime:ContentDisposition contentDisposition = new;
    contentDisposition.name = partName;
    contentDisposition.disposition = &quot;form-data&quot;;
    return contentDisposition;
}
</code></pre>
<h4 id="output-159"><a class="header" href="#output-159">Output</a></h4>
<pre><code class="language-bash"># Start multipartDemoService
# The cURL command, which you need to execute to decode a multipart request
curl -F &quot;part1={\&quot;name\&quot;:\&quot;ballerina\&quot;};type=application/json&quot; http://localhost:9090/multiparts/decode -H &quot;Content-Type: multipart/mixed&quot; -H 'Expect:'
--f710b4a02896b88a
content-disposition: attachment;name=&quot;part1&quot;
content-type: application/json
content-id: 0

{&quot;name&quot;:&quot;ballerina&quot;}
--f710b4a02896b88a--

# The cURL command, which you need to execute to encode the parts of the body and send a multipart request via the Ballerina service
curl -v http://localhost:9090/multiparts/encode
&gt; GET /multiparts/encode HTTP/1.1
&gt; Host: localhost:9090
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200 OK
&lt; content-type: multipart/form-data; boundary=bd7547c98465dae2
&lt; date: Wed, 23 Sep 2020 10:20:17 +0530
&lt; server: ballerina
&lt; content-length: 398
&lt;
--bd7547c98465dae2
content-disposition: form-data;name=&quot;json part&quot;
content-type: application/json
content-id: 0

{&quot;name&quot;:&quot;wso2&quot;}
--bd7547c98465dae2
content-disposition: form-data;name=&quot;xml file part&quot;
content-type: application/xml
content-id: 1

&lt;ballerinalang&gt;
    &lt;version&gt;0.963&lt;/version&gt;
    &lt;test&gt;test xml file to be used as a file part&lt;/test&gt;
&lt;/ballerinalang&gt;
--bd7547c98465dae2--
* Connection #0 to host localhost left intact
* Closing connection 0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="passthrough"><a class="header" href="#passthrough">Passthrough</a></h1>
<p>The passthrough sample exhibits the process of an HTTP client connector. The 'Echo Service' is used as a sample backend.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

http:Client clientEP = check new (&quot;http://postman-echo.com&quot;);

service / on new http:Listener(9090) {

    // The passthrough resource allows all HTTP methods as the accessor is `default`.
    resource function 'default passthrough(http:Request req)
            returns http:Response|error? {
        // When [forward()](https://docs.central.ballerina.io/ballerina/http/latest/clients/Client#forward) is called on the backend client endpoint, it forwards the request that the passthrough
        // resource received to the backend. When forwarding, the request is made using the same HTTP method that was
        // used to invoke the passthrough resource. The `forward()` function returns the response from the backend if
        // there are no errors.
        http:Response response = check clientEP-&gt;forward(&quot;/get&quot;, req);
        return response;
    }
}
</code></pre>
<h4 id="output-160"><a class="header" href="#output-160">Output</a></h4>
<pre><code class="language-bash"># To invoke the service, use the cURL commands below.
curl http://localhost:9090/passthrough
{&quot;args&quot;:{}, &quot;headers&quot;:{&quot;x-forwarded-proto&quot;:&quot;http&quot;, &quot;x-forwarded-port&quot;:&quot;80&quot;, &quot;host&quot;:&quot;postman-echo.com&quot;, &quot;x-amzn-trace-id&quot;:&quot;Root=1-60b7255d-23ce05a61ad55a0164ca19d3&quot;, &quot;accept&quot;:&quot;*/*&quot;, &quot;user-agent&quot;:&quot;ballerina&quot;}, &quot;url&quot;:&quot;http://postman-echo.com/get&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rest-api-interceptors"><a class="header" href="#rest-api-interceptors">REST API Interceptors</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="request-interceptor-at-listener-level"><a class="header" href="#request-interceptor-at-listener-level">Request Interceptor At Listener Level</a></h1>
<p>The HTTP Listener supports intercepting requests in the request path. It is possible to
define a <code>RequestInterceptor</code> service class with a resource function to execute 
custom logic and engage with an HTTP Listener. The request will go through the 
interceptor services before its dispatched to the actual resource in the target 
service. Interceptors engaged at listener level can only have default path. 
For more information, see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// Header name to be set to the request in the request interceptor.
final string interceptor_header1 = &quot;X-requestHeader1&quot;;
final string interceptor_header2 = &quot;X-requestHeader2&quot;;

// Header value to be set to the request in the request interceptor.
final string interceptor_header_value1 = &quot;RequestInterceptor1&quot;;
final string interceptor_header_value2 = &quot;RequestInterceptor2&quot;;

// A Request Interceptor service class implementation. It intercepts the request and adds a header before it is dispatched to the 
// target HTTP Resource. A Request Interceptor service class can have only one resource function.
service class RequestInterceptor1 {
    *http:RequestInterceptor;

    // A default resource function, which will be executed for all requests. A `RequestContext` is used to share data between 
    // interceptors. Resource methods are only allowed to return an `http:NextService|error?`.
    resource function 'default [string... path](http:RequestContext ctx, 
                            http:Request req) returns http:NextService|error? {
        // Sets a header to the request inside the interceptor service.
        req.setHeader(interceptor_header1, interceptor_header_value1);
        // Returns the next interceptor or the target service in the pipeline. An error is returned when the call fails.
        return ctx.next();
    }
}

// Creates a new Request Interceptor.
RequestInterceptor1 requestInterceptor1 = new;

// Another Request Interceptor service class.
service class RequestInterceptor2 {
    *http:RequestInterceptor;

    // This interceptor is only executed for GET requests with the default path. 
    resource function get [string... path](http:RequestContext ctx, 
                            http:Request req) returns http:NextService|error? {
        req.setHeader(interceptor_header2, interceptor_header_value2);
        return ctx.next();
    }
}

// Creates another new Request Interceptor.
RequestInterceptor2 requestInterceptor2 = new;

// Creates an HTTP Listener and assigns the interceptors as a config parameter. 
// Interceptor services will be executed in the configured order.
listener http:Listener interceptorListener = new http:Listener(9090, config = { 
    // Interceptor pipeline. Only interceptors with default path can be engaged 
    // at listener level.
    interceptors: [requestInterceptor1, requestInterceptor2] 
});

service / on interceptorListener {

    resource function get greeting(http:Request req) 
            returns http:Response|error? {
        // Create a new response.
        http:Response response = new;
        // Set the interceptor headers from request
        response.setHeader(interceptor_header1, 
                            check req.getHeader(interceptor_header1));
        response.setHeader(interceptor_header2, 
                            check req.getHeader(interceptor_header2));
        response.setTextPayload(&quot;Greetings!&quot;);
        return response;
    }
}
</code></pre>
<h4 id="output-161"><a class="header" href="#output-161">Output</a></h4>
<pre><code class="language-bash"># Run the service
bal run http_request_interceptor_at_listener.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="request-interceptor-at-service-level"><a class="header" href="#request-interceptor-at-service-level">Request Interceptor At Service Level</a></h1>
<p>When you want to engage a <code>RequestInterceptor</code> for a specific service path, you can engage interceptors at
the service level through the <code>ServiceConfig</code> annotation. The interceptors engaged at the service level will have the 
base path same as the target service.
For more information, see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// Header name to be set to the request in the request interceptor.
final string interceptor_header1 = &quot;X-requestHeader1&quot;;
final string interceptor_header2 = &quot;X-requestHeader2&quot;;

// Header value to be set to the request in the request interceptor.
final string interceptor_header_value1 = &quot;RequestInterceptor1&quot;;
final string interceptor_header_value2 = &quot;RequestInterceptor2&quot;;

service class RequestInterceptor1 {
    *http:RequestInterceptor;

    resource function 'default [string... path](http:RequestContext ctx, 
                            http:Request req) returns http:NextService|error? {
        // Sets a header to the request inside the interceptor service.
        req.setHeader(interceptor_header1, interceptor_header_value1);
        return ctx.next();
    }
}

RequestInterceptor1 requestInterceptor1 = new;

// Interceptor service class with specific path. This interceptor can only be engaged at service
// level.
service class RequestInterceptor2 {
    *http:RequestInterceptor;

    // This interceptor is only executed for GET requests with the relative path &quot;greeting&quot;. 
    resource function get greeting(http:RequestContext ctx, 
                            http:Request req) returns http:NextService|error? {
        req.setHeader(interceptor_header2, interceptor_header_value2);
        return ctx.next();
    }
}

RequestInterceptor2 requestInterceptor2 = new;

listener http:Listener interceptorListener = new http:Listener(9090);

// Engage interceptors at service level.
@http:ServiceConfig {
    // The base path of interceptor services is same as the target service.
    interceptors: [requestInterceptor1, requestInterceptor2]
}
service /user on interceptorListener {

    resource function get greeting(http:Request req) 
            returns http:Response|error? {
        // Create a new response.
        http:Response response = new;
        // Set the interceptor headers from request
        response.setHeader(interceptor_header1, 
                            check req.getHeader(interceptor_header1));
        response.setHeader(interceptor_header2, 
                            check req.getHeader(interceptor_header2));
        response.setTextPayload(&quot;Greetings!&quot;);
        return response;
    }
}
</code></pre>
<h4 id="output-162"><a class="header" href="#output-162">Output</a></h4>
<pre><code class="language-bash"># Invoke the service.
curl -v http://localhost:9090/user/greeting
*   Trying ::1...
* TCP_NODELAY set
* Connected to localhost (::1) port 9090 (#0)
&gt; GET /user/greeting HTTP/1.1
&gt; Host: localhost:9090
&gt; User-Agent: curl/7.64.1
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 200 OK
&lt; X-requestHeader1: RequestInterceptor1
&lt; X-requestHeader2: RequestInterceptor2
&lt; content-type: text/plain
&lt; content-length: 10
&lt; server: ballerina
&lt; date: Tue, 23 Nov 2021 17:16:16 +0530
&lt; 
* Connection #0 to host localhost left intact
Greetings!* Closing connection 0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="request-error-interceptor"><a class="header" href="#request-error-interceptor">Request Error Interceptor</a></h1>
<p>A <code>RequestErrorInterceptor</code> is used to handle the errors that occurred in the interceptor pipeline execution. 
When an error is returned from a <code>RequestInterceptor</code> service, the interceptor pipeline execution jumps to the
nearest <code>RequestErrorInterceptor</code>. However, if there is no <code>RequestErrorInterceptor</code> in the pipeline, then, 
the error response is returned to the client without executing the actual resource in the target service.
For more information, see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;

// Header name checked by the first request interceptor.
final string interceptor_check_header = &quot;X-requestCheckHeader&quot;;

// Header value to be set to the request in the request error interceptor.
final string interceptor_check_header_value = &quot;RequestErrorInterceptor&quot;;

service class RequestInterceptor1 {
    *http:RequestInterceptor;

    resource function 'default [string... path](http:RequestContext ctx, 
                            http:Request req) returns http:NextService|error? {
        io:println(&quot;Executing Request Interceptor 1&quot;);
        // Tries to read the header. This will return a `HeaderNotFoundError` if you do not set this header. Then, the execution will 
        // jump to the nearest `RequestErrorInterceptor`.
        string checkHeader = check req.getHeader(interceptor_check_header);
        io:println(&quot;Check Header Value : &quot; + checkHeader);
        return ctx.next();
    }
}

RequestInterceptor1 requestInterceptor1 = new;

service class RequestInterceptor2 {
    *http:RequestInterceptor;

    resource function get [string... path](http:RequestContext ctx) 
            returns http:NextService|error? {
        io:println(&quot;Executing Request Interceptor 2&quot;);
        return ctx.next();
    }
}

RequestInterceptor2 requestInterceptor2 = new;

// A Request Error Interceptor service class implementation. It intercepts the request when an error occurrs in the interceptor execution,
// and adds a header before it is dispatched to the target HTTP resource. Also, a Request Error Interceptor service class can have only one resource function.
service class RequestErrorInterceptor {
    *http:RequestErrorInterceptor;

    // The resource function inside a `RequestErrorInterceptor` is only allowed to have the default method and path. The error occurred
    // in the interceptor execution can be accessed by the `error` parameter.
    resource function 'default [string... path](http:RequestContext ctx, 
                http:Request req, error err) returns http:NextService|error? {
        io:println(&quot;Executing Request Error Interceptor&quot;);
        io:println(&quot;Error occurred : &quot; + err.message());
        // Sets a header to the request.
        req.setHeader(interceptor_check_header, interceptor_check_header_value);
        return ctx.next();
    }
}

// Creates a new Request Error Interceptor.
RequestErrorInterceptor requestErrorInterceptor = new;

listener http:Listener interceptorListener = new http:Listener(9090, config = { 
    // A `RequestErrorInterceptor` can be added anywhere in the interceptor pipeline.
    interceptors: [requestInterceptor1, requestInterceptor2, 
                   requestErrorInterceptor] 
});

service / on interceptorListener {

    resource function get greeting(http:Request req) 
            returns http:Response|error? {
        io:println(&quot;Executing Target Resource&quot;);
        // Creates a new response.
        http:Response response = new;
        // Sets the headers from the request.
        response.setHeader(interceptor_check_header, 
                        check req.getHeader(interceptor_check_header));
        response.setTextPayload(&quot;Greetings!&quot;);
        return response;
    }
}
</code></pre>
<h4 id="output-163"><a class="header" href="#output-163">Output</a></h4>
<pre><code class="language-bash"># Run the service.
bal run http_request_error_interceptor.bal

Executing Request Interceptor 1
error: Http header does not exist
        at ballerina.http.2:externRequestGetHeader(http_request.bal:733)
           ballerina.http.2.Request:getHeader(http_request.bal:147)
           RequestInterceptor1:$default$**(http_request_error_interceptor.bal:18)
Executing Request Error Interceptor
Error occurred : Http header does not exist
Executing Target Resource
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http2"><a class="header" href="#http2">HTTP2</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http-11-to-20-protocol-switch"><a class="header" href="#http-11-to-20-protocol-switch">HTTP 1.1 to 2.0 Protocol Switch</a></h1>
<p>In this example, the Ballerina HTTP service receives a message over the HTTP/1.1 protocol and forwards it 
to another service over the HTTP/2.0 protocol.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// HTTP version is set to 2.0.
http:Client http2serviceClientEP =
        check new (&quot;http://localhost:7090&quot;, {httpVersion: &quot;2.0&quot;});

service / on new http:Listener(9090) {

    resource function 'default http11Service(http:Request clientRequest)
            returns json|error {
        // Forward the [clientRequest](https://docs.central.ballerina.io/ballerina/http/latest/classes/Request) to the `http2` service.
        json clientResponse = check
            http2serviceClientEP-&gt;forward(&quot;/http2service&quot;, clientRequest);

        // Send the response back to the caller.
        return clientResponse;

    }
}

// HTTP version is set to 2.0.
listener http:Listener http2serviceEP = new (7090,
    config = {httpVersion: &quot;2.0&quot;});

service / on http2serviceEP {

    resource function 'default http2service() returns json {
        // Send the response back to the caller (http11Service).
        return { 
            &quot;response&quot;: {
                &quot;message&quot;:&quot;response from http2 service&quot;
            }
        };
    }
}
</code></pre>
<h4 id="output-164"><a class="header" href="#output-164">Output</a></h4>
<pre><code class="language-bash">bal run http_1_1_to_2_0_protocol_switch.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http-20-server-push"><a class="header" href="#http-20-server-push">HTTP 2.0 Server Push</a></h1>
<p>This example demonstrates sending and receiving HTTP/2 Server Push messages in Ballerina HTTP Library. 
HTTP/2 Server Push messages allow the server to send resources to the client before the client requests for it.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/log;

// Create an endpoint with port 7090 to accept HTTP requests.
// HTTP version is set to 2.0.
listener http:Listener http2ServiceEP = new (7090,
    config = {httpVersion: &quot;2.0&quot;});

service /http2Service on http2ServiceEP {

    resource function 'default .(http:Caller caller) {

        // [Send a Push Promise](https://docs.central.ballerina.io/ballerina/http/latest/clients/Caller#promise).
        http:PushPromise promise1 = new (path = &quot;/resource1&quot;, method = &quot;GET&quot;);
        var promiseResponse1 = caller-&gt;promise(promise1);
        if (promiseResponse1 is error) {
            log:printError(&quot;Error occurred while sending the promise1&quot;,
                'error = promiseResponse1);
        }

        // Send another Push Promise.
        http:PushPromise promise2 = new (path = &quot;/resource2&quot;, method = &quot;GET&quot;);
        var promiseResponse2 = caller-&gt;promise(promise2);
        if (promiseResponse2 is error) {
            log:printError(&quot;Error occurred while sending the promise2&quot;,
                'error = promiseResponse2);
        }

        // Send one more Push Promise.
        http:PushPromise promise3 = new (path = &quot;/resource3&quot;, method = &quot;GET&quot;);
        var promiseResponse3 = caller-&gt;promise(promise3);
        if (promiseResponse3 is error) {
            log:printError(&quot;Error occurred while sending the promise3&quot;,
                'error = promiseResponse3);
        }

        // Construct the requested resource.
        http:Response res = new;
        json msg = {&quot;response&quot;: {&quot;name&quot;: &quot;main resource&quot;}};
        res.setPayload(msg);

        // Send the requested resource.
        var response = caller-&gt;respond(res);
        if (response is error) {
            log:printError(&quot;Error occurred while sending the response&quot;,
                'error = response);
        }

        // Construct promised resource1.
        http:Response push1 = new;
        msg = {&quot;push&quot;: {&quot;name&quot;: &quot;resource1&quot;}};
        push1.setPayload(msg);

        // [Push promised resource1](https://docs.central.ballerina.io/ballerina/http/latest/clients/Caller#pushPromisedResponse).
        var pushResponse1 = caller-&gt;pushPromisedResponse(promise1, push1);
        if (pushResponse1 is error) {
            log:printError(&quot;Error occurred while sending the promised &quot; +
                           &quot;response1&quot;, 'error = pushResponse1);
        }

        // Construct promised resource2.
        http:Response push2 = new;
        msg = {&quot;push&quot;: {&quot;name&quot;: &quot;resource2&quot;}};
        push2.setPayload(msg);

        // Push promised resource2.
        var pushResponse2 = caller-&gt;pushPromisedResponse(promise2, push2);
        if (pushResponse2 is error) {
            log:printError(&quot;Error occurred while sending the promised &quot; +
                            &quot;response2&quot;, 'error = pushResponse2);
        }

        // Construct promised resource3.
        http:Response push3 = new;
        msg = {&quot;push&quot;: {&quot;name&quot;: &quot;resource3&quot;}};
        push3.setPayload(msg);

        // Push promised resource3.
        var pushResponse3 = caller-&gt;pushPromisedResponse(promise3, push3);
        if (pushResponse3 is error) {
            log:printError(&quot;Error occurred while sending the promised &quot; +
                            &quot;response3&quot;, 'error = pushResponse3);
        }
    }
}
</code></pre>
<h4 id="output-165"><a class="header" href="#output-165">Output</a></h4>
<pre><code class="language-bash">bal run http_2.0_service.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graphql"><a class="header" href="#graphql">GraphQL</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hello-world-1"><a class="header" href="#hello-world-1">Hello World</a></h1>
<p>A GraphQL service in Ballerina represents a GraphQL schema. Each resource function of the <code>graphql:Service</code>
represents a resolver function in the root <code>Query</code> type. The return type of each resource function will be the
type of each field represented by the resource function.<br/><br/>
For more information on the underlying package, see the
<a href="https:docs.central.ballerina.io/ballerina/graphql/latest/">GraphQL package</a>.<br/><br/>
This example shows a simple GraphQL endpoint that has a single field in the root Query type, which returns a string.</p>
<pre><code class="language-go">import ballerina/graphql;

// The `graphql:Service` exposes a GraphQL service on the provided port.
service /graphql on new graphql:Listener(4000) {

    // A resource function inside a `graphql:Service` represents a resolver.
    // This resource can be queried using the `{ greeting }`.
    resource function get greeting() returns string {

        return &quot;Hello, World&quot;;
    }
}
</code></pre>
<h4 id="output-166"><a class="header" href="#output-166">Output</a></h4>
<pre><code class="language-bash"># Send a query to the GraphQL endpoint using a cURL command.
# The query used: { greeting }
curl -X POST -H &quot;Content-type: application/json&quot; -d '{ &quot;query&quot;: &quot;{ greeting }&quot; }' 'http://localhost:4000/graphql'
{&quot;data&quot;:{&quot;greeting&quot;:&quot;Hello, World&quot;}}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="returning-record-values"><a class="header" href="#returning-record-values">Returning Record Values</a></h1>
<p>In Ballerina GraphQL, a service represents the GraphQL endpoint.
Each resource function inside the service represents a resolver function for a field in the root Query type.<br/><br/>
For more information on the underlying package, see the
<a href="https:docs.central.ballerina.io/ballerina/graphql/latest/">GraphQL package</a>.<br/><br/>
This example shows a GraphQL endpoint, which has a field <code>profile</code> of type <code>Person</code>.
A GraphQL client can query on this service to retrieve specific fields or subfields of the <code>Person</code> object.</p>
<pre><code class="language-go">import ballerina/graphql;

service /graphql on new graphql:Listener(4000) {

    // Ballerina GraphQL resolvers can return `record` values. The record will be mapped to an `OBJECT` type.
    resource function get profile() returns Person {

        return {
            name: &quot;Walter White&quot;,
            age: 51,
            address: {
                number: &quot;308&quot;,
                street: &quot;Negra Arroyo Lane&quot;,
                city: &quot;Albuquerque&quot;
            }
        };
    }
}

// Define the custom record types for the returning data.
public type Person record {
    string name;
    int age;
    Address address;
};
public type Address record {
    string number;
    string street;
    string city;
};
</code></pre>
<h4 id="output-167"><a class="header" href="#output-167">Output</a></h4>
<pre><code class="language-bash"># Send a query to the GraphQL endpoint using a cURL command.
# The query used: { profile { name, address { city } } }
curl -X POST -H &quot;Content-type: application/json&quot; -d '{ &quot;query&quot;: &quot;{ profile { name, address { city } } }&quot; }' 'http://localhost:4000/graphql'
{&quot;data&quot;:{&quot;profile&quot;:{&quot;name&quot;:&quot;Walter White&quot;, &quot;address&quot;:{&quot;city&quot;:&quot;Albuquerque&quot;}}}}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hierarchical-resource-paths"><a class="header" href="#hierarchical-resource-paths">Hierarchical Resource Paths</a></h1>
<p>The resources in Ballerina GraphQL services can have hierarchical resource
paths. When a hierarchical path is present, an <code>OBJECT</code> type is created for
each intermediate path segment with the same name. Every sub path under a
path segment will be added as a field of the created type.<br/><br/>
For more information on the underlying package, see the
<a href="https:docs.central.ballerina.io/ballerina/graphql/latest/"><code>graphql</code> package</a>.<br/><br/>
This example shows a GraphQL endpoint, which has a <code>profile</code> field of type <code>Person</code>.
A GraphQL client can query this service to retrieve specific fields or subfields of the <code>Person</code> object.</p>
<pre><code class="language-go">import ballerina/graphql;

// This service has multiple resources with hierarchical resource paths.
// The root operation has a field named `profile` and it is the first segment
// of the hierarchical path in this service. The type of this field will also
// be `profile`. (For hierarchical paths, the field name and the type name will
// be the same). The `profile` type has two fields: `quote` and `name`. The
// type of the `quote` field is `String` and the type of the `name` field is
// `name`. The `name` type has two fields:`first` and the `last`. Both of the
// fields are of type `String`.
service /graphql on new graphql:Listener(4000) {

    // This resource represents the `quote` field under the `profile` object.
    resource function get profile/quote() returns string {
        return &quot;I am the one who knocks!&quot;;
    }

    // This resource represents the `first` field under the `name` object type.
    // The `name` field in the `profile` object is of type `name`.
    resource function get profile/name/first() returns string {
        return &quot;Walter&quot;;
    }

    // This resource represents the `last` field under the `name` object type.
    // The `name` field in the `profile` object is of type `name`.
    resource function get profile/name/last() returns string {
        return &quot;White&quot;;
    }
}
</code></pre>
<h4 id="output-168"><a class="header" href="#output-168">Output</a></h4>
<pre><code class="language-bash">bal run graphql_hierarchical_resource_paths.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="returning-service-objects"><a class="header" href="#returning-service-objects">Returning Service Objects</a></h1>
<p>A GraphQL resource function can return service objects. The returning
service objects are mapped to the <code>OBJECT</code> type in the GraphQL schema. Each
resource function in the returned service object becomes a field in the
created <code>OBJECT</code> type.<br/><br/>
For more information on the underlying package, see the
<a href="https:docs.central.ballerina.io/ballerina/graphql/latest/"><code>graphql</code> package</a>.</p>
<pre><code class="language-go">import ballerina/graphql;

service /graphql on new graphql:Listener(4000) {

    // Resource functions can return service objects. The returning service
    // object is mapped to an `OBJECT` type in GraphQL. Each resource
    // function is mapped to a field in the `OBJECT`.
    resource function get profile() returns Person {

        return new(&quot;Walter White&quot;, 51);
    }
}

// Define a service class to use as an object in the GraphQL service.
service class Person {
    private final string name;
    private final int age;

    function init(string name, int age) {
        self.name = name;
        self.age = age;
    }

    // Each resource function becomes a field of the `Person` type.
    resource function get name() returns string {
        return self.name;
    }
    resource function get age() returns int {
        return self.age;
    }
    resource function get isAdult() returns boolean {
        return self.age &gt; 21;
    }
}
</code></pre>
<h4 id="output-169"><a class="header" href="#output-169">Output</a></h4>
<pre><code class="language-bash">bal run graphql_returning_service_objects.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="input-types"><a class="header" href="#input-types">Input Types</a></h1>
<p>GraphQL resources can have input parameters, which will be mapped to input
values in the generated GraphQL schema. Currently, the supported input types
are: <code>string</code>, <code>int</code>, <code>boolean</code>, <code>float</code>, and <code>enum</code>. Any of these types can
be an optional and/or defaultable types.<br/><br/>
For more information on the underlying package, see the
<a href="https:docs.central.ballerina.io/ballerina/graphql/latest/"><code>graphql</code> package</a>.</p>
<pre><code class="language-go">import ballerina/graphql;

service /graphql on new graphql:Listener(4000) {

    // The input parameters in a resource function becomes input values of the
    // corresponding GraphQL field. In this GraphQL schema, the 
    // `greeting` field of `Query` type  has a `name`  input value, which accepts
    // `string` values.
    resource function get greeting(string name) returns string {

        return string`Hello, ${name}`;
    }
}
</code></pre>
<h4 id="output-170"><a class="header" href="#output-170">Output</a></h4>
<pre><code class="language-bash"># Send a query to the GraphQL endpoint using a cURL command.
# The query used: { greeting(name: &quot;Walter&quot;) }
curl -X POST -H &quot;Content-type: application/json&quot; -d '{ &quot;query&quot;: &quot;{ greeting(name: \&quot;Walter\&quot;) }&quot; }' 'http://localhost:4000/graphql'
{&quot;data&quot;:{&quot;greeting&quot;:&quot;Hello, Walter&quot;}}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mutations"><a class="header" href="#mutations">Mutations</a></h1>
<p>A remote function inside a GraphQL service represents a field in the root
<code>Mutation</code> object type. Therefore, if a remote function is present inside
the Ballerina GraphQL service, the auto-generated schema will have a
<code>Mutation</code> type. Each remote function in the service will be added as a
field of the <code>Mutation</code> type. The field name will be the remote function
name and the field type will be the return type of the remote function.
<br/><br/>
For more information on the underlying package, see the
<a href="https:docs.central.ballerina.io/ballerina/graphql/latest/"><code>graphql</code> package</a>.</p>
<pre><code class="language-go">import ballerina/graphql;

service /graphql on new graphql:Listener(4000) {

    // Define a `Person` object in the service.
    private Person person;

    function init() {
        // Initialize the `person` value.
        self.person = new(&quot;Walter White&quot;, 51);

    }

    // A resource function represents a field in the root `Query` operation.
    resource function get profile() returns Person {

        return self.person;
    }

    // A remote function represents a field in the root `Mutation` operation.
    // After updating the name, the `person` object will be returned.
    remote function updateName(string name) returns Person {

        self.person.setName(name);
        return self.person;
    }

    // Remote function to update the age.
    remote function updateAge(int age) returns Person {

        self.person.setAge(age);
        return self.person;
    }
}

// Define a service class to use as an object in the GraphQL service.
public service class Person {

    private string name;
    private int age;

    function init(string name, int age) {
        self.name = name;
        self.age = age;
    }

    resource function get name() returns string {
        return self.name;
    }
    resource function get age() returns int {
        return self.age;
    }
    resource function get isAdult() returns boolean {
        return self.age &gt; 21;
    }

    function setName(string name) {
        self.name = name;
    }
    function setAge(int age) {
        self.age = age;
    }
}
</code></pre>
<h4 id="output-171"><a class="header" href="#output-171">Output</a></h4>
<pre><code class="language-bash"># Send a query to the GraphQL endpoint using a cURL command.
# The query used: { profile { name isAdult } }
curl -X POST -H &quot;Content-type: application/json&quot; -d '{ &quot;query&quot;: &quot;{ profile { name age } }&quot; }' 'http://localhost:4000/graphql'
{&quot;data&quot;:{&quot;profile&quot;:{&quot;name&quot;:&quot;Walter White&quot;, &quot;age&quot;:51}}}

# Now send a mutation to update the name.
# The document used for this: mutation { updateName(name: \&quot;Mr. Lambert\&quot;) { name age } }
curl -X POST -H &quot;Content-type: application/json&quot; -d '{ &quot;query&quot;: &quot;mutation { updateName(name: \&quot;Mr. Lambert\&quot;) { name age } }&quot; }' 'http://localhost:4000/graphql'
{&quot;data&quot;:{&quot;updateName&quot;:{&quot;name&quot;:&quot;Mr. Lambert&quot;, &quot;age&quot;:51}}}

# Then send a mutation to update the age.
# The document used for this: mutation { updateAge(age: 52) { name age } }
curl -X POST -H &quot;Content-type: application/json&quot; -d '{ &quot;query&quot;: &quot;mutation { updateAge(age: 52) { name age } }&quot; }' 'http://localhost:4000/graphql'
{&quot;data&quot;:{&quot;updateAge&quot;:{&quot;name&quot;:&quot;Mr. Lambert&quot;, &quot;age&quot;:52}}}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="context"><a class="header" href="#context">Context</a></h1>
<p>The <code>graphql:Context</code> object can be used to pass meta information between the resolver functions. An init function
should be provided using the <code>graphql:ServiceConfig</code> parameter named <code>contextInit</code>. Inside the init function, the
<code>graphql:Context</code> can be initialized. Values from the <code>http:RequestContext</code> and <code>http:Request</code> can be added as well as
other values. These values are stored as key-value pairs. The key is a <code>string</code> and the value can be any <code>readonly</code>
value or an <code>isolated</code> object. If the init function is not provided, an empty context object will be created.
The context can be accessed by defining it as the first parameter of any resolver (resource/remote) function.
<br/><br/>
For more information on the underlying package, see the
<a href="https:docs.central.ballerina.io/ballerina/graphql/latest/"><code>graphql</code> package</a>.</p>
<pre><code class="language-go">import ballerina/graphql;
import ballerina/http;
import ballerina/lang.value;

@graphql:ServiceConfig {
    // Initialization of the `graphqlContext` should be provided to the
    // `contextInit` field.
    contextInit: isolated function (http:RequestContext requestContext,
                                    http:Request request)
                                    returns graphql:Context|error {

        // Initialize the `graphql:Context` object.
        graphql:Context context = new;

        // Retrieve the header named `scope` and set it to the context with the
        // `scope` key. If the header does not exist, this will return an
        // `error`, and thereby, the request will not be processed.
        context.set(&quot;scope&quot;, check request.getHeader(&quot;scope&quot;));

        // Finally, the context object has to be returned.
        return context;

    }
}
service /graphql on new graphql:Listener(4000) {

    // Define a `Person` object when the service is initialized.
    private final Person person;

    function init() {
        // Initialize the `person` value.
        self.person = new(&quot;Walter White&quot;, 51, 737000.00);

    }

    // Resource functions can be defined without a context parameter.
    resource function get greet() returns string {
        return &quot;Hello, world&quot;;
    }

    // If the context is needed, it should be defined as the first paramter of
    // the resolver function.
    resource function get profile(graphql:Context context)
    returns Person|error {

        // Retrieve the `scope` attribute from the context. This will return
        // a `graphql:Error` if the `scope` is not
        // found in the context.
        value:Cloneable|isolated object {} scope = check context.get(&quot;scope&quot;);

        // The profile information will be returned for the scope of either
        // `admin` or `user`.
        if scope is string {
            if scope == &quot;admin&quot; || scope == &quot;user&quot; {
                return self.person;
            }
        }

        // Return an `error` if the required scope is not found.
        return error(&quot;Permission denied&quot;);
    }
}

// Define a service class to use as an object in the GraphQL service.
public service class Person {

    private final string name;
    private final int age;
    private final float salary;

    function init(string name, int age, float salary) {
        self.name = name;
        self.age = age;
        self.salary = salary;
    }

    resource function get name() returns string {
        return self.name;
    }

    resource function get age() returns int {
        return self.age;
    }

    resource function get salary(graphql:Context context) returns float|error {

        // Retrieve the `scope` attribute from the context.
        value:Cloneable|isolated object {} scope = check context.get(&quot;scope&quot;);

        // The `salary` value will only be returned if the `scope` is `admin`.
        if scope is string {
            if scope == &quot;admin&quot; {
                return self.salary;
            }
        }

        // Return an `error` if the required scope is not found.
        return error(&quot;Permission denied&quot;);

    }
}
</code></pre>
<h4 id="output-172"><a class="header" href="#output-172">Output</a></h4>
<pre><code class="language-bash">bal run graphql_context.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-upload"><a class="header" href="#file-upload">File Upload</a></h1>
<p>GraphQL package provides a way to upload files through the GraphQL endpoints with GraphQL mutations. To define
an endpoint with the file upload capability, the <code>graphql:Upload</code> type can be used as the input parameter of
resolver functions. The <code>graphql:Upload</code> type can represent the details of the file that needs to be uploaded and
that can be used only with the remote functions. The value of <code>graphql:Upload</code> type is extracted from the HTTP
multipart request, which will be received by the GraphQL endpoints. This example shows how to implement a GraphQL endpoint that
can be used to upload files.
<br/><br/>
For more information on the underlying package, see the
<a href="https:docs.central.ballerina.io/ballerina/graphql/latest/"><code>graphql</code> package</a>.</p>
<pre><code class="language-go">import ballerina/graphql;
import ballerina/io;

service /fileUpload on new graphql:Listener(4000) {

    // Store the file information that need to be shared between the remote and
    // resource functions.
    string[] uploadedFiles = [];

    // Remote functions can use the `graphql:Upload` type as an input
    // parameter type.
    remote function singleFileUpload(graphql:Upload file)
        returns string|error {

        // Access the file name from the `graphql:Upload` type parameter.
        // Similarly, it can access the mime type as `file.mimeType`
        // and encoding as `file.encoding`. Except the `byteStream` field, all
        // other fields in the `graphql:Upload` are `string` values.
        string fileName = file.fileName;
        string path = string`./uploads/${fileName}`;

        // Access the byte stream of the file from the `graphql:Upload` type
        // parameter. The type of the `byteStream` field is
        // `stream&lt;byte[], io:Error?&gt;`
        stream&lt;byte[], io:Error?&gt; byteStream = file.byteStream;

        // Store the received file using the ballerina `io` package. If any
        // `error` occurred during the file write, it can be returned as the
        // resolver function output.
        check io:fileWriteBlocksFromStream(path, byteStream);

        // Returns the message if the uploading process is successful.
        return &quot;Successfully Uploaded&quot;;
    }

    // Remote functions in GraphQL services can use the `graphql:Upload[]` as
    // an input parameter type. Therefore, remote functions can accept an array
    // of `graphql:Upload` values. This can be used to store multiple files via
    // a single request.
    remote function multipleFileUpload(graphql:Upload[] files)
        returns string[]|error {

        // Iterates the `graphql:Upload` type array to store the files.
        foreach int i in 0..&lt; files.length() {
            graphql:Upload file = files[i];
            stream&lt;byte[], io:Error?&gt; byteStream = file.byteStream;
            string fileName = file.fileName;
            string path = string`./uploads/${fileName}`;
            check io:fileWriteBlocksFromStream(path, byteStream);
            self.uploadedFiles.push(file.fileName);
        }
        return self.uploadedFiles;
    }

    resource function get getUploadedFileNames() returns string[] {
        return self.uploadedFiles;
    }
}
</code></pre>
<h4 id="output-173"><a class="header" href="#output-173">Output</a></h4>
<pre><code class="language-bash">bal run graphql_file_upload.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graphql-security"><a class="header" href="#graphql-security">GraphQL Security</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---ssltls-1"><a class="header" href="#service---ssltls-1">Service - SSL/TLS</a></h1>
<p>You can use the GraphQL listener to connect to or interact with an HTTPS client.
Provide the <code>graphql:ListenerSecureSocket</code> configurations to the server to
expose an HTTPS connection.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/graphql/latest/">GraphQL module</a>.</p>
<pre><code class="language-go">import ballerina/graphql;

// A GraphQL listener can be configured to communicate through HTTPS as well.
// To secure a listener using HTTPS, the listener needs to be configured with
// a certificate file and a private key file for the listener.
// The [`graphql:ListenerSecureSocket`](https://docs.central.ballerina.io/ballerina/graphql/latest/records/ListenerSecureSocket) record
// provides the SSL-related listener configurations of the listener.
listener graphql:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

service /graphql on securedEP {
    resource function get greeting() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-174"><a class="header" href="#output-174">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run graphql_service_ssl_tls.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---mutual-ssl-1"><a class="header" href="#service---mutual-ssl-1">Service - Mutual SSL</a></h1>
<p>Ballerina supports mutual SSL, which is a certificate-based authentication
process in which two parties (the client and server) authenticate each other by
verifying the digital certificates. It ensures that both parties are assured
of each other's identity.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/graphql/latest/">GraphQL module</a>.</p>
<pre><code class="language-go">import ballerina/graphql;
import ballerina/http;

// An GraphQL listener can be configured to accept new connections that are
// secured via mutual SSL.
// The [`graphql:ListenerSecureSocket`](https://docs.central.ballerina.io/ballerina/graphql/latest/records/ListenerSecureSocket) record provides the SSL-related listener configurations.
listener graphql:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        },
        // Enables mutual SSL.
        mutualSsl: {
            verifyClient: http:REQUIRE,
            cert: &quot;../resource/path/to/public.crt&quot;
        },
        // Enables the preferred SSL protocol and its versions.
        protocol: {
            name: http:TLS,
            versions: [&quot;TLSv1.2&quot;, &quot;TLSv1.1&quot;]
        },
        // Configures the preferred ciphers.
        ciphers: [&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;]

    }
);

service /graphql on securedEP {
    resource function get greeting() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-175"><a class="header" href="#output-175">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path, private key file path, and
# trusted certificate file path.
bal run graphql_service_mutual_ssl.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---basic-auth-file-user-store-1"><a class="header" href="#service---basic-auth-file-user-store-1">Service - Basic Auth File User Store</a></h1>
<p>A GraphQL service can be secured using Basic auth and optionally by
enforcing authorization. Then, it validates the Basic auth token sent in the
<code>Authorization</code> header against the provided configurations. This reads data
from a file, which has a TOML format. This stores the usernames, passwords
for authentication, and scopes for authorization.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s).<br/>
In the authorization phase, the scopes of the service are compared
against the scope included in the user store for at least one match between
the two sets.<br/>
<code>Config.toml</code> has defined three users - alice, ldclakmal and eve. Each user has a
password and optionally assigned scopes as an array.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/graphql;

listener graphql:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with Basic auth and can be authorized optionally.
// Using Basic auth with the file user store can be enabled by setting the
// `graphql:FileUserStoreConfig` configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@graphql:ServiceConfig {
    auth: [
        {
            fileUserStoreConfig: {},
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /graphql on securedEP {
    resource function get greeting() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-176"><a class="header" href="#output-176">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, ensure that the `Config.toml` file is populated correctly
# with the user information.
echo '[[&quot;ballerina.auth.users&quot;]]
username=&quot;alice&quot;
password=&quot;password1&quot;
scopes=[&quot;scope1&quot;]
[[&quot;ballerina.auth.users&quot;]]
username=&quot;bob&quot;
password=&quot;password2&quot;
scopes=[&quot;scope2&quot;, &quot;scope3&quot;]' &gt; Config.toml

# You may need to change the certificate file path and private key file path.
bal run graphql_service_basic_auth_file_user_store.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---basic-auth-ldap-user-store-1"><a class="header" href="#service---basic-auth-ldap-user-store-1">Service - Basic Auth LDAP User Store</a></h1>
<p>A GraphQL service can be secured using Basic auth and by enforcing
authorization optionally. Then, it validates the Basic auth token sent in
the <code>Authorization</code> header against the provided configurations. This reads
data from the configured LDAP. This stores usernames, passwords for
authentication, and scopes for authorization.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s).<br/>
In the authorization phase, the scopes of the service are compared
against the scope included in the user store for at least one match between
the two sets.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/graphql;

listener graphql:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with Basic auth and can be authorized  optionally.
// Basic auth using the LDAP user store can be enabled by setting the
// `graphql:LdapUserStoreConfig` configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@graphql:ServiceConfig {
    auth: [
        {
            ldapUserStoreConfig: {
                domainName: &quot;avix.lk&quot;,
                connectionUrl: &quot;ldap://localhost:389&quot;,
                connectionName: &quot;cn=admin,dc=avix,dc=lk&quot;,
                connectionPassword: &quot;avix123&quot;,
                userSearchBase: &quot;ou=Users,dc=avix,dc=lk&quot;,
                userEntryObjectClass: &quot;inetOrgPerson&quot;,
                userNameAttribute: &quot;uid&quot;,
                userNameSearchFilter: &quot;(&amp;(objectClass=inetOrgPerson)(uid=?))&quot;,
                userNameListFilter: &quot;(objectClass=inetOrgPerson)&quot;,
                groupSearchBase: [&quot;ou=Groups,dc=avix,dc=lk&quot;],
                groupEntryObjectClass: &quot;groupOfNames&quot;,
                groupNameAttribute: &quot;cn&quot;,
                groupNameSearchFilter: &quot;(&amp;(objectClass=groupOfNames)(cn=?))&quot;,
                groupNameListFilter: &quot;(objectClass=groupOfNames)&quot;,
                membershipAttribute: &quot;member&quot;,
                userRolesCacheEnabled: true,
                connectionPoolingEnabled: false,
                connectionTimeout: 5,
                readTimeout: 60
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /graphql on securedEP {
    resource function get greeting() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-177"><a class="header" href="#output-177">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run graphql_service_basic_auth_ldap_user_store.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---jwt-auth-1"><a class="header" href="#service---jwt-auth-1">Service - JWT Auth</a></h1>
<p>A GraphQL service can be secured using JWT and by enforcing
authorization optionally. Then, it validates the JWT sent in the
<code>Authorization</code> header against the provided configurations.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s). The scope can be included
in the JWT using a custom claim attribute. That custom claim attribute
also can be configured as the <code>scopeKey</code>.<br/>
In the authorization phase, the scopes of the service are compared
against the scope included in the JWT for at least one match between the two
sets.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/jwt/latest/">JWT module</a>.</p>
<pre><code class="language-go">import ballerina/graphql;

listener graphql:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with JWT authentication and can be authorized
// optionally. JWT authentication can be enabled by setting the
// `graphql:JwtValidatorConfig` configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@graphql:ServiceConfig {
    auth: [
        {
            jwtValidatorConfig: {
                issuer: &quot;wso2&quot;,
                audience: &quot;ballerina&quot;,
                signatureConfig: {
                    certFile: &quot;../resource/path/to/public.crt&quot;
                },
                scopeKey: &quot;scp&quot;
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /graphql on securedEP {
    resource function get greeting() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-178"><a class="header" href="#output-178">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run graphql_service_jwt_auth.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---oauth2-1"><a class="header" href="#service---oauth2-1">Service - OAuth2</a></h1>
<p>A GraphQL service can be secured using OAuth2 and by enforcing
authorization optionally. Then, it validates the OAuth2 token sent in the
<code>Authorization</code> header against the provided configurations. This calls the
configured introspection endpoint to validate.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s). The scope can be included
in the introspection response using a custom claim attribute. That custom
claim attribute also can be configured as the <code>scopeKey</code>.<br/>
In the authorization phase, the scopes of the service are compared
against the scope included in the introspection response for at least one
match between the two sets.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/graphql;

listener graphql:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with OAuth2 authentication and can be authorized
// optionally. OAuth2 authentication can be enabled by setting the
// `graphql:OAuth2IntrospectionConfig` configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@graphql:ServiceConfig {
    auth: [
        {
            oauth2IntrospectionConfig: {
                url: &quot;https://localhost:9445/oauth2/introspect&quot;,
                tokenTypeHint: &quot;access_token&quot;,
                scopeKey: &quot;scp&quot;,
                clientConfig: {
                    customHeaders: {&quot;Authorization&quot;: &quot;Basic YWRtaW46YWRtaW4=&quot;},
                    secureSocket: {
                        cert: &quot;../resource/path/to/public.crt&quot;
                    }
                }
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /graphql on securedEP {
    resource function get greeting() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-179"><a class="header" href="#output-179">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run graphql_service_oauth2.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="websockets"><a class="header" href="#websockets">WebSockets</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="handle-text-messages-with-client"><a class="header" href="#handle-text-messages-with-client">Handle Text Messages with Client</a></h1>
<p>The WebSocket client can be used to connect to and interact with a WebSocket server in a Synchronous manner. This example demonstrates how to read and write text messages using ballerina websocket client<br/><br/>
For more information on the underlying module,
see the <a href="https:lib.ballerina.io/ballerina/websocket/latest/">WebSocket module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/websocket;

public function main() returns error? {
    // Create a new [WebSocket client](https://lib.ballerina.io/ballerina/websocket/latest/clients/Client).
   websocket:Client wsClient = check new(&quot;ws://echo.websocket.org&quot;);

   // Write a text message to the server using [writeTextMessage](https://lib.ballerina.io/ballerina/websocket/latest/clients/Client#writeTextMessage).
   check wsClient-&gt;writeTextMessage(&quot;Text message&quot;);

   // Read a text message echoed from the server using [readTextMessage](https://lib.ballerina.io/ballerina/websocket/latest/clients/Client#readTextMessage).
   string textResp = check wsClient-&gt;readTextMessage();
   io:println(textResp);
}
</code></pre>
<h4 id="output-180"><a class="header" href="#output-180">Output</a></h4>
<pre><code class="language-bash">bal run websocket_text_client.bal

Text message
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="handle-binary-messages-with-client"><a class="header" href="#handle-binary-messages-with-client">Handle Binary Messages with Client</a></h1>
<p>The WebSocket client can be used to connect to and interact with a WebSocket server in a Synchronous manner.This example demonstrates how to read and write binary messages using ballerina websocket client<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/websocket/latest/">WebSocket module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/lang.'string;
import ballerina/websocket;

public function main() returns error? {
    // Create a new [WebSocket client](https://docs.central.ballerina.io/ballerina/websocket/latest/clients/Client).
   websocket:Client wsClient = check new(&quot;ws://echo.websocket.org&quot;);

   // Write a binary message to the server using [writeBinaryMessage](https://docs.central.ballerina.io/ballerina/websocket/latest/clients/Client#writeBinaryMessage).
   check wsClient-&gt;writeBinaryMessage(&quot;Binary message&quot;.toBytes());

   // Read a binary message echoed from the server using [readBinaryMessage](https://docs.central.ballerina.io/ballerina/websocket/latest/clients/Client#readBinaryMessage).
   byte[] byteResp = check wsClient-&gt;readBinaryMessage();
   string stringResp = check 'string:fromBytes(byteResp);
   io:println(stringResp);
}
</code></pre>
<h4 id="output-181"><a class="header" href="#output-181">Output</a></h4>
<pre><code class="language-bash">bal run websocket_binary_client.bal

Binary message
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="retry"><a class="header" href="#retry">Retry</a></h1>
<p>If the WebSocket client lost the connection due to some transient failure, it automatically tries to
reconnect to the given backend. If the maximum reconnect attempt is reached it gives up on the connection. <br/><br/>
For more information on the underlying module,
see the <a href="https:lib.ballerina.io/ballerina/websocket/latest/">WebSocket module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/websocket;

public function main() returns error? {
    websocket:Client wsClient = check new(&quot;ws://localhost:9090/foo&quot;, {
        // Set the maximum retry count to 20 so that it will try 20 times with an interval of
        // 1 second in between the retry attempts.
        retryConfig: { maxCount: 20 }
    });
    // Read the message sent from the server upon upgrading to a WebSocket connection.
    string text = check wsClient-&gt;readTextMessage();
    io:println(text);
    io:println(&quot;Please shutdown the server now.&quot; +
                        &quot;And restart at least within 15 seconds&quot;);
    // Client will retry 20 times(20 seconds in time) until the server gets started.
    string retryMsg = check wsClient-&gt;readTextMessage();
    io:println(retryMsg);
}
</code></pre>
<h4 id="output-182"><a class="header" href="#output-182">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample WebSocket service, which sends a message to the client upon upgrading to a WebSocket connection.
# If you are using a Ballerina WebSocket server, you can send a message to the client in the `onOpen` resource.
# The client will first connect to the server and then it will wait for 5 seconds to give time for the server to shut down.
# Start the server after 5 seconds so that the client will start retrying to connect to the server and read messages.
bal run websocket_retry_client.bal
Hello World!
Please shutdown the server now. And restart at least within 15 seconds
Hello World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="listener-functionalities"><a class="header" href="#listener-functionalities">Listener Functionalities</a></h1>
<p>This example explains the basic functions of a WebSocket server.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/websocket/latest/">WebSocket module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/websocket;

service /basic/ws on new websocket:Listener(9090) {
   resource isolated function get .()
                     returns websocket:Service|websocket:Error {
       // Accept the WebSocket upgrade by returning a `websocket:Service`.
       return new WsService();
   }
}

service class WsService {
    *websocket:Service;
    // This `remote function` is triggered when a new text message is received
    // from a client.
    remote isolated function onTextMessage(websocket:Caller caller,
                                 string text) returns websocket:Error? {
        io:println(&quot;\ntext message: &quot; + text);
        return caller-&gt;writeTextMessage(&quot;You said: &quot; + text);
    }
}
</code></pre>
<h4 id="output-183"><a class="header" href="#output-183">Output</a></h4>
<pre><code class="language-bash">bal run websocket_basic_sample.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="websocket-security"><a class="header" href="#websocket-security">WebSocket Security</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---ssltls-2"><a class="header" href="#service---ssltls-2">Service - SSL/TLS</a></h1>
<p>You can use the WebSocket listener to connect to or interact with an WebSocket client.
Provide the <code>websocket:ListenerSecureSocket</code> configurations to the server to
expose an WSS connection.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/websocket/latest/">WebSocket module</a>.</p>
<pre><code class="language-go">import ballerina/websocket;

// A WebSocket listener can be configured to communicate through WSS as well.
// To secure a listener using SSL/TLS, the listener needs to be configured with
// a certificate file and a private key file for the listener.
// The [`websocket:ListenerSecureSocket`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/ListenerSecureSocket) record
// provides the SSL-related listener configurations of the listener.
listener websocket:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

service /foo on securedEP {
    resource isolated function get bar() returns websocket:Service {
        return new WsService();
   }
}

service class WsService {
    *websocket:Service;
    remote isolated function onTextMessage(websocket:Caller caller,
                             string text) returns websocket:Error? {
        check caller-&gt;writeTextMessage(text);
    }
}
</code></pre>
<h4 id="output-184"><a class="header" href="#output-184">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run websocket_service_ssl_tls.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---mutual-ssl-2"><a class="header" href="#service---mutual-ssl-2">Service - Mutual SSL</a></h1>
<p>Ballerina supports mutual SSL, which is a certificate-based authentication
process in which two parties (the client and server) authenticate each other by
verifying the digital certificates. It ensures that both parties are assured
of each other's identity.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/websocket/latest/">WebSocket module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/websocket;

// A WebSocket listener can be configured to accept new connections that are
// secured via mutual SSL.
// The [`websocket:ListenerSecureSocket`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/ListenerSecureSocket) record provides the SSL-related listener configurations.
listener websocket:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        },
        // Enables mutual SSL.
        mutualSsl: {
            verifyClient: http:REQUIRE,
            cert: &quot;../resource/path/to/public.crt&quot;
        },
        // Enables the preferred SSL protocol and its versions.
        protocol: {
            name: http:TLS,
            versions: [&quot;TLSv1.2&quot;, &quot;TLSv1.1&quot;]
        },
        // Configures the preferred ciphers.
        ciphers: [&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;]

    }
);

service /foo on securedEP {
    resource isolated function get bar() returns websocket:Service {
        return new WsService();
   }
}

service class WsService {
    *websocket:Service;
    remote isolated function onTextMessage(websocket:Caller caller,
                             string text) returns websocket:Error? {
        check caller-&gt;writeTextMessage(text);
    }
}
</code></pre>
<h4 id="output-185"><a class="header" href="#output-185">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path, private key file path, and
# trusted certificate file path.
bal run websocket_service_mutual_ssl.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---basic-auth-file-user-store-2"><a class="header" href="#service---basic-auth-file-user-store-2">Service - Basic Auth File User Store</a></h1>
<p>A WebSocket service can be secured using Basic auth and optionally by
enforcing authorization. Then, it validates the Basic auth token sent in the
<code>Authorization</code> header against the provided configurations. This reads data
from a file, which has a TOML format. This stores the usernames, passwords
for authentication, and scopes for authorization.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s).<br/>
In the authorization phase, the scopes of the service are compared
against the scope included in the user store for at least one match between
the two sets.<br/>
<code>Config.toml</code> has defined three users - alice, ldclakmal and eve. Each user has a
password and optionally assigned scopes as an array.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/websocket;

listener websocket:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with Basic auth and can be authorized optionally.
// Using Basic auth with the file user store can be enabled by setting the
// [`websocket:FileUserStoreConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/FileUserStoreConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@websocket:ServiceConfig {
    auth: [
        {
            fileUserStoreConfig: {},
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /foo on securedEP {
    resource isolated function get bar() returns websocket:Service {
        return new WsService();
   }
}

service class WsService {
    *websocket:Service;
    remote isolated function onTextMessage(websocket:Caller caller,
                             string text) returns websocket:Error? {
        check caller-&gt;writeTextMessage(text);
    }
}
</code></pre>
<h4 id="output-186"><a class="header" href="#output-186">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, ensure that the `Config.toml` file is populated correctly
# with the user information.
echo '[[&quot;ballerina.auth.users&quot;]]
username=&quot;alice&quot;
password=&quot;password1&quot;
scopes=[&quot;scope1&quot;]
[[&quot;ballerina.auth.users&quot;]]
username=&quot;bob&quot;
password=&quot;password2&quot;
scopes=[&quot;scope2&quot;, &quot;scope3&quot;]' &gt; Config.toml

# You may need to change the certificate file path and private key file path.
bal run websocket_service_basic_auth_file_user_store.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---basic-auth-ldap-user-store-2"><a class="header" href="#service---basic-auth-ldap-user-store-2">Service - Basic Auth LDAP User Store</a></h1>
<p>A WebSocket service can be secured using Basic auth and by enforcing
authorization optionally. Then, it validates the Basic auth token sent in
the <code>Authorization</code> header against the provided configurations. This reads
data from the configured LDAP. This stores usernames, passwords for
authentication, and scopes for authorization.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s).<br/>
In the authorization phase, the scopes of the service are compared
against the scope included in the user store for at least one match between
the two sets.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/websocket;

listener websocket:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with Basic auth and can be authorized optionally.
// Basic auth using the LDAP user store can be enabled by setting the
// [`websocket:LdapUserStoreConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/LdapUserStoreConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@websocket:ServiceConfig {
    auth: [
        {
            ldapUserStoreConfig: {
                domainName: &quot;avix.lk&quot;,
                connectionUrl: &quot;ldap://localhost:389&quot;,
                connectionName: &quot;cn=admin,dc=avix,dc=lk&quot;,
                connectionPassword: &quot;avix123&quot;,
                userSearchBase: &quot;ou=Users,dc=avix,dc=lk&quot;,
                userEntryObjectClass: &quot;inetOrgPerson&quot;,
                userNameAttribute: &quot;uid&quot;,
                userNameSearchFilter: &quot;(&amp;(objectClass=inetOrgPerson)(uid=?))&quot;,
                userNameListFilter: &quot;(objectClass=inetOrgPerson)&quot;,
                groupSearchBase: [&quot;ou=Groups,dc=avix,dc=lk&quot;],
                groupEntryObjectClass: &quot;groupOfNames&quot;,
                groupNameAttribute: &quot;cn&quot;,
                groupNameSearchFilter: &quot;(&amp;(objectClass=groupOfNames)(cn=?))&quot;,
                groupNameListFilter: &quot;(objectClass=groupOfNames)&quot;,
                membershipAttribute: &quot;member&quot;,
                userRolesCacheEnabled: true,
                connectionPoolingEnabled: false,
                connectionTimeout: 5,
                readTimeout: 60
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /foo on securedEP {
    resource isolated function get bar() returns websocket:Service {
        return new WsService();
   }
}

service class WsService {
    *websocket:Service;
    remote isolated function onTextMessage(websocket:Caller caller,
                             string text) returns websocket:Error? {
        check caller-&gt;writeTextMessage(text);
    }
}
</code></pre>
<h4 id="output-187"><a class="header" href="#output-187">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run websocket_service_basic_auth_ldap_user_store.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---jwt-auth-2"><a class="header" href="#service---jwt-auth-2">Service - JWT Auth</a></h1>
<p>A WebSocket service can be secured using JWT and by enforcing
authorization optionally. Then, it validates the JWT sent in the
<code>Authorization</code> header against the provided configurations.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s). The scope can be included
in the JWT using a custom claim attribute. That custom claim attribute
also can be configured as the <code>scopeKey</code>.<br/>
In the authorization phase, the scopes of the service are compared
against the scope included in the JWT for at least one match between the two
sets.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/jwt/latest/">JWT module</a>.</p>
<pre><code class="language-go">import ballerina/websocket;

listener websocket:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with JWT authentication and can be authorized
// optionally. JWT authentication can be enabled by setting the
// [`websocket:JwtValidatorConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/JwtValidatorConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@websocket:ServiceConfig {
    auth: [
        {
            jwtValidatorConfig: {
                issuer: &quot;wso2&quot;,
                audience: &quot;ballerina&quot;,
                signatureConfig: {
                    certFile: &quot;../resource/path/to/public.crt&quot;
                },
                scopeKey: &quot;scp&quot;
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /foo on securedEP {
    resource isolated function get bar() returns websocket:Service {
        return new WsService();
   }
}

service class WsService {
    *websocket:Service;
    remote isolated function onTextMessage(websocket:Caller caller,
                             string text) returns websocket:Error? {
        check caller-&gt;writeTextMessage(text);
    }
}
</code></pre>
<h4 id="output-188"><a class="header" href="#output-188">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run websocket_service_jwt_auth.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---oauth2-2"><a class="header" href="#service---oauth2-2">Service - OAuth2</a></h1>
<p>A WebSocket service can be secured using OAuth2 and by enforcing
authorization optionally. Then, it validates the OAuth2 token sent in the
<code>Authorization</code> header against the provided configurations. This calls the
configured introspection endpoint to validate.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s). The scope can be included
in the introspection response using a custom claim attribute. That custom
claim attribute also can be configured as the <code>scopeKey</code>.<br/>
In the authorization phase, the scopes of the service are compared
against the scope included in the introspection response for at least one
match between the two sets.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/websocket;

listener websocket:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with OAuth2 authentication and can be authorized
// optionally. OAuth2 authentication can be enabled by setting the
// [`websocket:OAuth2IntrospectionConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/OAuth2IntrospectionConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@websocket:ServiceConfig {
    auth: [
        {
            oauth2IntrospectionConfig: {
                url: &quot;https://localhost:9445/oauth2/introspect&quot;,
                tokenTypeHint: &quot;access_token&quot;,
                scopeKey: &quot;scp&quot;,
                clientConfig: {
                    customHeaders: {&quot;Authorization&quot;: &quot;Basic YWRtaW46YWRtaW4=&quot;},
                    secureSocket: {
                        cert: &quot;../resource/path/to/public.crt&quot;
                    }
                }
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
service /foo on securedEP {
    resource isolated function get bar() returns websocket:Service {
        return new WsService();
   }
}

service class WsService {
    *websocket:Service;
    remote isolated function onTextMessage(websocket:Caller caller,
                             string text) returns websocket:Error? {
        check caller-&gt;writeTextMessage(text);
    }
}
</code></pre>
<h4 id="output-189"><a class="header" href="#output-189">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run websocket_service_oauth2.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---ssltls-1"><a class="header" href="#client---ssltls-1">Client - SSL/TLS</a></h1>
<p>You can use the WSS client to connect or interact with an WSS listener.
Provide the <code>websocket:ClientSecureSocket</code> configurations to the client to
initiate an WSS connection.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/websocket/latest/">WebSocket module</a>.</p>
<pre><code class="language-go">import ballerina/websocket;
import ballerina/io;

// A WebSocket client can be configured to communicate through WSS as well.
// To secure a client using TLS/SSL, the client needs to be configured with
// a certificate file of the listener.
// The [`websocket:ClientSecureSocket`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/ClientSecureSocket) record
// provides the SSL-related configurations of the client.
websocket:Client securedEP = check new(&quot;wss://localhost:9090/foo/bar&quot;,
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    check securedEP-&gt;writeTextMessage(&quot;Hello, World!&quot;);
    string textMessage = check securedEP-&gt;readTextMessage();
    io:println(textMessage);
}
</code></pre>
<h4 id="output-190"><a class="header" href="#output-190">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with SSL.
# You may need to change the trusted certificate file path.
bal run http_client_ssl_tls.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---mutual-ssl-1"><a class="header" href="#client---mutual-ssl-1">Client - Mutual SSL</a></h1>
<p>Ballerina supports mutual SSL, which is a certificate-based authentication
process in which two parties (the client and server) authenticate each other by
verifying the digital certificates. It ensures that both parties are assured
of each other's identity.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/websocket/latest/">WebSocket module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;
import ballerina/websocket;

// A WebSocket client can be configured to initiate new connections that are
// secured via mutual SSL.
// The [`websocket:ClientSecureSocket`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/ClientSecureSocket) record provides the SSL-related configurations.
websocket:Client securedEP = check new(&quot;wss://localhost:9090/foo/bar&quot;,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        },
        cert: &quot;../resource/path/to/public.crt&quot;,
        protocol: {
            name: http:TLS
        },
        ciphers: [&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;]

    }
);

public function main() returns error? {
    check securedEP-&gt;writeTextMessage(&quot;Hello, World!&quot;);
    string textMessage = check securedEP-&gt;readTextMessage();
    io:println(textMessage);
}
</code></pre>
<h4 id="output-191"><a class="header" href="#output-191">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with mutual SSL.
# You may need to change the certificate file path, private key file path, and
# trusted certificate file path.
bal run websocket_client_mutual_ssl.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---basic-auth-1"><a class="header" href="#client---basic-auth-1">Client - Basic Auth</a></h1>
<p>A client, which is secured with Basic auth can be used to connect to
a secured service.<br/>
The client is enriched with the <code>Authorization: Basic &lt;token&gt;</code> header by
passing the <code>websocket:CredentialsConfig</code> for the <code>auth</code> configuration of the
client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/websocket;

// Defines the WebSocket client to call the Basic auth secured APIs.
// The client is enriched with the `Authorization: Basic &lt;token&gt;` header by
// passing the [`websocket:CredentialsConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/CredentialsConfig) for the `auth` configuration of the
// client.
websocket:Client securedEP = check new(&quot;wss://localhost:9090/foo/bar&quot;,
    auth = {
        username: &quot;ldclakmal&quot;,
        password: &quot;ldclakmal@123&quot;
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    check securedEP-&gt;writeTextMessage(&quot;Hello, World!&quot;);
    string textMessage = check securedEP-&gt;readTextMessage();
    io:println(textMessage);
}
</code></pre>
<h4 id="output-192"><a class="header" href="#output-192">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample echo WebSocket service secured with Basic Auth.
# You may need to change the trusted certificate file path.
bal run websocket_client_basic_auth.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---bearer-token-auth-1"><a class="header" href="#client---bearer-token-auth-1">Client - Bearer Token Auth</a></h1>
<p>A client, which is secured with Bearer token auth can be used to connect to
a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>websocket:BearerTokenConfig</code> for the <code>auth</code> configuration of the
client.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/websocket;

// Defines the WebSocket client to call the secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`websocket:BearerTokenConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/BearerTokenConfig) for the `auth` configuration of the
// client.
websocket:Client securedEP = check new(&quot;wss://localhost:9090/foo/bar&quot;,
    auth = {
        token: &quot;56ede317-4511-44b4-8579-a08f094ee8c5&quot;
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    check securedEP-&gt;writeTextMessage(&quot;Hello, World!&quot;);
    string textMessage = check securedEP-&gt;readTextMessage();
    io:println(textMessage);
}
</code></pre>
<h4 id="output-193"><a class="header" href="#output-193">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a secured sample service.
# You may need to change the trusted certificate file path.
bal run websocket_client_bearer_token_auth.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---self-signed-jwt-auth-1"><a class="header" href="#client---self-signed-jwt-auth-1">Client - Self Signed JWT Auth</a></h1>
<p>A client, which is secured with self-signed JWT can be used to connect to
a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>websocket:JwtIssuerConfig</code> to the <code>auth</code> configuration of the
client. A self-signed JWT is issued before the request is sent.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/websocket;

// Defines the WebSocket client to call the JWT auth secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`websocket:JwtIssuerConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/JwtIssuerConfig) for the `auth` configuration of the
// client. A self-signed JWT is issued before the request is sent.
websocket:Client securedEP = check new(&quot;wss://localhost:9090/foo/bar&quot;,
    auth = {
        username: &quot;ballerina&quot;,
        issuer: &quot;wso2&quot;,
        audience: [&quot;ballerina&quot;, &quot;ballerina.org&quot;, &quot;ballerina.io&quot;],
        keyId: &quot;5a0b754-895f-4279-8843-b745e11a57e9&quot;,
        jwtId: &quot;JlbmMiOiJBMTI4Q0JDLUhTMjU2In&quot;,
        customClaims: { &quot;scp&quot;: &quot;admin&quot; },
        expTime: 3600,
        signatureConfig: {
            config: {
                keyFile: &quot;../resource/path/to/private.key&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    check securedEP-&gt;writeTextMessage(&quot;Hello, World!&quot;);
    string textMessage = check securedEP-&gt;readTextMessage();
    io:println(textMessage);
}
</code></pre>
<h4 id="output-194"><a class="header" href="#output-194">Output</a></h4>
<pre><code class="language-bash"># Before testing this sample, first start a sample service secured with JWT Auth.
# You may need to change the trusted certificate file path and private key file path.
bal run websocket_client_self_signed_jwt_auth.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-client-credentials-grant-type-1"><a class="header" href="#client---oauth2-client-credentials-grant-type-1">Client - OAuth2 Client Credentials Grant Type</a></h1>
<p>A client, which is secured with OAuth2 client credentials grant type
can be used to connect to a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>websocket:OAuth2ClientCredentialsGrantConfig</code> for the <code>auth</code>
configuration of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/websocket;

// Defines the WebSocket client to call the OAuth2 secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`websocket:OAuth2ClientCredentialsGrantConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/OAuth2ClientCredentialsGrantConfig) for the `auth` configuration
// of the client.
websocket:Client securedEP = check new(&quot;wss://localhost:9090/foo/bar&quot;,
    auth = {
        tokenUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    check securedEP-&gt;writeTextMessage(&quot;Hello, World!&quot;);
    string textMessage = check securedEP-&gt;readTextMessage();
    io:println(textMessage);
}
</code></pre>
<h4 id="output-195"><a class="header" href="#output-195">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with OAuth2.
# You may need to change the trusted certificate file path.
bal run websocket_client_oauth2_client_credentials_grant_type.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-password-grant-type-1"><a class="header" href="#client---oauth2-password-grant-type-1">Client - OAuth2 Password Grant Type</a></h1>
<p>A client, which is secured with OAuth2 password grant type can be used to
connect to a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>websocket:OAuth2PasswordGrantConfig</code> to the <code>auth</code> configuration of
the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/websocket;

// Defines the WebSocket client to call the OAuth2 secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`websocket:OAuth2PasswordGrantConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/OAuth2PasswordGrantConfig) to the `auth` configuration of the
// client.
websocket:Client securedEP = check new(&quot;wss://localhost:9090/foo/bar&quot;,
    auth = {
        tokenUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        username: &quot;admin&quot;,
        password: &quot;admin&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        refreshConfig: {
            refreshUrl: &quot;https://localhost:9445/oauth2/token&quot;,
            scopes: [&quot;hello&quot;],
            clientConfig: {
                secureSocket: {
                    cert: &quot;../resource/path/to/public.crt&quot;
                }
            }
        },
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    check securedEP-&gt;writeTextMessage(&quot;Hello, World!&quot;);
    string textMessage = check securedEP-&gt;readTextMessage();
    io:println(textMessage);
}
</code></pre>
<h4 id="output-196"><a class="header" href="#output-196">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with OAuth2.
# You may need to change the trusted certificate file path.
bal run websocket_client_oauth2_password_grant_type.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-refresh-token-grant-type-1"><a class="header" href="#client---oauth2-refresh-token-grant-type-1">Client - OAuth2 Refresh Token Grant Type</a></h1>
<p>A client, which is secured with an OAuth2 refresh token grant type can be
used to connect to a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>websocket:OAuth2RefreshTokenGrantConfig</code> to the <code>auth</code>
configuration of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/websocket;

// Defines the WebSocket client to call the OAuth2 secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`websocket:OAuth2RefreshTokenGrantConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/OAuth2RefreshTokenGrantConfig) for the `auth` configuration of the
// client.
websocket:Client securedEP = check new(&quot;wss://localhost:9090/foo/bar&quot;,
    auth = {
        refreshUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        refreshToken: &quot;24f19603-8565-4b5f-a036-88a945e1f272&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    check securedEP-&gt;writeTextMessage(&quot;Hello, World!&quot;);
    string textMessage = check securedEP-&gt;readTextMessage();
    io:println(textMessage);
}
</code></pre>
<h4 id="output-197"><a class="header" href="#output-197">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with OAuth2.
# You may need to change the trusted certificate file path.
bal run websocket_client_oauth2_refresh_token_grant_type.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-jwt-bearer-grant-type-1"><a class="header" href="#client---oauth2-jwt-bearer-grant-type-1">Client - OAuth2 JWT Bearer Grant Type</a></h1>
<p>A client, which is secured with an OAuth2 JWT bearer grant type can be
used to connect to a secured service.<br/>
The client is enriched with the <code>Authorization: Bearer &lt;token&gt;</code> header by
passing the <code>websocket:OAuth2JwtBearerGrantConfig</code> to the <code>auth</code>
configuration of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/websocket;

// Defines the WebSocket client to call the OAuth2 secured APIs.
// The client is enriched with the `Authorization: Bearer &lt;token&gt;` header by
// passing the [`websocket:OAuth2JwtBearerGrantConfig`](https://docs.central.ballerina.io/ballerina/websocket/latest/records/OAuth2JwtBearerGrantConfig) for the `auth` configuration of the
// client.
websocket:Client securedEP = check new(&quot;wss://localhost:9090/foo/bar&quot;,
    auth = {
        tokenUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        assertion: &quot;eyJhbGciOiJFUzI1NiIsImtpZCI6Ij[...omitted for brevity...]&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    check securedEP-&gt;writeTextMessage(&quot;Hello, World!&quot;);
    string textMessage = check securedEP-&gt;readTextMessage();
    io:println(textMessage);
}
</code></pre>
<h4 id="output-198"><a class="header" href="#output-198">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample service secured with OAuth2.
# You may need to change the trusted certificate file path.
bal run websocket_client_oauth2_jwt_bearer_grant_type.bal
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="websub"><a class="header" href="#websub">WebSub</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="websub-subscriber-service"><a class="header" href="#websub-subscriber-service">Websub Subscriber Service</a></h1>
<p>Ballerina provides the capability to easily introduce subscriber services that are WebSub-compliant.
Ballerina WebSub subscribers can specify the topic and hub to which they wish to subscribe to receive notifications. 
If not specified WebSub Subscriber Services will auto generate a unique random service path segment. 
Ballerina WebSub Subscriber Services could thus be registered as WebHooks to receive event notifications.
In this example, a WebSub Subscriber service is used to implement a GitHub-based WebHook service.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/websub/latest/">WebSub module</a>.</p>
<pre><code class="language-go">// The Ballerina WebSub Subscriber service, which could be used as a WebHook Listener for GitHub.
import ballerina/websub;
import ballerina/io;

// Annotation-based configurations specifying the subscription parameters.
@websub:SubscriberServiceConfig {
    target: [
        &quot;https://api.github.com/hub&quot;, 
        &quot;https://github.com/&lt;YOUR_ORGANIZATION&gt;/&lt;REPOSITORY&gt;/events/push.json&quot;
    ],
    secret: &quot;&lt;YOUR_SECRET_KEY&gt;&quot;,
    httpConfig: {
        auth: {
            token: &quot;&lt;YOUR_AUTH_TOKEN&gt;&quot;
        }
    }
}
service /JuApTOXq19 on new websub:Listener(9090) {
    // Defines the remote function that accepts the event notification request for the WebHook.
    remote function onEventNotification(
                    websub:ContentDistributionMessage event) returns error? {
        var retrievedContent = event.content;
        if (retrievedContent is json) {
            if (retrievedContent.zen is string) {
                int hookId = check retrievedContent.hook_id;
                json sender = check retrievedContent.sender;
                int senderId = check sender.id;
                io:println(string`PingEvent received for webhook [${hookId}]`);
                io:println(string`Event sender [${senderId}]`);
            } else if (retrievedContent.ref is string) {
                json repository = check retrievedContent.repository;
                string repositoryName =  check repository.name;
                string lastUpdatedTime =  check repository.updated_at;
                io:println(string`PushEvent received for [${repositoryName}]`);
                io:println(string`Last updated at ${lastUpdatedTime}`);
            }
        } else {
            io:println(&quot;Unrecognized content type, hence ignoring&quot;);
        }
    }
}
</code></pre>
<h4 id="output-199"><a class="header" href="#output-199">Output</a></h4>
<pre><code class="language-bash">bal run websub_webhook_sample.bal
time = 2022-01-24T17:48:07.207+05:30 level = WARN module = ballerina/websub message = &quot;HTTPS is recommended but using HTTP&quot;
PingEvent received for webhook [287075824]
Event sender [77491511]
PushEvent received for [Hello-World]
Last updated at 2021-03-15T15:43:01Z
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="resiliency"><a class="header" href="#resiliency">Resiliency</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="circuit-breaker"><a class="header" href="#circuit-breaker">Circuit Breaker</a></h1>
<p>The Circuit Breaker is used to gracefully handle network related errors, which occur when using the HTTP Client. Behavior of this example is something similar to as follows,</p>
<ol>
<li>First two requests works, 2) Third request fails and the circuit breaker trips, 3) As a result subsequent requests fails immediately until the timeout period is reached,</li>
<li>Timeout is reached and the circuit breaker falls back to closed state. <br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</li>
</ol>
<pre><code class="language-go">import ballerina/http;

// The circuit breaker looks for errors across a rolling time window.
// After the circuit is broken, it does not send requests to
// the backend until the `resetTime`.
http:Client cbrBackend = check new (&quot;http://localhost:8080&quot;, {
            // Configuration options that control the behavior of the circuit
            // breaker.
            circuitBreaker: {
                // Failure calculation window. This is how long the circuit
                // breaker keeps the statistics for the operations.
                rollingWindow: {

                    // Time period in seconds for which the failure
                    // threshold is calculated.
                    timeWindow: 10,

                    // The granularity (in seconds) at which the time
                    // window slides. The `RollingWindow` is divided into
                    // buckets and slides by these increments.
                    bucketSize: 2,

                    // Minimum number of requests in the `RollingWindow` that
                    // will trip the circuit.
                    requestVolumeThreshold: 0

                },
                // The threshold for request failures.
                // When this threshold exceeds, the circuit trips. This is the
                // ratio between failures and total requests. The ratio is
                // calculated using the requests received within the given
                // rolling window.
                failureThreshold: 0.2,

                // The time period (in seconds) to wait before attempting to
                // make another request to the upstream service.
                resetTime: 10,

                // HTTP response status codes that are considered as failures
                statusCodes: [400, 404, 500]

            },
            timeout: 2
        }
    );

service / on new http:Listener(9090) {
    resource function get cb() returns string|error {
        string payload = check cbrBackend-&gt;get(&quot;/hello&quot;);
        return payload;
    }
}

// This sample service is used to mock connection timeouts and service outages.
// This should run separately from the above service.
service / on new http:Listener(8080) {
    private int counter = 1;
    resource function get hello() returns string|http:InternalServerError {
        if (self.counter % 5 == 3) {
            self.counter += 1;
            return {body:&quot;Error occurred while processing the request.&quot;};
        } else {
            self.counter += 1;
            return &quot;Hello World!!!&quot;;
        }
    }
}
</code></pre>
<h4 id="output-200"><a class="header" href="#output-200">Output</a></h4>
<pre><code class="language-bash"># Keep sending the below request to experience how circuit breaker works.
curl http://localhost:9090/cb
Hello World!!!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="load-balancer"><a class="header" href="#load-balancer">Load Balancer</a></h1>
<p>An HTTP load balancing endpoint is used when the request load needs to be load balanced across a given 
set of target endpoints.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;

// Create an endpoint with port 8080 for the mock backend services.
listener http:Listener backendEP = check new (8080);

// Define the load balance client endpoint to call the backend services.
final http:LoadBalanceClient lbBackendEP = check new ({
        // Define the set of HTTP clients that need to be load balanced.
        targets: [
            {url: &quot;http://localhost:8080/mock1&quot;},
            {url: &quot;http://localhost:8080/mock2&quot;},
            {url: &quot;http://localhost:8080/mock3&quot;}
        ],

        timeout: 5
});

service / on new http:Listener(9090) {
    resource function 'default lb() returns string|error {
        string payload = check lbBackendEP-&gt;get(&quot;/&quot;);
        return payload;
    }
}

// Define the mock backend services, which are called by the load balancer.
service /mock1 on backendEP {
    resource function get .() returns string {
        return &quot;Mock1 resource was invoked.&quot;;
    }
}

service /mock2 on backendEP {
    resource function get .() returns string {
        return &quot;Mock2 resource was invoked.&quot;;
    }
}

service /mock3 on backendEP {
    resource function get .() returns string {
        return &quot;Mock3 resource was invoked.&quot;;
    }
}
</code></pre>
<h4 id="output-201"><a class="header" href="#output-201">Output</a></h4>
<pre><code class="language-bash"># To invoke the Load Balancer Demo Service, use the cURL command below.
curl  http://localhost:9090/lb
Mock1 resource was invoked.

# Repeat the same cURL command to invoke the service again and it will be load balanced to the second mock service.
curl http://localhost:9090/lb
Mock2 resource was invoked.

# The following request will be load balanced to the third mock service.
curl http://localhost:9090/lb
Mock3 resource was invoked.

# The following request will be load balanced to the first mock service again.
curl http://localhost:9090/lb
Mock1 resource was invoked.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="failover"><a class="header" href="#failover">Failover</a></h1>
<p>Ballerina users can configure multiple HTTP clients in a given failover group. 
If one of the HTTP clients (dependencies) fails, Ballerina automatically fails over to another endpoint.
The following example depicts the <code>FailoverClient</code> behaviour with three target services. The first two targets
are configured to mimic failure backends.
After the first invocation the client resumes the failover from the last successful target. In this case it is
the third target and the client will get the immediate response for subsequent calls.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/lang.runtime;

// Define the failover client endpoint to call the backend services.
http:FailoverClient foBackendEP = check new ({

    timeout: 5,
    failoverCodes: [501, 502, 503],
    interval: 5,
    // Define a set of HTTP Clients that are targeted for failover.
    targets: [
            {url: &quot;http://nonexistentEP/mock1&quot;},
            {url: &quot;http://localhost:8080/echo&quot;},
            {url: &quot;http://localhost:8080/mock&quot;}
        ]
});

service / on new http:Listener(9090) {
    resource function 'default fo() returns string|error {
        string payload = check foBackendEP-&gt;get(&quot;/&quot;);
        return payload;
    }
}

// Define the sample service to mock connection timeouts and service outages.
service / on new http:Listener(8080) {
    resource function 'default echo() returns string {

        // Delay the response for 30 seconds to mimic network level delays.
        runtime:sleep(30);
        return &quot;echo Resource is invoked&quot;;
    }

    // Define the sample resource to mock a healthy service.
    resource function 'default mock() returns string {
        return &quot;Mock Resource is Invoked.&quot;;
    }
}
</code></pre>
<h4 id="output-202"><a class="header" href="#output-202">Output</a></h4>
<pre><code class="language-bash"># To invoke the Failover Service, use the cURL command below.
# The first invocation will take a while but the subsequent invocations will be faster.
curl http://localhost:9090/fo
Mock Resource is Invoked.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="retry-1"><a class="header" href="#retry-1">Retry</a></h1>
<p>The HTTP retry client tries sending over the same request to the backend service when there is a network level failure.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/log;
import ballerina/lang.runtime;

http:Client backendClientEP = check new (&quot;http://localhost:8080&quot;, {
            // Retry configuration options.
            retryConfig: {

                // Initial retry interval in seconds.
                interval: 3,

                // Number of retry attempts before giving up.
                count: 3,

                // Multiplier of the retry interval to exponentially increase
                // the retry interval.
                backOffFactor: 2.0,

                // Upper limit of the retry interval in seconds. If
                // `interval` into `backOffFactor` value exceeded
                // `maxWaitInterval` interval value,
                // `maxWaitInterval` will be considered as the retry
                // interval.
                maxWaitInterval: 20

            },
            timeout: 2
        }
    );


service / on new http:Listener(9090) {
    resource function 'default 'retry() returns string|error {
        string payload = check backendClientEP-&gt;get(&quot;/hello&quot;);
        return payload;
    }
}


// This sample service is used to mock connection timeouts and service outages.
// The service outage is mocked by stopping/starting this service.
// This should run separately from the `retry` service.
service / on new http:Listener(8080) {
    private int counter = 0;

    resource function get hello() returns string {
        self.counter += 1;
        // Delay the response by 5 seconds to mimic network level delays.
        if (self.counter % 4 != 0) {
            log:printInfo(
                &quot;Request received from the client to delayed service.&quot;);
            runtime:sleep(5);

            return &quot;Hello World!!!&quot;;
        } else {
            log:printInfo(
                &quot;Request received from the client to healthy service.&quot;);
            return &quot;Hello World!!!&quot;;
        }
    }
}
</code></pre>
<h4 id="output-203"><a class="header" href="#output-203">Output</a></h4>
<pre><code class="language-bash">bal run http_retry.bal.bal
time = 2021-01-21 19:00:21,374 level = INFO  module = &quot;&quot; message = &quot;Request received from the client to delayed service.&quot;
time = 2021-01-21 19:00:26,379 level = INFO  module = &quot;&quot; message = &quot;Request received from the client to delayed service.&quot;
time = 2021-01-21 19:00:34,402 level = INFO  module = &quot;&quot; message = &quot;Request received from the client to delayed service.&quot;
time = 2021-01-21 19:00:48,404 level = INFO  module = &quot;&quot; message = &quot;Request received from the client to healthy service.&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="timeout"><a class="header" href="#timeout">Timeout</a></h1>
<p>The Timeout is used to gracefully handle network timeouts, which occur when using the HTTP Client.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/http/latest/">HTTP module</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/lang.runtime;

final http:Client backendClientEP = check new (&quot;http://localhost:8080&quot;, {
    // Timeout configuration.
    timeout: 10
});

// Create an HTTP service bound to the listener endpoint.
service / on new http:Listener(9090) {

    resource function get timeout() returns string|http:InternalServerError {
        string|error response = backendClientEP-&gt;get(&quot;/hello&quot;);

        // If `response` is a `string` (text/plain), it is sent back to the
        // client. If `response` is an `http:ClientError`, an internal
        // server error is returned to the client.
        if (response is string) {
            return response;
        } else {
            if (response is http:IdleTimeoutError) {
                return { body: 
                &quot;Request timed out. Please try again in sometime.&quot;};
            } else {
                return { body: response.message()};
            }
        }

    }
}

// This sample service is used to mock connection timeouts.
service / on new http:Listener(8080) {

    resource function get hello() returns string {
        // Delay the response by 15 seconds to mimic the network level delays.
        runtime:sleep(15);
        return &quot;Hello World!!!&quot;;
    }
}
</code></pre>
<h4 id="output-204"><a class="header" href="#output-204">Output</a></h4>
<pre><code class="language-bash">// Invoke the service using &quot;cURL&quot;.
curl -v http://localhost:9090/timeout
*   Trying 127.0.0.1:9090...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 9090 (#0)
&gt; GET /timeout HTTP/1.1
&gt; Host: localhost:9090
&gt; User-Agent: curl/7.68.0
&gt; Accept: */*
&gt; 
* Mark bundle as not supporting multiuse
&lt; HTTP/1.1 500 Internal Server Error
&lt; content-type: text/plain
&lt; content-length: 48
&lt; server: ballerina
&lt; date: Mon, 21 Sep 2020 20:36:56 +0530
&lt; 
* Connection #0 to host localhost left intact
Request timed out. Please try again in sometime.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="listeners"><a class="header" href="#listeners">Listeners</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dynamic-listener"><a class="header" href="#dynamic-listener">Dynamic Listener</a></h1>
<p>Dynamic listeners allow registering/deregistering a module listener dynamically.
This example demonstrates how to register and deregister an HTTP listener
and terminate it in the process.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/lang.runtime;
import ballerina/log;

final http:Listener httpListener = check new (9090);

http:Service helloService =  service object {

    resource function get sayHello(http:Caller caller, http:Request req) {
        // Send a response back to the caller.
        var respondResult = caller-&gt;respond(&quot;Hello, World!&quot;);
        if (respondResult is error) {
            log:printError(&quot;Error occurred when responding.&quot;, 
                'error = respondResult);
        }
    }

    // The resource function that will shutdown the server.
    resource function get shutDownServer(http:Caller caller, http:Request req) {
        // Send a response back to the caller.
        var respondResult = caller-&gt;respond(&quot;Shutting down the server&quot;);
        // Stop the listener.
        // This will be called automatically if the program exits by means of a system call.
        var stopResult = httpListener.gracefulStop();
        // Deregister the listener dynamically.
        runtime:deregisterListener(httpListener);
        // Handle the errors at the end.
        if (respondResult is error) {
            log:printError(&quot;Error occurred when responding.&quot;, 
                'error = respondResult);
        } 
        if (stopResult is error) {
            log:printError(&quot;Error occurred when stopping the listener. &quot;, 
                'error = stopResult);
        }
    }
};

public function main() returns error? {
    // Attach the service to the listener.
    check httpListener.attach(helloService);
    // Start the listener.
    check httpListener.'start();
    // Register the listener dynamically.
    runtime:registerListener(httpListener);
}
</code></pre>
<h4 id="output-205"><a class="header" href="#output-205">Output</a></h4>
<pre><code class="language-bash"># Invoke the service using &quot;cURL&quot;.
curl http://localhost:9090/sayHello
Hello, World!

# Invoke the shutdown resource to deregister the listener.
curl http://localhost:9090/shutDownServer
Shutting down the server
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="grpc"><a class="header" href="#grpc">gRPC</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="simple-rpc"><a class="header" href="#simple-rpc">Simple RPC</a></h1>
<p>The gRPC Server Connector exposes the gRPC service over HTTP2.
This example demonstrates how the gRPC simple service interacts with the gRPC client.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/grpc/latest/">GRPC module</a>.</p>
<pre><code class="language-go">// This is the server implementation of the simple RPC scenario.
import ballerina/grpc;

@grpc:ServiceDescriptor {
    descriptor: ROOT_DESCRIPTOR_GRPC_SIMPLE,
    descMap: getDescriptorMapGrpcSimple()
}
service &quot;HelloWorld&quot; on new grpc:Listener(9090) {

    remote function hello(string request) returns string|error {
        // Reads the request message and sends a response.
        return &quot;Hello &quot; + request;
    }
}
</code></pre>
<h4 id="output-206"><a class="header" href="#output-206">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina package.
# Copy the generated `grpc_simple_pb.bal` stub file to the package.
# For example, if you create a package named `service`, copy the stub file to the `service` package.

# Create a new `grpc_simple.bal` Ballerina file inside the `service` package and add the service implementation.

# Execute the command below to build the 'service' package.
`bal build service`

# Run the service using the command below.
bal run service/target/bin/service.jar
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="simple-rpc-with-headers"><a class="header" href="#simple-rpc-with-headers">Simple RPC With Headers</a></h1>
<p>The gRPC Server Connector exposes the gRPC service over HTTP2.
This example demonstrates how the gRPC simple service interacts with the gRPC client, and how
header values are handled.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/grpc/latest/">GRPC module</a>.</p>
<pre><code class="language-go">// This is the server implementation of the simple RPC scenario.
import ballerina/grpc;
import ballerina/log;
import ballerina/protobuf.types.wrappers;

@grpc:ServiceDescriptor {
    descriptor: ROOT_DESCRIPTOR_GRPC_SIMPLE_WITH_HEADERS,
    descMap: getDescriptorMapGrpcSimpleWithHeaders()
}
service &quot;HelloWorld&quot; on new grpc:Listener(9090) {

    remote function hello(wrappers:ContextString request)
                        returns wrappers:ContextString|error {
        // Reads the request message and creates a response.
        string message = &quot;Hello &quot; + request.content;

        // Reads the header value in the request message by passing the request header map and header key.
        string reqHeader = check grpc:getHeader(request.headers,
                &quot;client_header_key&quot;);
        log:printInfo(&quot;Server received header value: &quot; + reqHeader);

        // Sends the response with the header.
        return {content: message, headers: {server_header_key:
        &quot;Response Header value&quot;}};
    }
}
</code></pre>
<h4 id="output-207"><a class="header" href="#output-207">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina package.
# Copy the generated `grpc_simple_with_headers_pb.bal` stub file to the package.
# For example, if you create a package named `service`, copy the stub file to the `service` package.

# Create a new `grpc_simple_with_headers.bal` Ballerina file inside the `service` package and add the service implementation.

# Execute the command below to build the 'service' package.
`bal build service`

# Run the service using the command below.
`bal run service/target/bin/service.jar`
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="server-streaming-rpc"><a class="header" href="#server-streaming-rpc">Server Streaming RPC</a></h1>
<p>The gRPC Server Connector is used to expose gRPC services over HTTP/2.
This example includes a gRPC server streaming service and a client. The
client sends a request to the server and gets a stream to read the messages until all the messages are read.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/grpc/latest/">GRPC module</a>.</p>
<pre><code class="language-go">// This is the client implementation for the server streaming scenario.
import ballerina/grpc;
import ballerina/io;

// Creates a gRPC client to interact with the remote server.
HelloWorldClient ep = check new(&quot;http://localhost:9090&quot;);

public function main () returns error? {
    // Executes the streaming RPC call and gets the response as a stream.
    stream&lt;string, grpc:Error?&gt; result = check ep-&gt;lotsOfReplies(&quot;WSO2&quot;);
    // Iterates through the stream and prints the content.
    check result.forEach(function(string str) {
        io:println(str);
    });
}
</code></pre>
<h4 id="output-208"><a class="header" href="#output-208">Output</a></h4>
<pre><code class="language-bash"># Create new Protocol Buffers definition file `grpc_server_streaming.proto` and add service definition.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_server_streaming.proto  --output stubs

# Once you run the command, `grpc_server_streaming_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client-streaming-rpc"><a class="header" href="#client-streaming-rpc">Client Streaming RPC</a></h1>
<p>The gRPC Server Connector is used to expose gRPC services over HTTP/2.
This example includes a gRPC client streaming service and a client. The client writes a sequence of messages and sends them to the server.
Once the client has finished writing the messages, it waits for the server to read them and return a response.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/grpc/latest/">GRPC module</a>.</p>
<pre><code class="language-go">// This is the server implementation of the client streaming scenario.
import ballerina/grpc;
import ballerina/log;

@grpc:ServiceDescriptor {
    descriptor: ROOT_DESCRIPTOR_GRPC_CLIENT_STREAMING,
    descMap: getDescriptorMapGrpcClientStreaming()
}
service &quot;HelloWorld&quot; on new grpc:Listener(9090) {
    isolated remote function lotsOfGreetings(
                            stream&lt;string, error?&gt; clientStream)
                            returns string|error {
        log:printInfo(&quot;Client connected successfully.&quot;);
        // Reads and processes each message in the client stream.
        _ = check from string name in clientStream
            do {
                log:printInfo(string `Greet received: ${name}`);
            };
        // Once the client sends a notification to indicate the end of the stream, '()' is returned by the stream.
        return &quot;Ack&quot;;
    }
}
</code></pre>
<h4 id="output-209"><a class="header" href="#output-209">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina package.
# Copy the generated `grpc_client_streaming_pb.bal` stub file to the package.
# For example, if you create a package named `service`, copy the stub file to the `service` package.

# Create a new `grpc_client_streaming.bal` Ballerina file inside the `service` package and add the service implementation.

# Execute the command below to build the 'service' package.
bal build service

# Run the service using the command below.
bal run service/target/bin/service.jar
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bidirectional-streaming-rpc"><a class="header" href="#bidirectional-streaming-rpc">Bidirectional Streaming RPC</a></h1>
<p>The gRPC Server Connector exposes the gRPC service over HTTP2.
This example demonstrates how a gRPC bidirectional streaming service and a client
operate when each of them sends a sequence of messages using a read-write stream. 
In such scenarios, the two streams operate independently. Therefore, clients and servers can read and write in any order.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/grpc/latest/">GRPC module</a>.</p>
<pre><code class="language-go">// This is the server implementation of the bidirectional streaming scenario.
import ballerina/grpc;

@grpc:ServiceDescriptor {
    descriptor: ROOT_DESCRIPTOR_GRPC_BIDIRECTIONAL_STREAMING,
    descMap: getDescriptorMapGrpcBidirectionalStreaming()
}
service &quot;Chat&quot; on new grpc:Listener(9090) {
    // The generated code of the Ballerina gRPC command does not contain ChatStringCaller.
    // To show the usage of a caller, this RPC call uses a caller to send messages to the client.
    isolated remote function chat(ChatStringCaller caller,
                    stream&lt;ChatMessage, error?&gt; clientStream) returns error? {
        // Reads and processes each message in the client stream.
        _ = check from ChatMessage chatMsg in clientStream
            do {
                checkpanic caller-&gt;sendString(
                    string `${chatMsg.name}: ${chatMsg.message}`);
            };
        // Once the client sends a notification to indicate the end of the stream, '()' is returned by the stream.
        check caller-&gt;complete();
    }
}
</code></pre>
<h4 id="output-210"><a class="header" href="#output-210">Output</a></h4>
<pre><code class="language-bash"># Create new Protocol Buffers definition file `grpc_bidirectional_streaming.proto` and add service definition.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_bidirectional_streaming.proto  --output stubs

# Once you run the command, `grpc_bidirectional_streaming_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="proto-to-ballerina"><a class="header" href="#proto-to-ballerina">Proto To Ballerina</a></h1>
<p>If you already have protocol buffer file for your service(s) you can use that to autogenerate Ballerina source code.
Currently, Ballerina supports two types of code generation. <code>service</code> generation generates a mock version of the
Ballerina service for an input proto definition.  <code>client</code> generation generates a Ballerina client endpoint for an
input proto definition.
The Ballerina code generator supports the following parameters:
<code>--input</code> The path of the .proto file. This is a mandatory parameter.
<code>--output</code> The file location in which the Ballerina client/service and the stub must be generated. This is an optional parameter.
If no value is specified for this parameter and proto definition doesn't contain package value,
the Ballerina client/service and the stub files are generated inside <code>temp</code> directory in the current location.
This path must be a project directory.
<code>--mode</code> The mode (client or server) to generate code samples.
If no value is specified for this parameter, only the stub file will be generated.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/grpc/latest/">GRPC module</a> and 
<a href="https:ballerina.io/learn/how-to-generate-code-for-protocol-buffers/">How to generate Ballerina code for Protocol Buffer Definition</a>.</p>
<pre><code class="language-go"># Execute the command below in the Ballerina tools distribution to generate the mock service.
bal grpc --input proto_to_ballerina.proto --mode service --output service

# Execute the command below in the Ballerina tools distribution to generate the client endpoint and the stub file.
bal grpc --input proto_to_ballerina.proto --mode client --output client

# Execute the command below in the Ballerina tools distribution to generate the stub file.
bal grpc --input proto_to_ballerina.proto
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="grpc-security"><a class="header" href="#grpc-security">gRPC Security</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---ssltls-3"><a class="header" href="#service---ssltls-3">Service - SSL/TLS</a></h1>
<p>You can use the gRPC listener to connect to or interact with a gRPC client
secured with SSL/TLS.
Provide the <code>grpc:ListenerSecureSocket</code> configurations to the server to
expose an HTTPS connection over HTTP/2.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/grpc/latest/">gRPC module</a>.</p>
<pre><code class="language-go">import ballerina/grpc;

// A gRPC listener can be configured to communicate through SSL/TLS as well.
// To secure a listener using SSL/TLS, the listener needs to be configured
// with a certificate file and a private key file for the listener.
// The [`grpc:ListenerSecureSocket`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/ListenerSecureSocket) record
// provides the SSL-related listener configurations of the listener.
listener grpc:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;./resources/public.crt&quot;,
            keyFile: &quot;./resources/private.key&quot;
        }
    }
);

@grpc:ServiceDescriptor {
    descriptor: ROOT_DESCRIPTOR_GRPC_SERVICE,
    descMap: getDescriptorMapGrpcService()
}
service &quot;HelloWorld&quot; on securedEP {
    remote function hello() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-211"><a class="header" href="#output-211">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_service.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_service.proto --output stubs

# Once you run the command, `grpc_service_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---mutual-ssl-3"><a class="header" href="#service---mutual-ssl-3">Service - Mutual SSL</a></h1>
<p>Ballerina supports mutual SSL, which is a certificate-based authentication
process in which two parties (the client and server) authenticate each other by
verifying the digital certificates. It ensures that both parties are assured
of each other's identity.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/grpc/latest/">gRPC module</a>.</p>
<pre><code class="language-go">import ballerina/grpc;

// A gRPC listener can be configured to accept new connections that are
// secured via mutual SSL.
// The [`grpc:ListenerSecureSocket`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/ListenerSecureSocket) record provides the SSL-related listener configurations.
listener grpc:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        },
        // Enables mutual SSL.
        mutualSsl: {
            verifyClient: grpc:REQUIRE,
            cert: &quot;../resource/path/to/public.crt&quot;
        },
        // Enables the preferred SSL protocol and its versions.
        protocol: {
            name: grpc:TLS,
            versions: [&quot;TLSv1.2&quot;, &quot;TLSv1.1&quot;]
        },
        // Configures the preferred ciphers.
        ciphers: [&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;]

    }
);

@grpc:ServiceDescriptor {
    descriptor: ROOT_DESCRIPTOR_GRPC_SERVICE,
    descMap: getDescriptorMapGrpcService()
}
service &quot;HelloWorld&quot; on securedEP {
    remote function hello() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-212"><a class="header" href="#output-212">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_service.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_service.proto --output stubs

# Once you run the command, `grpc_service_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---basic-auth-file-user-store-3"><a class="header" href="#service---basic-auth-file-user-store-3">Service - Basic Auth File User Store</a></h1>
<p>A gRPC service/resource can be secured using Basic auth and optionally by
enforcing authorization. Then, it validates the Basic auth token sent as the
<code>Authorization</code> metadata against the provided configurations. This reads data
from a file, which has a TOML format. This stores the usernames, passwords
for authentication, and scopes for authorization.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s).<br/>
In the authorization phase, the scopes of the service/resource are compared
against the scope included in the user store for at least one match between
the two sets.<br/>
<code>Config.toml</code> has defined three users - alice, ldclakmal, and eve. Each user has a
password and optionally assigned scopes as an array.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/grpc;

listener grpc:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with Basic auth and can be authorized optionally.
// Using Basic auth with the file user store can be enabled by setting the
// [`grpc:FileUserStoreConfig`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/FileUserStoreConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@grpc:ServiceConfig {
    auth: [
        {
            fileUserStoreConfig: {},
            scopes: [&quot;admin&quot;]
        }
    ]
}
@grpc:ServiceDescriptor {
    descriptor: ROOT_DESCRIPTOR_GRPC_SERVICE,
    descMap: getDescriptorMapGrpcService()
}
service &quot;HelloWorld&quot; on securedEP {
    remote function hello() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-213"><a class="header" href="#output-213">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_service.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_service.proto --output stubs

# Once you run the command, `grpc_service_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---basic-auth-ldap-user-store-3"><a class="header" href="#service---basic-auth-ldap-user-store-3">Service - Basic Auth LDAP User Store</a></h1>
<p>A gRPC service/resource can be secured using Basic auth and by enforcing
authorization optionally. Then, it validates the Basic auth token sent in
the <code>Authorization</code> metadata against the provided configurations. This reads
data from the configured LDAP. This stores usernames, passwords for
authentication, and scopes for authorization.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s).<br/>
In the authorization phase, the scopes of the service/resource are compared
against the scope included in the user store for at least one match between
the two sets.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/grpc;

listener grpc:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with Basic auth and can be authorized optionally.
// Basic auth using the LDAP user store can be enabled by setting the
// [`grpc:LdapUserStoreConfig`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/LdapUserStoreConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@grpc:ServiceConfig {
    auth: [
        {
            ldapUserStoreConfig: {
                domainName: &quot;avix.lk&quot;,
                connectionUrl: &quot;ldap://localhost:389&quot;,
                connectionName: &quot;cn=admin,dc=avix,dc=lk&quot;,
                connectionPassword: &quot;avix123&quot;,
                userSearchBase: &quot;ou=Users,dc=avix,dc=lk&quot;,
                userEntryObjectClass: &quot;inetOrgPerson&quot;,
                userNameAttribute: &quot;uid&quot;,
                userNameSearchFilter: &quot;(&amp;(objectClass=inetOrgPerson)(uid=?))&quot;,
                userNameListFilter: &quot;(objectClass=inetOrgPerson)&quot;,
                groupSearchBase: [&quot;ou=Groups,dc=avix,dc=lk&quot;],
                groupEntryObjectClass: &quot;groupOfNames&quot;,
                groupNameAttribute: &quot;cn&quot;,
                groupNameSearchFilter: &quot;(&amp;(objectClass=groupOfNames)(cn=?))&quot;,
                groupNameListFilter: &quot;(objectClass=groupOfNames)&quot;,
                membershipAttribute: &quot;member&quot;,
                userRolesCacheEnabled: true,
                connectionPoolingEnabled: false,
                connectionTimeout: 5,
                readTimeout: 60
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
@grpc:ServiceDescriptor {
    descriptor: ROOT_DESCRIPTOR_GRPC_SERVICE,
    descMap: getDescriptorMapGrpcService()
}
service &quot;HelloWorld&quot; on securedEP {
    remote function hello() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-214"><a class="header" href="#output-214">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_service.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_service.proto --output stubs

# Once you run the command, `grpc_service_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---jwt-auth-3"><a class="header" href="#service---jwt-auth-3">Service - JWT Auth</a></h1>
<p>A gRPC service/resource can be secured using JWT and by enforcing
authorization optionally. Then, it validates the JWT sent in the
<code>Authorization</code> metadata against the provided configurations.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s). The scope can be included
in the JWT using a custom claim attribute. That custom claim attribute
also can be configured as the <code>scopeKey</code>.<br/>
In the authorization phase, the scopes of the service/resource are compared
against the scope included in the JWT for at least one match between the two
sets.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/jwt/latest/">JWT module</a>.</p>
<pre><code class="language-go">import ballerina/grpc;

listener grpc:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with JWT authentication and can be authorized
// optionally. JWT authentication can be enabled by setting the
// [`grpc:JwtValidatorConfig`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/JwtValidatorConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@grpc:ServiceConfig {
    auth: [
        {
            jwtValidatorConfig: {
                issuer: &quot;wso2&quot;,
                audience: &quot;ballerina&quot;,
                signatureConfig: {
                    certFile: &quot;../resource/path/to/public.crt&quot;
                },
                scopeKey: &quot;scp&quot;
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
@grpc:ServiceDescriptor {
    descriptor: ROOT_DESCRIPTOR_GRPC_SERVICE,
    descMap: getDescriptorMapGrpcService()
}
service &quot;HelloWorld&quot; on securedEP {
    remote function hello() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-215"><a class="header" href="#output-215">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_service.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_service.proto --output stubs

# Once you run the command, `grpc_service_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="service---oauth2-3"><a class="header" href="#service---oauth2-3">Service - OAuth2</a></h1>
<p>A gRPC service/resource can be secured using OAuth2 and by enforcing
authorization optionally. Then, it validates the OAuth2 token sent in the
<code>Authorization</code> metadata against the provided configurations. This calls the
configured introspection endpoint to validate.<br/>
Ballerina uses the concept of scopes for authorization. A resource declared
in a service can be bound to one/more scope(s). The scope can be included
in the introspection response using a custom claim attribute. That custom
claim attribute also can be configured as the <code>scopeKey</code>.<br/>
In the authorization phase, the scopes of the service/resource are compared
against the scope included in the introspection response for at least one
match between the two sets.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/grpc;

listener grpc:Listener securedEP = new(9090,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

// The service can be secured with OAuth2 authentication and can be authorized
// optionally. OAuth2 authentication can be enabled by setting the
// [`grpc:OAuth2IntrospectionConfig`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/OAuth2IntrospectionConfig) configurations.
// Authorization is based on scopes. A scope maps to one or more groups.
// Authorization can be enabled by setting the `string|string[]` type
// configurations for `scopes` field.
@grpc:ServiceConfig {
    auth: [
        {
            oauth2IntrospectionConfig: {
                url: &quot;https://localhost:9445/oauth2/introspect&quot;,
                tokenTypeHint: &quot;access_token&quot;,
                scopeKey: &quot;scp&quot;,
                clientConfig: {
                    customHeaders: {&quot;Authorization&quot;: &quot;Basic YWRtaW46YWRtaW4=&quot;},
                    secureSocket: {
                        cert: &quot;../resource/path/to/public.crt&quot;
                    }
                }
            },
            scopes: [&quot;admin&quot;]
        }
    ]
}
@grpc:ServiceDescriptor {
    descriptor: ROOT_DESCRIPTOR_GRPC_SERVICE,
    descMap: getDescriptorMapGrpcService()
}
service &quot;HelloWorld&quot; on securedEP {
    remote function hello() returns string {
        return &quot;Hello, World!&quot;;
    }
}
</code></pre>
<h4 id="output-216"><a class="header" href="#output-216">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_service.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_service.proto --output stubs

# Once you run the command, `grpc_service_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---ssltls-2"><a class="header" href="#client---ssltls-2">Client - SSL/TLS</a></h1>
<p>You can use the gRPC client to connect or interact with a gRPC listener
secured with SSL/TLS.
Provide the <code>grpc:ClientSecureSocket</code> configurations to the client to
initiate an HTTPS connection over HTTP/2.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/grpc/latest/">gRPC module</a>.</p>
<pre><code class="language-go">import ballerina/io;

// A gRPC client can be configured to communicate through SSL/TLS as well.
// To secure a client using SSL/TLS, the client needs to be configured with
// a certificate file of the listener.
// The [`grpc:ClientSecureSocket`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/ClientSecureSocket) record
// provides the SSL-related configurations of the client.
HelloWorldClient securedEP = check new(&quot;https://localhost:9090&quot;,
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string result = check securedEP-&gt;hello();
    io:println(result);
}
</code></pre>
<h4 id="output-217"><a class="header" href="#output-217">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_client.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_client.proto --output stubs

# Once you run the command, `grpc_client_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---mutual-ssl-2"><a class="header" href="#client---mutual-ssl-2">Client - Mutual SSL</a></h1>
<p>Ballerina supports mutual SSL, which is a certificate-based authentication
process in which two parties (the client and server) authenticate each other by
verifying the digital certificates. It ensures that both parties are assured
of each other's identity.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/grpc/latest/">gRPC module</a>.</p>
<pre><code class="language-go">import ballerina/grpc;
import ballerina/io;

// A gRPC client can be configured to initiate new connections that are
// secured via mutual SSL.
// The [`grpc:ClientSecureSocket`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/ClientSecureSocket) record provides the SSL-related configurations.
HelloWorldClient securedEP = check new(&quot;https://localhost:9090&quot;,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        },
        cert: &quot;../resource/path/to/public.crt&quot;,
        protocol: {
            name: grpc:TLS
        },
        ciphers: [&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA&quot;]

    }
);

public function main() returns error? {
    string result = check securedEP-&gt;hello();
    io:println(result);
}
</code></pre>
<h4 id="output-218"><a class="header" href="#output-218">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_client.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_client.proto --output stubs

# Once you run the command, `grpc_client_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---basic-auth-2"><a class="header" href="#client---basic-auth-2">Client - Basic Auth</a></h1>
<p>A client, which is secured with Basic auth can be used to connect to
a secured service.<br/>
The client metadata is enriched with the <code>Authorization: Basic &lt;token&gt;</code>
header by passing the <code>grpc:CredentialsConfig</code> for the <code>auth</code> configuration
of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/auth/latest/">Auth module</a>.</p>
<pre><code class="language-go">import ballerina/io;

// Defines the gRPC client to call the Basic auth secured APIs.
// The client metadata is enriched with the `Authorization: Basic &lt;token&gt;`
// header by passing the [`grpc:CredentialsConfig`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/CredentialsConfig) for the `auth` configuration
// of the client.
HelloWorldClient securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        username: &quot;ldclakmal&quot;,
        password: &quot;ldclakmal@123&quot;
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string result = check securedEP-&gt;hello();
    io:println(result);
}
</code></pre>
<h4 id="output-219"><a class="header" href="#output-219">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_client.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_client.proto --output stubs

# Once you run the command, `grpc_client_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---bearer-token-auth-2"><a class="header" href="#client---bearer-token-auth-2">Client - Bearer Token Auth</a></h1>
<p>A client, which is secured with Bearer token auth can be used to connect to
a secured service.<br/>
The client metadata is enriched with the <code>Authorization: Bearer &lt;token&gt;</code>
header by passing the <code>grpc:BearerTokenConfig</code> for the <code>auth</code> configuration
of the client.</p>
<pre><code class="language-go">import ballerina/io;

// Defines the gRPC client to call the secured APIs.
// The client metadata is enriched with the `Authorization: Bearer &lt;token&gt;`
// header by passing the [`grpc:BearerTokenConfig`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/BearerTokenConfig) for the `auth` configuration
// of the client.
HelloWorldClient securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        token: &quot;56ede317-4511-44b4-8579-a08f094ee8c5&quot;
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string result = check securedEP-&gt;hello();
    io:println(result);
}
</code></pre>
<h4 id="output-220"><a class="header" href="#output-220">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_client.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_client.proto --output stubs

# Once you run the command, `grpc_client_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---self-signed-jwt-auth-2"><a class="header" href="#client---self-signed-jwt-auth-2">Client - Self Signed JWT Auth</a></h1>
<p>A client, which is secured with self-signed JWT can be used to connect to
a secured service.<br/>
The client metadata is enriched with the <code>Authorization: Bearer &lt;token&gt;</code>
header by passing the <code>http:JwtIssuerConfig</code> to the <code>auth</code> configuration
of the client. A self-signed JWT is issued before the request is sent.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/io;

// Defines the gRPC client to call the JWT auth secured APIs.
// The client metadata is enriched with the `Authorization: Bearer &lt;token&gt;`
// header by passing the [`grpc:JwtIssuerConfig`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/JwtIssuerConfig) for the `auth` configuration
// of the client. A self-signed JWT is issued before the request is sent.
HelloWorldClient securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        username: &quot;ballerina&quot;,
        issuer: &quot;wso2&quot;,
        audience: [&quot;ballerina&quot;, &quot;ballerina.org&quot;, &quot;ballerina.io&quot;],
        keyId: &quot;5a0b754-895f-4279-8843-b745e11a57e9&quot;,
        jwtId: &quot;JlbmMiOiJBMTI4Q0JDLUhTMjU2In&quot;,
        customClaims: { &quot;scp&quot;: &quot;admin&quot; },
        expTime: 3600,
        signatureConfig: {
            config: {
                keyFile: &quot;../resource/path/to/private.key&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string result = check securedEP-&gt;hello();
    io:println(result);
}
</code></pre>
<h4 id="output-221"><a class="header" href="#output-221">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_client.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_client.proto --output stubs

# Once you run the command, `grpc_client_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-client-credentials-grant-type-2"><a class="header" href="#client---oauth2-client-credentials-grant-type-2">Client - OAuth2 Client Credentials Grant Type</a></h1>
<p>A client, which is secured with OAuth2 client credentials grant type
can be used to connect to a secured service.<br/>
The client metadata is enriched with the <code>Authorization: Bearer &lt;token&gt;</code>
header by passing the <code>grpc:OAuth2ClientCredentialsGrantConfig</code> for the
<code>auth</code> configuration of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/io;

// Defines the gRPC client to call the OAuth2 secured APIs.
// The client metadata is enriched with the `Authorization: Bearer &lt;token&gt;`
// header by passing the [`grpc:OAuth2ClientCredentialsGrantConfig`]((https://docs.central.ballerina.io/ballerina/grpc/latest/records/OAuth2ClientCredentialsGrantConfig) for the
// `auth` configuration of the client.
HelloWorldClient securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        tokenUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string result = check securedEP-&gt;hello();
    io:println(result);
}
</code></pre>
<h4 id="output-222"><a class="header" href="#output-222">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_client.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_client.proto --output stubs

# Once you run the command, `grpc_client_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-password-grant-type-2"><a class="header" href="#client---oauth2-password-grant-type-2">Client - OAuth2 Password Grant Type</a></h1>
<p>A client, which is secured with OAuth2 password grant type can be used to
connect to a secured service.<br/>
The client metadata is enriched with the <code>Authorization: Bearer &lt;token&gt;</code>
header by passing the <code>grpc:OAuth2PasswordGrantConfig</code> to the <code>auth</code>
configuration of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/io;

// Defines the gRPC client to call the OAuth2 secured APIs.
// The client metadata is enriched with the `Authorization: Bearer &lt;token&gt;`
// header by passing the [`grpc:OAuth2PasswordGrantConfig`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/OAuth2PasswordGrantConfig) to the `auth`
// configuration of the client.
HelloWorldClient securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        tokenUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        username: &quot;admin&quot;,
        password: &quot;admin&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        refreshConfig: {
            refreshUrl: &quot;https://localhost:9445/oauth2/token&quot;,
            scopes: [&quot;hello&quot;],
            clientConfig: {
                secureSocket: {
                    cert: &quot;../resource/path/to/public.crt&quot;
                }
            }
        },
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string result = check securedEP-&gt;hello();
    io:println(result);
}
</code></pre>
<h4 id="output-223"><a class="header" href="#output-223">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina package.
# Copy the generated `grpc_secured_pb.bal` stub file to the package.
# For example, if you create a package named `client`, copy the stub file to the `client` package.

# Create a new `grpc_client_oauth2_password_grant_type.bal` Ballerina file inside the `client` package and add the client implementation.

# Execute the command below to build the 'client' package.
# You may need to change the trusted certificate file path.
`bal build client`

# Run the client using the command below.
# As a prerequisite, start a sample service secured with OAuth2.
bal run client/target/bin/client.jar
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-refresh-token-grant-type-2"><a class="header" href="#client---oauth2-refresh-token-grant-type-2">Client - OAuth2 Refresh Token Grant Type</a></h1>
<p>A client, which is secured with an OAuth2 refresh token grant type can be
used to connect to a secured service.<br/>
The client metadata is enriched with the <code>Authorization: Bearer &lt;token&gt;</code>
header by passing the <code>grpc:OAuth2RefreshTokenGrantConfig</code> to the <code>auth</code>
configuration of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/io;

// Defines the gRPC client to call the OAuth2 secured APIs.
// The client metadata is enriched with the `Authorization: Bearer &lt;token&gt;`
// header by passing the [`grpc:OAuth2RefreshTokenGrantConfig`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/OAuth2RefreshTokenGrantConfig) for the `auth`
// configuration of the client.
HelloWorldClient securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        refreshUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        refreshToken: &quot;24f19603-8565-4b5f-a036-88a945e1f272&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string result = check securedEP-&gt;hello();
    io:println(result);
}
</code></pre>
<h4 id="output-224"><a class="header" href="#output-224">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_client.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_client.proto --output stubs

# Once you run the command, `grpc_client_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client---oauth2-jwt-bearer-grant-type-2"><a class="header" href="#client---oauth2-jwt-bearer-grant-type-2">Client - OAuth2 JWT Bearer Grant Type</a></h1>
<p>A client, which is secured with an OAuth2 JWT bearer grant type can be
used to connect to a secured service.<br/>
The client metadata is enriched with the <code>Authorization: Bearer &lt;token&gt;</code>
header by passing the <code>grpc:OAuth2JwtBearerGrantConfig</code> to the <code>auth</code>
configuration of the client.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/oauth2/latest/">OAuth2 module</a>.</p>
<pre><code class="language-go">import ballerina/io;

// Defines the gRPC client to call the OAuth2 secured APIs.
// The client metadata is enriched with the `Authorization: Bearer &lt;token&gt;`
// header by passing the [`grpc:OAuth2JwtBearerGrantConfig`](https://docs.central.ballerina.io/ballerina/grpc/latest/records/OAuth2JwtBearerGrantConfig) for the `auth`
// configuration of the client.
HelloWorldClient securedEP = check new(&quot;https://localhost:9090&quot;,
    auth = {
        tokenUrl: &quot;https://localhost:9445/oauth2/token&quot;,
        assertion: &quot;eyJhbGciOiJFUzI1NiIsImtpZCI6Ij[...omitted for brevity...]&quot;,
        clientId: &quot;FlfJYKBD2c925h4lkycqNZlC2l4a&quot;,
        clientSecret: &quot;PJz0UhTJMrHOo68QQNpvnqAY_3Aa&quot;,
        scopes: [&quot;admin&quot;],
        clientConfig: {
            secureSocket: {
                cert: &quot;../resource/path/to/public.crt&quot;
            }
        }
    },
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

public function main() returns error? {
    string result = check securedEP-&gt;hello();
    io:println(result);
}
</code></pre>
<h4 id="output-225"><a class="header" href="#output-225">Output</a></h4>
<pre><code class="language-bash"># Create a new Protocol Buffers definition file named `grpc_client.proto` and add the service definition to it.
# Run the command below in the Ballerina tools distribution for stub generation.
bal grpc --input grpc_client.proto --output stubs

# Once you run the command, `grpc_client_pb.bal` file is generated inside stubs directory.

# For more information on how to use the Ballerina Protocol Buffers tool, see the [Proto To Ballerina](https://ballerina.io/learn/by-example/proto-to-ballerina.html) example.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nats"><a class="header" href="#nats">NATS</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="publishsubscribe"><a class="header" href="#publishsubscribe">Publish/Subscribe</a></h1>
<p>The NATS client is used either to produce a message to a subject or consume a message from a subject.
In order to execute this example, it is required that a NATS server is up and running on its default host, port, and cluster.
For instructions on installing the NATS server,
go to <a href="https:docs.nats.io/nats-server/installation">NATS Server Installation</a>.<br/><br/>
This is a simple publish/subscribe messaging pattern example.
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/nats/latest"><code>nats</code> module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/nats;

// Initializes a NATS listener.
listener nats:Listener subscription = new(nats:DEFAULT_URL);

// Binds the consumer to listen to the messages published
// to the 'demo.bbe' subject.
service &quot;demo.bbe&quot; on subscription {

    remote function onMessage(nats:Message message) returns error? {

        // Logs the incoming message.
        string|error messageContent = string:fromBytes(message.content);
        if messageContent is string {
            log:printInfo(&quot;Received message: &quot; + messageContent);
        }
    }
}
</code></pre>
<h4 id="output-226"><a class="header" href="#output-226">Output</a></h4>
<pre><code class="language-bash">bal run publisher.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="requestreply"><a class="header" href="#requestreply">Request/Reply</a></h1>
<p>The NATS client is used either to produce a message to a subject or consume a message from a subject.
In order to execute this example, it is required that a NATS server is up and running on its default host, port, and cluster.
For instructions on installing the NATS server,
go to <a href="https:docs.nats.io/nats-server/installation">NATS Server Installation</a>.<br/><br/>
This is a simple request/reply messaging pattern example.
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/nats/latest"><code>nats</code> module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/nats;

// Initializes the NATS listener.
listener nats:Listener subscription = new(nats:DEFAULT_URL);

// Binds the consumer to listen to the messages published
// to the 'demo.bbe' subject.
service &quot;demo.bbe&quot; on subscription {

    remote function onRequest(nats:Message message) returns string {

        // Logs the incoming message.
        string|error messageContent = string:fromBytes(message.content);
        if messageContent is string {
            log:printInfo(&quot;Received message: &quot; + messageContent);
        }

        // Sends the reply message to the `replyTo` subject
        // of the received message.
        return &quot;Hello Back!&quot;;
    }
}
</code></pre>
<h4 id="output-227"><a class="header" href="#output-227">Output</a></h4>
<pre><code class="language-bash">bal run publisher.bal
Reply message: Hello Back!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="secured-connection"><a class="header" href="#secured-connection">Secured Connection</a></h1>
<p>In this example, the underlying connections of the subscriber and the publisher are
secured with TLS/SSL and basic authentication.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerinax/nats/latest"><code>nats</code> module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/nats;

// Initializes a NATS listener with TLS/SSL and username/password authentication.
listener nats:Listener securedEP = new(nats:DEFAULT_URL,

    // To secure the client connections using username/password authentication, provide the credentials
    // with the [`nats:Credentials`](https://docs.central.ballerina.io/ballerinax/nats/latest/records/Credentials) record.
    auth = {
         username: &quot;alice&quot;,
         password: &quot;alice@123&quot;
    },

    // To secure the client connection using TLS/SSL, the client needs to be configured with
    // a certificate file of the server.
    // The [`nats:SecureSocket`](https://docs.central.ballerina.io/ballerinax/nats/latest/records/SecureSocket)
    // record provides the SSL-related configurations of the client.
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

// Binds the consumer to listen to the messages published
// to the 'security.demo' subject.
service &quot;security.demo&quot; on securedEP {

    remote function onMessage(nats:Message message) returns error? {
        string|error messageContent = string:fromBytes(message.content);
        if messageContent is string {
            log:printInfo(&quot;Received message: &quot; + messageContent);
        }
    }
}
</code></pre>
<h4 id="output-228"><a class="header" href="#output-228">Output</a></h4>
<pre><code class="language-bash">bal run publisher.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stan"><a class="header" href="#stan">STAN</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="publishsubscribe-1"><a class="header" href="#publishsubscribe-1">Publish/Subscribe</a></h1>
<p>This sample demonstrates a basic publish/subscribe implementation of the NATS Streaming client
In order to run this sample, a NATS Streaming server should be
running on the corresponding port used in the sample.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/stan/latest">STAN module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/stan;

// Initializes the NATS Streaming listener.
listener stan:Listener lis = new(stan:DEFAULT_URL);

// Binds the consumer to listen to the messages published to the 'demo' subject.
@stan:ServiceConfig {
    subject: &quot;demo&quot;
}
service stan:Service on lis {
    remote function onMessage(stan:Message message) {
        // Prints the incoming message in the console.
        string|error messageData = string:fromBytes(message.content);
        if messageData is string {
            log:printInfo(&quot;Received message: &quot; + messageData);
        }
    }
}
</code></pre>
<h4 id="output-229"><a class="header" href="#output-229">Output</a></h4>
<pre><code class="language-bash">bal run publisher.bal
GUID m2jS6SLLefK325DWTkkwBh received for the produced message.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="queue-groups"><a class="header" href="#queue-groups">Queue Groups</a></h1>
<p>This sample demonstrates leveraging the NATS built-in load balancing
feature called &quot;distributed queues&quot;. All subscribers with the
same queue name form the queue group.  As messages on the registered
subject are published, one member of the group is chosen randomly
to receive the message. Although queue groups have multiple subscribers,
each message is consumed by only one.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/stan/latest">STAN module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/stan;

// Initializes the NATS Streaming listeners.
listener stan:Listener lis = new(stan:DEFAULT_URL);

// Binds the consumer to listen to the messages published to the 'demo' subject.
// Belongs to the queue group named &quot;sample-queue-group&quot;
@stan:ServiceConfig {
    subject: &quot;demo&quot;,
    queueGroup: &quot;sample-queue-group&quot;
}
service stan:Service on lis {
    remote function onMessage(stan:Message message) {
       // Prints the incoming message in the console.
       string|error messageData = string:fromBytes(message.content);
       if messageData is string {
            log:printInfo(&quot;Message Received to first queue group member: &quot;
                                                        + messageData);
       }
    }
}

// Belongs to the queue group named &quot;sample-queue-group&quot;
@stan:ServiceConfig {
    subject: &quot;demo&quot;,
    queueGroup: &quot;sample-queue-group&quot;
}
service stan:Service on lis {
    remote function onMessage(stan:Message message) {
       // Prints the incoming message in the console.
       string|error messageData = string:fromBytes(message.content);
       if messageData is string {
            log:printInfo(&quot;Message Received to second queue group member: &quot;
                                                        + messageData);
       }
    }
}

// Belongs to the queue group named &quot;sample-queue-group&quot;
@stan:ServiceConfig {
    subject: &quot;demo&quot;,
    queueGroup: &quot;sample-queue-group&quot;
}
service stan:Service on lis {
    remote function onMessage(stan:Message message) {
       // Prints the incoming message in the console.
       string|error messageData = string:fromBytes(message.content);
       if messageData is string {
            log:printInfo(&quot;Message Received to third queue group member: &quot;
                                                        + messageData);
       }
    }
}
</code></pre>
<h4 id="output-230"><a class="header" href="#output-230">Output</a></h4>
<pre><code class="language-bash">bal run publisher.bal
Message: First Message
GUID ywNe3mXd96jFL33ouJbFfg received for the produced message.
Message: Second Message
GUID ywNe3mXd96jFL33ouJbFkp received for the produced message.
Message: Third Message
GUID ywNe3mXd96jFL33ouJbFpy received for the produced message.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="durable-subscriptions"><a class="header" href="#durable-subscriptions">Durable Subscriptions</a></h1>
<p>This sample demonstrates creating a durable subscription
in the NATS Streaming server. Regular subscriptions remember
their position while the client is connected. If the client
disconnects, the position is lost. Durable subscriptions
remember their position even if the client is disconnected.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/stan/latest">STAN module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/stan;

// Initializes the NATS Streaming listener with a specific client ID.
listener stan:Listener lis = new(stan:DEFAULT_URL, clientId = &quot;c0&quot;);

// Provides the durable name to create a durable subscription.
@stan:ServiceConfig {
    subject: &quot;demo&quot;,
    durableName: &quot;sample-name&quot;
}
service stan:Service on lis {
    remote function onMessage(stan:Message message) {
        // Prints the incoming message in the console.
        string|error messageData = string:fromBytes(message.content);
        if messageData is string {
            log:printInfo(&quot;Received message: &quot; + messageData);
        }
    }
}
</code></pre>
<h4 id="output-231"><a class="header" href="#output-231">Output</a></h4>
<pre><code class="language-bash">bal run publisher.bal
GUID m2jS6SLLefK325DWTkkwBh received for the produced message.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="historical-message-replay"><a class="header" href="#historical-message-replay">Historical Message Replay</a></h1>
<p>This sample demonstrates leveraging the historical
message replay feature of Streaming NATS.
New subscriptions may specify a starting position in the stream of
messages stored for the channel of the subscribed subject.
Message delivery may begin at:</p>
<ol>
<li>The earliest message stored for this subject</li>
<li>The most recently stored message for this subject
prior to the start of the current subscription.</li>
<li>A historical offset from the current server date/time
(e.g., the last 30 seconds).</li>
<li>A specific message sequence number<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/stan/latest">STAN module</a>.</li>
</ol>
<pre><code class="language-go">import ballerina/log;
import ballerinax/stan;

// Initializes the NATS Streaming listener.
listener stan:Listener lis = new(stan:DEFAULT_URL);

// Binds the consumer to listen to the messages published to the 'demo' subject.
// By default, only new messages are received.
@stan:ServiceConfig {
    subject: &quot;demo&quot;
}
service stan:Service on lis {
    remote function onMessage(stan:Message message) {
        // Prints the incoming message in the console.
        string|error messageData = string:fromBytes(message.content);
        if messageData is string {
            log:printInfo(&quot;Message Received to service receiveNewOnly: &quot;
                + messageData);
        }
    }
}

// Binds the consumer to listen to the messages published to the 'demo' subject.
// Receives all the messages from the beginning.
@stan:ServiceConfig {
    subject: &quot;demo&quot;,
    startPosition: stan:FIRST
}
service stan:Service on lis {
    remote function onMessage(stan:Message message) {
        // Prints the incoming message in the console.
        string|error messageData = string:fromBytes(message.content);
        if messageData is string {
            log:printInfo(&quot;Message Received to service receiveFromBegining: &quot;
                + messageData);
        }
    }
}

// Binds the consumer to listen to the messages published to the 'demo' subject.
// Receives messages starting from the last received message.
@stan:ServiceConfig {
    subject: &quot;demo&quot;,
    startPosition: stan:LAST_RECEIVED
}
service stan:Service on lis {
    remote function onMessage(stan:Message message) {
        // Prints the incoming message in the console.
        string|error messageData = string:fromBytes(message.content);
        if messageData is string {
            log:printInfo(&quot;Message Received to service &quot; +
            &quot;receiveFromLastReceived: &quot; + messageData);
        }
    }
}

[stan:SEQUENCE_NUMBER, int] sequenceNo = [stan:SEQUENCE_NUMBER, 3];
// Binds the consumer to listen to the messages published to the 'demo' subject.
// Receives messages starting from the provided sequence number.
@stan:ServiceConfig {
    subject: &quot;demo&quot;,
    startPosition: sequenceNo
}
service stan:Service on lis {
    remote function onMessage(stan:Message message) {
        // Prints the incoming message in the console.
        string|error messageData = string:fromBytes(message.content);
        if messageData is string {
            log:printInfo(&quot;Message Received to service receiveFromGivenIndex: &quot;
                + messageData);
        }
    }
}

[stan:TIME_DELTA_START, int] timeDelta = [stan:TIME_DELTA_START, 5];
// Binds the consumer to listen to the messages published to the 'demo' subject.
// Receives messages since the provided historical time delta.
@stan:ServiceConfig {
    subject: &quot;demo&quot;,
    startPosition: timeDelta
}
service stan:Service on lis {
    remote function onMessage(stan:Message message) {
        // Prints the incoming message in the console.
        string|error messageData = string:fromBytes(message.content);
        if messageData is string {
            log:printInfo(&quot;Message Received to service receiveSinceTimeDelta: &quot;
                + messageData);
        }
    }
}
</code></pre>
<h4 id="output-232"><a class="header" href="#output-232">Output</a></h4>
<pre><code class="language-bash">bal run publisher.bal
Message: First Message
GUID UBMEgrERHdxZRqUBP05PtD received for the produced message.
Message: Second Message
GUID UBMEgrERHdxZRqUBP05Puz received for the produced message.
Message: Third Message
GUID UBMEgrERHdxZRqUBP05Pwl received for the produced message.
Message: Forth Message
GUID UBMEgrERHdxZRqUBP05PyX received for the produced message.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="secured-connection-1"><a class="header" href="#secured-connection-1">Secured Connection</a></h1>
<p>In this example, the underlying connections of the subscriber and the publisher are
secured with TLS/SSL and basic authentication.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerinax/stan/latest">STAN module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/stan;

// Initializes the NATS Streaming listener with TLS/SSL and username/password authentication.
listener stan:Listener securedEP = new(stan:DEFAULT_URL,
    clusterId = &quot;my_secure_cluster&quot;,

    // To secure the client connections using username/password authentication, provide the credentials
    // with the [`stan:Credentials`](https://docs.central.ballerina.io/ballerinax/stan/latest/records/Credentials) record.
    auth = {
         username: &quot;alice&quot;,
         password: &quot;alice@123&quot;
    },

    // To secure the client connection using TLS/SSL, the client needs to be configured with
    // a certificate file of the server.
    // The [`stan:SecureSocket`](https://docs.central.ballerina.io/ballerinax/stan/latest/records/SecureSocket)
    // record provides the SSL-related configurations of the client.
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

// Binds the consumer to listen to the messages published to the 'security.demo' subject.
@stan:ServiceConfig {
    subject: &quot;security.demo&quot;
}
service stan:Service on securedEP {
    remote function onMessage(stan:Message message) {
        // Prints the incoming message in the console.
        string|error messageData = string:fromBytes(message.content);
        if messageData is string {
            log:printInfo(&quot;Received message: &quot; + messageData);
        }
    }
}
</code></pre>
<h4 id="output-233"><a class="header" href="#output-233">Output</a></h4>
<pre><code class="language-bash">bal run publisher.bal
GUID m2jS6SLLefK325DWTkkwBh received for the produced message.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="kafka"><a class="header" href="#kafka">Kafka</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="producer"><a class="header" href="#producer">Producer</a></h1>
<p>This is an example on how to send messages to a Kafka topic using a
<code>kafka:Producer</code> object. The producer is configured to send <code>string</code>
values and <code>int</code> keys. For this example to work properly, an active Kafka
broker should be present.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/kafka/latest">Kafka module</a>.</p>
<pre><code class="language-go">import ballerinax/kafka;

kafka:Producer kafkaProducer = check new (kafka:DEFAULT_URL);

public function main() returns error? {
    string message = &quot;Hello World, Ballerina&quot;;
    // Sends the message to the Kafka topic.
    check kafkaProducer-&gt;send({
                                topic: &quot;test-kafka-topic&quot;,
                                value: message.toBytes() });

    // Flushes the sent messages.
    check kafkaProducer-&gt;'flush();
}
</code></pre>
<h4 id="output-234"><a class="header" href="#output-234">Output</a></h4>
<pre><code class="language-bash">bal run kafka_producer.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="consumer-service"><a class="header" href="#consumer-service">Consumer Service</a></h1>
<p>This is an example, which creates a Kafka consumer used as a listener
to a service with manual offset commits.
This consumer uses the builtin <code>int</code> deserializer for the keys and the
builtin <code>string</code> deserializer for the values. For this example to work
properly, an active Kafka broker should be present.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/kafka/latest">Kafka module</a>.</p>
<pre><code class="language-go">import ballerinax/kafka;
import ballerina/log;

kafka:ConsumerConfiguration consumerConfigs = {
    groupId: &quot;group-id&quot;,
    // Subscribes to the topic `test-kafka-topic`.
    topics: [&quot;test-kafka-topic&quot;],

    pollingInterval: 1,
    // Sets the `autoCommit` to `false` so that the records should be committed manually.
    autoCommit: false
};

listener kafka:Listener kafkaListener =
        new (kafka:DEFAULT_URL, consumerConfigs);

service kafka:Service on kafkaListener {
    remote function onConsumerRecord(kafka:Caller caller,
                                kafka:ConsumerRecord[] records) returns error? {
        // The set of Kafka records received by the service are processed one by one.
        foreach var kafkaRecord in records {
            check processKafkaRecord(kafkaRecord);
        }

        // Commits offsets of the returned records by marking them as consumed.
        kafka:Error? commitResult = caller-&gt;commit();

        if commitResult is error {
            log:printError(&quot;Error occurred while committing the &quot; +
                &quot;offsets for the consumer &quot;, 'error = commitResult);
        }
    }
}

function processKafkaRecord(kafka:ConsumerRecord kafkaRecord) returns error? {
    // The value should be a `byte[]` since the byte[] deserializer is used
    // for the value.
    byte[] value = kafkaRecord.value;

    // Converts the `byte[]` to a `string`.
    string messageContent = check string:fromBytes(value);
    log:printInfo(&quot;Received Message: &quot; + messageContent);
}
</code></pre>
<h4 id="output-235"><a class="header" href="#output-235">Output</a></h4>
<pre><code class="language-bash">bal run kafka_consumer_service.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="consumer-client"><a class="header" href="#consumer-client">Consumer Client</a></h1>
<p>This is an example on how to use a <code>kafka:Consumer</code> as a simple record
consumer. The records from a subscribed topic can be retrieved using the
<code>poll()</code> function.
This consumer uses the builtin byte array deserializer for both the key and
the value, which is the default deserializer in the <code>kafka:Consumer</code>. For
this example to work properly, an active Kafka broker should be present.
<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/kafka/latest">Kafka module</a>.</p>
<pre><code class="language-go">import ballerinax/kafka;
import ballerina/io;

kafka:ConsumerConfiguration consumerConfiguration = {
    groupId: &quot;group-id&quot;,
    offsetReset: &quot;earliest&quot;,
    // Subscribes to the topic `test-kafka-topic`.
    topics: [&quot;test-kafka-topic&quot;]

};

kafka:Consumer consumer = check new (kafka:DEFAULT_URL, consumerConfiguration);

public function main() returns error? {
    // Polls the consumer for messages.
    kafka:ConsumerRecord[] records = check consumer-&gt;poll(1);

    foreach var kafkaRecord in records {
        byte[] messageContent = kafkaRecord.value;
        // Converts the `byte[]` to a `string`.
        string message = check string:fromBytes(messageContent);

        // Prints the retrieved Kafka record.
        io:println(&quot;Received Message: &quot; + message);
    }
}
</code></pre>
<h4 id="output-236"><a class="header" href="#output-236">Output</a></h4>
<pre><code class="language-bash">bal run kafka_consumer_client.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transactional-producer"><a class="header" href="#transactional-producer">Transactional Producer</a></h1>
<p>This example shows you how to do transactional message producing by sending
messages to kafka brokers atomically using the <code>kafka:Producer</code> object. For
this example to work properly, an active Kafka broker should be present.
<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/kafka/latest">Kafka module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/kafka;

kafka:ProducerConfiguration producerConfigs = {
    clientId: &quot;basic-producer&quot;,
    acks: &quot;all&quot;,
    retryCount: 3,
    // The `enableIdempotence` should set to `true` to make a producer transactional.
    enableIdempotence: true,

    // A `transactionalId` must be provided to make a producer transactional.
    transactionalId: &quot;test-transactional-id&quot;
};

kafka:Producer kafkaProducer = check new (kafka:DEFAULT_URL, producerConfigs);

public function main() {
    string message = &quot;Hello World Transaction Message&quot;;
    byte[] serializedMessage = message.toBytes();
    // Creates a producer config with optional parameters.
    // The `transactionalId` enables transactional message production.
    kafkaAdvancedTransactionalProduce(serializedMessage);
}

function kafkaAdvancedTransactionalProduce(byte[] message) {
    transaction {
        kafka:Error? sendResult = kafkaProducer-&gt;send({
            topic: &quot;test-kafka-topic&quot;,
            value: message,
            partition: 0
        });
        // Checks for an error and notifies if an error has occurred.
        if sendResult is kafka:Error {
            io:println(&quot;Error occurred when sending message &quot;, sendResult);
        }

        var commitResult = commit;
        if commitResult is () {
            io:println(&quot;Transaction successful&quot;);
        } else {
            io:println(&quot;Transaction unsuccessful &quot; + commitResult.message());
        }
    }
}
</code></pre>
<h4 id="output-237"><a class="header" href="#output-237">Output</a></h4>
<pre><code class="language-bash">bal run kafka_message_producer_transactional.bal
Transaction successful
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="consumer-groups"><a class="header" href="#consumer-groups">Consumer Groups</a></h1>
<p>This is an example of a Kafka consumer used as a listener to listen to a
given topic/topics. The listener uses a group of concurrent consumers within
the service. This consumer uses the builtin <code>string</code> deserializer for the
values. For this example to work properly, an active Kafka broker should be
present.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/kafka/latest">Kafka module</a>.</p>
<pre><code class="language-go">import ballerinax/kafka;
import ballerina/log;

kafka:ConsumerConfiguration consumerConfigs = {
    // Uses two concurrent consumers to work as a group.
    concurrentConsumers: 2,

    groupId: &quot;group-id&quot;,
    // Subscribes to the `test-kafka-topic`.
    topics: [&quot;test-kafka-topic&quot;],

    pollingInterval: 1
};

listener kafka:Listener kafkaListener =
            new (kafka:DEFAULT_URL, consumerConfigs);

service kafka:Service on kafkaListener {
    // This remote function executes when a message or a set of messages are published
    // to the subscribed topic/topics.
    remote function onConsumerRecord(kafka:Caller caller,
                        kafka:ConsumerRecord[] records) returns error? {
        // The set of Kafka records received by the service are processed one
        // by one.
        foreach var kafkaRecord in records {
            check processKafkaRecord(kafkaRecord);
        }

    }
}

function processKafkaRecord(kafka:ConsumerRecord kafkaRecord) returns error? {
    byte[] messageContent = kafkaRecord.value;
    // Converts the `byte[]` to a `string`.
    string message = check string:fromBytes(messageContent);

    // Prints the retrieved message.
    log:printInfo(&quot;Received Message: &quot; + message);
}
</code></pre>
<h4 id="output-238"><a class="header" href="#output-238">Output</a></h4>
<pre><code class="language-bash">bal run kafka_consumer_group_service.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sasl-authentication---consumer"><a class="header" href="#sasl-authentication---consumer">SASL Authentication - Consumer</a></h1>
<p>This is an example of a Kafka consumer using the SASL/PLAIN authentication.
For this example to work properly, an active Kafka server must be present
and it should be configured to use the SASL/PLAIN authentication mechanism.
<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerinax/kafka/latest">Kafka module</a>.</p>
<pre><code class="language-go">import ballerinax/kafka;
import ballerina/log;

// Define the relevant SASL URL of the configured Kafka server.
const string SASL_URL = &quot;localhost:9093&quot;;

kafka:ConsumerConfiguration consumerConfig = {
    groupId: &quot;test-group&quot;,
    topics: [&quot;demo-security&quot;],
    // Provide the relevant authentication configurations to authenticate the consumer by [`kafka:AuthenticationConfiguration`](https://docs.central.ballerina.io/ballerinax/kafka/latest/records/AuthenticationConfiguration).
    auth: {
        // Provide the authentication mechanism used by the Kafka server.
        mechanism: kafka:AUTH_SASL_PLAIN,
        // Username and password should be set here in order to authenticate the consumer.
        // For information on how to secure values instead of directly using plain text values, see [Defining Configurable Variables](https://ballerina.io/learn/user-guide/configurability/defining-configurable-variables/#securing-sensitive-data-using-configurable-variables).
        username: &quot;alice&quot;,
        password: &quot;alice@123&quot;
    },
    securityProtocol: kafka:PROTOCOL_SASL_PLAINTEXT
};

listener kafka:Listener kafkaListener = new(SASL_URL, consumerConfig);

service kafka:Service on kafkaListener {
    remote function onConsumerRecord(kafka:Caller caller,
                    kafka:ConsumerRecord[] records) returns error? {
        foreach var consumerRecord in records {
            string value = check string:fromBytes(consumerRecord.value);
            log:printInfo(value);
        }
    }
}
</code></pre>
<h4 id="output-239"><a class="header" href="#output-239">Output</a></h4>
<pre><code class="language-bash">bal run kafka_authentication_sasl_plain_consumer.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sasl-authentication---producer"><a class="header" href="#sasl-authentication---producer">SASL Authentication - Producer</a></h1>
<p>This is an example of a Kafka producer using the SASL/PLAIN authentication.
For this example to work properly, an active Kafka server must be present
and it should be configured to use the SASL/PLAIN authentication mechanism.
<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerinax/kafka/latest">Kafka module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/kafka;

// Define the relevant SASL URL of the configured Kafka server.
const string SASL_URL = &quot;localhost:9093&quot;;

kafka:ProducerConfiguration producerConfig = {
    // Provide the relevant authentication configurations to authenticate the producer by [`kafka:AuthenticationConfiguration`](https://docs.central.ballerina.io/ballerinax/kafka/latest/records/AuthenticationConfiguration).
    auth: {
        // Provide the authentication mechanism used by the Kafka server.
        mechanism: kafka:AUTH_SASL_PLAIN,
        // Username and password should be set here in order to authenticate the producer.
        // For information on how to secure values instead of directly using plain text values, see [Defining Configurable Variables](https://ballerina.io/learn/user-guide/configurability/defining-configurable-variables/#securing-sensitive-data-using-configurable-variables).
        username: &quot;alice&quot;,
        password: &quot;alice@123&quot;
    },
    securityProtocol: kafka:PROTOCOL_SASL_PLAINTEXT
};

kafka:Producer kafkaProducer = check new(SASL_URL, producerConfig);

public function main() returns error? {
    string message = &quot;Hello, World!&quot;;
    check kafkaProducer-&gt;send({
        topic: &quot;demo-security&quot;,
        value: message.toBytes()
    });
    check kafkaProducer-&gt;'flush();
    io:println(&quot;Message published successfully.&quot;);
}
</code></pre>
<h4 id="output-240"><a class="header" href="#output-240">Output</a></h4>
<pre><code class="language-bash">bal run kafka_authentication_sasl_plain_producer.bal
Message published successfully.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rabbitmq"><a class="header" href="#rabbitmq">RabbitMQ</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="producer-1"><a class="header" href="#producer-1">Producer</a></h1>
<p>In this example, messages are sent to two different queues,
to one queue using the same channel and to the other using two different channels.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/rabbitmq/latest">RabbitMQ module</a>.</p>
<pre><code class="language-go">import ballerinax/rabbitmq;

public function main() returns error? {
    // Creates a ballerina RabbitMQ client.
    rabbitmq:Client newClient =
                check new(rabbitmq:DEFAULT_HOST, rabbitmq:DEFAULT_PORT);

    // Declares the queue, MyQueue.
    check newClient-&gt;queueDeclare(&quot;MyQueue&quot;);

    // Publishing messages to an exchange using a routing key.
    // Publishes the message using newClient and the routing key named MyQueue.
    string message = &quot;Hello from Ballerina&quot;;
    check newClient-&gt;publishMessage({ content: message.toBytes(),
                                            routingKey: &quot;MyQueue&quot; });
}
</code></pre>
<h4 id="output-241"><a class="header" href="#output-241">Output</a></h4>
<pre><code class="language-bash">bal run rabbitmq_producer.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="consumer"><a class="header" href="#consumer">Consumer</a></h1>
<p>In this example, the messages are consumed from an
existing queue using the Ballerina RabbitMQ message listener.
The Ballerina RabbitMQ connection used here can be re-used to create
multiple channels.
Multiple services consuming messages from the same queue or from
different queues can be attached to the same Listener.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/rabbitmq/latest">RabbitMQ module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/rabbitmq;

listener rabbitmq:Listener channelListener =
        new(rabbitmq:DEFAULT_HOST, rabbitmq:DEFAULT_PORT);

// The consumer service listens to the &quot;MyQueue&quot; queue.
// The `ackMode` is by default rabbitmq:AUTO_ACK where messages are acknowledged
// immediately after consuming.
@rabbitmq:ServiceConfig {
    queueName: &quot;MyQueue&quot;
}
// Attaches the service to the listener.
service rabbitmq:Service on channelListener {
    remote function onMessage(rabbitmq:Message message) {
        string|error messageContent = string:fromBytes(message.content);
        if messageContent is string {
            log:printInfo(&quot;Received message: &quot; + messageContent);
        }
    }
}
</code></pre>
<h4 id="output-242"><a class="header" href="#output-242">Output</a></h4>
<pre><code class="language-bash">bal run rabbitmq_consumer.bal
time = 2021-05-20T14:49:11.011+05:30 level = INFO module = &quot;&quot; message = &quot;Received message: Hello from Ballerina&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client-acknowledgements"><a class="header" href="#client-acknowledgements">Client Acknowledgements</a></h1>
<p>In this example, the messages are consumed from an
existing queue using the Ballerina RabbitMQ message listener.
The received messages are acknowledged manually.
By default, the ackMode is rabbitmq:AUTO_ACK, which will automatically acknowledge
all messages once consumed.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/rabbitmq/latest">RabbitMQ module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/rabbitmq;

listener rabbitmq:Listener channelListener =
        new(rabbitmq:DEFAULT_HOST, rabbitmq:DEFAULT_PORT);

// The consumer service listens to the &quot;MyQueue&quot; queue.
// The `ackMode` is by default rabbitmq:AUTO_ACK where messages are acknowledged
// immediately after consuming.
@rabbitmq:ServiceConfig {
    queueName: &quot;MyQueue&quot;
}
// Attaches the service to the listener.
service rabbitmq:Service on channelListener {
    remote function onMessage(rabbitmq:Message message,
                            rabbitmq:Caller caller) returns error? {
        string|error messageContent = string:fromBytes(message.content);
        if messageContent is string {
            log:printInfo(&quot;Received message: &quot; + messageContent);
        }

        // Positively acknowledges a single message.
        check caller-&gt;basicAck();
    }
}
</code></pre>
<h4 id="output-243"><a class="header" href="#output-243">Output</a></h4>
<pre><code class="language-bash">bal run rabbitmq_consumer_with_client_acknowledgement.bal
time = 2021-05-20T14:53:56.067+05:30 level = INFO module = &quot;&quot; message = &quot;Received message: Hello from Ballerina&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transactional-producer-1"><a class="header" href="#transactional-producer-1">Transactional Producer</a></h1>
<p>In this example, a message is sent to an existing queue
using the Ballerina RabbitMQ channel and Ballerina transactions.
Upon successful execution of the transaction block,
the channel will commit and rollback in the case of any error.
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerinax/rabbitmq/latest">RabbitMQ module</a>.</p>
<pre><code class="language-go">import ballerinax/rabbitmq;

public function main() returns error? {
    // Creates a ballerina RabbitMQ Client.
    rabbitmq:Client newClient =
            check new (rabbitmq:DEFAULT_HOST, rabbitmq:DEFAULT_PORT);

    // Declares the queue.
    check newClient-&gt;queueDeclare(&quot;MyQueue&quot;);
    transaction {
        string message = &quot;Hello from Ballerina&quot;;
        // Publishes the message using the routing key named &quot;MyQueue&quot;.
        check newClient-&gt;publishMessage({ content: message.toBytes(),
                                                    routingKey: &quot;MyQueue&quot; });
        check commit;
    }
}
</code></pre>
<h4 id="output-244"><a class="header" href="#output-244">Output</a></h4>
<pre><code class="language-bash">bal run rabbitmq_transaction_producer.bal
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transactional-consumer"><a class="header" href="#transactional-consumer">Transactional Consumer</a></h1>
<p>In this example, the messages are consumed from an
existing queue using the Ballerina RabbitMQ message listener
and Ballerina transactions.
Upon successful execution of the transaction block,
the acknowledgement will commit or rollback in the case of any error.
Messages will not be re-queued in the case of a rollback
automatically unless negatively acknowledged by the user.
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerinax/rabbitmq/latest">RabbitMQ module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/rabbitmq;

// The consumer service listens to the &quot;MyQueue&quot; queue.
@rabbitmq:ServiceConfig {
    queueName: &quot;MyQueue&quot;,
    autoAck: false
}
// Attaches the service to the listener.
service /transactionConsumer on
    new rabbitmq:Listener(rabbitmq:DEFAULT_HOST, rabbitmq:DEFAULT_PORT) {

    // Gets triggered when a message is received by the queue.
    remote function onMessage(rabbitmq:Message message,
                        rabbitmq:Caller caller) returns error? {

        string|error messageContent = 'string:fromBytes(message.content);
        if messageContent is string {
            log:printInfo(&quot;The message received: &quot; + messageContent);
        }

        // Acknowledges a single message positively.
        // The acknowledgement gets committed upon successful execution of the transaction,
        // or will rollback otherwise.
        transaction {
            rabbitmq:Error? result = caller-&gt;basicAck();
            if result is error {
                log:printError(
                            &quot;Error occurred while acknowledging the message.&quot;);
            }
            check commit;
        }
    }
}
</code></pre>
<h4 id="output-245"><a class="header" href="#output-245">Output</a></h4>
<pre><code class="language-bash">bal run rabbitmq_transaction_consumer.bal
time = 2021-01-18 15:15:36,514 level = INFO  module = &quot;&quot; message = &quot;The message received: Hello from Ballerina&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="secured-connection-2"><a class="header" href="#secured-connection-2">Secured Connection</a></h1>
<p>In this example, the underlying connections of the consumer and the producer are
secured with TLS/SSL and basic authentication.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerinax/rabbitmq/latest">RabbitMQ module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerinax/rabbitmq;

listener rabbitmq:Listener securedEP = new(rabbitmq:DEFAULT_HOST, 5671,

    // To secure the client connections using username/password authentication, provide the credentials
    // with the [`rabbitmq:Credentials`](https://docs.central.ballerina.io/ballerinax/rabbitmq/latest/records/Credentials) record.
    auth = {
         username: &quot;alice&quot;,
         password: &quot;alice@123&quot;
    },

    // To secure the client connection using TLS/SSL, the client needs to be configured with
    // a certificate file of the server.
    // The [`rabbitmq:SecureSocket`](https://docs.central.ballerina.io/ballerinax/rabbitmq/latest/records/SecureSocket)
    // record provides the SSL-related configurations of the client.
    secureSocket = {
        cert: &quot;../resource/path/to/public.crt&quot;
    }
);

@rabbitmq:ServiceConfig {
    queueName: &quot;Secured&quot;
}
// Attaches the service to the listener.
service rabbitmq:Service on securedEP {
    remote function onMessage(rabbitmq:Message message) {
        string|error messageContent = string:fromBytes(message.content);
        if messageContent is string {
            log:printInfo(&quot;Received message: &quot; + messageContent);
        }
    }
}
</code></pre>
<h4 id="output-246"><a class="header" href="#output-246">Output</a></h4>
<pre><code class="language-bash">bal run consumer.bal
time = 2021-05-20T14:49:11.011+05:30 level = INFO module = &quot;&quot; message = &quot;Received message: Hello from Ballerina&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tcp"><a class="header" href="#tcp">TCP</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client-1"><a class="header" href="#client-1">Client</a></h1>
<p>The TCP Client is used to connect to a remote TCP server.
This sample demonstrates how the TCP client interacts with the TCP server.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/tcp/latest">TCP module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/tcp;

public function main() returns error? {

    // Create a new TCP client by providing the `remoteHost` and `remotePort`.
    // Optionally, you can provide the interface that the socket needs to bind 
    // and the timeout in seconds, which specifies the read timeout value.
    // tcp:Client client = check new (&quot;localhost&quot;, 3000, localHost = &quot;localhost&quot;,
    //                             timeout = 5);
    tcp:Client socketClient = check new (&quot;localhost&quot;, 3000);

    // Send the desired content to the server.
    string msg = &quot;Hello Ballerina Echo from client&quot;;
    byte[] msgByteArray = msg.toBytes();
    check socketClient-&gt;writeBytes(msgByteArray);

    // Read the response from the server.
    readonly &amp; byte[] receivedData = check socketClient-&gt;readBytes();
    io:println(&quot;Received: &quot;, string:fromBytes(receivedData));

    // Close the connection between the server and the client.
    return socketClient-&gt;close();
}
</code></pre>
<h4 id="output-247"><a class="header" href="#output-247">Output</a></h4>
<pre><code class="language-bash"># As a prerequisite, start a sample TCP service.
bal run tcp_client.bal
Received: Hello Ballerina Echo from client
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="listener"><a class="header" href="#listener">Listener</a></h1>
<p>The TCP Listener is used to expose a TCP service over the TCP protocol.
This sample demonstrates how the TCP socket listener service interacts with the TCP client.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/tcp/latest">TCP module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/log;
import ballerina/tcp;

// Bind the service to the port. 
service on new tcp:Listener(3000) {

    // This remote method is invoked when the new client connects to the server.
    remote function onConnect(tcp:Caller caller)
                              returns tcp:ConnectionService {
        io:println(&quot;Client connected to echo server: &quot;, caller.remotePort);
        return new EchoService();
    }
}

service class EchoService {
    *tcp:ConnectionService;

    // This remote method is invoked once the content is received from the client.
    remote function onBytes(tcp:Caller caller, readonly &amp; byte[] data) 
        returns tcp:Error? {
        io:println(&quot;Echo: &quot;, string:fromBytes(data));
        // Echoes back the data to the client from which the data is received.
        return caller-&gt;writeBytes(data);
    }

    // This remote method is invoked in an erroneous situation,
    // which occurs during the execution of the `onConnect` or `onBytes` method.
    remote function onError(tcp:Error err) {
        log:printError(&quot;An error occurred&quot;, 'error = err);
    }

    // This remote method is invoked when the connection is closed.
    remote function onClose() {
        io:println(&quot;Client left&quot;);
    }
}
</code></pre>
<h4 id="output-248"><a class="header" href="#output-248">Output</a></h4>
<pre><code class="language-bash">bal run tcp_listener.bal
Client connected to echoServer: 48735
Echo: Hello Ballerina Echo from client
Client left
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transport-security"><a class="header" href="#transport-security">Transport Security</a></h1>
<p>This example demonstrates how the Ballerina TCP client can be configured to
connect to an SSL/TLS listener through a one-way SSL/TLS connection 
(i.e., the server is verified by the client). This example uses the Ballerina
TCP listener to host a service and the TCP client sends 
requests to that listener.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/tcp/latest">TCP module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/tcp;

// An HTTP listener can be configured to communicate through SSL/TLS as well.
// To secure a listener using SSL/TLS, the listener needs to be configured with
// a certificate file and a private key file for the listener.
// The [`tcp:ListenerSecureSocket`](https://docs.central.ballerina.io/ballerina/tcp/latest/records/ListenerSecureSocket) record
// provides the SSL-related listener configurations of the listener.
listener tcp:Listener securedListnerEP = check new(3000,
    secureSocket = {
        key: {
            certFile: &quot;../resource/path/to/public.crt&quot;,
            keyFile: &quot;../resource/path/to/private.key&quot;
        }
    }
);

service &quot;tcp&quot; on securedListnerEP {
    isolated remote function onConnect(tcp:Caller caller)
                             returns tcp:ConnectionService {
        io:println(&quot;Client connected on server port: &quot;, caller.remotePort);
        return new EchoService();
    }
}

service class EchoService {
    *tcp:ConnectionService;

    remote function onBytes(readonly &amp; byte[] data) returns byte[] {
        io:println(&quot;Received message: &quot;, string:fromBytes(data));
        return data;
    }
}
</code></pre>
<h4 id="output-249"><a class="header" href="#output-249">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path and private key file path.
bal run tcp_transport_security_service.bal
Client connected on server port: 5639
Received message: Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="udp"><a class="header" href="#udp">UDP</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="connectionless-client"><a class="header" href="#connectionless-client">Connectionless Client</a></h1>
<p>The UDP Client is used to send data to a specific remote host using the UDP protocol.
This sample demonstrates how to send a datagram to a remote server
and print the echoed response.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/udp/latest">UDP module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/udp;

public function main() returns error? {
  
    // Creates a new connectionless UDP client.
    // Optionally, you can provide the address that the socket needs to bind 
    // and the timeout in milliseconds, which specifies the read timeout value.
    // E.g.: `udp:Client client = new (localHost = &quot;localhost&quot;, timeout = 5);`
    udp:Client socketClient = check new;

    string msg = &quot;Hello Ballerina echo&quot;;
    udp:Datagram datagram = {
        remoteHost: &quot;localhost&quot;,
        remotePort : 8080,
        data : msg.toBytes()
    };

    // Sends the data to the remote host.
    // The parameter is a Datagram record, which contains the `remoteHost`,
    // `remotePort`, and the `data` to be sent.
    check socketClient-&gt;sendDatagram(datagram);
    io:println(&quot;Datagram was sent to the remote host.&quot;);

    // Waits until the data is received from the remote host.
    readonly &amp; udp:Datagram result = check socketClient-&gt;receiveDatagram();
    io:println(&quot;Received: &quot;, string:fromBytes(result.data));        

    // Closes the client and releases the bound port.
    check socketClient-&gt;close();

}
</code></pre>
<h4 id="output-250"><a class="header" href="#output-250">Output</a></h4>
<pre><code class="language-bash">bal run udp_client.bal

# This will print the output below upon a successful write.
Datagram was sent to the remote host.
# Print the response that is returned from the server as an echo.
Received: Hello Ballerina echo
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="connection-oriented-client"><a class="header" href="#connection-oriented-client">Connection-Oriented Client</a></h1>
<p>The ConnectClient is configured so that it only receives data from,
and sends data to, the given remote peer address. Once connected,
data may not be received from or sent to any other address.
The client remains connected until it is explicitly disconnected or until it is closed.
This sample demonstrates how to send data to a connected server and print the echoed response.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/udp/latest">UDP module</a>.</p>
<pre><code class="language-go">// This is the connection oriented client implementation of the UDP socket.
import ballerina/io;
import ballerina/udp;

public function main() returns error? {
  
    // Creates a new connection-oriented UDP client by providing the
    // `remoteHost` and the `remotePort`.
    // Optionally, you can provide the interface that the socket needs to bind 
    // and the timeout in milliseconds, which specifies the read timeout value.
    // E.g.: `udp:Client client = new (&quot;www.ballerina.com&quot;, 80,
    // localHost = &quot;localhost&quot;, timeout = 5);`
    udp:ConnectClient socketClient = check new(&quot;localhost&quot;, 8080);

    string msg = &quot;Hello Ballerina echo&quot;;

    // Sends the data to the connected remote host.
    // The parameter is a `byte[]`, which contains the data to be sent.
    check socketClient-&gt;writeBytes(msg.toBytes());
    io:println(&quot;Data was sent to the remote host.&quot;);

    // Waits until the data is received from the connected host.
    readonly &amp; byte[] result = check socketClient-&gt;readBytes();
    io:println(&quot;Received: &quot;, string:fromBytes(result));

    // Closes the client and releases the bound port.
    check socketClient-&gt;close();

}
</code></pre>
<h4 id="output-251"><a class="header" href="#output-251">Output</a></h4>
<pre><code class="language-bash">bal run udp_connect_client.bal

# This will print the output below upon a successful write.
Data was sent to the remote host.
# Print the response that is returned from the server as an echo.
Received: Hello Ballerina echo
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="listener-1"><a class="header" href="#listener-1">Listener</a></h1>
<p>The UDP Listener is used to expose a UDP service over the UDP protocol.
The UDP <code>Client</code>/<code>ConnectClient</code> is used to send data to a remote UDP server.
This sample demonstrates the UDP socket listener.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/udp/latest">UDP module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/udp;

// Binds the service to the port.
// Optionally, you can provide the `remoteHost` and `remotePort` to
// configure the listener as a connected listener, which only
// reads and writes to the configured remote host.
// E.g.: `udp:Listener(8080, remoteHost
// = &quot;www.remote-clinet.com&quot;, remotePort = 9090)`
service on new udp:Listener(8080) {

    // This remote method is invoked once the content is received from the
    // client. You may replace the `onBytes` method with `onDatagram`, which
    // reads the data as `readonly &amp; udp:Datagram`.
    remote function onDatagram(readonly &amp; udp:Datagram datagram) 
        returns udp:Datagram|udp:Error? {
        io:println(&quot;Received by listener: &quot;, string:fromBytes(datagram.data));
        // Echoes back the data to the same client.
        // This is similar to calling `caller-&gt;sendDatagram(data);`.
        return datagram;
    }
}
</code></pre>
<h4 id="output-252"><a class="header" href="#output-252">Output</a></h4>
<pre><code class="language-bash">bal run udp_listener.bal

# This will print the output below upon a successful read by the listener.
Received by listener: Hello Ballerina echo
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="email"><a class="header" href="#email">Email</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="send-emails"><a class="header" href="#send-emails">Send Emails</a></h1>
<p>The Email Connector is used to send (with SMTP) emails
using the SSL or STARTTLS protocols. This sample
includes sending emails with default configurations
over SSL using the default ports.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/email/latest/">Email module</a>.</p>
<pre><code class="language-go">import ballerina/email;

public function main() returns error? {
    // Creates an SMTP client with the connection parameters, host, username,
    // and password. The default port number `465` is used over SSL with these
    // configurations. `SmtpConfig` can be configured and passed to this
    // client if the port or security is to be customized.
    email:SmtpClient smtpClient = check new (&quot;smtp.email.com&quot;,
        &quot;sender@email.com&quot; , &quot;pass123&quot;);

    // Defines the email that is required to be sent.
    email:Message email = {
        // &quot;TO&quot;, &quot;CC&quot;, and &quot;BCC&quot; address lists are added as follows.
        // Only the &quot;TO&quot; address list is mandatory out of these three.
        to: [&quot;receiver1@email.com&quot;, &quot;receiver2@email.com&quot;],
        cc: [&quot;receiver3@email.com&quot;, &quot;receiver4@email.com&quot;],
        bcc: [&quot;receiver5@email.com&quot;],
        // Subject of the email is added as follows. This field is mandatory.
        subject: &quot;Sample Email&quot;,
        // Body content (text) of the email is added as follows.
        // This field is optional.
        body: &quot;This is a sample email.&quot;,
        // Email author's address is added as follows. This field is mandatory.
        'from: &quot;author@email.com&quot;,
        // Email sender service address is added as follows.
        // This field is optional. `Sender` is same as the `'from` when the
        // email author himself sends the email.
        sender: &quot;sender@email.com&quot;,
        // List of recipients when replying to the email is added as follows.
        // This field is optional. These addresses are required when the emails
        // are to be replied to some other address(es) other than the sender or
        // the author.
        replyTo: [&quot;replyTo1@email.com&quot;, &quot;replyTo2@email.com&quot;]
    };

    // Sends the email message with the client. The `send` method can be used
    // instead, if the email is required to be sent with mandatory and optional
    // parameters instead of configuring an `email:Message` record.
    check smtpClient-&gt;sendMessage(email);

}
</code></pre>
<h4 id="output-253"><a class="header" href="#output-253">Output</a></h4>
<pre><code class="language-bash">bal run send_email.bal

# Check the inbox to view the sent emails.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="receive-emails-using-a-client"><a class="header" href="#receive-emails-using-a-client">Receive Emails Using a Client</a></h1>
<p>The email client is used to receive (with POP3 or IMAP4) emails
using the SSL or STARTTLS protocols. This sample includes receiving
emails with default configurations over SSL using the default
ports.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/email/latest/">Email module</a>.</p>
<pre><code class="language-go">import ballerina/email;
import ballerina/io;

public function main() returns error? {
    // Creates the client with the connection parameters, host, username, and
    // password. An error is returned in a failure. The default port number
    // `995` is used over SSL with these configurations.
    email:PopClient popClient = check new (&quot;pop.email.com&quot;, &quot;reader@email.com&quot;,
        &quot;pass456&quot;);

    // Reads the first unseen email received by the POP3 server. `()` is
    // returned when there are no new unseen emails. In error cases, an
    // error is returned.
    email:Message? emailResponse = check popClient-&gt;receiveMessage();

    if (emailResponse is email:Message) {
        io:println(&quot;POP client received an email.&quot;);
        io:println(&quot;Email Subject: &quot;, emailResponse.subject);
        io:println(&quot;Email Body: &quot;, emailResponse?.body);
    // When no emails are available in the server, `()` is returned.
    } else {
        io:println(&quot;There are no emails in the INBOX.&quot;);
    }

    // Closes the POP3 store, which would close the TCP connection.
    check popClient-&gt;close();

    // Creates the client with the connection parameters, host, username, and
    // password. An error is received in a failure. The default port number
    // `993` is used over SSL with these configurations.
    email:ImapClient imapClient = check new (&quot;imap.email.com&quot;,
        &quot;reader@email.com&quot;, &quot;pass456&quot;);

    // Reads the first unseen email received by the IMAP4 server. `()` is
    // returned when there are no new unseen emails. In error cases, an
    // error is returned.
    emailResponse = check imapClient-&gt;receiveMessage();

    if (emailResponse is email:Message) {
        io:println(&quot;IMAP client received an email.&quot;);
        io:println(&quot;Email Subject: &quot;, emailResponse.subject);
        io:println(&quot;Email Body: &quot;, emailResponse?.body);
    // When no emails are available in the server, `()` is returned.
    } else {
        io:println(&quot;There are no emails in the INBOX.&quot;);
    }

    // Closes the IMAP store which would close the TCP connection.
    check imapClient-&gt;close();

}
</code></pre>
<h4 id="output-254"><a class="header" href="#output-254">Output</a></h4>
<pre><code class="language-bash">bal run receive_email_using_client.bal

# Subject and the content body of the received emails would be printed.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="receive-emails-using-a-listener"><a class="header" href="#receive-emails-using-a-listener">Receive Emails Using a Listener</a></h1>
<p>The email listener is used to receive (with POP3 or IMAP4) emails
using the SSL or STARTTLS protocols. This sample includes receiving
emails from a listener with default configurations over SSL using
the default ports.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/email/latest/">Email module</a>.</p>
<pre><code class="language-go">import ballerina/email;
import ballerina/io;

// Creates the listener with the connection parameters and the protocol-related
// configuration. The polling interval specifies the time duration between each
// poll performed by the listener in seconds.
listener email:PopListener emailListener = check new ({
    host: &quot;pop.email.com&quot;,
    username: &quot;reader@email.com&quot;,
    password: &quot;pass456&quot;,
    pollingInterval: 2,
    port: 995
});

// One or many services can listen to the email listener for the
// periodically-polled emails.
service &quot;emailObserver&quot; on emailListener {

    // When an email is successfully received, the `onMessage` method is
    // called.
    remote function onMessage(email:Message emailMessage) {
        io:println(&quot;POP Listener received an email.&quot;);
        io:println(&quot;Email Subject: &quot;, emailMessage.subject);
        io:println(&quot;Email Body: &quot;, emailMessage?.body);
    }

    // When an error occurs during the email poll operations, the `onError`
    // method is called.
    remote function onError(email:Error emailError) {
        io:println(&quot;Error while polling for the emails: &quot;
            + emailError.message());
    }

    // When the listener is closed, the `onClose` method is called.
    remote function onClose(email:Error? closeError) {
        io:println(&quot;Closed the listener.&quot;);
    }

}
</code></pre>
<h4 id="output-255"><a class="header" href="#output-255">Output</a></h4>
<pre><code class="language-bash">bal run receive_email_using_listener.bal

# Subject and the content body of the listened emails will be printed for each
# of the polled emails.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ftp"><a class="header" href="#ftp">FTP</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client-2"><a class="header" href="#client-2">Client</a></h1>
<p>The FTP client is used to perform CRUD operation on remote files/directories
using the FTP protocol. This sample includes getting and putting file
content with default configurations using the default port number.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/ftp/latest/">FTP module</a>.</p>
<pre><code class="language-go">import ballerina/ftp;
import ballerina/io;
import ballerina/lang.'string as strings;

public function main() returns error? {
    // Creates the client with the connection parameters, host, username, and
    // password. An error is returned in a failure. The default port number
    // `21` is used with these configurations.
    ftp:ClientConfiguration config = {
        protocol: ftp:FTP,
        host: &quot;ftp.example.com&quot;,
        port: 21,
        auth: {credentials: {username: &quot;user1&quot;, password: &quot;pass456&quot;}}
    };
    ftp:Client clientEp = check new(config);

    // Reads a file from a FTP server for a given file path. In error cases, 
    // an error is returned.
    stream&lt;byte[] &amp; readonly, io:Error?&gt; fileStream
        = check clientEp-&gt;get(&quot;/server/book.txt&quot;);
    check fileStream.forEach(isolated 
        function(byte[] &amp; readonly fileContent) {
            io:println(&quot;File content received: &quot;
                + checkpanic strings:fromBytes(fileContent));
        }
    );

    // Add a new file to the given file location. In error cases, 
    // an error is returned. The local file is provided as a stream of
    // `io:Block` in which 1024 is the block size.
    stream&lt;io:Block, io:Error?&gt; bStream
        = check io:fileReadBlocksAsStream(&quot;/local/logFile.txt&quot;, 1024);
    check clientEp-&gt;put(&quot;/server&quot;, bStream);

    // Closes the file stream to finish the `get` and `put` operations.    
    check fileStream.close();

}
</code></pre>
<h4 id="output-256"><a class="header" href="#output-256">Output</a></h4>
<pre><code class="language-bash">bal run ftp_client.bal

# File content of the received file would get printed.
# The newly-added file will appear in the FTP server.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="listener-2"><a class="header" href="#listener-2">Listener</a></h1>
<p>The FTP listener is used to receive file/directory changes that occur in a remote
location using the FTP protocol. This sample includes receiving
file/directory related change events from a listener with default
configurations using the default port.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/ftp/latest/">FTP module</a>.</p>
<pre><code class="language-go">import ballerina/ftp;
import ballerina/io;

// Creates the listener with the connection parameters and the protocol-related
// configuration. The polling interval specifies the time duration between each
// poll performed by the listener in seconds. The listener listens to the files
// with the given file name pattern located in the specified path.
listener ftp:Listener remoteServer = check new({
    protocol: ftp:FTP,
    host: &quot;ftp.example.com&quot;,
    auth: {
        credentials: {
            username: &quot;user1&quot;,
            password: &quot;pass456&quot;
        }
    },
    port: 21,
    path: &quot;/home/in&quot;,
    pollingInterval: 2,
    fileNamePattern: &quot;(.*).txt&quot;
});

// One or many services can listen to the FTP listener for the
// periodically-polled file related events.
service on remoteServer {

    // When a file event is successfully received, the `onFileChange` method is
    // called.
    remote function onFileChange(ftp:WatchEvent event) {

        // `addedFiles` contains the paths of the newly-added files/directories
        // after the last polling was called.
        foreach ftp:FileInfo addedFile in event.addedFiles {
            io:println(&quot;Added file path: &quot; + addedFile.path);
        }

        // `deletedFiles` contains the paths of the deleted files/directories
        // after the last polling was called.
        foreach string deletedFile in event.deletedFiles {
            io:println(&quot;Deleted file path: &quot; + deletedFile);
        }
    }
}
</code></pre>
<h4 id="output-257"><a class="header" href="#output-257">Output</a></h4>
<pre><code class="language-bash">bal run ftp_listener.bal

# Paths of the newly-added and newly-deleted files/directories during the
# latest polling will be printed for each of the polled events.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sftp"><a class="header" href="#sftp">SFTP</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="client-3"><a class="header" href="#client-3">Client</a></h1>
<p>The SFTP client is used to perform CRUD operation on remote
files/directories using the SFTP protocol. This sample includes getting and
putting file content with default configurations using the default port
number.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/ftp/latest/">FTP module</a>.</p>
<pre><code class="language-go">import ballerina/ftp;
import ballerina/io;
import ballerina/lang.'string as strings;

public function main() returns error? {
    // Creates the client with the connection parameters, host, username, and
    // password. An error is returned in a failure. The default port number
    // `22` for SSH is used with these configurations.
    ftp:ClientConfiguration config = {
        protocol: ftp:SFTP,
        host: &quot;sftp.example.com&quot;,
        port: 22,
        auth: {
            credentials: {username: &quot;user1&quot;, password: &quot;pass456&quot;},

            // Private key file location and its password (if encrypted) is
            // given corresponding to the SSH key file used in the SFTP client.
            privateKey: {
                path: &quot;../resource/path/to/private.key&quot;,
                password: &quot;keyPass123&quot;
            }
        }
    };
    ftp:Client clientEp = check new(config);

    // Reads a file from a FTP server for a given file path. In error cases, 
    // an error is returned.
    stream&lt;byte[] &amp; readonly, io:Error?&gt; fileStream
        = check clientEp-&gt;get(&quot;/server/book.txt&quot;);
    check fileStream.forEach(isolated 
        function(byte[] &amp; readonly fileContent) {
            io:println(&quot;File content received: &quot;
                + checkpanic strings:fromBytes(fileContent));
        }
    );

    // Add a new file to the given file location. In error cases, 
    // an error is returned. The local file is provided as a stream of
    // `io:Block` in which 1024 is the block size.
    stream&lt;io:Block, io:Error?&gt; bStream
        = check io:fileReadBlocksAsStream(&quot;/local/logFile.txt&quot;, 1024);
    check clientEp-&gt;put(&quot;/server&quot;, bStream);

    // Closes the file stream to finish the `get` and `put` operations.    
    check fileStream.close();

}
</code></pre>
<h4 id="output-258"><a class="header" href="#output-258">Output</a></h4>
<pre><code class="language-bash">bal run sftp_client.bal

# File content of the received file would get printed.
# The newly-added file will appear in the SFTP server.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="listener-3"><a class="header" href="#listener-3">Listener</a></h1>
<p>The SFTP listener is used to receive file/directory changes that occur in a
remote location using the SFTP protocol. This sample includes receiving
file/directory related change events from a listener with default
configurations using the default port.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/ftp/latest/">FTP module</a>.</p>
<pre><code class="language-go">import ballerina/ftp;
import ballerina/io;

// Creates the listener with the connection parameters and the protocol-related
// configuration. The polling interval specifies the time duration between each
// poll performed by the listener in seconds. The listener listens to the files
// with the given file name pattern located in the specified path.
listener ftp:Listener remoteServer = check new({
    protocol: ftp:SFTP,
    host: &quot;sftp.example.com&quot;,
    auth: {
        credentials: {
            username: &quot;user1&quot;,
            password: &quot;pass456&quot;
        },
        privateKey: {
            path: &quot;../resource/path/to/private.key&quot;,
            password: &quot;keyPass123&quot;
        }
    },
    port: 22,
    path: &quot;/home/in&quot;,
    pollingInterval: 2,
    fileNamePattern: &quot;(.*).txt&quot;
});

// One or many services can listen to the SFTP listener for the
// periodically-polled file related events.
service on remoteServer {

    // When a file event is successfully received, the `onFileChange` method is
    // called.
    remote function onFileChange(ftp:WatchEvent event) {

        // `addedFiles` contains the paths of the newly-added files/directories
        // after the last polling was called.
        foreach ftp:FileInfo addedFile in event.addedFiles {
            io:println(&quot;Added file path: &quot; + addedFile.path);
        }

        // `deletedFiles` contains the paths of the deleted files/directories
        // after the last polling was called.
        foreach string deletedFile in event.deletedFiles {
            io:println(&quot;Deleted file path: &quot; + deletedFile);
        }
    }
}
</code></pre>
<h4 id="output-259"><a class="header" href="#output-259">Output</a></h4>
<pre><code class="language-bash">bal run sftp_listener.bal

# Paths of the newly-added and newly-deleted files/directories during the
# latest polling will be printed for each of the polled events.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mysql"><a class="header" href="#mysql">MySQL</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="simple-query"><a class="header" href="#simple-query">Simple Query</a></h1>
<p>This BBE demonstrates how to use the MySQL client select query operations
with the stream return type. Note that the MySQL database driver JAR should
be defined in the <code>Ballerina.toml</code> file as a dependency.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/mysql/latest/">MySQL module</a>.
The MySQL connector uses database properties from MySQL version 8.0.13 onwards. Therefore, it is
recommended to use a MySQL driver version greater than 8.0.13.<br><br></p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/mysql;
import ballerina/sql;

// Defines a record to load the query result schema as shown below in the
// 'getDataWithTypedQuery' function. In this example, all columns of the 
// customer table will be loaded. Therefore, the `Customer` record will be 
// created with all the columns. The column name of the result and the 
// defined field name of the record will be matched case insensitively.
type Customer record {|
    int customerId;
    string lastName;
    string firstName;
    int registrationId;
    float creditLimit;
    string country;
|};

public function main() returns error? {
    // Runs the prerequisite setup for the example.
    check beforeExample();

    // Initializes the MySQL client.
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, 
            password = &quot;Test@123&quot;, database = &quot;MYSQL_BBE&quot;);

    // Select the rows in the database table via the query remote operation.
    // The result is returned as a stream and the elements of the stream can
    // be either a record or an error. The name and type of the attributes 
    // within the record from the `resultStream` will be automatically 
    // identified based on the column name and type of the query result.
    stream&lt;record {}, error?&gt; resultStream =
            mysqlClient-&gt;query(`SELECT * FROM Customers`);

    // If there is any error during the execution of the SQL query or
    // iteration of the result stream, the result stream will terminate and
    // return the error.
    check from record {} result in resultStream
        do {
            io:println(&quot;Full Customer details: &quot;, result);
        };

    // The result of the count operation is provided as a record stream.
    stream&lt;record {}, error?&gt; resultStream2 =
            mysqlClient-&gt;query(`SELECT COUNT(*) AS total FROM Customers`);

    // Since the above count query will return only a single row,
    // the `next()` operation is sufficient to retrieve the data.
    record {|record {} value;|}|error? result = resultStream2.next();
    // Checks the result and retrieves the value for the total.
    if result is record {|record {} value;|} {
        io:println(&quot;Total rows in customer table : &quot;, result.value[&quot;total&quot;]);
    }

    // In general cases, the stream will be closed automatically
    // when the stream is fully consumed or any error is encountered.
    // However, in case if the stream is not fully consumed, the stream
    // should be closed specifically.
    check resultStream2.close();

    // If a `Customer` stream type is defined when calling the query method,
    // The result is returned as a `Customer` record stream and the elements
    // of the stream can be either a `Customer` record or an error.
    stream&lt;Customer, error?&gt; customerStream =
        mysqlClient-&gt;query(`SELECT * FROM Customers`);

    // Iterates the customer stream.
    check from Customer customer in customerStream
        do {
            io:println(&quot;Full Customer details: &quot;, customer);
        };

    // Performs the cleanup after the example.
    check afterExample(mysqlClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample() returns sql:Error? {
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, password = &quot;Test@123&quot;);

    // Creates a database.
    _ = check mysqlClient-&gt;execute(`CREATE DATABASE MYSQL_BBE`);

    // Creates a table in the database.
    _ = check mysqlClient-&gt;execute(`CREATE TABLE MYSQL_BBE.Customers
            (customerId INTEGER NOT NULL AUTO_INCREMENT, firstName
            VARCHAR(300), lastName  VARCHAR(300), registrationID INTEGER,
            creditLimit DOUBLE, country  VARCHAR(300),
            PRIMARY KEY (customerId))`);

    // Adds the records to the newly-created table.
    _ = check mysqlClient-&gt;execute(`INSERT INTO MYSQL_BBE.Customers
            (firstName, lastName, registrationID,creditLimit,country) VALUES
            ('Peter','Stuart', 1, 5000.75, 'USA')`);
    _ = check mysqlClient-&gt;execute(`INSERT INTO MYSQL_BBE.Customers
            (firstName, lastName, registrationID,creditLimit,country) VALUES
            ('Dan', 'Brown', 2, 10000, 'UK')`);

    check mysqlClient.close();
}

// Cleans up the database after running the example.
function afterExample(mysql:Client mysqlClient) returns sql:Error? {
    // Cleans the database.
    _ = check mysqlClient-&gt;execute(`DROP DATABASE MYSQL_BBE`);

    // Closes the MySQL client.
    check mysqlClient.close();
}
</code></pre>
<h4 id="output-260"><a class="header" href="#output-260">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Full Customer details: {&quot;customerId&quot;:1,&quot;firstName&quot;:&quot;Peter&quot;,&quot;lastName&quot;:&quot;Stuart&quot;,&quot;registrationID&quot;:1,&quot;creditLimit&quot;:5000.75,&quot;country&quot;:&quot;USA&quot;}
Full Customer details: {&quot;customerId&quot;:2,&quot;firstName&quot;:&quot;Dan&quot;,&quot;lastName&quot;:&quot;Brown&quot;,&quot;registrationID&quot;:2,&quot;creditLimit&quot;:10000.0,&quot;country&quot;:&quot;UK&quot;}
Total rows in customer table : 2
Full Customer details: {&quot;customerId&quot;:1,&quot;firstName&quot;:&quot;Peter&quot;,&quot;lastName&quot;:&quot;Stuart&quot;,&quot;registrationId&quot;:1,&quot;creditLimit&quot;:5000.75,&quot;country&quot;:&quot;USA&quot;}
Full Customer details: {&quot;customerId&quot;:2,&quot;firstName&quot;:&quot;Dan&quot;,&quot;lastName&quot;:&quot;Brown&quot;,&quot;registrationId&quot;:2,&quot;creditLimit&quot;:10000.0,&quot;country&quot;:&quot;UK&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="query-with-complex-types"><a class="header" href="#query-with-complex-types">Query With Complex Types</a></h1>
<p>This BBE demonstrates how to use the MySQL client with complex data types
such as JSON, binary, blobs, and date/time fields. Note that the MySQL database
driver JAR should be defined in the <code>Ballerina.toml</code> file as a dependency.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/mysql/latest/">MySQL module</a>.
The MySQL connector uses database properties from MySQL version 8.0.13 onwards. Therefore, it is
recommended to use a MySQL driver version greater than 8.0.13.<br><br></p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/mysql;
import ballerina/sql;
import ballerina/time;

// The `BinaryType` record to represent the `BINARY_TYPES` database table.
type BinaryType record {|
    int row_id;
    byte[] blob_type;
    byte[] binary_type;
|};

// The `JsonType` record to represent the `JSON_TYPES` database table.
type JsonType record {|
    int row_id;
    json json_doc;
    json json_array;
|};

// The `DateTimeType` record to represent the `DATE_TIME_TYPES` database table.
type DateTimeType record {|
    int row_id;
    string date_type;
    int time_type;
    time:Utc timestamp_type;
    string datetime_type;
|};

public function main() returns error? {
    // Runs the prerequisite setup for the example.
    check beforeExample();

    // Initializes the MySQL client.
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, 
            password = &quot;Test@123&quot;, database = &quot;MYSQL_BBE&quot;);

    // Since the `rowType` is provided as a `BinaryType`, the `binaryResultStream`
    // will have `BinaryType` records.
    stream&lt;BinaryType, error?&gt; binaryResultStream =
                mysqlClient-&gt;query(`SELECT * FROM BINARY_TYPES`);

    io:println(&quot;Binary types Result :&quot;);
    // Iterates the `binaryResultStream`.
    check from BinaryType result in binaryResultStream
        do {
            io:println(result);
        };

    // Since the `rowType` is provided as an `JsonType`, the `jsonResultStream` will
    // have `JsonType` records.
    stream&lt;JsonType, error?&gt; jsonResultStream =
                mysqlClient-&gt;query(`SELECT * FROM JSON_TYPES`);

    io:println(&quot;Json type Result :&quot;);
    // Iterates the `jsonResultStream`.
    check from JsonType result in jsonResultStream
        do {
            io:println(result);
        };

    // Since the `rowType` is provided as a `DateTimeType`, the `dateResultStream`
    // will have `DateTimeType` records. The `Date`, `Time`, `DateTime`, and
    // `Timestamp` fields of the database table can be mapped to `time:Utc`,
    // string, and int types in Ballerina.
    stream&lt;DateTimeType, error?&gt; dateResultStream =
                mysqlClient-&gt;query(`SELECT * FROM DATE_TIME_TYPES`);

    io:println(&quot;DateTime types Result :&quot;);
    // Iterates the `dateResultStream`.
    check from DateTimeType result in dateResultStream
        do {
            io:println(result);
        };

    // Performs the cleanup after the example.
    check afterExample(mysqlClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample() returns sql:Error? {
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, password = &quot;Test@123&quot;);

    // Creates a database.
    _ = check mysqlClient-&gt;execute(`CREATE DATABASE MYSQL_BBE`);
    
    // Create complex data type tables in the database.
    _ = check mysqlClient-&gt;execute(`CREATE TABLE MYSQL_BBE.BINARY_TYPES
            (row_id INTEGER NOT NULL, blob_type BLOB(1024),  
            binary_type BINARY(27), PRIMARY KEY (row_id))`);
    _ = check mysqlClient-&gt;execute(`CREATE TABLE MYSQL_BBE.JSON_TYPES
            (row_id INTEGER NOT NULL, json_doc JSON, json_array JSON,
            PRIMARY KEY (row_id))`);
    _ = check mysqlClient-&gt;execute(
            `CREATE TABLE MYSQL_BBE.DATE_TIME_TYPES (row_id
            INTEGER NOT NULL, date_type DATE, time_type TIME, 
            timestamp_type timestamp, datetime_type  datetime, 
            PRIMARY KEY (row_id))`);

    // Adds the records to the newly-created tables.
    _ = check mysqlClient-&gt;execute(`INSERT INTO MYSQL_BBE.BINARY_TYPES
            (row_id, blob_type, binary_type) VALUES (1,
            X'77736F322062616C6C6572696E6120626C6F6220746573742E',  
            X'77736F322062616C6C6572696E612062696E61727920746573742E')`);
    _ = check mysqlClient-&gt;execute(`INSERT INTO MYSQL_BBE.JSON_TYPES
            (row_id, json_doc, json_array) VALUES (1, '{&quot;firstName&quot; : &quot;Jhon&quot;,
            &quot;lastName&quot; : &quot;Bob&quot;, &quot;age&quot; : 18}', JSON_ARRAY(1, 2, 3))`);
    _ = check mysqlClient-&gt;execute(
            `Insert into MYSQL_BBE.DATE_TIME_TYPES (row_id,
            date_type, time_type, timestamp_type, datetime_type) values (1, 
            '2017-05-23', '14:15:23', '2017-01-25 16:33:55', 
            '2017-01-25 16:33:55')`);

    check mysqlClient.close();        
}

// Cleans up the database after running the example.
function afterExample(mysql:Client mysqlClient) returns sql:Error? {
    // Cleans the database.
    _ = check mysqlClient-&gt;execute(`DROP DATABASE MYSQL_BBE`);
    
    // Closes the MySQL client.
    check mysqlClient.close();
}
</code></pre>
<h4 id="output-261"><a class="header" href="#output-261">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Binary types Result :
{&quot;row_id&quot;:1,&quot;blob_type&quot;:[119,115,111,50,32,98,97,108,108,101,114,105,110,97,32,98,108,111,98,32,116,101,115,116,46],&quot;binary_type&quot;:[119,115,111,50,32,98,97,108,108,101,114,105,110,97,32,98,105,110,97,114,121,32,116,101,115,116,46]}
Json type Result :
{&quot;row_id&quot;:1,&quot;json_doc&quot;:{&quot;age&quot;:18,&quot;lastName&quot;:&quot;Bob&quot;,&quot;firstName&quot;:&quot;Jhon&quot;},&quot;json_array&quot;:[1,2,3]}
DateTime types Result :
{&quot;row_id&quot;:1,&quot;date_type&quot;:&quot;2017-05-23&quot;,&quot;time_type&quot;:11723000,&quot;timestamp_type&quot;:[1485342235,0E-9],&quot;datetime_type&quot;:&quot;2017-01-25 11:03:55.0&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dml-and-ddl-operation"><a class="header" href="#dml-and-ddl-operation">DML and DDL Operation</a></h1>
<p>This BBE demonstrates how to use the MySQL client with the DDL and  DML
operations. Note that the MySQL database driver JAR should be defined in the <code>Ballerina.toml</code> file as a dependency.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/mysql/latest/">MySQL module</a>.
The MySQL connector uses database properties from MySQL version 8.0.13 onwards. Therefore, it is
recommended to use a MySQL driver version greater than 8.0.13.<br><br></p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/mysql;
import ballerina/sql;

public function main() returns error? {
    // Runs the prerequisite setup for the example.
    check beforeExample();

    // Initializes the MySQL client.
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, 
            password = &quot;Test@123&quot;, database = &quot;MYSQL_BBE&quot;);

    float newCreditLimit = 15000.5;

    // Creates a parameterized query for the record update.
    sql:ParameterizedQuery updateQuery = 
            `UPDATE Customers SET creditLimit = ${newCreditLimit} 
            where customerId = 1`;

    sql:ExecutionResult result = check mysqlClient-&gt;execute(updateQuery);
    io:println(&quot;Updated Row count: &quot;, result?.affectedRowCount);

    string firstName = &quot;Dan&quot;;

    // Creates a parameterized query for deleting the records.
    sql:ParameterizedQuery deleteQuery = 
            `DELETE FROM Customers WHERE firstName = ${firstName}`;

    result = check mysqlClient-&gt;execute(deleteQuery);
    io:println(&quot;Deleted Row count: &quot;, result.affectedRowCount);

    // Performs the cleanup after the example.
    check afterExample(mysqlClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample() returns sql:Error? {
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, password = &quot;Test@123&quot;);

    // Creates a database.
    sql:ExecutionResult result = 
        check mysqlClient-&gt;execute(`CREATE DATABASE MYSQL_BBE`);

    //Creates a table in the database.
    result = check mysqlClient-&gt;execute(`CREATE TABLE MYSQL_BBE.Customers
            (customerId INTEGER NOT NULL AUTO_INCREMENT, firstName  
            VARCHAR(300), lastName  VARCHAR(300), registrationID INTEGER, 
            creditLimit DOUBLE, country VARCHAR(300),
            PRIMARY KEY (customerId))`);

    // Inserts data into the table. The result will have the `affectedRowCount`
    // and `lastInsertedId` with the auto-generated ID of the last row.
    result = check mysqlClient-&gt;execute(`INSERT INTO MYSQL_BBE.Customers
            (firstName, lastName, registrationID,creditLimit,country) VALUES
            ('Peter','Stuart', 1, 5000.75, 'USA')`);
    result = check mysqlClient-&gt;execute(`INSERT INTO MYSQL_BBE.Customers
            (firstName, lastName, registrationID,creditLimit,country) VALUES
            ('Dan', 'Brown', 2, 10000, 'UK')`);

    io:println(&quot;Rows affected: &quot;, result.affectedRowCount);
    io:println(&quot;Generated Customer ID: &quot;, result.lastInsertId);

    check mysqlClient.close();
}

// Cleans up the database after running the example.
function afterExample(mysql:Client mysqlClient) returns sql:Error? {
    // Cleans the database.
    _ = check mysqlClient-&gt;execute(`DROP DATABASE MYSQL_BBE`);
    
    // Closes the MySQL client.
    check mysqlClient.close();
}
</code></pre>
<h4 id="output-262"><a class="header" href="#output-262">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Rows affected: 1
Generated Customer ID: 2
Updated Row count: 1
Deleted Row count: 1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="batch-execute"><a class="header" href="#batch-execute">Batch Execute</a></h1>
<p>This BBE demonstrates how to use the MySQL client to execute a batch of
DDL/DML operations. Note that the MySQL database driver JAR should be defined in
the <code>Ballerina.toml</code> file as a dependency.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/mysql/latest/">MySQL module</a>.
The MySQL connector uses database properties from MySQL version 8.0.13 onwards. Therefore, it is
recommended to use a MySQL driver version greater than 8.0.13.<br><br></p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/mysql;
import ballerina/sql;

public function main() returns error? {
    // Runs the prerequisite setup for the example.
    check beforeExample();

    // Initializes the MySQL client.
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, 
            password = &quot;Test@123&quot;, database = &quot;MYSQL_BBE&quot;);

    // The records to be inserted.
    var insertRecords = [
        {
            firstName: &quot;Peter&quot;,
            lastName: &quot;Stuart&quot;,
            registrationID: 1,
            creditLimit: 5000.75,
            country: &quot;USA&quot;
        }, 
        {
            firstName: &quot;Stephanie&quot;,
            lastName: &quot;Mike&quot;,
            registrationID: 2,
            creditLimit: 8000.00,
            country: &quot;USA&quot;
        }, 
        {
            firstName: &quot;Bill&quot;,
            lastName: &quot;John&quot;,
            registrationID: 3,
            creditLimit: 3000.25,
            country: &quot;USA&quot;
        }
    ];

    // Creates a batch parameterized query.
    sql:ParameterizedQuery[] insertQueries = 
        from var data in insertRecords
        select `INSERT INTO Customers
                (firstName, lastName, registrationID, creditLimit, country)
                VALUES (${data.firstName}, ${data.lastName},
                ${data.registrationID}, ${data.creditLimit}, ${data.country})`;

    // Inserts the records with the auto-generated ID.
    sql:ExecutionResult[] result = 
                            check mysqlClient-&gt;batchExecute(insertQueries);

    int[] generatedIds = [];
    foreach var summary in result {
        generatedIds.push(&lt;int&gt;summary.lastInsertId);
    }
    io:println(&quot;\nInsert success, generated IDs are: &quot;, generatedIds, &quot;\n&quot;);

    // Checks the data after the batch execution.
    stream&lt;record {}, error?&gt; resultStream =
        mysqlClient-&gt;query(`SELECT * FROM Customers`);

    io:println(&quot;Data in Customers table:&quot;);
    check from record {} resultRecord in resultStream
        do {
            io:println(resultRecord.toString());
        };

    // Performs the cleanup after the example.
    check afterExample(mysqlClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample() returns sql:Error? {
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, password = &quot;Test@123&quot;);

    // Creates a database.
    _ = check mysqlClient-&gt;execute(`CREATE DATABASE MYSQL_BBE`);

    // Creates a table in the database.
    _ = check mysqlClient-&gt;execute(`CREATE TABLE MYSQL_BBE.Customers
            (customerId INTEGER NOT NULL AUTO_INCREMENT,
            firstName VARCHAR(300), lastName  VARCHAR(300),
            registrationID INTEGER, creditLimit DOUBLE,
            country  VARCHAR(300), PRIMARY KEY (customerId))`);

    check mysqlClient.close();
}

// Cleans up the database after running the example.
function afterExample(mysql:Client mysqlClient) returns sql:Error? {
    // Cleans the database.
    _ = check mysqlClient-&gt;execute(`DROP DATABASE MYSQL_BBE`);

    // Closes the MySQL client.
    check mysqlClient.close();
}
</code></pre>
<h4 id="output-263"><a class="header" href="#output-263">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Insert success, generated IDs are: [1,2,3]

Data in Customers table:
{&quot;customerId&quot;:1,&quot;firstName&quot;:&quot;Peter&quot;,&quot;lastName&quot;:&quot;Stuart&quot;,&quot;registrationID&quot;:1,&quot;creditLimit&quot;:5000.75,&quot;country&quot;:&quot;USA&quot;}
{&quot;customerId&quot;:2,&quot;firstName&quot;:&quot;Stephanie&quot;,&quot;lastName&quot;:&quot;Mike&quot;,&quot;registrationID&quot;:2,&quot;creditLimit&quot;:8000.0,&quot;country&quot;:&quot;USA&quot;}
{&quot;customerId&quot;:3,&quot;firstName&quot;:&quot;Bill&quot;,&quot;lastName&quot;:&quot;John&quot;,&quot;registrationID&quot;:3,&quot;creditLimit&quot;:3000.25,&quot;country&quot;:&quot;USA&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="atomic-batch-execute"><a class="header" href="#atomic-batch-execute">Atomic Batch Execute</a></h1>
<p>This BBE demonstrates how to use the MySQL client to execute a batch of
DDL/DML operations with the help of a <code>transaction</code> to achieve the atomic behaviour.
Note that the MySQL database driver JAR should be defined in
the <code>Ballerina.toml</code> file as a dependency.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/mysql/latest/">MySQL module</a>.
The MySQL connector uses database properties from MySQL version 8.0.13 onwards. Therefore, it is
recommended to use a MySQL driver version greater than 8.0.13.<br><br></p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/mysql;
import ballerina/sql;

public function main() returns error? {
    // Runs the prerequisite setup for the example.
    check beforeExample();

    // Initializes the MySQL client.
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, 
            password = &quot;Test@123&quot;, database = &quot;MYSQL_BBE&quot;);

    // Records with the duplicate `registrationID` entry. Here it is `registrationID` = 1.
    var insertRecords = [
        {
            firstName: &quot;Linda&quot;,
            lastName: &quot;Jones&quot;,
            registrationID: 4,
            creditLimit: 10000.75,
            country: &quot;USA&quot;
        }, 
        {
            firstName: &quot;Peter&quot;,
            lastName: &quot;Stuart&quot;,
            registrationID: 1,
            creditLimit: 5000.75,
            country: &quot;USA&quot;
        }, 
        {
            firstName: &quot;Camellia&quot;,
            lastName: &quot;Potter&quot;,
            registrationID: 5,
            creditLimit: 2000.25,
            country: &quot;USA&quot;
        }
    ];

    // Creates a batch parameterized query.
    sql:ParameterizedQuery[] insertQueries = 
        from var data in insertRecords
        select `INSERT INTO Customers
                (firstName, lastName, registrationID, creditLimit, country)
                VALUES (${data.firstName}, ${data.lastName},
                ${data.registrationID}, ${data.creditLimit}, ${data.country})`;

    // The transaction block can be used to roll back if any error occurred.
    transaction {
        var result = mysqlClient-&gt;batchExecute(insertQueries);
        if result is sql:BatchExecuteError {
            io:println(result.message());
            io:println(result.detail()?.executionResults);
            io:println(&quot;Rollback transaction.\n&quot;);
            rollback;
        } else {
            error? err = commit;
            if err is error {
                io:println(&quot;Error occurred while committing: &quot;, err);
            }
        }
    }

    // Checks the data after the batch execution.
    stream&lt;record {}, error?&gt; resultStream =
        mysqlClient-&gt;query(`SELECT * FROM Customers`);

    io:println(&quot;Data in Customers table:&quot;);
    check from record {} result in resultStream
        do {
            io:println(result.toString());
        };

    // Performs a cleanup after the example.
    check afterExample(mysqlClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample() returns sql:Error? {
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, password = &quot;Test@123&quot;);

    // Creates a database.
    _ = check mysqlClient-&gt;execute(`CREATE DATABASE MYSQL_BBE`);

    // Creates a table in the database.
    _ = check mysqlClient-&gt;execute(`CREATE TABLE MYSQL_BBE.Customers
            (customerId INTEGER NOT NULL AUTO_INCREMENT,
            firstName VARCHAR(300), lastName  VARCHAR(300), registrationID
            INTEGER UNIQUE, creditLimit DOUBLE, country  VARCHAR(300),
            PRIMARY KEY (customerId))`);

    // Adds records to the newly-created table.
    _ = check mysqlClient-&gt;execute(`INSERT INTO MYSQL_BBE.Customers
            (firstName, lastName, registrationID,creditLimit,country) VALUES
             ('Peter', 'Stuart', 1, 5000.75, 'USA')`);

    check mysqlClient.close();
}

// Cleans up the database after running the example.
function afterExample(mysql:Client mysqlClient) returns sql:Error? {
    // Cleans the database.
    _ = check mysqlClient-&gt;execute(`DROP DATABASE MYSQL_BBE`);
    
    // Closes the MySQL client.
    check mysqlClient.close();
}
</code></pre>
<h4 id="output-264"><a class="header" href="#output-264">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Error while executing batch command starting with: 'INSERT INTO Customers
                (firstName, lastName, registrationID, creditLimit, country)
                VALUES ( ? ,  ? ,
                 ? ,  ? ,  ? )'.Duplicate entry '1' for key 'Customers.registrationID'.
[{&quot;affectedRowCount&quot;:1,&quot;lastInsertId&quot;:null},{&quot;affectedRowCount&quot;:-3,&quot;lastInsertId&quot;:null},{&quot;affectedRowCount&quot;:1,&quot;lastInsertId&quot;:null}]
Rollback transaction.

Data in Customers table:
{&quot;customerId&quot;:1,&quot;firstName&quot;:&quot;Peter&quot;,&quot;lastName&quot;:&quot;Stuart&quot;,&quot;registrationID&quot;:1,&quot;creditLimit&quot;:5000.75,&quot;country&quot;:&quot;USA&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="call-stored-procedures"><a class="header" href="#call-stored-procedures">Call Stored Procedures</a></h1>
<p>This BBE demonstrates how to use the MySQL client to execute a stored
procedure. Note that the MySQL database driver JAR should be defined in
the <code>Ballerina.toml</code> file as a dependency.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/mysql/latest/">MySQL module</a>.
The MySQL connector uses database properties from MySQL version 8.0.13 onwards. Therefore, it is
recommended to use a MySQL driver version greater than 8.0.13.<br><br></p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/mysql;
import ballerina/sql;

// The `Student` record to represent the database table.
type Student record {
    int id;
    int age;
    string name;
};

public function main() returns error? {
    // Runs the prerequisite setup for the example.
    check beforeExample();

    // Initializes the MySQL client.
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, 
            password = &quot;Test@123&quot;, database = &quot;MYSQL_BBE&quot;);

    // Creates a parameterized query to invoke the procedure.
    string name = &quot;George&quot;;
    int age = 24;
    sql:ParameterizedCallQuery sqlQuery = 
                                `CALL InsertStudent(${name}, ${age})`;

    // Invokes the stored procedure `InsertStudent` with the `IN` parameters.
    sql:ProcedureCallResult retCall = check mysqlClient-&gt;call(sqlQuery);
    io:println(&quot;Call stored procedure `InsertStudent`.&quot; + 
        &quot;\nAffected Row count: &quot;, retCall.executionResult?.affectedRowCount);
    check retCall.close();

    // Initializes the `INOUT` and `OUT` parameters.
    sql:InOutParameter id = new (1);
    sql:IntegerOutParameter totalCount = new;
    sql:ParameterizedCallQuery sqlQuery2 = 
                        `{CALL GetCount(${id}, ${totalCount})}`;

    // The stored procedure with the `OUT` and `INOUT` parameters is invoked.
    sql:ProcedureCallResult retCall2 = check mysqlClient-&gt;call(sqlQuery2);
    io:println(&quot;Call stored procedure `GetCount`.&quot;);
    io:println(&quot;Age of the student with id '1' : &quot;, id.get(int));
    io:println(&quot;Total student count: &quot;, totalCount.get(int));
    check retCall2.close();

    // Invokes the stored procedure, which returns the data.
    sql:ProcedureCallResult retCall3 = 
            check mysqlClient-&gt;call(`{CALL GetStudents()}`, [Student]);
    io:println(&quot;Call stored procedure `GetStudents`.&quot;);

    // Processes the returned result stream.
    stream&lt;record {}, sql:Error?&gt;? result = retCall3.queryResult;
    if result is stream&lt;record {}, sql:Error?&gt; {
        stream&lt;Student, sql:Error?&gt; studentStream =
                &lt;stream&lt;Student, sql:Error?&gt;&gt;result;
        check from Student student in studentStream
            do {
                io:println(&quot;Student details: &quot;, student);
            };
    }
    check retCall3.close();

    // Performs the cleanup after the example.
    check afterExample(mysqlClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample() returns sql:Error? {
    mysql:Client mysqlClient = check new (user = &quot;root&quot;, password = &quot;Test@123&quot;);

    // Creates a database.
    _ = check mysqlClient-&gt;execute(`CREATE DATABASE MYSQL_BBE`);

    // Creates a table in the database.
    _ = check mysqlClient-&gt;execute(`CREATE TABLE MYSQL_BBE.Student
            (id INT AUTO_INCREMENT, age INT, name VARCHAR(255),
            PRIMARY KEY (id))`);

    // Creates the necessary stored procedures using the execute command.
    _ = check mysqlClient-&gt;execute(`CREATE PROCEDURE
        MYSQL_BBE.InsertStudent (IN pName VARCHAR(255), IN pAge INT)
        BEGIN INSERT INTO Student(age, name) VALUES (pAge, pName); END`);
    _ = check mysqlClient-&gt;execute(`CREATE PROCEDURE MYSQL_BBE.GetCount
        (INOUT pID INT, OUT totalCount INT) BEGIN SELECT age INTO pID FROM
        Student WHERE id = pID; SELECT COUNT(*) INTO totalCount FROM Student;
        END`);
    _ = check mysqlClient-&gt;execute(`CREATE PROCEDURE
        MYSQL_BBE.GetStudents() BEGIN SELECT * FROM Student; END`);

    check mysqlClient.close();
}

// Cleans up the database after running the example.
function afterExample(mysql:Client mysqlClient) returns sql:Error? {
    // Cleans the database.
    _ = check mysqlClient-&gt;execute(`DROP DATABASE MYSQL_BBE`);

    // Closes the MySQL client.
    check mysqlClient.close();
}
</code></pre>
<h4 id="output-265"><a class="header" href="#output-265">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Call stored procedure `InsertStudent`.
Affected Row count: 1
Call stored procedure `GetCount`.
Age of the student with id '1' : 24
Total student count: 1
Call stored procedure `GetStudents`.
Student details: {&quot;id&quot;:1,&quot;age&quot;:24,&quot;name&quot;:&quot;George&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jdbc"><a class="header" href="#jdbc">JDBC</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="simple-query-1"><a class="header" href="#simple-query-1">Simple Query</a></h1>
<p>This BBE demonstrates how to use the JDBC client select query operations
with the stream return type. Note that the relevant database driver JAR
should be defined in the <code>Ballerina.toml</code> file as a dependency.
This sample is based on an H2 database and the H2 database driver JAR need to be added to <code>Ballerina.toml</code> file.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/java.jdbc/latest/">JDBC module</a> .<br><br>
This sample is written using H2 2.0.6 and it is recommended to use H2 JAR with versions higher than 2.0.2.</p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/java.jdbc;
import ballerina/sql;

// Defines a record to load the query result schema as shown below in the
// 'getDataWithTypedQuery' function. In this example, all columns of the 
// customer table will be loaded. Therefore, the `Customer` record will be 
// created with all the columns. The column name of the result and the 
// defined field name of the record will be matched case insensitively.
type Customer record {|
    int customerId;
    string lastName;
    string firstName;
    int registrationId;
    float creditLimit;
    string country;
|};

public function main() returns error? {
    // Initializes the JDBC client.
    jdbc:Client jdbcClient = check new (&quot;jdbc:h2:file:./target/bbes/java_jdbc&quot;, 
        &quot;rootUser&quot;, &quot;rootPass&quot;);
    // Runs the prerequisite setup for the example.
    check beforeExample(jdbcClient);

    // Selects the rows in the database table via the query remote operation.
    // The result is returned as a stream and the elements of the stream can
    // be either a record or an error. The name and type of the attributes 
    // within the record from the `resultStream` will be automatically 
    // identified based on the column name and type of the query result.
    stream&lt;record {}, error?&gt; resultStream =
            jdbcClient-&gt;query(`SELECT * FROM Customers`);

    // If there is any error during the execution of the SQL query or
    // iteration of the result stream, the result stream will terminate and
    // return the error.
    check from record{} result in resultStream
        do {
            io:println(&quot;Full Customer details: &quot;, result);
        };

    // The result of the count operation is provided as a record stream.
    stream&lt;record {}, error?&gt; resultStream2 =
            jdbcClient-&gt;query(`SELECT COUNT(*) AS total FROM Customers`);

    // Since the above count query will return only a single row,
    // the `next()` operation is sufficient to retrieve the data.
    record {|record {} value;|}|error? result = resultStream2.next();
    // Checks the result and retrieves the value for the total.
    if result is record {|record {} value;|} {
        io:println(&quot;Total rows in customer table : &quot;, result.value[&quot;TOTAL&quot;]);
    }

    // In general cases, the stream will be closed automatically
    // when the stream is fully consumed or any error is encountered.
    // However, in case if the stream is not fully consumed, the stream
    // should be closed specifically.
    check resultStream2.close();

    // If a `Customer` stream type is defined when calling the query method,
    // The result is returned as a `Customer` record stream and the elements
    // of the stream can be either a `Customer` record or an error.
    stream&lt;Customer, error?&gt; customerStream =
        jdbcClient-&gt;query(`SELECT * FROM Customers`);

    // Iterates the customer stream.
    check from Customer customer in customerStream
        do {
            io:println(&quot;Full Customer details: &quot;, customer);
        };

    // Performs the cleanup after the example.
    check afterExample(jdbcClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample(jdbc:Client jdbcClient) returns sql:Error? {
    // Creates a table in the database.
    _ = check jdbcClient-&gt;execute(`CREATE TABLE Customers(customerId INTEGER
            NOT NULL GENERATED BY DEFAULT AS IDENTITY, firstName  VARCHAR(300),
            lastName  VARCHAR(300), registrationID INTEGER, creditLimit DOUBLE,
            country  VARCHAR(300), PRIMARY KEY (customerId))`);

    // Adds records to the newly-created table.
    _ = check jdbcClient-&gt;execute(`INSERT INTO Customers (firstName,
            lastName, registrationID,creditLimit,country) VALUES ('Peter',
            'Stuart', 1, 5000.75, 'USA')`);
    _ = check jdbcClient-&gt;execute(`INSERT INTO Customers (firstName,
            lastName, registrationID,creditLimit,country) VALUES
            ('Dan', 'Brown', 2, 10000, 'UK')`);
}

// Cleans up the database after running the example.
function afterExample(jdbc:Client jdbcClient) returns sql:Error? {
    // Cleans the database.
    _ = check jdbcClient-&gt;execute(`DROP TABLE Customers`);

    // Closes the JDBC client.
    check jdbcClient.close();
}
</code></pre>
<h4 id="output-266"><a class="header" href="#output-266">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Full Customer details: {&quot;CUSTOMERID&quot;:1,&quot;FIRSTNAME&quot;:&quot;Peter&quot;,&quot;LASTNAME&quot;:&quot;Stuart&quot;,&quot;REGISTRATIONID&quot;:1,&quot;CREDITLIMIT&quot;:5000.75,&quot;COUNTRY&quot;:&quot;USA&quot;}
Full Customer details: {&quot;CUSTOMERID&quot;:2,&quot;FIRSTNAME&quot;:&quot;Dan&quot;,&quot;LASTNAME&quot;:&quot;Brown&quot;,&quot;REGISTRATIONID&quot;:2,&quot;CREDITLIMIT&quot;:10000.0,&quot;COUNTRY&quot;:&quot;UK&quot;}
Total rows in customer table : 2
Full Customer details: {&quot;customerId&quot;:1,&quot;firstName&quot;:&quot;Peter&quot;,&quot;lastName&quot;:&quot;Stuart&quot;,&quot;registrationId&quot;:1,&quot;creditLimit&quot;:5000.75,&quot;country&quot;:&quot;USA&quot;}
Full Customer details: {&quot;customerId&quot;:2,&quot;firstName&quot;:&quot;Dan&quot;,&quot;lastName&quot;:&quot;Brown&quot;,&quot;registrationId&quot;:2,&quot;creditLimit&quot;:10000.0,&quot;country&quot;:&quot;UK&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="query-with-complex-types-1"><a class="header" href="#query-with-complex-types-1">Query With Complex Types</a></h1>
<p>This BBE demonstrates how to use the JDBC client with complex data types
such as arrays, binary, blobs, clob, and date/time fields. Note that the
relevant database driver JAR should be defined in the <code>Ballerina.toml</code> file as a dependency.
This sample is based on an H2 database and the H2 database driver JAR need to be added to <code>Ballerina.toml</code> file.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/java.jdbc/latest/">JDBC module</a>.<br><br>
This sample is written using H2 2.0.6 and it is recommended to use H2 JAR with versions higher than 2.0.2.</p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/java.jdbc;
import ballerina/sql;
import ballerina/time;

// The `BinaryType` record to represent the `BINARY_TYPES` database table.
type BinaryType record {|
    int row_id;
    byte[] blob_type;
    string clob_type;
    byte[] binary_type;
|};

// The `ArrayType` record to represent the `ARRAY_TYPES` database table.
type ArrayType record {|
    int row_id;
    int[] int_array;
    int[] long_array;
    decimal[] float_array;
    float[] double_array;
    boolean[] boolean_array;
    string[] string_array;
|};

// The `DateTimeType` record to represent the `DATE_TIME_TYPES` database table.
type DateTimeType record {|
    int row_id;
    string date_type;
    int time_type;
    time:Utc timestamp_type;
    string datetime_type;
|};

public function main() returns error? {
    // Initializes the JDBC client.
    jdbc:Client jdbcClient = check new (&quot;jdbc:h2:file:./target/bbes/java_jdbc&quot;,
        &quot;rootUser&quot;, &quot;rootPass&quot;);
    // Runs the prerequisite setup for the example.
    check beforeExample(jdbcClient);

    // Since the `rowType` is provided as a `BinaryType`, the `binaryResultStream`
    // will have `BinaryType` records.
    stream&lt;BinaryType, error?&gt; binaryResultStream =
                jdbcClient-&gt;query(`SELECT * FROM BINARY_TYPES`);

    io:println(&quot;Binary types Result :&quot;);
    // Iterates the `binaryResultStream`.
    check from BinaryType result in binaryResultStream
        do {
            io:println(result);
        };

    // Since the `rowType` is provided as an `ArrayType`, the `arrayResultStream` will
    // have `ArrayType` records.
    stream&lt;ArrayType, error?&gt; arrayResultStream =
                jdbcClient-&gt;query(`SELECT * FROM ARRAY_TYPES`);

    io:println(&quot;Array types Result :&quot;);
    // Iterates the `arrayResultStream`.
    check from ArrayType result in arrayResultStream
        do {
            io:println(result);
        };

    // Since the `rowType` is provided as a `DateTimeType`, the `dateResultStream`
    // will have `DateTimeType` records. The `Date`, `Time`, `DateTime`, and
    // `Timestamp` fields of the database table can be mapped to `time:Utc`,
    // string, and int types in Ballerina.
    stream&lt;DateTimeType, error?&gt; dateResultStream =
                jdbcClient-&gt;query(`SELECT * FROM DATE_TIME_TYPES`);

    io:println(&quot;DateTime types Result :&quot;);
    // Iterates the `dateResultStream`.
    check from DateTimeType result in dateResultStream
        do {
            io:println(result);
        };

    // Performs the cleanup after the example.
    check afterExample(jdbcClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample(jdbc:Client jdbcClient) returns sql:Error? {
    // Creates complex data type tables in the database.
    _ = check jdbcClient-&gt;execute(`CREATE TABLE BINARY_TYPES (row_id
            INTEGER NOT NULL, blob_type BLOB(1024), clob_type CLOB(1024), 
            binary_type BINARY(27), PRIMARY KEY (row_id))`);
    _ = check jdbcClient-&gt;execute(`CREATE TABLE ARRAY_TYPES (row_id
            INTEGER NOT NULL, int_array INT ARRAY, long_array BIGINT ARRAY,
            float_array FLOAT ARRAY, double_array DOUBLE ARRAY,
            boolean_array BOOLEAN ARRAY, string_array VARCHAR ARRAY,
            PRIMARY KEY (row_id))`);
    _ = check jdbcClient-&gt;execute(`CREATE TABLE DATE_TIME_TYPES(row_id
            INTEGER NOT NULL, date_type DATE, time_type TIME,
            timestamp_type timestamp, datetime_type  datetime, 
            PRIMARY KEY (row_id))`);

    // Adds the records to the newly-created tables.
    _ = check jdbcClient-&gt;execute(`INSERT INTO BINARY_TYPES (row_id,
            blob_type, clob_type, binary_type) VALUES (1, 
            X'77736F322062616C6C6572696E6120626C6F6220746573742E', 
            CONVERT('very long text', CLOB), 
            X'77736F322062616C6C6572696E612062696E61727920746573742E')`);
    _ = check jdbcClient-&gt;execute(`INSERT INTO ARRAY_TYPES (row_id,
            int_array, long_array, float_array, double_array, boolean_array, 
            string_array) VALUES (1, ARRAY[1, 2, 3], ARRAY[100000000,
            200000000, 300000000], ARRAY[245.23, 5559.49, 8796.123],
            ARRAY[245.23, 5559.49, 8796.123], ARRAY[TRUE, FALSE, TRUE],
            ARRAY['Hello', 'Ballerina'])`);
    _ = check jdbcClient-&gt;execute(`Insert into DATE_TIME_TYPES (row_id,
            date_type, time_type, timestamp_type, datetime_type) values (1, 
            '2017-05-23', '14:15:23', '2017-01-25 16:33:55', 
            '2017-01-25 16:33:55')`);
}

// Cleans up the database after running the example.
function afterExample(jdbc:Client jdbcClient) returns sql:Error? {
    // Cleans the database.
    _ = check jdbcClient-&gt;execute(`DROP TABLE BINARY_TYPES`);
    _ = check jdbcClient-&gt;execute(`DROP TABLE ARRAY_TYPES`);
    _ = check jdbcClient-&gt;execute(`DROP TABLE DATE_TIME_TYPES`);
    // Closes the JDBC client.
    check jdbcClient.close();
}
</code></pre>
<h4 id="output-267"><a class="header" href="#output-267">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Binary types Result :
{&quot;row_id&quot;:1,&quot;blob_type&quot;:[119,115,111,50,32,98,97,108,108,101,114,105,110,97,32,98,108,111,98,32,116,101,115,116,46],&quot;clob_type&quot;:&quot;very long text&quot;,&quot;binary_type&quot;:[119,115,111,50,32,98,97,108,108,101,114,105,110,97,32,98,105,110,97,114,121,32,116,101,115,116,46]}
Array types Result :
{&quot;row_id&quot;:1,&quot;int_array&quot;:[1,2,3],&quot;long_array&quot;:[100000000,200000000,300000000],&quot;float_array&quot;:[245.23,5559.49,8796.123],&quot;double_array&quot;:[245.23,5559.49,8796.123],&quot;boolean_array&quot;:[true,false,true],&quot;string_array&quot;:[&quot;Hello&quot;,&quot;Ballerina&quot;]}
DateTime types Result :
{&quot;row_id&quot;:1,&quot;date_type&quot;:&quot;2017-05-23&quot;,&quot;time_type&quot;:31523000,&quot;timestamp_type&quot;:[1485342235,0E-9],&quot;datetime_type&quot;:&quot;2017-01-25 16:33:55.0&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dml-and-ddl-operation-1"><a class="header" href="#dml-and-ddl-operation-1">DML and DDL Operation</a></h1>
<p>This BBE demonstrates how to use the JDBC client with DDL and
DML operations. Note that the relevant database driver JAR
should be defined in the <code>Ballerina.toml</code> file as a dependency.
This sample is based on an H2 database and the H2 database driver JAR need to be added to <code>Ballerina.toml</code> file.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/java.jdbc/latest/">JDBC module</a> .<br><br>
This sample is written using H2 2.0.6 and it is recommended to use H2 JAR with versions higher than 2.0.2.</p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/java.jdbc;
import ballerina/sql;

public function main() returns error? {
    // Initializes the JDBC client.
    jdbc:Client jdbcClient = check new (&quot;jdbc:h2:file:./target/bbes/java_jdbc&quot;, 
        &quot;rootUser&quot;, &quot;rootPass&quot;);
    // Runs the prerequisite setup for the example.
    check beforeExample(jdbcClient);

    float newCreditLimit = 15000.5;

    // Creates a parameterized query for the record update.
    sql:ParameterizedQuery updateQuery = 
            `UPDATE Customers SET creditLimit = ${newCreditLimit} 
            where customerId = 1`;

    sql:ExecutionResult result = check jdbcClient-&gt;execute(updateQuery);
    io:println(&quot;Updated Row count: &quot;, result?.affectedRowCount);

    string firstName = &quot;Dan&quot;;

    // Creates a parameterized query for deleting the records.
    sql:ParameterizedQuery deleteQuery = 
            `DELETE FROM Customers WHERE firstName = ${firstName}`;

    result = check jdbcClient-&gt;execute(deleteQuery);
    io:println(&quot;Deleted Row count: &quot;, result.affectedRowCount);

    // Performs the cleanup after the example.
    check afterExample(jdbcClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample(jdbc:Client jdbcClient) returns sql:Error? {
    //Creates a table in the database.
    sql:ExecutionResult result = 
        check jdbcClient-&gt;execute(`CREATE TABLE Customers(customerId INTEGER
            NOT NULL GENERATED BY DEFAULT AS IDENTITY, firstName  VARCHAR(300),
            lastName  VARCHAR(300), registrationID INTEGER, creditLimit DOUBLE,
            country  VARCHAR(300), PRIMARY KEY (customerId))`);

    // Inserts data into the table. The result will have the `affectedRowCount`
    // and `lastInsertedId` with the auto-generated ID of the last row.
    result = check jdbcClient-&gt;execute(`INSERT INTO Customers (firstName,
            lastName, registrationID,creditLimit,country) VALUES ('Peter',
            'Stuart', 1, 5000.75, 'USA')`);
    result = check jdbcClient-&gt;execute(`INSERT INTO Customers (firstName,
            lastName, registrationID,creditLimit,country) VALUES
            ('Dan', 'Brown', 2, 10000, 'UK')`);

    io:println(&quot;Rows affected: &quot;, result.affectedRowCount);
    io:println(&quot;Generated Customer ID: &quot;, result.lastInsertId);
}

// Cleans up the database after running the example.
function afterExample(jdbc:Client jdbcClient) returns sql:Error? {
    // Cleans the database.
    _ = check jdbcClient-&gt;execute(`DROP TABLE Customers`);
    
    // Closes the JDBC client.
    check jdbcClient.close();
}
</code></pre>
<h4 id="output-268"><a class="header" href="#output-268">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Rows affected: 1
Generated Customer ID: 2
Updated Row count: 1
Deleted Row count: 1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="batch-execute-1"><a class="header" href="#batch-execute-1">Batch Execute</a></h1>
<p>This BBE demonstrates how to use the JDBC client to execute a batch of
DDL/DML operations. Note that the relevant database driver JAR
should be defined in the <code>Ballerina.toml</code> file as a dependency. 
This sample is based on an H2 database and the H2 database driver JAR need to be added to the <code>Ballerina.toml</code> file.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/java.jdbc/latest/">JDBC module</a>.<br><br>
This sample is written using H2 2.0.6 and it is recommended to use H2 JAR with versions higher than 2.0.2.</p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/java.jdbc;
import ballerina/sql;

public function main() returns error? {
    // Initializes the JDBC client.
    jdbc:Client jdbcClient = check new (&quot;jdbc:h2:file:./target/bbes/java_jdbc&quot;, 
        &quot;rootUser&quot;, &quot;rootPass&quot;);
    // Runs the prerequisite setup for the example.
    check beforeExample(jdbcClient);

    // The records to be inserted.
    var insertRecords = [
        {
            firstName: &quot;Peter&quot;,
            lastName: &quot;Stuart&quot;,
            registrationID: 1,
            creditLimit: 5000.75,
            country: &quot;USA&quot;
        }, 
        {
            firstName: &quot;Stephanie&quot;,
            lastName: &quot;Mike&quot;,
            registrationID: 2,
            creditLimit: 8000.00,
            country: &quot;USA&quot;
        }, 
        {
            firstName: &quot;Bill&quot;,
            lastName: &quot;John&quot;,
            registrationID: 3,
            creditLimit: 3000.25,
            country: &quot;USA&quot;
        }
    ];

    // Creates a batch parameterized query.
    sql:ParameterizedQuery[] insertQueries = 
        from var data in insertRecords
        select `INSERT INTO Customers
                (firstName, lastName, registrationID, creditLimit, country)
                VALUES (${data.firstName}, ${data.lastName},
                ${data.registrationID}, ${data.creditLimit}, ${data.country})`;

    // Inserts the records with the auto-generated ID.
    sql:ExecutionResult[] result = 
                            check jdbcClient-&gt;batchExecute(insertQueries);

    int[] generatedIds = [];
    foreach var summary in result {
        generatedIds.push(&lt;int&gt;summary.lastInsertId);
    }
    io:println(&quot;\nInsert success, generated IDs are: &quot;, generatedIds, &quot;\n&quot;);

    // Checks the data after the batch execution.
    stream&lt;record {}, error?&gt; resultStream =
        jdbcClient-&gt;query(`SELECT * FROM Customers`);

    io:println(&quot;Data in Customers table:&quot;);
    check from record{} resultRecord in resultStream
        do {
            io:println(resultRecord.toString());
        };

    // Performs the cleanup after the example.
    check afterExample(jdbcClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample(jdbc:Client jdbcClient) returns sql:Error? {
    // Creates a table in the database.
    _ = check jdbcClient-&gt;execute(`CREATE TABLE Customers(customerId INTEGER
            NOT NULL GENERATED BY DEFAULT AS IDENTITY, firstName  VARCHAR(300),
            lastName  VARCHAR(300), registrationID INTEGER, creditLimit DOUBLE,
            country  VARCHAR(300), PRIMARY KEY (customerId))`);
}

// Cleans up the database after running the example.
function afterExample(jdbc:Client jdbcClient) returns sql:Error? {
    // Cleans the database.
    _ = check jdbcClient-&gt;execute(`DROP TABLE Customers`);
    
    // Closes the JDBC client.
    check jdbcClient.close();
}
</code></pre>
<h4 id="output-269"><a class="header" href="#output-269">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Insert success, generated IDs are: [1,2,3]

Data in Customers table:
{&quot;CUSTOMERID&quot;:1,&quot;FIRSTNAME&quot;:&quot;Peter&quot;,&quot;LASTNAME&quot;:&quot;Stuart&quot;,&quot;REGISTRATIONID&quot;:1,&quot;CREDITLIMIT&quot;:5000.75,&quot;COUNTRY&quot;:&quot;USA&quot;}
{&quot;CUSTOMERID&quot;:2,&quot;FIRSTNAME&quot;:&quot;Stephanie&quot;,&quot;LASTNAME&quot;:&quot;Mike&quot;,&quot;REGISTRATIONID&quot;:2,&quot;CREDITLIMIT&quot;:8000.0,&quot;COUNTRY&quot;:&quot;USA&quot;}
{&quot;CUSTOMERID&quot;:3,&quot;FIRSTNAME&quot;:&quot;Bill&quot;,&quot;LASTNAME&quot;:&quot;John&quot;,&quot;REGISTRATIONID&quot;:3,&quot;CREDITLIMIT&quot;:3000.25,&quot;COUNTRY&quot;:&quot;USA&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="atomic-batch-execute-1"><a class="header" href="#atomic-batch-execute-1">Atomic Batch Execute</a></h1>
<p>This BBE demonstrates how to use the JDBC client to execute a batch of
DDL/DML operations with the help of a <code>transaction</code> to achieve the atomic behaviour.
Note that the relevant database driver JAR should be defined in the <code>Ballerina.toml</code>
file as a dependency. 
This sample is based on an H2 database and the H2 database driver JAR need to be added to <code>Ballerina.toml</code> file.
For a sample configuration and more information on the underlying module, see the <a href="https:docs.central.ballerina.io/ballerinax/java.jdbc/latest/">JDBC module</a> <br><br>
This sample is written using H2 2.0.6 and it is recommended to use H2 JAR with versions higher than 2.0.2.</p>
<pre><code class="language-go">import ballerina/io;
import ballerinax/java.jdbc;
import ballerina/sql;

public function main() returns error? {
    // Initializes the JDBC client.
    jdbc:Client jdbcClient = check new (&quot;jdbc:h2:file:./target/bbes/java_jdbc&quot;, 
        &quot;rootUser&quot;, &quot;rootPass&quot;);
    // Runs the prerequisite setup for the example.
    check beforeExample(jdbcClient);

    // Records with the duplicate `registrationID` entry. Here it is registrationID = 1.
    var insertRecords = [
        {
            firstName: &quot;Linda&quot;,
            lastName: &quot;Jones&quot;,
            registrationID: 2,
            creditLimit: 10000.75,
            country: &quot;USA&quot;
        }, 
        {
            firstName: &quot;Peter&quot;,
            lastName: &quot;Stuart&quot;,
            registrationID: 1,
            creditLimit: 5000.75,
            country: &quot;USA&quot;
        }, 
        {
            firstName: &quot;Camellia&quot;,
            lastName: &quot;Potter&quot;,
            registrationID: 4,
            creditLimit: 2000.25,
            country: &quot;USA&quot;
        }
    ];

    // Creates a batch parameterized query.
    sql:ParameterizedQuery[] insertQueries = 
        from var data in insertRecords
        select `INSERT INTO Customers
                (firstName, lastName, registrationID, creditLimit, country)
                VALUES (${data.firstName}, ${data.lastName},
                ${data.registrationID}, ${data.creditLimit}, ${data.country})`;

    // The transaction block can be used to roll back if any error occurred.
    transaction {
        var result = jdbcClient-&gt;batchExecute(insertQueries);
        if result is sql:BatchExecuteError {
            io:println(result.message());
            io:println(result.detail()?.executionResults);
            io:println(&quot;Rollback transaction.\n&quot;);
            rollback;
        } else {
            error? err = commit;
            if err is error {
                io:println(&quot;Error occurred while committing: &quot;, err);
            }
        }
    }

    // Checks the data after the batch execution.
    stream&lt;record {}, error?&gt; resultStream =
        jdbcClient-&gt;query(`SELECT * FROM Customers`);

    io:println(&quot;Data in Customers table:&quot;);
    check from record{} result in resultStream
        do {
            io:println(result.toString());
        };

    // Performs the cleanup after the example.
    check afterExample(jdbcClient);
}

// Initializes the database as a prerequisite to the example.
function beforeExample(jdbc:Client jdbcClient) returns sql:Error? {
    // Creates a table in the database.
    _ = check jdbcClient-&gt;execute(`CREATE TABLE Customers(customerId INTEGER
            NOT NULL GENERATED BY DEFAULT AS IDENTITY, firstName  VARCHAR(300),
            lastName  VARCHAR(300), registrationID INTEGER UNIQUE,
            creditLimit DOUBLE, country VARCHAR(300),
            PRIMARY KEY (customerId))`);

    // Adds records to the newly-created table.
    _ = check jdbcClient-&gt;execute(`INSERT INTO Customers (firstName,
            lastName, registrationID,creditLimit,country) VALUES ('Peter',
            'Stuart', 1, 5000.75, 'USA')`);
}

// Cleans up the database after running the example.
function afterExample(jdbc:Client jdbcClient) returns sql:Error? {
    // Cleans the database.
    _ = check jdbcClient-&gt;execute(`DROP TABLE Customers`);
    
    // Closes the JDBC client.
    check jdbcClient.close();
}
</code></pre>
<h4 id="output-270"><a class="header" href="#output-270">Output</a></h4>
<pre><code class="language-bash"># Create a Ballerina project.
# Copy the example to the project and add relevant database driver jar details to the `Ballerina.toml` file.
# Execute the command below to build and run the project.
bal run

Error while executing batch command starting with: 'INSERT INTO Customers
                (firstName, lastName, registrationID, creditLimit, country)
                VALUES ( ? ,  ? ,
                 ? ,  ? ,  ? )'.Unique index or primary key violation: &quot;PUBLIC.CONSTRAINT_INDEX_6 ON PUBLIC.CUSTOMERS(REGISTRATIONID NULLS FIRST) VALUES ( /* 1 */ 1 )&quot;; SQL statement:
INSERT INTO Customers
                (firstName, lastName, registrationID, creditLimit, country)
                VALUES ( ? ,  ? ,
                 ? ,  ? ,  ? ) [23505-206].
[{&quot;affectedRowCount&quot;:1,&quot;lastInsertId&quot;:null},{&quot;affectedRowCount&quot;:-3,&quot;lastInsertId&quot;:null},{&quot;affectedRowCount&quot;:1,&quot;lastInsertId&quot;:null}]
Rollback transaction.

Data in Customers table:
{&quot;CUSTOMERID&quot;:1,&quot;FIRSTNAME&quot;:&quot;Peter&quot;,&quot;LASTNAME&quot;:&quot;Stuart&quot;,&quot;REGISTRATIONID&quot;:1,&quot;CREDITLIMIT&quot;:5000.75,&quot;COUNTRY&quot;:&quot;USA&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="io"><a class="header" href="#io">IO</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="readwrite-bytes"><a class="header" href="#readwrite-bytes">Read/Write Bytes</a></h1>
<p>This example demonstrates how bytes can be read and written through the I/O APIs.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/io/latest/">IO module</a>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    // Initializes the image paths.
    string imagePath = &quot;./files/ballerina.jpg&quot;;
    string imageCopyPath1 = &quot;./files/ballerinaCopy1.jpg&quot;;
    string imageCopyPath2 = &quot;./files/ballerinaCopy2.jpg&quot;;

    // Reads the file content as a byte array using the given file path.
    byte[] bytes = check io:fileReadBytes(imagePath);
    // Writes the already-read content to the given destination file.
    check io:fileWriteBytes(imageCopyPath1, bytes);
    io:println(&quot;Successfully copied the image as a byte array.&quot;);

    // Reads the file as a stream of blocks. The default block size is 4KB.
    // Here, the default size is overridden by the value 2KB.
    stream&lt;io:Block, io:Error?&gt; blockStream = check
    io:fileReadBlocksAsStream(imagePath, 2048);
    // If the file reading was successful, then,
    // the content will be written to the given destination file using the given stream.
    check io:fileWriteBlocksFromStream(imageCopyPath2, blockStream);
    io:println(&quot;Successfully copied the image as a stream.&quot;);
}
</code></pre>
<h4 id="output-271"><a class="header" href="#output-271">Output</a></h4>
<pre><code class="language-bash"># In the directory, which contains the `.bal` file, create a directory named `files`,
# and add an image file named `ballerina.jpg` in it as follows.
# tree .
#  files
#     ballerina.jpeg
#  io_bytes.bal
bal run io_bytes.bal
Successfully copied the image as a byte array.
Successfully copied the image as a stream.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="readwrite-strings"><a class="header" href="#readwrite-strings">Read/Write Strings</a></h1>
<p>This demonstrates how string could be read and written through I/O APIs.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/io/latest/">IO module</a>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    // Initializes the text path and the content.
    string textFilePath1 = &quot;./files/textfile1.txt&quot;;
    string textFilePath2 = &quot;./files/textfile2.txt&quot;;
    string textFilePath3 = &quot;./files/textfile3.txt&quot;;
    string textContent = &quot;Ballerina is an open source programming language.&quot;;
    string[] lines = [&quot;The Big Bang Theory&quot;, &quot;F.R.I.E.N.D.S&quot;,
    &quot;Game of Thrones&quot;, &quot;LOST&quot;];

    // Writes the given string to a file.
    check io:fileWriteString(textFilePath1, textContent);
    // If the write operation was successful, then, reads the content as a string.
    string readContent = check io:fileReadString(textFilePath1);
    io:println(readContent);

    // Writes the given array of lines to a file.
    check io:fileWriteLines(textFilePath2, lines);
    // If the write operation was successful, then, performs a read operation to read the lines as an array.
    string[] readLines = check io:fileReadLines(textFilePath2);
    io:println(readLines);

    // Writes the given stream of lines to a file.
    check io:fileWriteLinesFromStream(textFilePath3, lines.toStream());
    // If the write operation was successful, then, performs a read operation to read the lines as a stream.
    stream&lt;string, io:Error?&gt; lineStream = check
                                    io:fileReadLinesAsStream(textFilePath3);
    // Iterates through the stream and prints the content.
    check lineStream.forEach(function(string val) {
                               io:println(val);
                           });
}
</code></pre>
<h4 id="output-272"><a class="header" href="#output-272">Output</a></h4>
<pre><code class="language-bash">bal run io_strings.bal
Ballerina is an open source programming language.
[&quot;The Big Bang Theory&quot;,&quot;F.R.I.E.N.D.S&quot;,&quot;Game of Thrones&quot;,&quot;LOST&quot;]
The Big Bang Theory
F.R.I.E.N.D.S
Game of Thrones
LOST
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="readwrite-csv"><a class="header" href="#readwrite-csv">Read/Write CSV</a></h1>
<p>This sample demonstrates how to read/write from/to a CSV file using the CSV channel of the I/O API.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/io/latest/">IO module</a>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    // Initializes the CSV file path and content.
    string csvFilePath1 = &quot;./files/csvFile1.csv&quot;;
    string csvFilePath2 = &quot;./files/csvFile2.csv&quot;;
    string[][] csvContent = [[&quot;1&quot;, &quot;James&quot;, &quot;10000&quot;], [&quot;2&quot;, &quot;Nathan&quot;, &quot;150000&quot;],
    [&quot;3&quot;, &quot;Ronald&quot;, &quot;120000&quot;], [&quot;4&quot;, &quot;Roy&quot;, &quot;6000&quot;],
    [&quot;5&quot;, &quot;Oliver&quot;, &quot;1100000&quot;]];

    // Writes the given content string[][] to a CSV file.
    check io:fileWriteCsv(csvFilePath1, csvContent);
    // If the write operation was successful, then, performs a read operation to read the CSV content as a string array of arrays.
    string[][] readCsv = check io:fileReadCsv(csvFilePath1);
    io:println(readCsv);

    // Writes the given content stream to a CSV file.
    check io:fileWriteCsvFromStream(csvFilePath2, csvContent.toStream());
    // If the write operation was successful, then, perform a read operation to read the CSV content as a stream.
    stream&lt;string[], io:Error?&gt; csvStream = check
                                        io:fileReadCsvAsStream(csvFilePath2);
    // Iterates through the stream and prints the content.
    check csvStream.forEach(function(string[] val) {
                              io:println(val);
                          });
}
</code></pre>
<h4 id="output-273"><a class="header" href="#output-273">Output</a></h4>
<pre><code class="language-bash">bal run io_csv.bal
[[&quot;1&quot;,&quot;James&quot;,&quot;10000&quot;],[&quot;2&quot;,&quot;Nathan&quot;,&quot;150000&quot;],[&quot;3&quot;,&quot;Ronald&quot;,&quot;120000&quot;],[&quot;4&quot;,&quot;Roy&quot;,&quot;6000&quot;],[&quot;5&quot;,&quot;Oliver&quot;,&quot;1100000&quot;]]
[&quot;1&quot;,&quot;James&quot;,&quot;10000&quot;]
[&quot;2&quot;,&quot;Nathan&quot;,&quot;150000&quot;]
[&quot;3&quot;,&quot;Ronald&quot;,&quot;120000&quot;]
[&quot;4&quot;,&quot;Roy&quot;,&quot;6000&quot;]
[&quot;5&quot;,&quot;Oliver&quot;,&quot;1100000&quot;]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="readwrite-json"><a class="header" href="#readwrite-json">Read/Write JSON</a></h1>
<p>This sample demonstrates how to read JSON content from a file and write JSON content
to a file using the character channel, <code>readJson()</code>, and <code>writeJson()</code> of the I/O API.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/io/latest/">IO module</a>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    // Initializes the JSON file path and content.
    string jsonFilePath = &quot;./files/jsonFile.json&quot;;
    json jsonContent = {&quot;Store&quot;: {
            &quot;@id&quot;: &quot;AST&quot;,
            &quot;name&quot;: &quot;Anne&quot;,
            &quot;address&quot;: {
                &quot;street&quot;: &quot;Main&quot;,
                &quot;city&quot;: &quot;94&quot;
            },
            &quot;codes&quot;: [&quot;4&quot;, &quot;8&quot;]
        }};

    // Writes the given JSON to a file.
    check io:fileWriteJson(jsonFilePath, jsonContent);
    // If the write operation was successful, then, performs a read operation to read the JSON content.
    json readJson = check io:fileReadJson(jsonFilePath);
    io:println(readJson);
}
</code></pre>
<h4 id="output-274"><a class="header" href="#output-274">Output</a></h4>
<pre><code class="language-bash">bal run io_json.bal
{&quot;Store&quot;:{&quot;@id&quot;:&quot;AST&quot;,&quot;name&quot;:&quot;Anne&quot;,&quot;address&quot;:{&quot;street&quot;:&quot;Main&quot;,&quot;city&quot;:&quot;94&quot;},&quot;codes&quot;:[&quot;4&quot;,&quot;8&quot;]}}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="readwrite-xml"><a class="header" href="#readwrite-xml">Read/Write XML</a></h1>
<p>This example demonstrates how XML content can be read from a file and written
to a file using a character channel and the <code>readXml()</code> and <code>writeXml()</code> functions of the I/O API.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/io/latest/">IO module</a>.</p>
<pre><code class="language-go">import ballerina/io;

public function main() returns error? {
    // Initializes the XML file path and content.
    string xmlFilePath = &quot;./files/xmlFile.xml&quot;;
    xml xmlContent = xml `&lt;book&gt;The Lost World&lt;/book&gt;`;

    // Writes the given XML to a file.
    check io:fileWriteXml(xmlFilePath, xmlContent);
    // If the write operation was successful, then, performs a read operation to read the XML content.
    xml readXml = check io:fileReadXml(xmlFilePath);
    io:println(readXml);
}
</code></pre>
<h4 id="output-275"><a class="header" href="#output-275">Output</a></h4>
<pre><code class="language-bash">bal run io_xml.bal
&lt;book&gt;The Lost World&lt;/book&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="security"><a class="header" href="#security">Security</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cryptographic-operations"><a class="header" href="#cryptographic-operations">Cryptographic Operations</a></h1>
<p>The <code>crypto</code> stdlib provides functions usable to perform different cryptographic operations such as
hashing, HMAC generation, checksum generation, encryption, decryption, digitally signing data and 
verifying digitally signed data.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/crypto/latest/">Crypto module</a>.</p>
<pre><code class="language-go">import ballerina/crypto;
import ballerina/io;
import ballerina/random;

function hash() returns error? {
    // Input value for hash operations.
    string value = &quot;Hello Ballerina!&quot;;
    byte[] input = value.toBytes();

    // Hashing input value using the [MD5 hashing algorithm](https://docs.central.ballerina.io/ballerina/crypto/latest/functions#hashMd5), and printing the hash value using the Hex encoding.
    byte[] output = crypto:hashMd5(input);
    io:println(&quot;Hex encoded hash with MD5: &quot; + output.toBase16());

    // Hashing the input value using the SHA1 hashing algorithm, and printing the hash value using the Base64 encoding.
    output = crypto:hashSha1(input);
    io:println(&quot;Base64 encoded hash with SHA1: &quot; + output.toBase64());

    // Hashing the input value using the SHA256 hashing algorithm, and printing the hash value using the Hex encoding.
    output = crypto:hashSha256(input);
    io:println(&quot;Hex encoded hash with SHA256: &quot; + output.toBase16());

    // Hashing the input value using the SHA384 hashing algorithm, and printing the hash value using the Base64 encoding.
    output = crypto:hashSha384(input);
    io:println(&quot;Base64 encoded hash with SHA384: &quot; + output.toBase64());

    // Hashing the input value using the SHA512 hashing algorithm, and printing the hash value using the Hex encoding.
    output = crypto:hashSha512(input);
    io:println(&quot;Hex encoded hash with SHA512: &quot; + output.toBase16());

    // The Hex-encoded CRC32B checksum generation for the input value.
    io:println(&quot;CRC32B for text: &quot; + crypto:crc32b(input));
}

function hmac() returns error? {
    // Input value for HMAC operations.
    string value = &quot;Hello Ballerina!&quot;;
    byte[] input = value.toBytes();

    // The key used for the HMAC generation.
    string secret = &quot;somesecret&quot;;
    byte[] key = secret.toBytes();

    // HMAC generation for the input value using the MD5 hashing algorithm, and printing the HMAC value using the Hex encoding.
    byte[] output = check crypto:hmacMd5(input, key);
    io:println(&quot;Hex encoded HMAC with MD5: &quot; + output.toBase16());

    // HMAC generation for input the value using the SHA1 hashing algorithm, and printing the HMAC value using the Base64 encoding.
    output = check crypto:hmacSha1(input, key);
    io:println(&quot;Base64 encoded HMAC with SHA1: &quot; + output.toBase64());

    // HMAC generation for the input value using the SHA256 hashing algorithm, and printing the HMAC value using the Hex encoding.
    output = check crypto:hmacSha256(input, key);
    io:println(&quot;Hex encoded HMAC with SHA256: &quot; + output.toBase16());

    // HMAC generation for the input value using the SHA384 hashing algorithm, and printing the HMAC value using the Base64 encoding.
    output = check crypto:hmacSha384(input, key);
    io:println(&quot;Base64 encoded HMAC with SHA384: &quot; + output.toBase64());

    // HMAC generation for the input value using the SHA512 hashing algorithm, and printing the HMAC value using the Hex encoding.
    output = check crypto:hmacSha512(input, key);
    io:println(&quot;Hex encoded HMAC with SHA512: &quot; + output.toBase16());
}

function decodePrivateKey() returns crypto:PrivateKey|error {
    // Obtaining the reference to an RSA private key by a key file.
    string keyFile = &quot;../resource/path/to/private.key&quot;;
    crypto:PrivateKey privateKey =
        check crypto:decodeRsaPrivateKeyFromKeyFile(keyFile);

    // Obtaining the reference to an RSA private key by an encrypted key file.
    string encryptedKeyFile = &quot;../resource/path/to/encryptedPrivate.key&quot;;
    privateKey = check crypto:decodeRsaPrivateKeyFromKeyFile(encryptedKeyFile,
                                                         &quot;ballerina&quot;);

    // Obtaining the reference to an RSA private key stored within a PKCS#12 or PFX format archive file.
    crypto:KeyStore keyStore = {
        path: &quot;../resource/path/to/ballerinaKeystore.p12&quot;,
        password: &quot;ballerina&quot;
    };
    privateKey = check crypto:decodeRsaPrivateKeyFromKeyStore(keyStore,
                                              &quot;ballerina&quot;, &quot;ballerina&quot;);

    return privateKey;
}

function decodePublicKey() returns crypto:PublicKey|error {
    // Obtaining the reference to an RSA public key by a cert file.
    string certFile = &quot;../resource/path/to/public.crt&quot;;
    crypto:PublicKey publicKey =
        check crypto:decodeRsaPublicKeyFromCertFile(certFile);

    // Obtaining reference to a RSA public key stored within a PKCS#12 or PFX format archive file.
    crypto:TrustStore trustStore = {
        path: &quot;../resource/path/to/ballerinaTruststore.p12&quot;,
        password: &quot;ballerina&quot;
    };
    publicKey = check crypto:decodeRsaPublicKeyFromTrustStore(trustStore,
                                                             &quot;ballerina&quot;);

    return publicKey;
}

function sign() returns error? {
    // Input value for the `sign` operations.
    string value = &quot;Hello Ballerina!&quot;;
    byte[] input = value.toBytes();

    // Private and public keys for the `sign` and `verify` operations.
    crypto:PrivateKey privateKey = check decodePrivateKey();
    crypto:PublicKey publicKey = check decodePublicKey();

    // Signing the input value using the RSA-MD5 signature algorithms, and printing the signature value using the Hex encoding.
    byte[] output = check crypto:signRsaMd5(input, privateKey);
    io:println(&quot;Hex encoded RSA-MD5 signature: &quot; + output.toBase16());

    boolean verified =
        check crypto:verifyRsaMd5Signature(input, output, publicKey);
    io:println(&quot;RSA-MD5 signature verified: &quot; + verified.toString());

    // Signing the input value using the RSA-MD5 signature algorithms, and printing the signature value using the Base64 encoding.
    output = check crypto:signRsaSha1(input, privateKey);
    io:println(&quot;Base64 encoded RSA-SHA1 signature: &quot; + output.toBase64());

    verified = check crypto:verifyRsaSha1Signature(input, output, publicKey);
    io:println(&quot;RSA-SHA1 signature verified: &quot; + verified.toString());

    // Signing the input value using the RSA-MD5 signature algorithms, and printing the signature value using the Hex encoding.
    output = check crypto:signRsaSha256(input, privateKey);
    io:println(&quot;Hex encoded RSA-SHA256 signature: &quot; + output.toBase16());

    verified = check crypto:verifyRsaSha256Signature(input, output, publicKey);
    io:println(&quot;RSA-SHA256 signature verified: &quot; + verified.toString());

    // Signing the input value using the RSA-MD5 signature algorithms, and printing the signature value using the Base64 encoding.
    output = check crypto:signRsaSha384(input, privateKey);
    io:println(&quot;Base64 encoded RSA-SHA384 signature: &quot; + output.toBase64());

    verified = check crypto:verifyRsaSha384Signature(input, output, publicKey);
    io:println(&quot;RSA-SHA384 signature verified: &quot; + verified.toString());

    // Signing the input value using the RSA-MD5 signature algorithms, and printing the signature value using the Hex encoding.
    output = check crypto:signRsaSha512(input, privateKey);
    io:println(&quot;Hex encoded RSA-SHA512 signature: &quot; + output.toBase16());

    verified = check crypto:verifyRsaSha512Signature(input, output, publicKey);
    io:println(&quot;RSA-SHA512 signature verified: &quot; + verified.toString());
}

function encrypt() returns error? {
    // Input value for the `encrypt` operations.
    string value = &quot;Hello Ballerina!&quot;;
    byte[] input = value.toBytes();

    // Private and public keys for the `encrypt` and `decrypt` operations.
    crypto:PrivateKey privateKey = check decodePrivateKey();
    crypto:PublicKey publicKey = check decodePublicKey();

    // Encrypts and decrypts an input value using the `RSA ECB PKCS1` padding.
    byte[] output = check crypto:encryptRsaEcb(input, publicKey);
    output = check crypto:decryptRsaEcb(output, privateKey);
    io:println(&quot;RSA ECB PKCS1 decrypted value: &quot; +
        check string:fromBytes(output));

    // Encrypts and decrypts an input value using the `RSA ECB OAEPwithSHA512andMGF1` padding.
    output = check crypto:encryptRsaEcb(input, publicKey,
                                        crypto:OAEPwithSHA512andMGF1);
    output = check crypto:decryptRsaEcb(output, privateKey,
                                        crypto:OAEPwithSHA512andMGF1);
    io:println(&quot;RSA ECB OAEPwithSHA512andMGF1 decrypted value: &quot; +
        check string:fromBytes(output));

    // Randomly generates a 128 bit key for the AES encryption.
    byte[16] aesKey = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    foreach var i in 0 ... 15 {
        aesKey[i] = &lt;byte&gt;(check random:createIntInRange(0, 255));
    }

    // Randomly generates a 128 bit IV for the AES encryption.
    byte[16] iv = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    foreach var i in 0 ... 15 {
        iv[i] = &lt;byte&gt;(check random:createIntInRange(0, 255));
    }

    // Encrypts and decrypts an input value using the `AES CBC PKCS5` padding.
    output = check crypto:encryptAesCbc(input, aesKey, iv);
    output = check crypto:decryptAesCbc(output, aesKey, iv);
    io:println(&quot;AES CBC PKCS5 decrypted value: &quot; +
        check string:fromBytes(output));

    // Encrypts and decrypts an input value using the `AES CBC` without padding.
    output = check crypto:encryptAesCbc(input, aesKey, iv, crypto:NONE);
    output = check crypto:decryptAesCbc(output, aesKey, iv, crypto:NONE);
    io:println(&quot;AES CBC no padding decrypted value: &quot; +
        check string:fromBytes(output));

    // Encrypts and decrypts an input value using the `AES GCM PKCS5` padding.
    output = check crypto:encryptAesGcm(input, aesKey, iv);
    output = check crypto:decryptAesGcm(output, aesKey, iv);
    io:println(&quot;AES GCM PKCS5 decrypted value: &quot; +
        check string:fromBytes(output));

    // Encrypts and decrypts an input value using the `AES GCM` without padding.
    output = check crypto:encryptAesGcm(input, aesKey, iv, crypto:NONE);
    output = check crypto:decryptAesGcm(output, aesKey, iv, crypto:NONE);
    io:println(&quot;AES GCM no padding decrypted value: &quot; +
        check string:fromBytes(output));

    // Encrypts and decrypts an input value using the `AES ECB PKCS5 padding`.
    output = check crypto:encryptAesEcb(input, aesKey);
    output = check crypto:decryptAesEcb(output, aesKey);
    io:println(&quot;AES ECB PKCS5 decrypted value: &quot; +
        check string:fromBytes(output));

    // Encrypts and decrypts an input value using the `AES ECB` without padding.
    output = check crypto:encryptAesEcb(input, aesKey, crypto:NONE);
    output = check crypto:decryptAesEcb(output, aesKey, crypto:NONE);
    io:println(&quot;AES ECB no padding decrypted value: &quot; +
        check string:fromBytes(output));
}

public function main() returns error? {
    check hash();
    check hmac();
    check sign();
    check encrypt();
}
</code></pre>
<h4 id="output-276"><a class="header" href="#output-276">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path, private key file path, and
# trusted certificate file path.
bal run security_crypto.bal
Hex encoded hash with MD5: 0605402ee16d8e96511a58ff105bc24a
Base64 encoded hash with SHA1: /8fwbGIevBvv2Nl3gEL9DtWas+Q=
Hex encoded hash with SHA256: a984a643c350b17f0738bac0fef17f2cd91d91e04596351d0af
    670c79adc12d5
Base64 encoded hash with SHA384: lselzItgAZHQmqNbkf/s2aRjBSd93O3ayc0PB0Dxk6AEo1s4
    4zyTz/Qp0FJO1n6b
Hex encoded hash with SHA512: a6f0770f1582f49396a97fbd5973ac22a3a578ac6a991786427
    dfec17dbd984d8d6289771ac6f44176160a3dcd59f4a8c6b3ab97bef0caa5c67a3fac78c8e946
CRC32B for text: db9230c5
Hex encoded HMAC with MD5: b69fa2cc698e0923a7eea9d8f2b156fe
Base64 encoded HMAC with SHA1: AkWFajkb/gml703Zf4pPgxrjam4=
Hex encoded HMAC with SHA256: 13a3369b8ba326fd311d4500b06a5214a02ed2a033917108f6b
    9af58b7ede381
Base64 encoded HMAC with SHA384: 0AjKoWLhNPgdobGTPJs0PdkA0W9wkJtzUvXigzC1ZmXDJJsx
    p4icks4JrPiwHGm6
Hex encoded HMAC with SHA512: 27588ad08e772a6bba5fca5f45cf467819c8de69a70a42be6fe
    3eb09ceb3bfeb8b2976bda8ea5c10dcfa2294b12cb0b50b22a06309bada98af21857904a03205
Hex encoded RSA-MD5 signature: 2cfd121e4ff2409d1b2482ebbf37d0c035884d6d858e307e44
    60b092d79cb20abb624a0dfae76b73b1fc85447be3060a36b318813f0115b1919e5efa7a7f9b1
    173ec869f56fd9448d99770e1565db1c69a04fd0075fa0e33423a7e829a8b9c25a4dd2c68f3ee
    e021c0c4ff27979750b395384e280afd87af5274c8d2d99ad4438d9bfc9b2c5a2814212ba29ce
    6ff70cbe30a5c23f86b0330e143c4d8813ff10092cd313c6861706d37df5f4bb4e9fc72354975
    ee1786cf24c79b9edfa909968f198c4da37464f3d214a68fb39956717e92d667bb5a9a7f5986b
    a055d431813d4053a028873499f98c94fd6b5c6fd5aefad432669f957ab4ce9e91c5e77b36ec0
RSA-MD5 signature verified: true
Base64 encoded RSA-SHA1 signature: bYMHKKVkjbOUp9ly3AdW9/euxF94krkkF9SDk2FfbVEc0m
    qpGIxVoZlPiFxszurZF1YPcqOSeOehDkaHXUMfQkTjBq7XlcePtkywy0fChqw8/SWqZR8nbYv97tt
    8+MVTkymbm26syQLwYNLiGp/EsN6X+fJpkdakwHE+TrdE+rEFrNysGyAm1DWwc4c+l7MEmSYMUnh/
    GWPY5r2knOOdDA3mr+XyrsxzFRWZgO7ebVvEQfq9XkRp8kdiGVgpLS5au0jKj3EpbCdS1prFgy3gr
    kuSJTTUQCwgPo7WSjWbuehFGni7rbas8HIqNlyWF0qUyznJ3eqbUwZ95QqOoVWZoQ==
RSA-SHA1 signature verified: true
Hex encoded RSA-SHA256 signature: 215c6ea96c9e82348430c6bb02e715560b4fbd3afcf24fb
    eb41ff12d4d68a797d61c4d6f822807688e4dc604e212b3cc7ac563b3cbe4e5690e2aebaf4e3d
    f35c19d4b0f7043f50501f390634303577053b029d495104c0e98bc887f0be744ef6f726f7192
    01907ad4e86cef82eb030b60c384f7034a85159081e598e197bb8904a9123f39d190796dc7fd9
    46157547c10523999b8fa956d4119dbfe3c1435911c0585cf3c537964516706772e87f2470557
    40cc4867ac6b99d7bf699fce1b59956c7f55368c8c88c9d47e51ef120ed3f27c3e555691a6971
    42c78cbd72c23b81b43fa5ab67164a35f8e8c6bf1da187d3feb866add13f1fb9576a2f7887535
    311
RSA-SHA256 signature verified: true
Base64 encoded RSA-SHA384 signature: BjQ40dffGiRQ4zo1s+ld+zKhJL21RbO5sW3L2+4xmonU
    t126u9D4/FZ2sM1QGGamj8btB9otiYmWr9sFm4fTs1EX6vrxcCGCAiDdkMxiRs7kShaz2x/BjJQ7c
    Od9OY+amwo7DQ/FAk9mNOt4lFUpjc9WyEW9F1PEJRXZQvMmVabDu8lp/Fh02lmEquG15DT5qT0jRx
    RJiS8CNa+97cMZdOmF2KeADfRbNJSz70mZ76MrsNxYIXYIiJzJBQod0efQr0Sr/HDn4JDVph9rpDM
    3p8m94TyXvSOwxwxzZWRLEwB0ANdfDmbrW4bOpxfZZFmy1hltqNJQ9G0BcKOHsZDj6Q==
RSA-SHA384 signature verified: true
Hex encoded RSA-SHA512 signature: 15428fdc7b26d18b1f3eae4569399ae6ebfd430c8f073bf
    2fa77ebfe1ad5645640374ea4a4aeadd252af3a198e55e69ad2a910e28470d9b54748887de06a
    5c3ed7ab12399a404359332553e051e8ae0f3ef741faa15a21ad17a9c235e5f91d567bcca0e5a
    6117689dccada4a33ee897514f7a8a32f12dac0087f5dcbb094c93c792f672e1685618ac5d93a
    a9d30f6d8e306145ef2d1b9cfdc04d6c61b43376089a78471e8e03d97ee3b57e1b734a23f4436
    6a99234a0abeb1d36d01c474833b4c2beaf430dae06ab95a1c951645fb1e0a5e7b9eed44d40e3
    5036f2cd2764df6cc04fe1248e1bb772a53c8201a974109333a318ce57930494d4cb5e41d0dc8
    f1c
RSA-SHA512 signature verified: true
RSA ECB PKCS1 decrypted value: Hello Ballerina!
RSA ECB OAEPwithSHA512andMGF1 decrypted value: Hello Ballerina!
AES CBC PKCS5 decrypted value: Hello Ballerina!
AES CBC no padding decrypted value: Hello Ballerina!
AES GCM PKCS5 decrypted value: Hello Ballerina!
AES GCM no padding decrypted value: Hello Ballerina!
AES ECB PKCS5 decrypted value: Hello Ballerina!
AES ECB no padding decrypted value: Hello Ballerina!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jwt-issuevalidate"><a class="header" href="#jwt-issuevalidate">JWT Issue/Validate</a></h1>
<p>This example demonstrates how to issue a self-signed JWT and
validate a JWT.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/jwt/latest/">JWT module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/jwt;

public function main() returns error? {
    // Defines the JWT issuer configurations with the private key file configurations, which are used to self-sign the JWT.
    jwt:IssuerConfig issuerConfig = {
        username: &quot;ballerina&quot;,
        issuer: &quot;wso2&quot;,
        audience: &quot;vEwzbcasJVQm1jVYHUHCjhxZ4tYa&quot;,
        keyId: &quot;NTAxZmMxNDMyZDg3MTU1ZGM0MzEzODJhZWI4NDNlZDU1OGFkNjFiMQ&quot;,
        expTime: 3600,
        // Signature can be created using either the private key configurations or keystore configurations.
        // [jwt:IssuerSignatureConfig](https://docs.central.ballerina.io/ballerina/jwt/latest/records/IssuerSignatureConfig)
        signatureConfig: {
            config: {
                keyFile: &quot;../resource/path/to/private.key&quot;
            }
        }
    };

    // Issues a JWT based on the provided header, payload, and private key.
    string jwt = check jwt:issue(issuerConfig);
    io:println(&quot;Issued JWT: &quot;, jwt);

    // Defines the JWT validator configurations with the public certificate file configurations, which are used to
    // validate the signature of JWT.
    jwt:ValidatorConfig validatorConfig = {
        issuer: &quot;wso2&quot;,
        audience: &quot;vEwzbcasJVQm1jVYHUHCjhxZ4tYa&quot;,
        clockSkew: 60,
        // Signature can be validated using the public certificate file, truststore configurations, or JWKS configurations.
        // [jwt:ValidatorSignatureConfig](https://docs.central.ballerina.io/ballerina/jwt/latest/records/ValidatorSignatureConfig)
        signatureConfig: {
            certFile: &quot;../resource/path/to/public.crt&quot;
        }
    };

    // Validates the created JWT.
    jwt:Payload payload = check jwt:validate(jwt, validatorConfig);
    io:println(&quot;Validated JWT Payload: &quot;, payload.toString());
}
</code></pre>
<h4 id="output-277"><a class="header" href="#output-277">Output</a></h4>
<pre><code class="language-bash"># You may need to change the certificate file path, private key file path, and
# trusted certificate file path.
bal run security_jwt_issue_validate.bal
Issued JWT: eyJhbGciOiJSUzI1NiIsICJ0eXAiOiJKV1QiLCAia2lkIjoiTlRBeFptTXhORE15WkR
            nM01UVTFaR00wTXpFek9ESmhaV0k0TkRObFpEVTFPR0ZrTmpGaU1RIn0.eyJpc3MiOi
            JiYWxsZXJpbmEiLCAic3ViIjoiYWRtaW4iLCAiYXVkIjoidkV3emJjYXNKVlFtMWpWW
            UhVSENqaHhaNHRZYSIsICJqdGkiOiI1NWEwYjc1NC04OTVmLTQyNzktODg0My1iNzQ1
            ZTExYTU3ZTkiLCAiZXhwIjoxNjExMTI3MDIzLCAibmJmIjoxNjExMTIzNDIzLCAiaWF
            0IjoxNjExMTIzNDIzfQ.DMJDjJEFiQN7d_2CXGfXX_UR8Fi7Witr3aVGm4K7amEm3xN
            cbh1bZmKO2ir-oP2_ikoM1_ETO7i4E4LKJHNAEdhqj8YHyKpbszaEq5zouMOtdFcI7i
            TS8LyYDnyLEQQ6sa9L9NoMz3xULeF8epk0eaN1vVA-ijndVkZlMjaXJNf9Bgzn2qJOd
            sQ6F0GeC4WKEt-xcEY5C2_haEDotSOYhUzEqh6D1fRtrGy7GaH5gzx99n-xjn8NZbTD
            F0VnD6c1kJPe25FiPz24l9KdaCE1i2WbuzEhZWMclHW5RcTXVkLLkjQ4DvxfE-riGmK
            qPN1gatWViZQF_VGBK-G7rEhi9Q
Validated JWT Payload: {&quot;iss&quot;:&quot;ballerina&quot;,&quot;sub&quot;:&quot;admin&quot;,
                        &quot;aud&quot;:&quot;vEwzbcasJVQm1jVYHUHCjhxZ4tYa&quot;,
                        &quot;jti&quot;:&quot;55a0b754-895f-4279-8843-b745e11a57e9&quot;,
                        &quot;exp&quot;:1611127023,&quot;nbf&quot;:1611123423,&quot;iat&quot;:1611123423}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="url"><a class="header" href="#url">URL</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="url-encodedecode-operations"><a class="header" href="#url-encodedecode-operations">URL Encode/Decode Operations</a></h1>
<p>Ballerina URL API supports encoding/decoding a URL or part of a URL.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/url/latest/">URL module</a>.</p>
<pre><code class="language-go">import ballerina/url;
import ballerina/io;

public function main() returns error? {
    string value1 = &quot;data=value&quot;;
    // Encoding a URL component into a string.
    string encoded = check url:encode(value1, &quot;UTF-8&quot;);
    io:println(&quot;URL encoded value: &quot;, encoded);

    string value2 = &quot;data%3Dvalue&quot;;
    // Decoding an encoded URL component into a string.
    string decoded = check url:decode(value2, &quot;UTF-8&quot;);
    io:println(&quot;URL decoded value: &quot;, decoded);
}
</code></pre>
<h4 id="output-278"><a class="header" href="#output-278">Output</a></h4>
<pre><code class="language-bash">bal run url_encode_decode.bal
URL encoded value: data%3Dvalue
URL decoded value: data=value
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="time"><a class="header" href="#time">Time</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="utc-time"><a class="header" href="#utc-time">UTC Time</a></h1>
<p>This sample demonstrates how to obtain the current time from the epoch
<code>1970-01-01T00:00:00</code><br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/time/latest/">Time module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/time;

public function main() {
    // Gets the current instant of the system clock (seconds from the epoch of
    // 1970-01-01T00:00:00). The returned `time:Utc` value represents seconds
    // from the epoch with nanoseconds precision.
    // The `time:Utc` is a tuple with `[int, decimal]`. The first member of the
    // tuple represents the number of seconds from the epoch. The second
    // member represents the rest of the nanoseconds from the epoch as a
    // fraction.
    time:Utc currentUtc = time:utcNow();
    io:println(`Number of seconds from the epoch: ${currentUtc[0]}s`);
    io:println(`Nanoseconds fraction: ${currentUtc[1]}s`);
}
</code></pre>
<h4 id="output-279"><a class="header" href="#output-279">Output</a></h4>
<pre><code class="language-bash">bal run time_utc.bal
Number of seconds from the epoch: 1621839972s
Nanoseconds fraction: 0.005413000s
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="time-with-zone-offset"><a class="header" href="#time-with-zone-offset">Time with Zone Offset</a></h1>
<p>This sample demonstrates how to convert UTC to local time and
vice versa.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/time/latest/">Time module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/time;

public function main() returns error? {
    // Gets the current instant of the system clock (seconds from the epoch of
    // 1970-01-01T00:00:00). The returned `time:Utc` value represents seconds
    // from the epoch with nanoseconds precision.
    time:Utc utc1 = time:utcNow();
    // Converts a given `time:Utc` value to a `time:Civil` value.
    time:Civil civil1 = time:utcToCivil(utc1);
    io:println(`Civil record: ${civil1.toString()}`);

    // Converts a given `time:Civil` value to a `time:Utc` value.
    // Note that, since `time:Civil` is used to represent localized time,
    // it is mandatory to have the `utcOffset` field to be specified in the
    // given `time:Civil` value.
    time:Civil civil2 = {
        year: 2021,
        month: 4,
        day: 13,
        hour: 4,
        minute: 50,
        second: 50.52,
        timeAbbrev: &quot;Asia/Colombo&quot;,
        utcOffset: {hours: 5, minutes: 30, seconds: 0d}
    };
    time:Utc utc2 = check time:utcFromCivil(civil2);
    io:println(`UTC value of the civil record: ${utc2.toString()}`);
}
</code></pre>
<h4 id="output-280"><a class="header" href="#output-280">Output</a></h4>
<pre><code class="language-bash">bal run time_utc_and_civil.bal
Civil record: {&quot;timeAbbrev&quot;:&quot;Z&quot;,&quot;dayOfWeek&quot;:1,&quot;year&quot;:2021,&quot;month&quot;:5,&quot;day&quot;:24,&quot;hour&quot;:7,&quot;minute&quot;:7,&quot;second&quot;:15.757818}
UTC value of the civil record: [1618269650,0.52]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="time-formattingparsing"><a class="header" href="#time-formattingparsing">Time formatting/Parsing</a></h1>
<p>This sample demonstrates how time APIs can be used to convert UTC and
local time to different string representations (RFC 5322 and RFC 3339)
vice versa.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/time/latest/">Time module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/time;

public function main() returns error? {
    // Converts a given RFC 3339 timestamp
    // (e.g. `2007-12-03T10:15:30.12Z`) string to a `time:Utc` value.
    time:Utc utc = check time:utcFromString(&quot;2007-12-03T10:15:30.120Z&quot;);
    io:println(&quot;UTC value: &quot; + utc.toString());

    // Converts a given `time:Utc` to a RFC 3339 timestamp
    // (e.g. `2007-12-03T10:15:30.00Z`) string.
    string utcString = time:utcToString(utc);
    io:println(`UTC string representation: ${utcString}`);

    // Converts a given RFC 3339 timestamp(e.g. `2007-12-03T10:15:30.00Z`)
    // to a `time:Civil` record.
    time:Civil civil1 = check
    time:civilFromString(&quot;2021-04-12T23:20:50.520+05:30[Asia/Colombo]&quot;);
    io:println(&quot;Converted civil value: &quot; + civil1.toString());

    // Converts a given `time:Civil` value to a RFC 3339
    // (e.g. `2007-12-03T10:15:30.00Z`) formatted string.
    string civilString = check time:civilToString(civil1);
    io:println(`Civil string representation: ${civilString}`);

    // Converts a given UTC to an RFC 5322 formatted string
    // (e.g `Mon, 3 Dec 2007 10:15:30 GMT`).
    string emailFormattedString = time:utcToEmailString(utc, &quot;Z&quot;);
    io:println(`Email formatted string: ${emailFormattedString}`);

    // Converts a given RFC 5322 formatted string
    // (e.g `Mon, 3 Dec 2007 10:15:30 GMT`) to a `time:Civil` record.
    time:Civil civil2 = check
    time:civilFromEmailString(&quot;Wed, 10 Mar 2021 19:51:55 -0800 (PST)&quot;);
    io:println(`Civil record of the email string: ${civil2.toString()}`);

    // Converts a given `time:Civil` record to an RFC 5322 formatted string
    // (e.g `Mon, 3 Dec 2007 10:15:30 GMT`).
    string emailString = check
    time:civilToEmailString(civil2, time:PREFER_ZONE_OFFSET);
    io:println(`Email string of the civil record: ${emailString}`);
}
</code></pre>
<h4 id="output-281"><a class="header" href="#output-281">Output</a></h4>
<pre><code class="language-bash">bal run time_formatting_and_parsing.bal
UTC value: [1196676930,0.12]
UTC string representation: 2007-12-03T10:15:30.120Z
Converted civil value: {&quot;utcOffset&quot;:{&quot;hours&quot;:5,&quot;minutes&quot;:30},&quot;timeAbbrev&quot;:&quot;Asia/Colombo&quot;,&quot;dayOfWeek&quot;:1,&quot;year&quot;:2021,&quot;month&quot;:4,&quot;day&quot;:12,&quot;hour&quot;:23,&quot;minute&quot;:20,&quot;second&quot;:50.52}
Civil string representation: 2021-04-12T17:50:50.520Z
Email formatted string: Mon, 3 Dec 2007 10:15:30 Z
Civil record of the email string: {&quot;utcOffset&quot;:{&quot;hours&quot;:-8,&quot;minutes&quot;:0},&quot;timeAbbrev&quot;:&quot;America/Los_Angeles&quot;,&quot;dayOfWeek&quot;:3,&quot;year&quot;:2021,&quot;month&quot;:3,&quot;day&quot;:10,&quot;hour&quot;:19,&quot;minute&quot;:51,&quot;second&quot;:55}
Email string of the civil record: Wed, 10 Mar 2021 19:51:55 -0800
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cache"><a class="header" href="#cache">Cache</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cache-basics"><a class="header" href="#cache-basics">Cache Basics</a></h1>
<p>The Ballerina Cache API provides an in-memory cache implementation by default with a
<code>Least Recently Used</code> algorithm-based eviction policy.
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/cache/latest/">Cache module</a>.</p>
<pre><code class="language-go">import ballerina/cache;
import ballerina/io;

public function main() returns error? {
    // This creates a new cache instance with the default configurations.
    cache:Cache cache = new();

    // Adds new entries to the cache.
    check cache.put(&quot;key1&quot;, &quot;value1&quot;);
    check cache.put(&quot;key2&quot;, &quot;value2&quot;);

    // Checks for the cached key availability.
    if (cache.hasKey(&quot;key1&quot;)) {
        // Fetches the cached value.
        string value = &lt;string&gt; check cache.get(&quot;key1&quot;);
        io:println(&quot;The value of the key1: &quot; + value);
    }
    // Gets the keys of the cache entries.
    string[] keys = cache.keys();
    io:println(&quot;The existing keys in the cache: &quot; + keys.toString());

    // Gets the size of the cache.
    int size = cache.size();
    io:println(&quot;The cache size: &quot;, size);
}
</code></pre>
<h4 id="output-282"><a class="header" href="#output-282">Output</a></h4>
<pre><code class="language-bash">bal run cache_basic.bal
The value of the key1: value1
The existing keys in the cache: [&quot;key1&quot;,&quot;key2&quot;]
The cache size: 2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cache-invalidation"><a class="header" href="#cache-invalidation">Cache Invalidation</a></h1>
<p>The Ballerina Cache API provides an in-memory cache implementation by default with the
<code>Least Recently Used</code> algorithm-based eviction policy.
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/cache/latest/">Cache module</a>.</p>
<pre><code class="language-go">import ballerina/cache;
import ballerina/io;

public function main() returns error? {

    // This creates a new cache with the advanced configuration.
    cache:Cache cache = new ({
        // The maximum size of the cache is 10.
        capacity: 10,
        // The eviction factor is set to 0.2, which means at the
        // time of eviction 10*0.2=2 entries get removed from the cache.
        evictionFactor: 0.2,
        // The default max age of the cache entry is set to 2 seconds.
        defaultMaxAge: 2,
        // The cache cleanup task runs every 3 seconds and clears all
        // the expired entries.
        cleanupInterval: 3
    });

    // Adds the new entries to the cache.
    check cache.put(&quot;key1&quot;, &quot;value1&quot;);
    check cache.put(&quot;key2&quot;, &quot;value2&quot;);
    // Adds a new entry to the cache by overriding the default max age.
    check cache.put(&quot;key3&quot;, &quot;value3&quot;, 3600);

    // Gets the keys of the cache entries.
    string[] keys = cache.keys();
    io:println(&quot;The existing keys in the cache: &quot;, keys);

    // Discards the given cache entry.
    _ = check cache.invalidate(&quot;key2&quot;);

    // Gets the keys of the cache entries.
    io:println(&quot;The existing keys in after invalidating a given key: &quot;,
                cache.keys());

    // Discards all the cache entries of the cache.
    _ = check cache.invalidateAll();

    // Gets the keys of the cache entries after all the keys are invalidated.
    io:println(&quot;The keys after invalidating all the keys: &quot;, cache.keys());
}
</code></pre>
<h4 id="output-283"><a class="header" href="#output-283">Output</a></h4>
<pre><code class="language-bash">bal run cache_invalidation.bal
The existing keys in the cache: [&quot;key1&quot;,&quot;key2&quot;,&quot;key3&quot;]
The existing keys in after invalidating a given key: [&quot;key1&quot;,&quot;key3&quot;]
The keys after invalidating all the keys: []
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="log"><a class="header" href="#log">Log</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="logging"><a class="header" href="#logging">Logging</a></h1>
<p>The Ballerina Log API contains the application log handling functions.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/log/latest/">Log module</a>.</p>
<pre><code class="language-go">import ballerina/log;

public function main() {
    // The Ballerina log API provides functions to log at four levels, which are
    // `DEBUG`, `ERROR`, `INFO`, and `WARN`.
    log:printDebug(&quot;debug log&quot;);
    log:printError(&quot;error log&quot;);
    log:printInfo(&quot;info log&quot;);
    log:printWarn(&quot;warn log&quot;);

    // You can pass any number of key/value pairs, which need to be displayed in the log message.
    // These can be of the `anydata` type including int, string, and boolean.
    log:printInfo(&quot;info log&quot;, id = 845315, name = &quot;foo&quot;, successful = true);

    // Optionally, an error can be passed to the functions.
    error e = error(&quot;something went wrong!&quot;);
    log:printError(&quot;error log with cause&quot;, 'error = e, id = 845315,
        name = &quot;foo&quot;);
}
</code></pre>
<h4 id="output-284"><a class="header" href="#output-284">Output</a></h4>
<pre><code class="language-bash">bal run logging.bal
time = 2021-05-25T11:29:58.290+05:30 level = DEBUG module = &quot;&quot; message = &quot;debug log&quot;
time = 2021-05-25T11:29:58.305+05:30 level = ERROR module = &quot;&quot; message = &quot;error log&quot;
time = 2021-05-25T11:29:58.306+05:30 level = INFO module = &quot;&quot; message = &quot;info log&quot;
time = 2021-05-25T11:29:58.307+05:30 level = WARN module = &quot;&quot; message = &quot;warn log&quot;
time = 2021-05-25T11:29:58.307+05:30 level = INFO module = &quot;&quot; message = &quot;info log&quot; name = &quot;foo&quot; id = 845315 successful = true
time = 2021-05-25T11:29:58.317+05:30 level = ERROR module = &quot;&quot; message = &quot;error log with cause&quot; error = &quot;something went wrong!&quot; name = &quot;foo&quot; id = 845315
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="logging-with-context"><a class="header" href="#logging-with-context">Logging with Context</a></h1>
<p>The Ballerina Log API contains the application log handling functions.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/log/latest/">Log module</a>.</p>
<pre><code class="language-go">import ballerina/log;
import ballerina/random;
import ballerina/time;

public function main() {
    // The Ballerina log API provides functions to log at four levels, which are
    // `DEBUG`, `ERROR`, `INFO`, and `WARN`.
    // You can pass key/value pairs where the values are function pointers.
    // These functions can return values, which change dynamically.
    // The following log prints the current UTC time as a key/value pair.
    log:printInfo(&quot;info log&quot;,
                  current_time = isolated function() returns string {
                      return time:utcToString(time:utcNow());});
    // The following log prints a random percentage as a key/value pair.
    log:printInfo(&quot;info log&quot;,
                   percentage = isolated function() returns float {
                       return random:createDecimal() * 100.0;});
}
</code></pre>
<h4 id="output-285"><a class="header" href="#output-285">Output</a></h4>
<pre><code class="language-bash">bal run logging_with_context.bal
time = 2021-05-25T10:34:25.460+05:30 level = INFO module = &quot;&quot; message = &quot;info log&quot; current_time = &quot;2021-05-25T05:04:25.473981Z&quot;
time = 2021-05-25T10:34:25.487+05:30 level = INFO module = &quot;&quot; message = &quot;info log&quot; percentage = 38.4141353500368
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configure-logging"><a class="header" href="#configure-logging">Configure Logging</a></h1>
<p>The Ballerina Log API contains the application log handling functions.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/log/latest/">Log module</a>.</p>
<pre><code class="language-go">import ballerina/log;

public function main() {
    // The Ballerina log API provides functions to log at four levels, which are
    // `DEBUG`, `ERROR`, `INFO`, and `WARN`.
    log:printDebug(&quot;debug log&quot;);
    log:printError(&quot;error log&quot;);
    log:printInfo(&quot;info log&quot;);
    log:printWarn(&quot;warn log&quot;);
}
</code></pre>
<h4 id="output-286"><a class="header" href="#output-286">Output</a></h4>
<pre><code class="language-bash">bal run logging_configuration.bal
time = 2021-05-25T11:06:54.998+05:30 level = ERROR module = &quot;&quot; message = &quot;error log&quot;
time = 2021-05-25T11:06:55.009+05:30 level = INFO module = &quot;&quot; message = &quot;info log&quot;
time = 2021-05-25T11:06:55.010+05:30 level = WARN module = &quot;&quot; message = &quot;warn log&quot;
# As shown in the output, only the `INFO` and higher level logs are logged by default.

# The log level can be configured via a Ballerina configuration file.
# To set the global log level to `DEBUG`, place the entry given below in the `Config.toml` file and run the sample.
# ```
# [ballerina.log]
# level = &quot;DEBUG&quot;
# ```
time = 2021-05-25T11:11:24.898+05:30 level = DEBUG module = &quot;&quot; message = &quot;debug log&quot;
time = 2021-05-25T11:11:24.914+05:30 level = ERROR module = &quot;&quot; message = &quot;error log&quot;
time = 2021-05-25T11:11:24.915+05:30 level = INFO module = &quot;&quot; message = &quot;info log&quot;
time = 2021-05-25T11:11:24.915+05:30 level = WARN module = &quot;&quot; message = &quot;warn log&quot;
# As shown in the output, now the `DEBUG` and higher level logs are logged.

# Each module can also be assigned its own log level. To assign a
# log level to a module, provide the following entry in the `Config.toml` file:
#
# ```
# [[ballerina.log.modules]]
# name = &quot;[ORG_NAME]/[MODULE_NAME]&quot;
# level = &quot;[LOG_LEVEL]&quot;
# ```

# By default, log messages are logged to the console in the LogFmt format.
# To set the output format to JSON, place the entry given below in the `Config.toml` file and run the sample.
# ```
# [ballerina.log]
# format = &quot;json&quot;
# ```
{&quot;time&quot;:&quot;2021-05-25T11:14:43.986+05:30&quot;, &quot;level&quot;:&quot;ERROR&quot;, &quot;module&quot;:&quot;&quot;, &quot;message&quot;:&quot;error log&quot;}
{&quot;time&quot;:&quot;2021-05-25T11:14:44.005+05:30&quot;, &quot;level&quot;:&quot;INFO&quot;, &quot;module&quot;:&quot;&quot;, &quot;message&quot;:&quot;info log&quot;}
{&quot;time&quot;:&quot;2021-05-25T11:14:44.006+05:30&quot;, &quot;level&quot;:&quot;WARN&quot;, &quot;module&quot;:&quot;&quot;, &quot;message&quot;:&quot;warn log&quot;}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file"><a class="header" href="#file">File</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-paths"><a class="header" href="#file-paths">File Paths</a></h1>
<p>The Ballerina File API also contains utility functions to manipulate file paths in a way that is compatible with the
target operating system.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/file/latest/">File module</a>.</p>
<pre><code class="language-go">import ballerina/file;
import ballerina/io;

public function main() returns error? {
    // Gets the absolute representation of the path.
    string absValue = check file:getAbsolutePath(&quot;test.txt&quot;);
    io:println(&quot;Absolute path: &quot;, absValue);

    // Checks whether the path is absolute.
    boolean isAbs = check file:isAbsolutePath(&quot;/A/B/C&quot;);
    io:println(&quot;/A/B/C is absolute: &quot;, isAbs);

    // Gets the base name of the path.
    string name = check file:basename(&quot;/A/B/C&quot;);
    io:println(&quot;Filename of /A/B/C: &quot;, name);

    // Gets the enclosing parent directory.
    string parentPath = check file:parentPath(&quot;/A/B/C&quot;);
    io:println(&quot;Parent of /A/B/C: &quot;, parentPath);

    // Gets the shortest path name equivalent to the path by purely lexical processing.
    string normalizedPath = check file:normalizePath(&quot;foo/../bar&quot;, file:CLEAN);
    io:println(&quot;Normalized path of foo/../bar: &quot;, normalizedPath);

    // Gets the list of path elements joined by the OS-specific path separator.
    string[] parts = check file:splitPath(&quot;/A/B/C&quot;);
    io:println(string `Path elements of /A/B/C: ${parts.toString()}`);

    // Joins any number of path elements into a single path.
    string path = check file:joinPath(&quot;/&quot;, &quot;foo&quot;, &quot;bar&quot;);
    io:println(&quot;Built path of '/', 'foo', 'bar': &quot;, path);

    // Returns a relative path that is logically equivalent to the target path when joined to the base path.
    string relPath = check file:relativePath(&quot;a/b/c&quot;, &quot;a/c/d&quot;);
    io:println(&quot;Relative path between 'a/b/c' and 'a/c/d': &quot;, relPath);
}
</code></pre>
<h4 id="output-287"><a class="header" href="#output-287">Output</a></h4>
<pre><code class="language-bash">bal run filepaths.bal
On Unix:
Absolute path of test.txt: /A/test.txt
/A/B/C is absolute: true
Filename of /A/B/C: C
Parent of /A/B/C: /A/B
Normalized path of foo/../bar: bar
Path elements of /A/B/C: [&quot;A&quot;,&quot;B&quot;,&quot;C&quot;]
Built path of '/', 'foo', 'bar': /foo/bar
Relative path between 'a/b/c' and 'a/c/d': ../../c/d

On Windows:
Absolute path of test.txt: \A\test.txt
/A/B/C is absolute: false
Filename of /A/B/C: C
Parent of /A/B/C: \A\B
Normalized path of foo/../bar: bar
Path elements of /A/B/C: [&quot;A&quot;,&quot;B&quot;,&quot;C&quot;]
Built path of '/', 'foo', 'bar': \foo\bar
Relative path between 'a/b/c' and 'a/c/d': ..\..\c\d
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="directories"><a class="header" href="#directories">Directories</a></h1>
<p>The Ballerina File API contains functions to perform directory operations.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/file/latest/">File module</a>.</p>
<pre><code class="language-go">import ballerina/file;
import ballerina/io;

public function main() returns error? {

    // Creates a new directory with any non-existent parents.
    string dirPath = check file:joinPath(&quot;foo&quot;, &quot;bar&quot;);
    check file:createDir(dirPath, file:RECURSIVE);
    io:println(&quot;The &quot; + dirPath + &quot; directory created successfully.&quot;);

    // Checks whether the directory of the provided path exists.
    boolean dirExists = check file:test(&quot;foo&quot;, file:EXISTS);
    io:println(&quot;Is foo directory exist: &quot;, dirExists.toString());

    // Copies the directory with another name.
    check file:copy(dirPath, &quot;test&quot;, file:REPLACE_EXISTING);
    io:println(&quot;The &quot; + dirPath + &quot; directory copied successfully.&quot;);

    // Renames the directory to another new name.
    check file:rename(&quot;foo&quot;, &quot;test1&quot;);
    io:println(&quot;The foo directory renamed successfully.&quot;);

    // Gets the list of files/directories in the given directory.
    file:MetaData[] readDirResults = check file:readDir(&quot;test1&quot;);
    io:println(&quot;Directory path: &quot;, readDirResults[0].absPath);
    io:println(&quot;Directory size: &quot;, readDirResults[0].size.toString());
    io:println(&quot;Is directory: &quot;, readDirResults[0].dir.toString());
    io:println(&quot;Modified at &quot;, readDirResults[0].modifiedTime.toString());

    // Removes the directory in the specified file path.
    check file:remove(&quot;test&quot;);

    // Removes the directory in the specified file path with all its children.
    check file:remove(&quot;test1&quot;, file:RECURSIVE);
    io:println(&quot;Directories removed successfully.&quot;);
}
</code></pre>
<h4 id="output-288"><a class="header" href="#output-288">Output</a></h4>
<pre><code class="language-bash">bal run directories.bal
The foo/bar directory created successfully.
Is foo directory exist: true
The foo/bar directory copied successfully.
The foo directory renamed successfully.
Directory path: /A/B/C/test1/bar
Directory size: 64
Is directory: true
Modified at 1621859440 0.871000000
Directories removed successfully.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="files"><a class="header" href="#files">Files</a></h1>
<p>The Ballerina File API contains functions to perform file-system operations.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/file/latest/">File module</a>.</p>
<pre><code class="language-go">import ballerina/file;
import ballerina/io;

public function main() returns error? {

    // Creates a file in the given file path.
    check file:create(&quot;bar.txt&quot;);
    io:println(&quot;The bar.txt file created successfully.&quot;);

    // Checks whether the file exists on the provided path.
    boolean fileExists = check file:test(&quot;bar.txt&quot;, file:EXISTS);
    io:println(&quot;Does the bar.txt file exist: &quot;, fileExists.toString());

    // Checks whether the file is readable or not.
    fileExists = check file:test(&quot;bar.txt&quot;, file:READABLE);
    io:println(&quot;Is the bar.txt file readable: &quot;, fileExists.toString());

    // Checks whether the file is writable or not.
    fileExists = check file:test(&quot;bar.txt&quot;, file:WRITABLE);
    io:println(&quot;Is the bar.txt file writeable: &quot;, fileExists.toString());

    // Copies the file or directory to the new path.
    check file:copy(&quot;bar.txt&quot;,  &quot;bar1.txt&quot;, file:REPLACE_EXISTING);
    io:println(&quot;The bar.txt file copied successfully.&quot;);

    check file:rename(&quot;bar.txt&quot;, &quot;bar2.txt&quot;);
    io:println(&quot;The bar.txt file renamed successfully.&quot;);

    // Gets the metadata information of the file.
    file:MetaData fileMetadata = check file:getMetaData(&quot;bar1.txt&quot;);
    io:println(&quot;File path: &quot;, fileMetadata.absPath);
    io:println(&quot;File size: &quot;, fileMetadata.size.toString());
    io:println(&quot;Is directory: &quot;, fileMetadata.dir.toString());
    io:println(&quot;Modified at &quot;, fileMetadata.modifiedTime.toString());

    // Removes the file in the specified file path.
    check file:remove(&quot;bar1.txt&quot;);
    check file:remove(&quot;bar2.txt&quot;);
    io:println(&quot;Files removed successfully.&quot;);
}
</code></pre>
<h4 id="output-289"><a class="header" href="#output-289">Output</a></h4>
<pre><code class="language-bash">bal run files.bal
The bar.txt file created successfully.
Does the bar.txt file exist: true
Is the bar.txt file readable: true
Is the bar.txt file writeable: true
The bar.txt file copied successfully.
The bar.txt file renamed successfully.
File path: /A/B/bar1.txt
File size: 0
Is directory: false
Modified at [1643011228,0.178000000]
Files removed successfully.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="temp-files-and-directories"><a class="header" href="#temp-files-and-directories">Temp Files and Directories</a></h1>
<p>The Ballerina File API contains functions to perform temp file and directory operations.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/file/latest/">File module</a>.</p>
<pre><code class="language-go">import ballerina/file;
import ballerina/io;

public function main() returns error? {

    // Creates a temporary directory in the default `tmp` directory of the OS.
    string tmpDir = check file:createTempDir();
    io:println(&quot;Absolute path of the tmp directory: &quot;, tmpDir);

    // Creates a temporary file in the default `tmp` directory of the OS.
    string tmpResult = check file:createTemp();
    io:println(&quot;Absolute path of the tmp file: &quot;, tmpResult);

    // Creates a temporary file in a specific directory.
    string tmp2Result = check file:createTemp(dir = tmpDir);
    io:println(&quot;Absolute path of the tmp file: &quot;, tmp2Result);
}
</code></pre>
<h4 id="output-290"><a class="header" href="#output-290">Output</a></h4>
<pre><code class="language-bash">bal run temp_files_directories.bal
Absolute path of the tmp directory: /var/folders/f2/1s2f2mzd30ldl_fzxk4_gq3c0000gn/T/90eb0a6f-200a-454d-9285-f3264a71cd80
Absolute path of the tmp file: /var/folders/f2/1s2f2mzd30ldl_fzxk4_gq3c0000gn/T/9b0ce907-51cd-4f6b-98f0-d99566e3870d
Absolute path of the tmp file: /var/folders/f2/1s2f2mzd30ldl_fzxk4_gq3c0000gn/T/90eb0a6f-200a-454d-9285-f3264a71cd80/14c45332-37df-44d1-b24b-3dbcb7c7404c
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="directory-listener"><a class="header" href="#directory-listener">Directory Listener</a></h1>
<p>The <code>Directory Listener</code> is used to listen to a directory in the local file system. 
It notifies when new files are created in the directory or when the existing files are deleted or modified.<br/><br/>
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/file/latest/">File module</a>.</p>
<pre><code class="language-go">import ballerina/file;
import ballerina/log;

// In this example, the listener monitors any modifications done to a specific directory.
// Before running the example, change the value of the 'path' field 
// to indicate the path of the directory that you want the listener to monitor.
// As the recursive property is set to false,
// the listener does not monitor the child directories of the main directory
// that it listens to.
listener file:Listener inFolder = new ({
    path: &quot;/home/ballerina/fs-server-connector/observed-dir&quot;,
    recursive: false
});

// The directory listener should have at least one of these predefined resources.
service &quot;localObserver&quot; on inFolder {

    // This function is invoked once a new file is created in the listening directory.
    remote function onCreate(file:FileEvent m) {
        log:printInfo(&quot;Create: &quot; + m.name);
    }

    // This function is invoked once an existing file is deleted from the listening directory.
    remote function onDelete(file:FileEvent m) {
        log:printInfo(&quot;Delete: &quot; + m.name);
    }

    // This function is invoked once an existing file is modified in the listening directory.
    remote function onModify(file:FileEvent m) {
        log:printInfo(&quot;Modify: &quot; + m.name);
    }
}
</code></pre>
<h4 id="output-291"><a class="header" href="#output-291">Output</a></h4>
<pre><code class="language-bash"># After running the sample, create a new file called `test1.txt` in the directory called `observed-dir`, modify it, and delete it.
bal run directory_listener.bal
time = 2020-12-12 13:49:08,497 level = INFO  module = &quot;&quot; message = &quot;Create: /home/ballerina/fs-server-connector/observed-dir/test1.txt&quot;
time = 2020-12-12 13:49:41,709 level = INFO  module = &quot;&quot; message = &quot;Modify: /home/ballerina/fs-server-connector/observed-dir/test1.txt&quot;
time = 2020-12-12 13:50:04,997 level = INFO  module = &quot;&quot; message = &quot;Delete: /home/ballerina/fs-server-connector/observed-dir/test1.txt&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="random"><a class="header" href="#random">Random</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="random-numbers"><a class="header" href="#random-numbers">Random Numbers</a></h1>
<p>The <code>random</code> library provides functions related to random number generation.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/random/latest/">Random module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/random;

public function main() returns error? {
    // Generates a random decimal number between 0.0 and 1.0.
    float randomDecimal = random:createDecimal();
    io:println(&quot;Random decimal number: &quot;, randomDecimal);

    // Generates a random number between the given start(inclusive) and end(exclusive) values.
    int randomInteger = check random:createIntInRange(1, 100);
    io:println(&quot;Random integer number in range: &quot;, randomInteger);
}
</code></pre>
<h4 id="output-292"><a class="header" href="#output-292">Output</a></h4>
<pre><code class="language-bash">bal run random_numbers.bal
Random decimal number: 0.6146990788006506
Random integer number in range: 94
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="task"><a class="header" href="#task">Task</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schedule-job-recurrence-by-frequency"><a class="header" href="#schedule-job-recurrence-by-frequency">Schedule Job recurrence by Frequency</a></h1>
<p>A  <code>task:scheduleJobRecurByFrequency()</code> can be used to execute Ballerina jobs periodically.
The <code>task:Job</code> and interval should be specified and optional configurations are start time,
end time, and maximum count.
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/task/latest/">Task module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/lang.runtime;
import ballerina/task;

// Creates a job to be executed by the scheduler.
class Job {

    *task:Job;
    int i = 1;

    // Executes this function when the scheduled trigger fires.
    public function execute() {
        self.i += 1;
        io:println(&quot;MyCounter: &quot;, self.i);
    }

    isolated function init(int i) {
        self.i = i;
    }
}

public function main() returns error? {

    // Schedules the task to execute the job every second.
    task:JobId id = check task:scheduleJobRecurByFrequency(new Job(0), 1);

    // Waits for nine seconds.
    runtime:sleep(9);

    // Unschedules the job.
    check task:unscheduleJob(id);
}
</code></pre>
<h4 id="output-293"><a class="header" href="#output-293">Output</a></h4>
<pre><code class="language-bash">bal run task_frequency_job_execution.bal
MyCounter: 1
MyCounter: 2
MyCounter: 3
MyCounter: 4
MyCounter: 5
MyCounter: 6
MyCounter: 7
MyCounter: 8
MyCounter: 9
MyCounter: 10
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="schedule-one-time-job"><a class="header" href="#schedule-one-time-job">Schedule one time job</a></h1>
<p>A  <code>task:scheduleOneTimeJob()</code> can be used to execute Ballerina jobs at a specific time.
The <code>task:Job</code> and time should be specified to schedule the job.
For more information on the underlying module, 
see the <a href="https:docs.central.ballerina.io/ballerina/task/latest/">Task module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/lang.runtime;
import ballerina/task;
import ballerina/time;

// Creates a job to be executed by the scheduler.
class Job {

    *task:Job;
    int i = 1;

    // Executes this function when the scheduled trigger fires.
    public function execute() {
        self.i += 1;
        io:println(&quot;MyCounter: &quot;, self.i);
    }

    isolated function init(int i) {
        self.i = i;
    }
}

public function main() returns error? {
    // Gets the current time.
    time:Utc currentUtc = time:utcNow();
    // Increases the time by three seconds to get the specified time for scheduling the job.
    time:Utc newTime = time:utcAddSeconds(currentUtc, 3);
    // Gets the `time:Civil` for the given time.
    time:Civil time = time:utcToCivil(newTime);

    // Schedules the one-time job at the specified time.
    _ = check task:scheduleOneTimeJob(new Job(0), time);

    // Waits for five seconds.
    runtime:sleep(5);
}
</code></pre>
<h4 id="output-294"><a class="header" href="#output-294">Output</a></h4>
<pre><code class="language-bash">bal run task_one_time_job_execution.bal
MyCounter: 1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="manage-scheduled-jobs"><a class="header" href="#manage-scheduled-jobs">Manage Scheduled Jobs</a></h1>
<p>The <code>task</code> library provides functions to manage the scheduled jobs such as pause, resume,
unschedule, and etc.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/regex/latest/">Regex module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/lang.runtime;
import ballerina/task;
import ballerina/time;

// Creates a job to be executed by the scheduler.
class Job {

    *task:Job;
    int i = 1;
    string jobIdentifier;

    // Executes this function when the scheduled trigger fires.
    public function execute() {
        self.i += 1;
        io:println(self.jobIdentifier + &quot;, MyCounter: &quot;, self.i);
    }

    isolated function init(int i, string jobIdentifier) {
        self.i = i;
        self.jobIdentifier = jobIdentifier;
    }
}

public function main() returns error? {

    // Gets the current time.
    time:Utc currentUtc = time:utcNow();
    // Increases the time by three seconds to set the starting delay for the scheduling job.
    time:Utc newTime = time:utcAddSeconds(currentUtc, 5);
    // Gets the `time:Civil` for the given time.
    time:Civil time = time:utcToCivil(newTime);

    // Schedules the tasks to execute the job every second.
    task:JobId id1 = check task:scheduleJobRecurByFrequency(
                            new Job(0, &quot;1st Job&quot;), 1);
    task:JobId id2 = check task:scheduleJobRecurByFrequency(
                            new Job(0, &quot;2nd Job&quot;), 3);
    // Schedules the one-time job at the specified time.
    _ = check task:scheduleOneTimeJob(new Job(0, &quot;3rd Job&quot;), time);

    // Waits for 3 seconds.
    runtime:sleep(3);

    // Gets all the running jobs.
    task:JobId[] result = task:getRunningJobs();
    io:println(&quot;No of running jobs: &quot;, result.length());

    // Pauses the specified job.
    check task:pauseJob(id1);
    io:println(&quot;Pasused the 1st job.&quot;);
    // Waits for 3 seconds.
    runtime:sleep(3);

    // Resumes the specified job.
    check task:resumeJob(id1);
    io:println(&quot;Resumed the 1st job.&quot;);

    // Gets all the running jobs.
    result = task:getRunningJobs();
    io:println(&quot;No of running jobs: &quot;, result.length());

     // Waits for 3 seconds.
    runtime:sleep(3);

    // Unschedules the jobs.
    check task:unscheduleJob(id1);
    check task:unscheduleJob(id2);
}
</code></pre>
<h4 id="output-295"><a class="header" href="#output-295">Output</a></h4>
<pre><code class="language-bash">bal run manage_scheduled_jobs.bal
1st Job, MyCounter: 1
2nd Job, MyCounter: 1
1st Job, MyCounter: 2
1st Job, MyCounter: 3
1st Job, MyCounter: 4
2nd Job, MyCounter: 2
No of running jobs: 3
Pasused the 1st job.
3rd Job, MyCounter: 1
2nd Job, MyCounter: 3
Resumed the 1st job.
1st Job, MyCounter: 5
1st Job, MyCounter: 6
No of running jobs: 2
1st Job, MyCounter: 7
1st Job, MyCounter: 8
1st Job, MyCounter: 9
1st Job, MyCounter: 10
2nd Job, MyCounter: 4
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="uuid"><a class="header" href="#uuid">UUID</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="generate-uuid"><a class="header" href="#generate-uuid">Generate UUID</a></h1>
<p>The <code>uuid</code> library provides functions related to UUID(Universal Unique Identifier).<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/uuid/latest/">UUID module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/uuid;

public function main() returns error? {
    // Generates a UUID of type 1 as a string.
    string uuid1String = uuid:createType1AsString();
    io:println(&quot;UUID of type 1 as a string: &quot;, uuid1String);

    // Generates a UUID of type 1 as a UUID record.
    uuid:Uuid uuid1Record = check uuid:createType1AsRecord();
    io:println(&quot;UUID of type 1 as a record: &quot;, uuid1Record);

    // Generates a UUID of type 3 as a string.
    string uuid3String = check uuid:createType3AsString(
    uuid:NAME_SPACE_DNS, &quot;ballerina.io&quot;);
    io:println(&quot;UUID of type 3 as a string: &quot;, uuid3String);

    // Generates a UUID of type 3 as a record.
    uuid:Uuid uuid3Record = check uuid:createType3AsRecord(
    uuid:NAME_SPACE_DNS, &quot;ballerina.io&quot;);
    io:println(&quot;UUID of type 3 as a record: &quot;, uuid3Record);

    // Generates a UUID of type 4 as a string.
    string uuid4String = uuid:createType4AsString();
    io:println(&quot;UUID of type 4 as a string: &quot;, uuid4String);

    // Generates a UUID of type 4 as a UUID record.
    uuid:Uuid uuid4Record = check uuid:createType4AsRecord();
    io:println(&quot;UUID of type 4 as a record: &quot;, uuid4Record);

    // Generates a UUID of type 5 as a string.
    string uuid5String = check uuid:createType5AsString(
                                    uuid:NAME_SPACE_DNS, &quot;ballerina.io&quot;);
    io:println(&quot;UUID of type 5 as a string: &quot;, uuid5String);

    // Generates a UUID of type 5 as a record.
    uuid:Uuid uuid5Record = check uuid:createType5AsRecord(
                                       uuid:NAME_SPACE_DNS, &quot;ballerina.io&quot;);
    io:println(&quot;UUID of type 5 as a record: &quot;, uuid5Record);

    // Generates a nil UUID as a string.
    string nilUuidString = uuid:nilAsString();
    io:println(&quot;Nil UUID as a string: &quot;, nilUuidString);

    // Generates a nil UUID as a UUID record.
    uuid:Uuid nilUuidRecord = uuid:nilAsRecord();
    io:println(&quot;Nil UUID as a record: &quot;, nilUuidRecord);
}
</code></pre>
<h4 id="output-296"><a class="header" href="#output-296">Output</a></h4>
<pre><code class="language-bash">bal run uuid_generation.bal
UUID of type 1 as a string: 01eb3f05-fbf8-1b92-8711-dc6a5719bb63
UUID of type 1 as a record: {&quot;timeLow&quot;:32194310,&quot;timeMid&quot;:7997,&quot;timeHiAndVersion&quot;:5524,&quot;clockSeqHiAndReserved&quot;:170,&quot;clockSeqLo&quot;:116,&quot;node&quot;:82490221220318}
UUID of type 3 as a string: cea5c405-7d11-3fbb-bdfb-9b68497be28b
UUID of type 3 as a record: {&quot;timeLow&quot;:3466970117,&quot;timeMid&quot;:32017,&quot;timeHiAndVersion&quot;:16315,&quot;clockSeqHiAndReserved&quot;:189,&quot;clockSeqLo&quot;:251,&quot;node&quot;:170872211759755}
UUID of type 4 as a string: 73e0d74e-8a4a-40ce-b1d9-b5b522533852
UUID of type 4 as a record: {&quot;timeLow&quot;:2795821625,&quot;timeMid&quot;:5327,&quot;timeHiAndVersion&quot;:20251,&quot;clockSeqHiAndReserved&quot;:161,&quot;clockSeqLo&quot;:71,&quot;node&quot;:59752348973988}
UUID of type 5 as a string: 08aab8bc-c69e-5ea8-8a52-dbb645c67fb5
UUID of type 5 as a record: {&quot;timeLow&quot;:145406140,&quot;timeMid&quot;:50846,&quot;timeHiAndVersion&quot;:24232,&quot;clockSeqHiAndReserved&quot;:138,&quot;clockSeqLo&quot;:82,&quot;node&quot;:241575901167541}
Nil UUID as a string: 00000000-0000-0000-0000-000000000000
Nil UUID as a record: {&quot;timeLow&quot;:0,&quot;timeMid&quot;:0,&quot;timeHiAndVersion&quot;:0,&quot;clockSeqHiAndReserved&quot;:0,&quot;clockSeqLo&quot;:0,&quot;node&quot;:0}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="uuid-operations"><a class="header" href="#uuid-operations">UUID Operations</a></h1>
<p>The <code>uuid</code> library provides functions related to UUID(Universal Unique Identifier).<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/uuid/latest/">UUID module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/uuid;

public function main() returns error? {
    // Tests a string to see if it is a valid UUID.
    boolean valid = uuid:validate(&quot;4397465e-35f9-11eb-adc1-0242ac120002&quot;);
    io:println(&quot;UUID validated: &quot;, valid.toString());

    // Detects the RFC version of a UUID.
    uuid:Version v = check uuid:getVersion(
                                &quot;4397465e-35f9-11eb-adc1-0242ac120002&quot;);
    io:println(&quot;UUID version: &quot;, v.toString());

    // Converts a UUID string to an array of bytes.
    byte[] uuidBytes1 = check uuid:toBytes(
                                  &quot;4397465e-35f9-11eb-adc1-0242ac120002&quot;);
    io:println(&quot;UUID bytes: &quot;, uuidBytes1);

    // Converts a UUID string to a UUID record.
    uuid:Uuid uuidRecord1 = check uuid:toRecord(
                            &quot;4397465e-35f9-11eb-adc1-0242ac120002&quot;);
    io:println(&quot;UUID record: &quot;, uuidRecord1);

    uuid:Uuid uuidRecord = {
        timeLow: 1133987422,
        timeMid: 13817,
        timeHiAndVersion: 4587,
        clockSeqHiAndReserved: 173,
        clockSeqLo: 193,
        node: 2485377957890
    };
    // Converts a UUID record to a UUID string.
    string uuidString1 = check uuid:toString(uuidRecord);
    io:println(&quot;UUID string: &quot;, uuidString1);

    // Converts a UUID record to an array of bytes.
    byte[] uuidBytes2 = check uuid:toBytes(uuidRecord);
    io:println(&quot;UUID bytes: &quot;, uuidBytes2);

    // Converts a UUID bytes array to a UUID string.
    string uuidString2 = check uuid:toString(
                        [67,151,70,94,53,249,17,235,173,193,2,66,172,18,0,2]);
    io:println(&quot;UUID string: &quot;, uuidString2);

    // Converts a UUID bytes array to a UUID record.
    uuid:Uuid uuidRecord2 = check uuid:toRecord(
                        [67,151,70,94,53,249,17,235,173,193,2,66,172,18,0,2]);
    io:println(&quot;UUID record: &quot;, uuidRecord2);
}
</code></pre>
<h4 id="output-297"><a class="header" href="#output-297">Output</a></h4>
<pre><code class="language-bash">bal run uuid_operations.bal
UUID validated: true
UUID version: V1
UUID bytes: [67,151,70,94,53,249,17,235,173,193,2,66,172,18,0,2]
UUID record: {&quot;timeLow&quot;:1133987422,&quot;timeMid&quot;:13817,&quot;timeHiAndVersion&quot;:4587,&quot;clockSeqHiAndReserved&quot;:173,&quot;clockSeqLo&quot;:193,&quot;node&quot;:2485377957890}
UUID string: 4397465e-35f9-11eb-adc1-0242ac120002
UUID bytes: [67,151,70,94,53,249,17,235,173,193,2,66,172,18,0,2]
UUID string: 4397465e-35f9-11eb-adc1-0242ac120002
UUID record: {&quot;timeLow&quot;:1133987422,&quot;timeMid&quot;:13817,&quot;timeHiAndVersion&quot;:4587,&quot;clockSeqHiAndReserved&quot;:173,&quot;clockSeqLo&quot;:193,&quot;node&quot;:2485377957890}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xslt"><a class="header" href="#xslt">XSLT</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xslt-transformation"><a class="header" href="#xslt-transformation">XSLT Transformation</a></h1>
<p>This example demonstrates how XML content can be transformed to HTML using a given XSL transformation.
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/xslt/latest/">XSLT module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/xslt;

public function main() returns error? {
    // Gets an `XML` value, which needs to be transformed.
    xml sourceXml = getXml();
    // Gets an `XSL` style sheet represented in an XML value.
    xml xsl = getXsl();
    // [Transforms](https://docs.central.ballerina.io/ballerina/xslt/latest/functions#transform) the `XML` content to another format.
    xml target = check xslt:transform(sourceXml, xsl);
    
    io:println(&quot;Transformed XML: &quot;, target);
}

// Returns an `XML` element, which needs to be transformed.
function getXml() returns xml {
    return xml `&lt;samples&gt;
                    &lt;song&gt;
                        &lt;title&gt;Summer of 69&lt;/title&gt;
                        &lt;artist&gt;Bryan Adams&lt;/artist&gt;
                        &lt;country&gt;Canada&lt;/country&gt;
                        &lt;year&gt;1984&lt;/year&gt;
                    &lt;/song&gt;
                    &lt;song&gt;
                        &lt;title&gt;Zombie&lt;/title&gt;
                        &lt;artist&gt;Bad Wolves&lt;/artist&gt;
                        &lt;country&gt;USA&lt;/country&gt;
                        &lt;year&gt;2018&lt;/year&gt;
                    &lt;/song&gt;
                &lt;/samples&gt;`;
}

// Returns an `XSL` style sheet represented by an XML element.
function getXsl() returns xml {
    return xml
        `&lt;xsl:stylesheet version=&quot;1.0&quot; 
                         xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt;
            &lt;xsl:template match=&quot;/&quot;&gt;
                &lt;html&gt;
                    &lt;body&gt;
                        &lt;h2&gt;All time favourites&lt;/h2&gt;
                        &lt;table border=&quot;1&quot;&gt;
                            &lt;tr bgcolor=&quot;#9acd33&quot;&gt;
                                &lt;th&gt;Title&lt;/th&gt;
                                &lt;th&gt;Artist&lt;/th&gt;
                            &lt;/tr&gt;
                        &lt;xsl:for-each select=&quot;samples/song&quot;&gt;
                            &lt;tr&gt;
                                &lt;td&gt;
                                    &lt;xsl:value-of select=&quot;title&quot;/&gt;
                                &lt;/td&gt;
                                &lt;td&gt;
                                    &lt;xsl:value-of select=&quot;artist&quot;/&gt;
                                &lt;/td&gt;
                            &lt;/tr&gt;
                        &lt;/xsl:for-each&gt;
                        &lt;/table&gt;
                    &lt;/body&gt;
                &lt;/html&gt;
            &lt;/xsl:template&gt;
        &lt;/xsl:stylesheet&gt;`;
}
</code></pre>
<h4 id="output-298"><a class="header" href="#output-298">Output</a></h4>
<pre><code class="language-bash">bal run xslt_transformation.bal
Transformed XML: &lt;html&gt;
&lt;body&gt;
&lt;h2&gt;All time favourites&lt;/h2&gt;
&lt;table border=&quot;1&quot;&gt;
&lt;tr bgcolor=&quot;#9acd33&quot;&gt;
&lt;th&gt;Title&lt;/th&gt;&lt;th&gt;Artist&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Summer of 69&lt;/td&gt;&lt;td&gt;Bryan Adams&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Zombie&lt;/td&gt;&lt;td&gt;Bad Wolves&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="regex"><a class="header" href="#regex">Regex</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="regular-expressions"><a class="header" href="#regular-expressions">Regular Expressions</a></h1>
<p>The <code>regex</code> library provides functionalities for searching, splitting, and replacing
the set of characters of the string by using the <code>regular expression</code>.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/regex/latest/">Regex module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/regex;

public function main() {

    // Checks whether the given string matches the provided regex.
    // You need to provide the original `string` and the regex to
    // this string, which is to be matched with.
    boolean isMatched = regex:matches(&quot;This Should Match&quot;, &quot;Th.*ch&quot;);
    io:println(&quot;Is the given string matched with the original string: &quot;,
                isMatched);

    // Replaces each occurrence of the substrings, which match the provided
    // regular expression from the given original string value with the
    // provided replacement string.
    string new_string = regex:replaceAll(&quot;Ballerina is great&quot;, &quot;\\s+&quot;, &quot;_&quot;);
    io:println(&quot;Replaced string: &quot;, new_string);

    // Replaces the first substring that matches the given regular expression
    // with the provided `replacement` string.
    new_string = regex:replaceFirst(&quot;ReplacethisthisTextThis&quot;, &quot;this&quot;, &quot; &quot;);
    io:println(&quot;String after replacing first Match: &quot;, new_string);

    // Retrieves an array of strings by splitting a string using the provided
    // delimiter.
    string[] names = regex:split(&quot;amal, kamal, nimal, sunimal&quot;, &quot;,&quot;);
    io:println(&quot;No of names: &quot;, names.length());
}
</code></pre>
<h4 id="output-299"><a class="header" href="#output-299">Output</a></h4>
<pre><code class="language-bash">bal run regex_expressions.bal
Is the given string matched with the original string: true
Replaced string: Ballerina_is_great
String after replacing first Match: Replace thisTextThis
No of names: 4
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="os"><a class="header" href="#os">OS</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h1>
<p>The <code>os</code> library provides functions to retrieve information about the OS and the current users of the OS.<br/><br/>
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/os/latest/">OS module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/os;

public function main() {
    // Returns the environment variable value associated with the `HTTP_PORT`.
    string port = os:getEnv(&quot;HTTP_PORT&quot;);
    io:println(&quot;HTTP_PORT: &quot;, port);

    // Returns the username of the current user.
    string username = os:getUsername();
    io:println(&quot;Username: &quot;, username);

    // Returns the current user's home directory path.
    string userHome = os:getUserHome();
    io:println(&quot;Userhome: &quot;, userHome);
}
</code></pre>
<h4 id="output-300"><a class="header" href="#output-300">Output</a></h4>
<pre><code class="language-bash">bal run environment_variables.bal
HTTP_PORT: 5005
Username: Alex
Userhome: /Users/Alex
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xml-data"><a class="header" href="#xml-data">XML Data</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="xml-json-conversion"><a class="header" href="#xml-json-conversion">XML JSON Conversion</a></h1>
<p>The <code>xmldata:fromJson()</code> and <code>xmldata:toJson()</code> functions are used to do the conversions between JSON and XML.
For more information on the underlying module,
see the <a href="https:docs.central.ballerina.io/ballerina/xmldata/latest/">xmldata module</a>.</p>
<pre><code class="language-go">import ballerina/io;
import ballerina/xmldata;

public function main() returns error? {
    // Creates a JSON object.
    json jsonObject = {&quot;Store&quot;: {
            &quot;@id&quot;: &quot;AST&quot;,
            &quot;name&quot;: &quot;Anne&quot;,
            &quot;address&quot;: {
                &quot;street&quot;: &quot;Main&quot;,
                &quot;city&quot;: &quot;94&quot;
            },
            &quot;codes&quot;: [&quot;4&quot;, &quot;8&quot;]
        }};
    // Converts the JSON object to XML using a default `attributePrefix` (i.e., the `@` character)
    // and the default `arrayEntryTag` (i.e., `root`).
    xml? xmlData = check xmldata:fromJson(jsonObject);
    io:println(xmlData);

    if (xmlData is xml) {
        // Converts the XML to JSON object using a default `attributePrefix` (i.e., the `@` character)
        // and the default `preserveNamespaces` (i.e., `true`).
        jsonObject = check xmldata:toJson(xmlData);
        io:println(jsonObject);
    }
}
</code></pre>
<h4 id="output-301"><a class="header" href="#output-301">Output</a></h4>
<pre><code class="language-bash">bal run xml_json_conversion.bal
&lt;Store id=&quot;AST&quot;&gt;&lt;name&gt;Anne&lt;/name&gt;&lt;address&gt;&lt;street&gt;Main&lt;/street&gt;&lt;city&gt;94&lt;/city&gt;&lt;/address&gt;&lt;codes&gt;4&lt;/codes&gt;&lt;codes&gt;8&lt;/codes&gt;&lt;/Store&gt;
{&quot;Store&quot;:{&quot;name&quot;:&quot;Anne&quot;,&quot;address&quot;:{&quot;street&quot;:&quot;Main&quot;,&quot;city&quot;:&quot;94&quot;},&quot;codes&quot;:[&quot;4&quot;,&quot;8&quot;],&quot;@id&quot;:&quot;AST&quot;}}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tracing"><a class="header" href="#tracing">Tracing</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="distributed-tracing"><a class="header" href="#distributed-tracing">Distributed Tracing</a></h1>
<p>Ballerina supports Observability out of the box, and Tracing is one of the three important aspects of
Observability. To observe Ballerina code, the build time flag <code>--observability-included</code> should be given along with the
<code>Config.toml</code> file when starting the service. The <code>Config.toml</code> file contains the required runtime configurations related to observability.
The developers can trace their code blocks and measure the time incurred during the actual runtime execution.
They can choose to hook their measurement with the default trace created or can create a completely new trace.<br/><br/>
For more information about configs and observing applications, see <a href="https:ballerina.io/learn/observing-ballerina-code/">Observing Ballerina Code</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/log;
import ballerina/observe;
import ballerina/lang.runtime;
import ballerinax/jaeger as _;

// Simple `Hello` HTTP Service
service /hello on new http:Listener(9234) {

    // Resource functions are invoked with the HTTP caller and the
    // incoming request as arguments.
    resource function get sayHello(http:Caller caller, http:Request req)
            returns error? {
        http:Response res = new;

        //Start a child span attaching to the generated system span.
        int spanId = check observe:startSpan(&quot;MyFirstLogicSpan&quot;);

        //Start a new root span without attaching to the system span.
        int rootParentSpanId = observe:startRootSpan(&quot;MyRootParentSpan&quot;);
        // Some actual logic will go here, and for example, we have introduced some delay with the sleep.
        runtime:sleep(1);
        //Start a new child span for the `MyRootParentSpan` span.
        int childSpanId = check observe:startSpan(&quot;MyRootChildSpan&quot;, (),
                                                            rootParentSpanId);
        // Some actual logic will go here, and for example, we have introduced some delay with the sleep.
        runtime:sleep(1);
        //Finish the `MyRootChildSpan` span.
        error? result = observe:finishSpan(childSpanId);
        if (result is error) {
            log:printError(&quot;Error in finishing span&quot;, 'error = result);
        }
        // Some actual logic will go here, and for example, we have introduced some delay with the sleep.
        runtime:sleep(1);
        //Finish the `MyRootParentSpan` span.
        result = observe:finishSpan(rootParentSpanId);
        if (result is error) {
            log:printError(&quot;Error in finishing span&quot;, 'error = result);
        }

        //Some actual logic will go here, and for example, we have introduced some delay with the sleep.
        runtime:sleep(1);

        //Finish the created child `MyFirstLogicSpan` span, which was attached to the system trace.
        result = observe:finishSpan(spanId);
        if (result is error) {
            log:printError(&quot;Error in finishing span&quot;, 'error = result);
        }
        //Use a util method to set a string payload.
        res.setPayload(&quot;Hello, World!&quot;);

        //Send the response back to the caller.
        result = caller-&gt;respond(res);

        if (result is error) {
            log:printError(&quot;Error sending response&quot;, 'error = result);
        }

        return ();
    }
}
</code></pre>
<h4 id="output-302"><a class="header" href="#output-302">Output</a></h4>
<pre><code class="language-bash">// Invoke the service using cURL and access Jaeger UI in `http://localhost:16686`.
curl http://localhost:9234/hello/sayHello
Hello, World!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="counter-based-metrics"><a class="header" href="#counter-based-metrics">Counter-Based Metrics</a></h1>
<p>Ballerina supports Observability out of the box and Metrics is one of the three important aspects of 
Observability. To observe Ballerina code, the <code>--observability-included</code> build time flag should be given along with the
<code>Config.toml</code> file when starting the service. The <code>Config.toml</code> file contains the required runtime configurations related to observability.
You can define and use metrics to measure your own logic. A counter is one type of the metrics that is
supported by default in Ballerina, and it is a cumulative metric that represents a single monotonically-increasing
counter whose value can only increase or be reset to zero.<br/><br/>
For more information about configs and observing applications, see <a href="https:ballerina.io/learn/observing-ballerina-code/">Observing Ballerina Code</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;
import ballerina/log;
import ballerina/observe;
import ballerinax/prometheus as _;

//Create a counter as a global variable in the service with the optional field description.
observe:Counter globalCounter = new (&quot;total_orders&quot;,
                                    desc = &quot;Total quantity required&quot;);

service /onlineStoreService on new http:Listener(9090) {

    resource function get makeOrder(http:Caller caller, http:Request req) {
        //Incrementing the global counter defined with the default value 1.
        globalCounter.increment();

        //Create a counter with simply a name.
        observe:Counter localCounter = new (&quot;local_operations&quot;);
        localCounter.increment();
        //Increment the value of the counter by 20.
        localCounter.increment(20);

        //Create a counter with optional fields description, and tags.
        observe:Counter registeredCounter = new (&quot;total_product_order_quantity&quot;,
            desc = &quot;Total quantity required&quot;,
            tags = {prodName: &quot;HeadPhone&quot;, prodType: &quot;Electronics&quot;});

        //Register the counter instance, therefore it is stored in the global registry and can be reported to the
        //metrics server such as Prometheus. Additionally, this operation will register to the global registry for the
        //first invocation and will throw an error if there is already a registration of different metrics instance
        //or type. Subsequent invocations of register() will simply retrieve the stored metrics instance
        //for the provided name and tags fields, and use that instance for the subsequent operations on the
        //counter instance.
        error? result = registeredCounter.register();
        if (result is error) {
            log:printError(&quot;Error in registering counter&quot;, 'error = result);
        }

        //Increase the amount of the registered counter instance by amount 10.
        registeredCounter.increment(10);

        //Get the value of the counter instances.
        io:println(&quot;------------------------------------------&quot;);
        io:println(&quot;Global Counter = &quot;, globalCounter.getValue());
        io:println(&quot;Local Counter = &quot;, localCounter.getValue());
        io:println(&quot;Registered Counter = &quot;, registeredCounter.getValue());
        io:println(&quot;------------------------------------------&quot;);

        //Send reponse to the client.
        http:Response res = new;
        // Use a util method to set a string payload.
        res.setPayload(&quot;Order Processed!&quot;);

        // Send the response back to the caller.
        result = caller-&gt;respond(res);
        if (result is error) {
            log:printError(&quot;Error sending response&quot;, 'error = result);
        }
    }
}
</code></pre>
<h4 id="output-303"><a class="header" href="#output-303">Output</a></h4>
<pre><code class="language-bash"># To start the service, navigate to the directory that contains the
# `.bal` file and execute the `bal run` command below with the `--observability-included` build time flag and the `Config.toml` runtime configuration file.
BAL_CONFIG_FILES=Config.toml bal run --observability-included counter_metrics.bal

ballerina: started Prometheus HTTP listener 0.0.0.0:9797
------------------------------------------
Global Counter = 1
Local Counter = 21
Registered Counter = 10
------------------------------------------
------------------------------------------
Global Counter = 2
Local Counter = 21
Registered Counter = 20
------------------------------------------
------------------------------------------
Global Counter = 3
Local Counter = 21
Registered Counter = 30
------------------------------------------
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="metrics"><a class="header" href="#metrics">Metrics</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gauge-based-metrics"><a class="header" href="#gauge-based-metrics">Gauge-Based Metrics</a></h1>
<p>Ballerina supports Observability out of the box and Metrics is one of the three important aspects of the
Observability. To observe Ballerina code, the build time flag <code>--observability-included</code> should be given along with the
<code>Config.toml</code> file when starting the service. The <code>Config.toml</code> file contains the required runtime configurations related to observability.
The developers can define and use metrics to measure their own logic. A gauge is one type of the metrics that is
supported by default in Ballerina, and it represents a single numerical value that can arbitrarily go up and down,
and also based on the statistics configurations provided to the Gauge, it can also report the statistics such as max,
min, mean, percentiles, etc.<br/><br/>
For more information about configs and observing applications, see <a href="https:ballerina.io/learn/observing-ballerina-code/">Observing Ballerina Code</a>.</p>
<pre><code class="language-go">import ballerina/http;
import ballerina/io;
import ballerina/log;
import ballerina/observe;
import ballerinax/prometheus as _;

//Create a gauge as a global variable in the service with the optional field description,
//default statistics configurations = { timeWindow: 600000, buckets: 5,
// and percentiles: [0.33, 0.5, 0.66, 0.99] }.
observe:Gauge globalGauge = new (&quot;global_gauge&quot;, &quot;Global gauge defined&quot;);

service /onlineStoreService on new http:Listener(9090) {

    resource function get makeOrder(http:Caller caller, http:Request req) {
        io:println(&quot;------------------------------------------&quot;);
        //Incrementing the global gauge defined by 15.0.
        globalGauge.increment(15.0);
        //Log the current state of global gauge.
        printGauge(globalGauge);


        //Create a gauge with simply a name, and default statistics configurations.
        observe:Gauge localGauge = new (&quot;local_operations&quot;);
        //Increment the local gauge by default value 1.0.
        localGauge.increment();
        //Increment the value of the gauge by 20.
        localGauge.increment(20.0);
        //Decrement the local gauge by default value 1.0.
        localGauge.decrement();
        //Decrement the value of the gauge by 20.
        localGauge.decrement(10.0);
        //Log the current state of local gauge.
        printGauge(localGauge);


        //Create a gauge with optional fields description, and tags defined.
        observe:Gauge registeredGaugeWithTags =
                  new (&quot;registered_gauge_with_tags&quot;, &quot;RegisteredGauge&quot;,
                       {property: &quot;gaugeProperty&quot;, gaugeType: &quot;RegisterType&quot;});

        //Register the gauge instance, therefore it is stored in the global registry and can be reported to the
        //metrics server such as Prometheus. Additionally, this operation will register to the global registry for the
        //first invocation and will throw an error if there is already a registration of different metrics instance
        //or type. And subsequent invocations of register() will simply retrieve the stored metrics instance
        //for the provided name and tags fields, and use that instance for the subsequent operations on the
        //Counter instance.
        error? result = registeredGaugeWithTags.register();
        if (result is error) {
            log:printError(&quot;Error in registering gauge&quot;, 'error = result);
        }

        //Set the value of the gauge with the new value.
        registeredGaugeWithTags.increment();
        float value = registeredGaugeWithTags.getValue();
        float newValue = value * 12.0;
        registeredGaugeWithTags.setValue(newValue);
        //Log the current state of registered gauge with tags.
        printGauge(registeredGaugeWithTags);


        //Create a gauge with statistics disabled by passing empty statistics config array.
        observe:StatisticConfig[] statsConfigs = [];
        observe:Gauge gaugeWithNoStats = new (&quot;gauge_with_no_stats&quot;,
                                        &quot;Some description&quot;, (), statsConfigs);
        gaugeWithNoStats.setValue(100);
        printGauge(gaugeWithNoStats);


        //Create gauge with custom statistics config.
        observe:StatisticConfig config = {
            timeWindow: 30000,
            percentiles: [0.33, 0.5, 0.9, 0.99],
            buckets: 3
        };
        statsConfigs[0] = config;
        observe:Gauge gaugeWithCustomStats = new (&quot;gauge_with_custom_stats&quot;,
                                        &quot;Some description&quot;, (), statsConfigs);
        int i = 1;
        while (i &lt; 6) {
            gaugeWithCustomStats.setValue(&lt;float&gt;(100 * i));
            i = i + 1;
        }
        //Log the current state of registered gauge with tags.
        printGauge(gaugeWithCustomStats);

        io:println(&quot;------------------------------------------&quot;);

        //Send response to the client.
        http:Response res = new;
        // Use a util method to set a string payload.
        res.setPayload(&quot;Order Processed!&quot;);

        // Send the response back to the caller.
        result = caller-&gt;respond(res);

        if (result is error) {
            log:printError(&quot;Error sending response&quot;, 'error = result);
        }
    }
}

function printGauge(observe:Gauge gauge) {
    //Get the statistics snapshot of the gauge.
    io:print(&quot;Gauge - &quot; + gauge.name + &quot; Snapshot: &quot;);
    observe:Snapshot[]? snapshots = gauge.getSnapshot();
    json|error snapshotAsAJson = snapshots.cloneWithType(json);
    if snapshotAsAJson is json {
        io:println(snapshotAsAJson.toJsonString());
    }
    //Get the current value of the gauge.
    io:println(&quot;Gauge - &quot;, gauge.name, &quot; Current Value: &quot;
        , gauge.getValue());
}
</code></pre>
<h4 id="output-304"><a class="header" href="#output-304">Output</a></h4>
<pre><code class="language-bash">// Invoke the service three times using the cURL commands below.
curl http://localhost:9090/onlineStoreService/makeOrder
Order Processed!
curl http://localhost:9090/onlineStoreService/makeOrder
Order Processed!
curl http://localhost:9090/onlineStoreService/makeOrder
Order Processed!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="code-to-cloud"><a class="header" href="#code-to-cloud">Code to Cloud</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="kubernetes"><a class="header" href="#kubernetes">Kubernetes</a></h1>
<p>Ballerina supports generating Docker and Kubernetes artifacts from code without any additional configuration.
This simplifies the experience of developing and deploying Ballerina code in the cloud.
Code to cloud builds the containers and required artifacts by deriving the required values from the code.
If you want to override the default values taken by the compiler, you can use a <code>Cloud.toml</code> file. <br/><br/>
For more information, see <a href="categories/code-to-cloud//learn/deployment/code-to-cloud">Code to Cloud Deployment</a>.</p>
<pre><code class="language-go">import ballerina/http;

// Note that the code below is completely focused on the business logic and it does not specify anything related to operations.
listener http:Listener helloEP = new(9090);

service http:Service /helloWorld on helloEP {
    resource function get sayHello() returns string {
        return &quot;Hello, World from service helloWorld ! \n&quot;;
    }
}
</code></pre>
<h4 id="output-305"><a class="header" href="#output-305">Output</a></h4>
<pre><code class="language-bash"># Before you build the package, we are going to override some of the default values taken by the compiler,
In order to do this you need to create a filed named `Cloud.toml` in package directory and paste the following content into it.
All the supported key value properties can be found in the Code to cloud deployment guide.

[container.image]
repository=&quot;wso2inc&quot;
name=&quot;hello&quot;
tag=&quot;v0.1.0&quot;

Additionally, if you are using minikube, you could execute the following command to reuse the Docker daemon from minikube.
$ eval $(minikube docker-env)

# Now let's build the ballerina package.

# Note that the `bal build` command should be executed on the package. Code to cloud generates only one container per package.
$ bal build

Compiling source
        wso2/hello:0.1.0

Creating balas
        target/bala/hello-2020r2-any-0.1.0.bala

Running Tests

        wso2/hello:0.1.0
        No tests found

Generating executables
        target/bin/hello.jar

Generating artifacts...

        @kubernetes:Service                      - complete 1/1
        @kubernetes:Deployment                   - complete 1/1
        @kubernetes:HPA                          - complete 1/1
        @kubernetes:Docker                       - complete 2/2

        Execute the below command to deploy the Kubernetes artifacts:
        kubectl apply -f /home/wso2/project/target/kubernetes/hello-0.1.0

        Execute the below command to access service via NodePort:
        kubectl expose deployment wso2-hello-0--deployment --type=NodePort --name=wso2-hello-0--svc-local



# Lets try executing the Docker image separately first.

# Verify if the Docker image is generated. If you have used `minikube docker-env`, you have to skip this and go to Kubernetes deployment directly.
$ docker images

REPOSITORY                    TAG                 IMAGE ID            CREATED             SIZE
wso2inc/hello                       v0.1.0              60d95f0928b2        About a minute ago   228MB

# Run the generated Docker image.
$ docker run -d -p 9090:9090 wso2inc/hello:v0.1.0
c04194eb0b4d0d78cbc8ca55e0527d381d8ab4a1a68f8ea5dd3770a0845d5fbb

# Access the service.
$ curl http://localhost:9090/helloWorld/sayHello
Hello, World from service helloWorld !

# Lets try executing Kubernetes service now.
$ kubectl apply -f /home/wso2/project/target/kubernetes/hello-0.1.0
service/helloep-svc created
deployment.apps/wso2-hello-0--deployment created
horizontalpodautoscaler.autoscaling/wso2-hello-0--hpa created

# Verify the kubernetes pods.
$ kubectl get pods
NAME                                          READY   STATUS    RESTARTS   AGE
wso2-hello-0--deployment-7d4d56457b-7jlzx   1/1     Running   0          57s

# Expose via Nodeport to test in the developer environment.
$ kubectl expose deployment wso2-hello-0--deployment --type=NodePort --name=wso2-hello-0--svc-local
service/wso2-hello-0--svc-local exposed

# Get the IP and port of the Kubernetes service.
$ kubectl get svc
NAME                        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE
wso2-hello-0--svc-local   NodePort    10.111.61.112    &lt;none&gt;        9090:32437/TCP   4m17s

# If you are using Minikube, IP address should be changed according to the output of the `minikube ip` command.
$ minikube ip
192.168.49.2

# Access the deployed service via CURL.
$ curl http://192.168.49.2:32437/helloWorld/sayHello
Hello, World from service helloWorld !
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="function-as-a-service"><a class="header" href="#function-as-a-service">Function as a Service</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="azure-functions"><a class="header" href="#azure-functions">Azure Functions</a></h1>
<p>Azure Functions is an event driven, serverless computing platform.
Ballerina functions can be deployed in Azure Functions by annotating a Ballerina function with Azure functions annotation&quot;. You can view the code examples below.
For more information, see the <a href="https:ballerina.io/learn/deployment/azure-functions/">Azure Deployment Guide</a>.</p>
<pre><code class="language-go">import ballerina/uuid;
import ballerinax/azure_functions as af;

// HTTP request/response with no authentication
@af:Function
public function hello(@af:HTTPTrigger { authLevel: &quot;anonymous&quot; }
                      string payload)
                      returns @af:HTTPOutput string|error {
    return &quot;Hello, &quot; + payload + &quot;!&quot;;
}

// HTTP request to add data to a queue
@af:Function
public function fromHttpToQueue(af:Context ctx, 
            @af:HTTPTrigger af:HTTPRequest req, 
            @af:QueueOutput { queueName: &quot;queue1&quot; } af:StringOutputBinding msg) 
            returns @af:HTTPOutput af:HTTPBinding {
    msg.value = req.body;
    return { statusCode: 200, payload: &quot;Request: &quot; + req.toString() };
}

// A message put to a queue is copied to another queue
@af:Function
public function fromQueueToQueue(af:Context ctx, 
        @af:QueueTrigger { queueName: &quot;queue2&quot; } string inMsg,
        @af:QueueOutput { queueName: &quot;queue3&quot; } af:StringOutputBinding outMsg) {
    ctx.log(&quot;In Message: &quot; + inMsg);
    ctx.log(&quot;Metadata: &quot; + ctx.metadata.toString());
    outMsg.value = inMsg;
}

// A blob added to a container is copied to a queue
@af:Function
public function fromBlobToQueue(af:Context ctx, 
        @af:BlobTrigger { path: &quot;bpath1/{name}&quot; } byte[] blobIn,
        @af:BindingName  string name,
        @af:QueueOutput { queueName: &quot;queue3&quot; } af:StringOutputBinding outMsg) 
        returns error? {
    outMsg.value = &quot;Name: &quot; + name + &quot; Content: &quot; + blobIn.toString();
}

// HTTP request to read a blob value
@af:Function
public function httpTriggerBlobInput(@af:HTTPTrigger af:HTTPRequest req, 
                    @af:BlobInput { path: &quot;bpath1/{Query.name}&quot; }
                    byte[]? blobIn)
                    returns @af:HTTPOutput string {
    int length = 0;
    if blobIn is byte[] {
        length = blobIn.length();
    }
    return &quot;Blob: &quot; + req.query[&quot;name&quot;].toString() + &quot; Length: &quot; + 
            length.toString() + &quot; Content: &quot; + blobIn.toString();
}

// HTTP request to add a new blob
@af:Function
public function httpTriggerBlobOutput(@af:HTTPTrigger af:HTTPRequest req, 
        @af:BlobOutput { path: &quot;bpath1/{Query.name}&quot; }
            af:StringOutputBinding bb)
        returns @af:HTTPOutput string|error {
    bb.value = req.body;
    return &quot;Blob: &quot; + req.query[&quot;name&quot;].toString() + &quot; Content: &quot; + 
            bb?.value.toString();
}

// HTTP request to add a new blob
@af:Function
public function httpTriggerBlobOutput2(@af:HTTPTrigger af:HTTPRequest req,
        @af:BlobOutput { path: &quot;bpath1/{Query.name}&quot; } af:BytesOutputBinding bb)
        returns @af:HTTPOutput string|error {
    bb.value = [65, 66, 67, 97, 98];
    return &quot;Blob: &quot; + req.query[&quot;name&quot;].toString() + &quot; Content: &quot; +
            bb?.value.toString();
}

// Sending an SMS
@af:Function
public function sendSMS(@af:HTTPTrigger af:HTTPRequest req, 
                        @af:TwilioSmsOutput { fromNumber: &quot;+12069845840&quot; } 
                                              af:TwilioSmsOutputBinding tb)
                        returns @af:HTTPOutput string {
    tb.to = req.query[&quot;to&quot;].toString();
    tb.body = req.body.toString();
    return &quot;Message - to: &quot; + tb?.to.toString() + &quot; body: &quot; +
            tb?.body.toString();
}

public type Person record {
    string id;
    string name;
    string country;
};

// CosmosDB record trigger
@af:Function
public function cosmosDBToQueue1(@af:CosmosDBTrigger { 
        connectionStringSetting: &quot;CosmosDBConnection&quot;, databaseName: &quot;db1&quot;,
        collectionName: &quot;c1&quot; } Person[] req, 
        @af:QueueOutput { queueName: &quot;queue3&quot; } af:StringOutputBinding outMsg) {
    outMsg.value = req.toString();
}

@af:Function
public function cosmosDBToQueue2(@af:CosmosDBTrigger { 
        connectionStringSetting: &quot;CosmosDBConnection&quot;, databaseName: &quot;db1&quot;, 
        collectionName: &quot;c2&quot; } json req,
        @af:QueueOutput { queueName: &quot;queue3&quot; } af:StringOutputBinding outMsg) {
    outMsg.value = req.toString();
}

// HTTP request to read CosmosDB records
@af:Function
public function httpTriggerCosmosDBInput1(
            @af:HTTPTrigger af:HTTPRequest httpReq, 
            @af:CosmosDBInput { connectionStringSetting: &quot;CosmosDBConnection&quot;, 
                databaseName: &quot;db1&quot;, collectionName: &quot;c1&quot;, 
                id: &quot;{Query.id}&quot;, partitionKey: &quot;{Query.country}&quot; } json dbReq)
                returns @af:HTTPOutput string|error {
    return dbReq.toString();
}

@af:Function
public function httpTriggerCosmosDBInput2(
            @af:HTTPTrigger af:HTTPRequest httpReq, 
            @af:CosmosDBInput { connectionStringSetting: &quot;CosmosDBConnection&quot;, 
                databaseName: &quot;db1&quot;, collectionName: &quot;c1&quot;, 
                id: &quot;{Query.id}&quot;, partitionKey: &quot;{Query.country}&quot; }
                      Person? dbReq)
                returns @af:HTTPOutput string|error {
    return dbReq.toString();
}

@af:Function
public function httpTriggerCosmosDBInput3(
        @af:HTTPTrigger { route: &quot;c1/{country}&quot; } af:HTTPRequest httpReq, 
        @af:CosmosDBInput { connectionStringSetting: &quot;CosmosDBConnection&quot;, 
        databaseName: &quot;db1&quot;, collectionName: &quot;c1&quot;, 
        sqlQuery: &quot;select * from c1 where c1.country = {country}&quot; } 
        Person[] dbReq)
        returns @af:HTTPOutput string|error {
    return dbReq.toString();
}

// HTTP request to write records to CosmosDB
@af:Function
public function httpTriggerCosmosDBOutput1(
    @af:HTTPTrigger af:HTTPRequest httpReq, @af:HTTPOutput af:HTTPBinding hb) 
    returns @af:CosmosDBOutput { connectionStringSetting: &quot;CosmosDBConnection&quot;, 
                                 databaseName: &quot;db1&quot;, collectionName: &quot;c1&quot; }
                                 json {
    json entry = { id: uuid:createType1AsString(), name: &quot;Saman&quot;,
                    country: &quot;Sri Lanka&quot; };
    hb.payload = &quot;Adding entry: &quot; + entry.toString();
    return entry;
}

@af:Function
public function httpTriggerCosmosDBOutput2(
        @af:HTTPTrigger af:HTTPRequest httpReq, 
        @af:HTTPOutput af:HTTPBinding hb) 
        returns @af:CosmosDBOutput { 
            connectionStringSetting: &quot;CosmosDBConnection&quot;, 
            databaseName: &quot;db1&quot;, collectionName: &quot;c1&quot; } json {
    json entry = [{ id: uuid:createType1AsString(),
                    name: &quot;John Doe A&quot;, country: &quot;USA&quot; },
                  { id: uuid:createType1AsString(),
                    name: &quot;John Doe B&quot;, country: &quot;USA&quot; }];
    hb.payload = &quot;Adding entries: &quot; + entry.toString();
    return entry;
}

@af:Function
public function httpTriggerCosmosDBOutput3(
                    @af:HTTPTrigger af:HTTPRequest httpReq) 
                    returns @af:CosmosDBOutput { 
                        connectionStringSetting: &quot;CosmosDBConnection&quot;, 
                        databaseName: &quot;db1&quot;, collectionName: &quot;c1&quot; } Person[] {
    Person[] persons = [];
    persons.push({id: uuid:createType1AsString(), name: &quot;Jack&quot;, country: &quot;UK&quot;});
    persons.push({id: uuid:createType1AsString(), name: &quot;Will&quot;, country: &quot;UK&quot;});
    return persons;
}

// A timer function which is executed every 10 seconds.
@af:Function
public function queuePopulationTimer(
            @af:TimerTrigger { schedule: &quot;*/10 * * * * *&quot; } json triggerInfo, 
            @af:QueueOutput { queueName: &quot;queue4&quot; }
             af:StringOutputBinding msg) {msg.value = triggerInfo.toString();
}
</code></pre>
<h4 id="output-306"><a class="header" href="#output-306">Output</a></h4>
<pre><code class="language-bash"># Prerequisites: Azure CLI tools installation and configuration. Visit [Azure Deployment Guide](https://ballerina.io/learn/deployment/azure-functions/) for detailed steps.

# Create a ballerina package and replace the contents of the generated bal file with the contents above.
bal new azure_functions_deployment

# Build the Ballerina program to generate the Azure Functions
bal build
Compiling source
	wso2/azure_functions_deployment:0.1.0

Generating executables
	@azure_functions:Function: hello, fromHttpToQueue, fromQueueToQueue, fromBlobToQueue, httpTriggerBlobInput, httpTriggerBlobOutput, sendSMS, cosmosDBToQueue1, cosmosDBToQueue2, httpTriggerCosmosDBInput1, httpTriggerCosmosDBInput2, httpTriggerCosmosDBInput3, httpTriggerCosmosDBOutput1, httpTriggerCosmosDBOutput2, httpTriggerCosmosDBOutput3, queuePopulationTimer

	Run the following command to deploy Ballerina Azure Functions:
	az functionapp deployment source config-zip -g &lt;resource_group&gt; -n &lt;function_app_name&gt; --src &lt;project_dir&gt;/target/bin/azure-functions.zip
	
    target/bin/azure_functions_deployment.jar
# Execute the Azure CLI command given by the compiler to publish the functions (replace with your respective Azure &lt;resource_group&gt; and &lt;function_app_name&gt;)
az functionapp deployment source config-zip -g functions1777 -n functions1777 --src  &lt;project_dir&gt;/target/bin/azure-functions.zip
Getting scm site credentials for zip deployment
Starting zip deployment. This operation can take a while to complete ...
Deployment endpoint responded with status code 202
{
  &quot;active&quot;: true,
  &quot;author&quot;: &quot;N/A&quot;,
  &quot;author_email&quot;: &quot;N/A&quot;,
  &quot;complete&quot;: true,
  &quot;deployer&quot;: &quot;ZipDeploy&quot;,
  &quot;end_time&quot;: &quot;2020-07-02T06:48:08.7706207Z&quot;,
  &quot;id&quot;: &quot;2bacf185fb114d42aab762dfd5f303dc&quot;,
  &quot;is_readonly&quot;: true,
  &quot;is_temp&quot;: false,
  &quot;last_success_end_time&quot;: &quot;2020-07-02T06:48:08.7706207Z&quot;,
  &quot;log_url&quot;: &quot;https://functions1777.scm.azurewebsites.net/api/deployments/latest/log&quot;,
  &quot;message&quot;: &quot;Created via a push deployment&quot;,
  &quot;progress&quot;: &quot;&quot;,
  &quot;provisioningState&quot;: null,
  &quot;received_time&quot;: &quot;2020-07-02T06:47:56.2756472Z&quot;,
  &quot;site_name&quot;: &quot;functions1777&quot;,
  &quot;start_time&quot;: &quot;2020-07-02T06:47:56.7600364Z&quot;,
  &quot;status&quot;: 4,
  &quot;status_text&quot;: &quot;&quot;,
  &quot;url&quot;: &quot;https://functions1777.scm.azurewebsites.net/api/deployments/latest&quot;
}

# Invoke the functions (replace with your &lt;auth_code&gt; value in authenticated requests)
curl -d &quot;Jack&quot; https://functions1777.azurewebsites.net/api/hello
Hello, Jack!

curl -d &quot;ABCDE&quot; https://functions1777.azurewebsites.net/api/fromHttpToQueue?code=&lt;auth_code&gt;
Request: url=https://functions1777.azurewebsites.net/api/fromHttpToQueue... body=ABCDE

curl &quot;https://functions1777.azurewebsites.net/api/httpTriggerBlobInput?name=input.txt&amp;code=&lt;auth_code&gt;&quot;
Blob: input.txt Length: 6 Content: 65 66 67 68 69 10

curl -d &quot;123456&quot; &quot;https://functions1777.azurewebsites.net/api/httpTriggerBlobOutput?name=payload.txt&amp;code=&lt;auth_code&gt;&quot;
Blob: payload.txt Content: 123456

curl -d &quot;123456&quot; &quot;https://functions1777.azurewebsites.net/api/httpTriggerBlobOutput2?name=payload.txt&amp;code=&lt;auth_code&gt;&quot;
Blob: payload.txt Content: 65 66 67 97 98

curl -d &quot;Hello!&quot; &quot;https://functions1777.azurewebsites.net/api/sendSMS?to=xxxxxxxxxx&amp;code=&lt;auth_code&gt;&quot;
Message - to: xxxxxxxxxx body: Hello!

curl &quot;https://functions1777.azurewebsites.net/api/httpTriggerCosmosDBInput1?id=id1&amp;code=&lt;auth_code&gt;&quot;
id=id1 _rid=zEkwANYTRPoFAAAAAAAAAA== _self=dbs/zEkwAA==/colls/zEkwANYTRPo=/docs/zEkwANYTRPoFAAAAAAAAAA==/ _ts=1591201470 _etag=&quot;10009f6c-0000-0100-0000-5ed7cebe0000&quot; name=Tom birthYear=1950 country=Sri Lanka pk=p1

curl &quot;https://functions1777.azurewebsites.net/api/httpTriggerCosmosDBInput2?id=id1&amp;code=&lt;auth_code&gt;&quot;
id=id1 name=Tom birthYear=1950 _rid=zEkwANYTRPoFAAAAAAAAAA== _self=dbs/zEkwAA==/colls/zEkwANYTRPo=/docs/zEkwANYTRPoFAAAAAAAAAA==/ _ts=1591201470 _etag=&quot;10009f6c-0000-0100-0000-5ed7cebe0000&quot; country=Sri Lanka pk=p1

curl &quot;https://functions1777.azurewebsites.net/api/c1/Sri%20Lanka?code=&lt;auth_code&gt;&quot;
id=id3 name=Jack X birthYear=1950 country=Sri Lanka pk=p1 _rid=zEkwANYTRPoEAAAAAAAAAA== _self=dbs/zEkwAA==/colls/zEkwANYTRPo=/docs/zEkwANYTRPoEAAAAAAAAAA==/ _etag=&quot;1000076b-0000-0100-0000-5ed7cc110000&quot; _attachments=attachments/ _ts=1591200785 id=id4 name=Tom birthYear=1950 country=Sri Lanka pk=p1 _rid=zEkwANYTRPoFAAAAAAAAAA== _self=dbs/zEkwAA==/colls/zEkwANYTRPo=/docs/zEkwANYTRPoFAAAAAAAAAA==/ _etag=&quot;10009f6c-0000-0100-0000-5ed7cebe0000&quot; _attachments=attachments/ _ts=1591201470

curl https://functions1777.azurewebsites.net/api/httpTriggerCosmosDBOutput1?code=&lt;auth_code&gt;
Adding entry: id=abf42517-53d7-4fa3-a30c-87cb65e9597d name=John Doe birthYear=1980

curl https://functions1777.azurewebsites.net/api/httpTriggerCosmosDBOutput2?code=&lt;auth_code&gt;
Adding entries: id=f510e0d2-5341-4901-8c12-9aac1b212378 name=John Doe A birthYear=1985 id=cc145a0f-cb4f-4a5f-8d0f-fbf01209aa2d name=John Doe B birthYear=1990

curl https://functions1777.azurewebsites.net/api/httpTriggerCosmosDBOutput3?code=&lt;auth_code&gt;
[{&quot;id&quot;:&quot;4ba53cb4-47a1-4028-af7b-2515f0a9c6bf&quot;,&quot;name&quot;:&quot;Jack&quot;,&quot;birthYear&quot;:2001},{&quot;id&quot;:&quot;5b8a6697-c9e9-488d-91b3-3942574efeef&quot;,&quot;name&quot;:&quot;Will&quot;,&quot;birthYear&quot;:2005}]


</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="aws-lambda"><a class="header" href="#aws-lambda">AWS Lambda</a></h1>
<p>AWS Lambda is an event driven, serverless computing platform.
Ballerina functions can be deployed in AWS Lambda by annotating
a Ballerina function with &quot;@awslambda:Function&quot;, which should have
the function signature <code>function (awslambda:Context, json|EventType) returns json|error</code>.<br/><br/>
For more information, see the <a href="https:ballerina.io/learn/deployment/aws-lambda/">AWS Lambda Deployment Guide</a>.</p>
<pre><code class="language-go">import ballerinax/awslambda;
import ballerina/uuid;
import ballerina/io;

// The `@awslambda:Function` annotation marks a function to
// generate an AWS Lambda function
@awslambda:Function
public function echo(awslambda:Context ctx, json input) returns json {
   return input;
}

@awslambda:Function
public function uuid(awslambda:Context ctx, json input) returns json {
   return uuid:createType1AsString();
}

// The `awslambda:Context` object contains request execution
// context information
@awslambda:Function
public function ctxinfo(awslambda:Context ctx, json input) returns json|error {
   json result = { RequestID: ctx.getRequestId(),
                   DeadlineMS: ctx.getDeadlineMs(),
                   InvokedFunctionArn: ctx.getInvokedFunctionArn(),
                   TraceID: ctx.getTraceId(),
                   RemainingExecTime: ctx.getRemainingExecutionTime() };
   return result;
}

@awslambda:Function
public function notifySQS(awslambda:Context ctx, 
                          awslambda:SQSEvent event) returns json {
    return event.Records[0].body;
}

@awslambda:Function
public function notifyS3(awslambda:Context ctx, 
                         awslambda:S3Event event) returns json {
    return event.Records[0].s3.'object.key;
}

@awslambda:Function
public function notifyDynamoDB(awslambda:Context ctx, 
                               awslambda:DynamoDBEvent event) returns json {
    return event.Records[0].dynamodb.Keys.toString();
}

@awslambda:Function
public function notifySES(awslambda:Context ctx, 
                          awslambda:SESEvent event) returns json {
    return event.Records[0].ses.mail.commonHeaders.subject;
}

@awslambda:Function
public function apigwRequest(awslambda:Context ctx, 
                             awslambda:APIGatewayProxyRequest request) {
    io:println(&quot;Path: &quot;, request.path);
}
</code></pre>
<h4 id="output-307"><a class="header" href="#output-307">Output</a></h4>
<pre><code class="language-bash"># Prerequisites: AWS CLI tools installation and configuration. Visit [AWS Lambda Deployment Guide](https://ballerina.io/learn/deployment/aws-lambda/) for detailed steps.

# Create a ballerina package and replace the contents of the generated bal file with the contents above.
bal new aws_lambda_deployment

# Build the Ballerina program to generate the AWS Lambda functions
$ bal build
Compiling source
	wso2/aws_lambda_deployment:0.1.0

Generating executables
	@awslambda:Function: echo, uuid, ctxinfo, notifySQS, notifyS3

	Run the following command to deploy each Ballerina AWS Lambda function:
	aws lambda create-function --function-name $FUNCTION_NAME --zip-file fileb://&lt;project_dir&gt;/target/bin/aws-ballerina-lambda-functions.zip --handler aws_lambda_deployment.$FUNCTION_NAME --runtime provided --role $LAMBDA_ROLE_ARN --layers arn:aws:lambda:$REGION_ID:134633749276:layer:ballerina-jre11:6 --memory-size 512 --timeout 10

	Run the following command to re-deploy an updated Ballerina AWS Lambda function:
	aws lambda update-function-code --function-name $FUNCTION_NAME --zip-file fileb://&lt;project_dir&gt;/target/bin/aws-ballerina-lambda-functions.zip
    
    target/bin/aws_lambda_deployment.jar
# Execute the AWS CLI commands to create and publish the functions; and set your respective AWS $LAMBDA_ROLE_ARN, $REGION_ID, and $FUNCTION_NAME values; following are some examples:-
$ aws lambda create-function --function-name echo --zip-file fileb://aws-ballerina-lambda-functions.zip --handler aws_lambda_deployment.echo --runtime provided --role arn:aws:iam::908363916111:role/lambda-role
 --layers arn:aws:lambda:us-west-1:134633749276:layer:ballerina-jre11:6 --memory-size 512 --timeout 10
$ aws lambda create-function --function-name uuid --zip-file fileb://aws-ballerina-lambda-functions.zip --handler aws_lambda_deployment.uuid --runtime provided --role arn:aws:iam::908363916111:role/lambda-role
 --layers arn:aws:lambda:us-west-1:134633749276:layer:ballerina-jre11:6 --memory-size 512 --timeout 10
$ aws lambda create-function --function-name ctxinfo --zip-file fileb://aws-ballerina-lambda-functions.zip --handler aws_lambda_deployment.ctxinfo --runtime provided --role arn:aws:iam::908363916111:role/lambda-role
 --layers arn:aws:lambda:us-west-1:134633749276:layer:ballerina-jre11:6 --memory-size 512 --timeout 10


# Invoke the functions
$ echo '{&quot;MESSAGE&quot;:&quot;HELLO&quot;}' &gt; input.json
$ aws lambda invoke --function-name echo --payload fileb://input.json echo-response.txt
{
    &quot;ExecutedVersion&quot;: &quot;$LATEST&quot;, 
    &quot;StatusCode&quot;: 200
}
$ cat echo-response.txt 
{&quot;MESSAGE&quot;:&quot;HELLO&quot;}

$ aws lambda invoke --function-name uuid uuid-response.txt
{
    &quot;ExecutedVersion&quot;: &quot;$LATEST&quot;, 
    &quot;StatusCode&quot;: 200
}
$ cat uuid-response.txt 
&quot;711cd328-1937-40cc-9078-c3628c6edb02&quot;

$ aws lambda invoke --function-name ctxinfo ctxinfo-response.txt
{
    &quot;ExecutedVersion&quot;: &quot;$LATEST&quot;, 
    &quot;StatusCode&quot;: 200
}
$ cat ctxinfo-response.txt 
{&quot;RequestID&quot;:&quot;d55f7d06-f2ab-4b6e-8606-482607785a91&quot;, &quot;DeadlineMS&quot;:1548069389978, &quot;InvokedFunctionArn&quot;:&quot;arn:aws:lambda:us-west-2:908363916138:function:ctxinfo&quot;, &quot;TraceID&quot;:&quot;Root=1-5c45aa03-f8aff4c9e24dc4fbf48f2990;Parent=17ad3b290def98fd;Sampled=0&quot;, &quot;RemainingExecTime&quot;:9946}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
